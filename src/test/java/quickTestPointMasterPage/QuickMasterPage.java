package quickTestPointMasterPage;

import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.StringSelection;
import java.awt.event.InputEvent;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.time.Duration;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.NoSuchElementException;
import java.util.Objects;
import java.util.Optional;
import java.util.Set;
import java.util.concurrent.TimeoutException;
import java.util.function.BiConsumer;
import java.util.stream.Collectors;

import org.apache.logging.log4j.util.TriConsumer;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.DataFormatter;
import org.apache.poi.ss.usermodel.FormulaEvaluator;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.ElementClickInterceptedException;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.NoAlertPresentException;
import org.openqa.selenium.StaleElementReferenceException;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Assert;
import org.testng.asserts.SoftAssert;

import com.Pages.CommodityDetailsPage;
import com.Pages.CustomerMasterPage;
import com.Pages.OHPMaster_PageClass;
import com.Pages.PartMasterPage;
import com.Pages.ProcessMasterPage;
import com.Pages.SupplierMasterPage;
import com.github.javafaker.Faker;
import com.google.common.base.Function;
import com.helper.Base;
import com.helper.ExcelFiller;
import com.helper.ExcelFiller.ValueType;
import com.helper.ExcelUtil;
import com.helper.LoggerUtil;
import java.util.HashMap;
import java.util.Map;
import java.util.function.BiConsumer;

public class QuickMasterPage extends Base {

	@FunctionalInterface
	public static interface TriConsumer<A, B, C> {
		void accept(A a, B b, C c);
	}

	SupplierMasterPage Supplier = new SupplierMasterPage();

	Actions action = new Actions(driver);
	static WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(20));

	static Faker faker = new Faker();

	SoftAssert soft = new SoftAssert();
	public static final By EnterCommodityGroupnameFirstTab = By.xpath("//input[@id='commodityGroup']");
	public static final By clickingSaveButtonFirstTab = By.xpath("//button[@id='tab1Save']");
	public static final By clickcommoditygroupdropBtnSecondTab = By
			.xpath("//span[@id='select2-commodityDropdown-container']");
	public static final By ListValueOfCommDropDownSecondTab = By.xpath("//select[@id='commodityDropdown']/option");

	public static final By commoditygrouptab = By.xpath("//div[@id='exTab3']/ul/li[2]/a");

	public static final By EntergroupclassficationForSecondTab = By.xpath("//input[@id='subGroupClassification']");
	public static final By EnterspecificgradevalueForSecondTab = By.xpath("//input[@id='SpecificGradeText']");
	public static final By EnterDensityForSecondTab = By.xpath("//input[@id='groupDensity']");
	public static final By ClcikingsavebtnForSecondTab = By.xpath("//button[@id='tab2Save']");
	public static final By toastmessageSecodTabForButtonReflection = By
			.xpath("//div[contains (@class,'toast-message')]");
	public static final By clickingupdatebtnForSecondTab = By.xpath("//button[@id='tab2Save']");
	public static final By EnterSearchBoxForSecondTab = By.xpath("(//input[contains(@type,'search')])[2]");
	public static final By clickingSaveButtonForSecondTabComGrp = By.xpath("//button[@id='tab2Save']");

////////////////////////////////////////////////////////////////Locators For Supplier Master ////////////////////////////////////////////////////////////////////////////////////////	

	public static final By EnterSearchboxForBusinessSegAndDomainTab = By.xpath(
			"//div[@id='businessdomainSegmentsTable_filter']/label/input[@class='form-control form-control-sm']");

	public static final By FetchingTableRowsFromBusinessDomAndSegTabTableSupp = By
			.xpath("//table[@id='businessdomainSegmentsTable']/tbody/tr");

	////////////////////////////////////////////// Commodity Details for Verifying
	////////////////////////////////////////////// Supplier Allocation
	////////////////////////////////////////////// ////////////////////////////////

	public static final By ClickingSearchFilterCommodityDetailsTabbtn = By.xpath("//div[@class='row cs_serch ']/div/i");
	public static final By clickingcheckboxlistForSearchfilter = By.xpath("//div[@id='chkddd']/label/input");
	public static final By EnteringValueSearchboxInCommodityDetailsTab = By.xpath("//input[@id='myInputListSearch']");

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	

	public static void SaveNewCommodityGroupNameFirstTab(String EnterCommodityGroupFirstTab)
			throws InterruptedException {

		Thread.sleep(4000);
		clearAndEnterText(waitForExpectedElement(EnterCommodityGroupnameFirstTab), EnterCommodityGroupFirstTab);
		Thread.sleep(3000);
		clickOnElement(clickingSaveButtonFirstTab);
		Thread.sleep(6000);

	}

	public static void verifyNewCommGrpName(String value, String EnterClssificationValue, String EnterGradeValue,
			String EnterDensityValue, String ExpectedMsg) throws InterruptedException {

// STEP 1: Click on dropdown
		try {
			LoggerUtil.info("STEP 1: Click on 'Commodity Group' dropdown in Second Tab.");
			clickOnElement(clickcommoditygroupdropBtnSecondTab);
			Thread.sleep(3000);
			LoggerUtil.pass("Dropdown opened successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click on commodity group dropdown. " + e.getMessage());
			Assert.fail("Dropdown click failed.");
		}

// STEP 2: Select commodity group
		try {
			LoggerUtil.info("STEP 2: Select commodity group value → " + value);
			List<WebElement> Commgrpnamelist = driver.findElements(ListValueOfCommDropDownSecondTab);
			boolean isFound = false;
			for (WebElement Comgrpname : Commgrpnamelist) {
				String actualdata = Comgrpname.getText().trim();
				if (actualdata.equalsIgnoreCase(value)) {
					Comgrpname.click();
					LoggerUtil.pass("Commodity group selected successfully: " + actualdata);
					isFound = true;
					break;
				}
			}
			if (!isFound) {
				LoggerUtil.fail("Commodity group not found in dropdown: " + value);
				Assert.fail("Commodity group not found: " + value);
			}
		} catch (Exception e) {
			LoggerUtil.fail("Exception while selecting commodity group. " + e.getMessage());
			Assert.fail("Commodity group selection failed.");
		}

// STEP 3: Enter Group Classification
		try {
			LoggerUtil.info("STEP 3: Enter Group Classification → " + EnterClssificationValue);
			clearAndEnterText(waitForExpectedElement(EntergroupclassficationForSecondTab), EnterClssificationValue);
			LoggerUtil.pass("Group Classification entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Group Classification. " + e.getMessage());
			Assert.fail("Group Classification entry failed.");
		}

// STEP 4: Enter Specific Grade
		try {
			LoggerUtil.info("STEP 4: Enter Specific Grade → " + EnterGradeValue);
			clearAndEnterText(waitForExpectedElement(EnterspecificgradevalueForSecondTab), EnterGradeValue);
			LoggerUtil.pass("Specific Grade entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Specific Grade. " + e.getMessage());
			Assert.fail("Specific Grade entry failed.");
		}

// STEP 5: Enter Density
		try {
			LoggerUtil.info("STEP 5: Enter Density → " + EnterDensityValue);
			clearAndEnterText(waitForExpectedElement(EnterDensityForSecondTab), EnterDensityValue);
			LoggerUtil.pass("Density entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Density. " + e.getMessage());
			Assert.fail("Density entry failed.");
		}

// STEP 6: Click Save button
		try {
			LoggerUtil.info("STEP 6: Click Save button.");
			clickOnElement(ClcikingsavebtnForSecondTab);
			LoggerUtil.pass("Save button clicked successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click Save button. " + e.getMessage());
			Assert.fail("Save button click failed.");
		}

// STEP 7: Validate Toast Message
		try {
			LoggerUtil.info("STEP 7: Validate success toast message.");
			String actual = waitForExpectedElement(toastmessageSecodTabForButtonReflection).getText().trim();
			LoggerUtil.info("→ Expected: " + ExpectedMsg);
			LoggerUtil.info("→ Actual: " + actual);

			if (actual.contains(ExpectedMsg)) {
				LoggerUtil.pass("Toast message validated successfully.");
			} else {
				LoggerUtil.fail("Toast message mismatch.");
			}
			Assert.assertTrue(actual.contains(ExpectedMsg));
		} catch (Exception e) {
			LoggerUtil.fail("Failed to validate toast message. " + e.getMessage());
			Assert.fail("Toast validation failed.");
		}
	}

	public static final By editbtn = By.xpath("//table[@id='SubGroupTable']/tbody/tr/td[6]/a[1]/i");

	public void editandupdateexistingentry(String value, String groupClassification, String specificGrade,
			String density, String searchValue, String EnterUpdatedValueSpecificGrade) throws InterruptedException {

// STEP 4: Click on 'Commodity Group' tab
		try {
			LoggerUtil.info("STEP 4: Click on 'Commodity Group' tab.");
			clickOnElement(commoditygrouptab);
			Thread.sleep(3000);
			LoggerUtil.pass("Clicked on 'Commodity Group' tab successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click on 'Commodity Group' tab. " + e.getMessage());
			Assert.fail("Commodity Group tab click failed.");
		}

// STEP 5: Open 'Commodity Group' dropdown and select a value
		try {
			LoggerUtil.info("STEP 5: Open 'Commodity Group' dropdown and select a value.");
			clickOnElement(clickcommoditygroupdropBtnSecondTab);
			Thread.sleep(3000);

			List<WebElement> Commgrpnamelist = driver.findElements(ListValueOfCommDropDownSecondTab);
			boolean isFound = false;
			for (WebElement Comgrpname : Commgrpnamelist) {
				String actualdata = Comgrpname.getText().trim();
				if (actualdata.equalsIgnoreCase(value)) {
					Comgrpname.click();
					LoggerUtil.pass("Commodity group selected successfully: " + actualdata);
					isFound = true;
					break;
				}
			}
			if (!isFound) {
				LoggerUtil.fail("Commodity group not found in dropdown: " + value);
				Assert.fail("Commodity group not found: " + value);
			}
		} catch (Exception e) {
			LoggerUtil.fail("Exception while selecting commodity group. " + e.getMessage());
			Assert.fail("Commodity group selection failed.");
		}

// STEP 6: Enter Group Classification
		try {
			LoggerUtil.info("STEP 6: Entering Group Classification → " + groupClassification);
			clearAndEnterText(waitForExpectedElement(EntergroupclassficationForSecondTab), groupClassification);
			Thread.sleep(2000);
			LoggerUtil.pass("Group Classification entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Group Classification. " + e.getMessage());
			Assert.fail("Group Classification entry failed.");
		}

// STEP 7: Enter Specific Grade
		try {
			LoggerUtil.info("STEP 7: Entering Specific Grade → " + specificGrade);
			clearAndEnterText(waitForExpectedElement(EnterspecificgradevalueForSecondTab), specificGrade);
			Thread.sleep(2000);
			LoggerUtil.pass("Specific Grade entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Specific Grade. " + e.getMessage());
			Assert.fail("Specific Grade entry failed.");
		}

// STEP 8: Enter Density
		try {
			LoggerUtil.info("STEP 8: Entering Density → " + density);
			clearAndEnterText(waitForExpectedElement(EnterDensityForSecondTab), density);
			Thread.sleep(2000);
			LoggerUtil.pass("Density entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Density. " + e.getMessage());
			Assert.fail("Density entry failed.");
		}

// STEP 9: Save new commodity group
		try {
			LoggerUtil.info("STEP 9: Saving new commodity group.");
			clickOnElement(clickingSaveButtonForSecondTabComGrp);
			Thread.sleep(9000);
			LoggerUtil.pass("New commodity group saved successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to save new commodity group. " + e.getMessage());
			Assert.fail("Save action failed.");
		}

// STEP 10: Search for saved entry
		try {
			LoggerUtil.info("STEP 10: Searching for the saved entry → " + searchValue);
			driver.navigate().refresh();
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxForSecondTab), searchValue);
			Thread.sleep(2000);
			LoggerUtil.pass("Search performed successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to search entry. " + e.getMessage());
			Assert.fail("Search failed.");
		}

// STEP 11: Click on Edit icon
		try {
			LoggerUtil.info("STEP 11: Clicking on edit icon.");
			clickOnElement(editbtn);
			Thread.sleep(3000);
			LoggerUtil.pass("Edit button clicked successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click Edit button. " + e.getMessage());
			Assert.fail("Edit button click failed.");
		}

// STEP 12: Update Group Classification
		try {
			LoggerUtil.info("STEP 12: Updating Group SpecificGrade to → " + EnterUpdatedValueSpecificGrade);
			clearAndEnterText(waitForExpectedElement(EnterspecificgradevalueForSecondTab),
					EnterUpdatedValueSpecificGrade);
			Thread.sleep(3000);
			LoggerUtil.pass("Group Classification updated successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to update Group Classification. " + e.getMessage());
			Assert.fail("Group Classification update failed.");
		}

// STEP 13: Click Update button
		try {
			LoggerUtil.info("STEP 13: Clicking Update button to save changes.");
			clickOnElement(clickingupdatebtnForSecondTab);
			Thread.sleep(2000);
			LoggerUtil.pass("Update button clicked successfully. Changes saved.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click Update button. " + e.getMessage());
			Assert.fail("Update action failed.");
		}
		Thread.sleep(4000);
		driver.navigate().refresh();
		Thread.sleep(3000);

	}

	public void validateFilteredRow(String searchValue, String expectedCommodity, String expectedClassification,
			String expectedGrade, String expectedDensity) throws InterruptedException {
		SoftAssert soft = new SoftAssert();

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxForSecondTab), searchValue);
		Thread.sleep(2000);

		try {
			LoggerUtil.info("STEP 1: Locate the filtered row in table.");
			WebElement row = waitForExpectedElement(By.xpath("//table[@id='SubGroupTable']/tbody/tr"));

			List<WebElement> cols = row.findElements(By.tagName("td"));

			String actualCommodity = cols.get(1).getText().trim();
			String actualClassification = cols.get(2).getText().trim();
			String actualGrade = cols.get(3).getText().trim();
			String actualDensity = cols.get(4).getText().trim();

			LoggerUtil.info("STEP 2: Expected vs Actual validation.");
			LoggerUtil.info("Commodity → Expected: " + expectedCommodity + " | Actual: " + actualCommodity);
			LoggerUtil.info("Group Classification → Expected: " + expectedClassification + " | Actual: "
					+ actualClassification);
			LoggerUtil.info("Specific Grade → Expected: " + expectedGrade + " | Actual: " + actualGrade);
			LoggerUtil.info("Density → Expected: " + expectedDensity + " | Actual: " + actualDensity);

			soft.assertEquals(actualCommodity, expectedCommodity, "Commodity mismatch!");
			soft.assertEquals(actualClassification, expectedClassification, "Group Classification mismatch!");
			soft.assertEquals(actualGrade, expectedGrade, "Specific Grade mismatch!");
			soft.assertEquals(actualDensity, expectedDensity, "Density mismatch!");

			LoggerUtil.pass("✅ All column values validated successfully.");

		} catch (Exception e) {
			LoggerUtil.fail("❌ Failed to validate filtered row. " + e.getMessage());
			Assert.fail("Validation failed due to: " + e.getMessage());
		}
		soft.assertAll();
	}

	public static final By ClickingSaveAsNewButton = By.xpath("//button[@id='tab2SaveAsNew']");

	public void SaveAsNewCommodityGroup(String value, String groupClassification, String specificGrade, String density,
			String searchValue, String EnterUpdatedValueSpecificGrade) throws InterruptedException {

// STEP 4: Click on 'Commodity Group' tab
		try {
			LoggerUtil.info("STEP 4: [Save As New] Click on 'Commodity Group' tab.");
			clickOnElement(commoditygrouptab);
			Thread.sleep(3000);
			LoggerUtil.pass(" Clicked on 'Commodity Group' tab successfully.");
		} catch (Exception e) {
			LoggerUtil.fail(" Failed to click on 'Commodity Group' tab. " + e.getMessage());
			Assert.fail("Commodity Group tab click failed.");
		}

// STEP 5: Select value from Commodity Group dropdown
		try {
			LoggerUtil.info("STEP 5: Open dropdown and select → " + value);
			clickOnElement(clickcommoditygroupdropBtnSecondTab);
			Thread.sleep(3000);

			List<WebElement> Commgrpnamelist = driver.findElements(ListValueOfCommDropDownSecondTab);
			boolean isFound = false;
			for (WebElement Comgrpname : Commgrpnamelist) {
				String actualdata = Comgrpname.getText().trim();
				if (actualdata.equalsIgnoreCase(value)) {
					Comgrpname.click();
					LoggerUtil.pass(" Commodity group selected successfully: " + actualdata);
					isFound = true;
					break;
				}
			}
			if (!isFound) {
				LoggerUtil.fail(" Commodity group not found in dropdown: " + value);
				Assert.fail("Commodity group not found: " + value);
			}
		} catch (Exception e) {
			LoggerUtil.fail(" Exception while selecting commodity group. " + e.getMessage());
			Assert.fail("Commodity group selection failed.");
		}

// STEP 6: Enter Group Classification
		try {
			LoggerUtil.info("STEP 6: Enter Group Classification → " + groupClassification);
			clearAndEnterText(waitForExpectedElement(EntergroupclassficationForSecondTab), groupClassification);
			Thread.sleep(2000);
			LoggerUtil.pass(" Group Classification entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Group Classification. " + e.getMessage());
			Assert.fail("Group Classification entry failed.");
		}

// STEP 7: Enter Specific Grade
		try {
			LoggerUtil.info("STEP 7: Enter Specific Grade → " + specificGrade);
			clearAndEnterText(waitForExpectedElement(EnterspecificgradevalueForSecondTab), specificGrade);
			Thread.sleep(2000);
			LoggerUtil.pass("Specific Grade entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to enter Specific Grade. " + e.getMessage());
			Assert.fail("Specific Grade entry failed.");
		}

// STEP 8: Enter Density
		try {
			LoggerUtil.info("STEP 8:Enter Density → " + density);
			clearAndEnterText(waitForExpectedElement(EnterDensityForSecondTab), density);
			Thread.sleep(2000);
			LoggerUtil.pass(" Density entered successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to enter Density. " + e.getMessage());
			Assert.fail("Density entry failed.");
		}

// STEP 9: Save commodity group
		try {
			LoggerUtil.info("STEP 9:  Save the commodity group.");
			clickOnElement(clickingSaveButtonForSecondTabComGrp);
			Thread.sleep(9000);
			LoggerUtil.pass("Commodity group saved successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to save commodity group. " + e.getMessage());
			Assert.fail("Save action failed.");
		}

// STEP 10: Search for saved entry
		try {
			LoggerUtil.info("STEP 10:  Search for the saved entry → " + searchValue);
			driver.navigate().refresh();
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxForSecondTab), searchValue);
			Thread.sleep(2000);
			LoggerUtil.pass(" Search performed successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to search entry. " + e.getMessage());
			Assert.fail("Search failed.");
		}

// STEP 11: Click on Edit icon
		try {
			LoggerUtil.info("STEP 11:Click on edit icon.");
			clickOnElement(editbtn);
			Thread.sleep(3000);
			LoggerUtil.pass("Edit button clicked successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to click Edit button. " + e.getMessage());
			Assert.fail("Edit button click failed.");
		}

// STEP 12: Update Specific Grade
		try {
			LoggerUtil.info("STEP 12:  Update Specific Grade → " + EnterUpdatedValueSpecificGrade);
			clearAndEnterText(waitForExpectedElement(EnterspecificgradevalueForSecondTab),
					EnterUpdatedValueSpecificGrade);
			Thread.sleep(3000);
			LoggerUtil.pass(" Specific Grade updated successfully.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to update Specific Grade. " + e.getMessage());
			Assert.fail("Specific Grade update failed.");
		}

// STEP 13: Click Save As New button
		try {
			LoggerUtil.info("STEP 13: Click Save As New button to save changes.");
			clickOnElement(ClickingSaveAsNewButton);
			Thread.sleep(2000);
			LoggerUtil.pass("Save As New button clicked successfully. New entry created.");
		} catch (Exception e) {
			LoggerUtil.fail("[Save As New] Failed to click Save As New button. " + e.getMessage());
			Assert.fail("Save As New action failed.");
		}

		Thread.sleep(4000);
		driver.navigate().refresh();
		Thread.sleep(3000);

		LoggerUtil.info(" [Save As New] Commodity group flow completed successfully.");
	}

	public static final By ClickingExportButtonForCommodityGroup = By.xpath("//button[@id='tab2Export']");

	public void verifyCommodityGroupFileStructure() throws InterruptedException, IOException {
		try {
			LoggerUtil.info("[Verify Commodity Group File Structure] STEP 1: Click on Export button.");
			clickOnElement(ClickingExportButtonForCommodityGroup);
			Thread.sleep(13000);
			LoggerUtil.pass("Export button clicked, waiting for file download...");
		} catch (Exception e) {
			LoggerUtil.fail("Failed to click Export button. " + e.getMessage());
			Assert.fail("Export button click failed.");
		}

		String filePath = null;
		try {
			LoggerUtil.info(
					"[Verify Commodity Group File Structure] STEP 2: Fetch latest 'New Specific Grade Addition' Excel file.");
			File latestFile = getLatestNewSpecificGradeFileForCommodityGroup();
			if (latestFile == null) {
				LoggerUtil.fail("❌ No 'New Specific Grade Addition' file found in downloads.");
				Assert.fail("Excel file not found.");
			}
			filePath = latestFile.getAbsolutePath();
			LoggerUtil.pass("Latest Excel file fetched → " + latestFile.getName());
		} catch (Exception e) {
			LoggerUtil.fail("Exception while fetching latest Excel file. " + e.getMessage());
			Assert.fail("File fetch failed.");
		}

		try {
			LoggerUtil.info("[Verify Commodity Group File Structure] STEP 3: Read unique headers from Excel file.");
			List<String> headers = ExcelUtil.readLimitedHeaders(filePath);
			System.out.println("Clean Headers → " + headers);
			LoggerUtil.info("Clean Headers → " + headers);

			if (headers.isEmpty()) {
				LoggerUtil.fail(" No headers found in Excel file.");
				Assert.fail("Header validation failed.");
			} else {
				LoggerUtil.pass(" Headers validated successfully. Found: " + headers);
			}
		} catch (Exception e) {
			LoggerUtil.fail("Exception while reading headers. " + e.getMessage());
			Assert.fail("Header read failed.");
		}
	}

	public static void verifyDownLoadExcelFile() throws InterruptedException {

		clickOnElement(ClickingExportButtonForCommodityGroup);
		Thread.sleep(12000);
		getLatestNewSpecificGradeFileForCommodityGroup();

	}

	static HashMap<String, String> map = new HashMap<>();

	public static String VerifyWritingExcelValue(String comgroupname, String GroupClassification, String specificgrade,
			String Density) throws InterruptedException {

		Thread.sleep(3000);
		File latestFile = getLatestNewSpecificGradeFileForCommodityGroup();
		if (latestFile == null) {
			System.out.println(" CommodityGroupExcelFile file found.");
			return null;
		}

		String filePath = latestFile.getAbsolutePath();

		ExcelFiller.setCellValue(filePath, 0, 3, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(comgroupname));

		ExcelFiller.setCellValue(filePath, 0, 3, 2, ExcelFiller.ValueType.STRING, Arrays.asList(GroupClassification));
		ExcelFiller.setCellValue(filePath, 0, 3, 3, ExcelFiller.ValueType.STRING, Arrays.asList(specificgrade));
		ExcelFiller.setCellValue(filePath, 0, 3, 4, ExcelFiller.ValueType.INTEGER, Arrays.asList(Density));

		map.put("CommodityGroup", comgroupname);
		map.put("grpclassification", GroupClassification);
		map.put("specific", specificgrade);
		map.put("den", Density);

		return filePath;

	}

	public static void ImportExcelFileCommodityGroup(String comgroupname, String GroupClassification,
			String specificgrade, String Density, String expectedpopup) throws InterruptedException {

		String fullPath = null;
		try {
			fullPath = VerifyWritingExcelValue(comgroupname, GroupClassification, specificgrade, Density);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		WebElement fileInput = driver.findElement(By.id("attachmentcommodity"));

		// Make it visible via JS
		((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

		System.out.println("Uploading file: " + fullPath);

		fileInput.sendKeys(fullPath);

		System.out.println(waitForExpectedElement(toastmessageSecodTabForButtonReflection).getText());
		String actualpoup = waitForExpectedElement(toastmessageSecodTabForButtonReflection).getText();

		Assert.assertTrue(actualpoup.contains(expectedpopup));

		Thread.sleep(5000);
		driver.navigate().refresh();

	}

	public static final By ComgrptableRows = By.xpath("//table[@id='SubGroupTable']/tbody/tr");

	public static final By ComgrpcolDatas = By.xpath("//table[@id='SubGroupTable']/tbody/tr[1]/td");

	public static void verifyMatchingDataAllAreImportedCorrectly(String enterValue) {
		try {
			LoggerUtil.info("Step 0: Entering search value in Commodity Group table → " + enterValue);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxForSecondTab), enterValue);

			// ✅ Wait until table rows/columns appear
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));

			LoggerUtil.info("Step 1: Fetching actual values from HashMap");
			String comgrpActualValue = map.get("CommodityGroup");
			String groupClass = map.get("grpclassification");
			String specificGrade = map.get("specific");
			String density = map.get("den");

			LoggerUtil.info("Step 2: Fetching expected values from UI table");
			List<WebElement> comgrpTabColmData = driver.findElements(ComgrpcolDatas);

			// ✅ Check if table has data
			if (comgrpTabColmData == null || comgrpTabColmData.isEmpty()) {
				LoggerUtil.fail("No data found in Commodity Group table after search → " + enterValue);
				Assert.fail("Table data not loaded or empty");
				return;
			}

			// ✅ Check if table has minimum 5 columns
			if (comgrpTabColmData.size() < 5) {
				LoggerUtil.fail("Table columns are less than expected. Found: " + comgrpTabColmData.size());
				Assert.fail("Not enough table columns for validation");
				return;
			}

			String expectedComgrpName = comgrpTabColmData.get(1).getText().trim();
			String expectedClassification = comgrpTabColmData.get(2).getText().trim();
			String expectedSpecificGrade = comgrpTabColmData.get(3).getText().trim();
			String expectedDensity = comgrpTabColmData.get(4).getText().trim();

			LoggerUtil.info("Step 3: Validating each field from HashMap vs UI");

			// ✅ Condition 1: Commodity Group
			if (comgrpActualValue.equalsIgnoreCase(expectedComgrpName)) {
				LoggerUtil.pass("Commodity Group matched → Expected: " + expectedComgrpName + " | Actual: "
						+ comgrpActualValue);
			} else {
				LoggerUtil.fail("Commodity Group mismatch → Expected: " + expectedComgrpName + " | Actual: "
						+ comgrpActualValue);
			}

			// ✅ Condition 2: Group Classification
			if (groupClass.equalsIgnoreCase(expectedClassification)) {
				LoggerUtil.pass("Group Classification matched → Expected: " + expectedClassification + " | Actual: "
						+ groupClass);
			} else {
				LoggerUtil.fail("Group Classification mismatch → Expected: " + expectedClassification + " | Actual: "
						+ groupClass);
			}

			// ✅ Condition 3: Specific Grade
			if (specificGrade.equalsIgnoreCase(expectedSpecificGrade)) {
				LoggerUtil.pass(
						"Specific Grade matched → Expected: " + expectedSpecificGrade + " | Actual: " + specificGrade);
			} else {
				LoggerUtil.fail(
						"Specific Grade mismatch → Expected: " + expectedSpecificGrade + " | Actual: " + specificGrade);
			}

			// ✅ Condition 4: Density
			// ✅ Condition 4: Density
			if (expectedDensity.equalsIgnoreCase(density)) {
				LoggerUtil.pass("Density matched → Expected(UI): " + expectedDensity + " | Actual(Map): " + density);
			} else {
				LoggerUtil.fail("Density mismatch → Expected(UI): " + expectedDensity + " | Actual(Map): " + density);
			}

			// ✅ Final assertion

			// ✅ Final hard assertions
			Assert.assertEquals(comgrpActualValue, expectedComgrpName, "Commodity Group mismatch");
			Assert.assertEquals(groupClass, expectedClassification, "Group Classification mismatch");
			Assert.assertEquals(specificGrade, expectedSpecificGrade, "Specific Grade mismatch");
			Assert.assertEquals(density, expectedDensity, "Density mismatch");

			LoggerUtil.pass("All fields validated successfully for Commodity Group: " + comgrpActualValue);

		} catch (Exception e) {
			LoggerUtil.error("Exception in verifyMatchingDataAllAreImportedCorrectly: " + e.getMessage());
			Assert.fail("Test failed due to exception in data verification");
		}
	}

	public static final By ClickingcommoditydropdownBtnThirdTab = By
			.xpath("//span[@id='select2-commodityDrop-container']");
	public static final By enterSearchValueCommodityGrpThirdTab = By.xpath("//*[@class='select2-search__field']");
	public static final By CommoditydropDownlistThirdTab = By.xpath("//select[@id='commodityDrop']/option");
	public static final By ClickingGroupclassificationBtnThirdTabDropdown = By
			.xpath("//span[@id='select2-materialDrop-container']");
	public static final By searchInputforgroupclassificationDropDownInThirdTab = By
			.xpath("//*[@id='page-top']/span/span/span[1]/input");
	public static final By GroupClassificationDropdownValueInThirdTab = By
			.xpath("//ul[@id='select2-materialDrop-results']/li");
	public static final By ClickingspecificgradeBtndropdownForThirdTab = By
			.xpath("//span[@id='select2-SpecificGrade-container']");
	public static final By SearchInputspecificgradeForThirdTab = By
			.xpath("//*[@id='page-top']/span/span/span[1]/input");
	public static final By GradeListThirdTab = By.xpath("//ul[@id='select2-SpecificGrade-results']/li ");
	public static final By clickingAnotherWebElementCommodityDetailsTab = By.xpath("//h3[normalize-space(text())='Suppliers']");

	public static void VerifySearchFilterForCommodityDetailsTab() throws InterruptedException {
		SoftAssert softAssert = new SoftAssert();
		String searchKeyword = "Ferrous Metals";
		String expectedGroupClassification = "Stainless Steel";
		String expectedSpecificGrade = "CRCA-007";

		try {
			LoggerUtil.info("STEP 1: Open 'Commodity Group' dropdown.");
			clickOnElement(ClickingcommoditydropdownBtnThirdTab);
			Thread.sleep(1000);
			LoggerUtil.pass("Commodity Group dropdown opened successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Failed to open Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Commodity Group dropdown could not be opened.");
		}

		try {
			LoggerUtil.info("STEP 2: Enter search text → " + searchKeyword);
			WebElement searchInput = waitForExpectedElement(enterSearchValueCommodityGrpThirdTab);
			clearAndEnterText(searchInput, searchKeyword);
			Thread.sleep(2000);
			LoggerUtil.pass("Search keyword '" + searchKeyword + "' entered successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Failed to enter search text in Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Search keyword entry failed for Commodity Group.");
		}

		try {
			LoggerUtil.info("STEP 3: Validate filtered options for '" + searchKeyword + "'.");
			List<WebElement> filteredOptions = driver.findElements(CommoditydropDownlistThirdTab);
			softAssert.assertTrue(filteredOptions.size() > 0,
					"No options displayed after applying search filter: " + searchKeyword);

			boolean commodityMatchFound = false;
			for (WebElement option : filteredOptions) {
				if (option.getText().trim().equalsIgnoreCase(searchKeyword)) {
					commodityMatchFound = true;
					option.click();
					LoggerUtil.pass("Expected value '" + searchKeyword + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(commodityMatchFound,
					"Expected option '" + searchKeyword + "' not found in commodity group dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Commodity Group validation failed.");
		}

		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 4: Open 'Group Classification' dropdown.");
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 5: Enter search text → " + expectedGroupClassification);
			clearAndEnterText(waitForExpectedElement(searchInputforgroupclassificationDropDownInThirdTab),
					expectedGroupClassification);
			Thread.sleep(5000);

			LoggerUtil.info("STEP 6: Validate filtered options for '" + expectedGroupClassification + "'.");
			List<WebElement> groupClassificationOptions = driver
					.findElements(GroupClassificationDropdownValueInThirdTab);

			boolean groupMatchFound = false;
			for (WebElement option : groupClassificationOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedGroupClassification)) {
					groupMatchFound = true;
					option.click();
					LoggerUtil.pass("Expected value '" + expectedGroupClassification + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(groupMatchFound, "Expected option '" + expectedGroupClassification
					+ "' not found in group classification dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Group Classification dropdown → " + e.getMessage());
			softAssert.fail("Group Classification validation failed.");
		}

		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
			LoggerUtil.info("Clicked on Specific Grade dropdown.");
			Thread.sleep(4000);

			clearAndEnterText(waitForExpectedElement(SearchInputspecificgradeForThirdTab), expectedSpecificGrade);
			Thread.sleep(4000);

			List<WebElement> gradeOptions = driver.findElements(GradeListThirdTab);
			boolean gradeFound = false;

			for (WebElement option : gradeOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedSpecificGrade)) {
					gradeFound = true;
					option.click();
					LoggerUtil.pass("Expected Specific Grade '" + expectedSpecificGrade + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(gradeFound,
					"Expected Specific Grade '" + expectedSpecificGrade + "' not found in dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Specific Grade dropdown → " + e.getMessage());
			softAssert.fail("Specific Grade validation failed.");
		}

		LoggerUtil.info("STEP 7: Execute all collected soft assertions.");
		softAssert.assertAll();
	}

	public static final By ClickingShapedropdownForthirdTab = By.xpath("//span[@id='select2-shapeDrop-container']");

	public static void SaveComDetailsWithoutSelectingUOMDropDown(String searchComGrpName,
			String expectedGroupClassification, String expectedSpecificGrade) throws InterruptedException {
		SoftAssert softAssert = new SoftAssert();

		try {
			LoggerUtil.info("STEP 1: Open 'Commodity Group' dropdown.");
			clickOnElement(ClickingcommoditydropdownBtnThirdTab);
			Thread.sleep(1000);
			LoggerUtil.pass("Commodity Group dropdown opened successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Failed to open Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Commodity Group dropdown could not be opened.");
		}

		try {
			LoggerUtil.info("STEP 2: Enter search text → " + searchComGrpName);
			WebElement searchInput = waitForExpectedElement(enterSearchValueCommodityGrpThirdTab);
			clearAndEnterText(searchInput, searchComGrpName);
			Thread.sleep(2000);
			LoggerUtil.pass("Search keyword '" + searchComGrpName + "' entered successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Failed to enter search text in Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Search keyword entry failed for Commodity Group.");
		}

		try {
			LoggerUtil.info("STEP 3: Validate filtered options for '" + searchComGrpName + "'.");
			List<WebElement> filteredOptions = driver.findElements(CommoditydropDownlistThirdTab);
			softAssert.assertTrue(filteredOptions.size() > 0,
					"No options displayed after applying search filter: " + searchComGrpName);

			boolean commodityMatchFound = false;
			for (WebElement option : filteredOptions) {
				if (option.getText().trim().equalsIgnoreCase(searchComGrpName)) {
					commodityMatchFound = true;
					option.click();
					LoggerUtil.pass("Expected value '" + searchComGrpName + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(commodityMatchFound,
					"Expected option '" + searchComGrpName + "' not found in commodity group dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Commodity Group dropdown → " + e.getMessage());
			softAssert.fail("Commodity Group validation failed.");
		}

		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 4: Open 'Group Classification' dropdown.");
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 5: Enter search text → " + expectedGroupClassification);
			clearAndEnterText(waitForExpectedElement(searchInputforgroupclassificationDropDownInThirdTab),
					expectedGroupClassification);
			Thread.sleep(5000);

			LoggerUtil.info("STEP 6: Validate filtered options for '" + expectedGroupClassification + "'.");
			List<WebElement> groupClassificationOptions = driver
					.findElements(GroupClassificationDropdownValueInThirdTab);

			boolean groupMatchFound = false;
			for (WebElement option : groupClassificationOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedGroupClassification)) {
					groupMatchFound = true;
					option.click();
					LoggerUtil.pass("Expected value '" + expectedGroupClassification + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(groupMatchFound, "Expected option '" + expectedGroupClassification
					+ "' not found in group classification dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Group Classification dropdown → " + e.getMessage());
			softAssert.fail("Group Classification validation failed.");
		}

		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 7: Open 'Specific Grade' dropdown.");
			clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
			Thread.sleep(4000);

			LoggerUtil.info("STEP 8: Enter search text → " + expectedSpecificGrade);
			clearAndEnterText(waitForExpectedElement(SearchInputspecificgradeForThirdTab), expectedSpecificGrade);
			Thread.sleep(4000);

			LoggerUtil.info("STEP 9: Validate filtered options for '" + expectedSpecificGrade + "'.");
			List<WebElement> gradeOptions = driver.findElements(GradeListThirdTab);
			boolean gradeFound = false;

			for (WebElement option : gradeOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedSpecificGrade)) {
					gradeFound = true;
					option.click();
					LoggerUtil.pass("Expected Specific Grade '" + expectedSpecificGrade + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(gradeFound,
					"Expected Specific Grade '" + expectedSpecificGrade + "' not found in dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Error while validating Specific Grade dropdown → " + e.getMessage());
			softAssert.fail("Specific Grade validation failed.");
		}

		LoggerUtil.info("STEP 10: Execute all collected soft assertions.");

		try {
			LoggerUtil.info("Step 7: Selecting Shape = 'Sheet'");
			clickOnElement(ClickingShapedropdownForthirdTab);
			Thread.sleep(300);
			WebElement shapesearch = waitForExpectedElement(CommodityDetailsPage.searchinputforshape);
			clearAndEnterText(shapesearch, "Sheet");
			shapesearch.sendKeys(Keys.ENTER);
			LoggerUtil.pass("Shape set to Sheet");
		} catch (Exception e) {
			LoggerUtil.error("Step 7 failed: " + e.getMessage());
		}

		try {
			LoggerUtil.info("Step 8: Scrolling window by 160px before Year selection...");
			((JavascriptExecutor) driver).executeScript("window.scrollBy(0, 160);");
			LoggerUtil.pass("Scroll successful.");
		} catch (Exception e) {
			LoggerUtil.error("Step 8 failed (scroll): " + e.getMessage());
		}

		Thread.sleep(4000);
// Step 8: Select Year
		try {
			LoggerUtil.info("Step 8: Selecting Year = '2025-2026'");
			clickOnElement(CommodityDetailsPage.selectyeardrop);
			Thread.sleep(500);
			WebElement yearsearch = waitForExpectedElement(CommodityDetailsPage.searchinputyear);
			clearAndEnterText(yearsearch, "2025-2026");
			yearsearch.sendKeys(Keys.ENTER);
			LoggerUtil.pass("Year set to 2025-2026");
		} catch (Exception e) {
			LoggerUtil.error("Step 8 failed: " + e.getMessage());
		}

// Step 9: Select Business Segment
		try {
			LoggerUtil.info("Step 9: Selecting Business Segment = " + DataProp.getProperty("BusinessSegment"));
			clickOnElement(CommodityDetailsPage.businessSegbox);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
					DataProp.getProperty("BusinessSegment"));
			Thread.sleep(5000);
			clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
			LoggerUtil.pass("Business Segment" + DataProp.getProperty("BusinessSegment") + " selected");
		} catch (Exception e) {
			LoggerUtil.error("Step 9 failed: " + e.getMessage());
		}

// Step 10: Select Customer checkbox
		try {
			LoggerUtil.info("Step 10: Selecting Customer checkbox");
			clickOnElement(CommodityDetailsPage.customercheckbox);
			LoggerUtil.pass("Customer checkbox selected");
		} catch (Exception e) {
			LoggerUtil.error("Step 10 failed: " + e.getMessage());
		}

// Step 11: Save and validate toast
		try {
			LoggerUtil.info("Step 11: Clicking Save and validating toast");
			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);

			String actualMessage = waitForExpectedElement(CommodityDetailsPage.ToastMessageForSaveThirdTab).getText();
			String expectedMessage = "Select Unit";
			System.out.println("Toast Message: " + actualMessage);
			LoggerUtil.info("Toast Message Displayed: " + actualMessage);

			if (expectedMessage.equals(actualMessage)) {
				LoggerUtil.pass("Toast matched ✅ Expected: " + expectedMessage + " | Actual: " + actualMessage);
			} else {
				LoggerUtil.fail("❌ Toast mismatch! Expected: " + expectedMessage + " | Actual: " + actualMessage);
			}
		} catch (Exception e) {
			LoggerUtil.error("Step 11 failed: " + e.getMessage());
		}

	}

	public static void SaveComDetailsWithoutSelectingShapeDropdown(String searchComGrpName,
			String expectedGroupClassification, String expectedSpecificGrade) throws InterruptedException {
		SoftAssert softAssert = new SoftAssert();

// STEP 1: Commodity Group
		try {
			LoggerUtil.info("STEP 1: Open 'Commodity Group' dropdown.");
			clickOnElement(ClickingcommoditydropdownBtnThirdTab);
			Thread.sleep(1000);

			LoggerUtil.info("STEP 2: Enter search text → " + searchComGrpName);
			WebElement searchInput = waitForExpectedElement(enterSearchValueCommodityGrpThirdTab);
			clearAndEnterText(searchInput, searchComGrpName);
			Thread.sleep(2000);

			List<WebElement> filteredOptions = driver.findElements(CommoditydropDownlistThirdTab);
			softAssert.assertTrue(filteredOptions.size() > 0,
					"No options displayed after applying search filter: " + searchComGrpName);

			boolean commodityMatchFound = false;
			for (WebElement option : filteredOptions) {
				if (option.getText().trim().equalsIgnoreCase(searchComGrpName)) {
					option.click();
					commodityMatchFound = true;
					LoggerUtil.pass("Expected value '" + searchComGrpName + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(commodityMatchFound,
					"Expected option '" + searchComGrpName + "' not found in commodity group dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Commodity Group selection failed → " + e.getMessage());
			softAssert.fail("Commodity Group validation failed.");
		}

// STEP 2: Group Classification
		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 3: Open 'Group Classification' dropdown.");
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 4: Enter search text → " + expectedGroupClassification);
			clearAndEnterText(waitForExpectedElement(searchInputforgroupclassificationDropDownInThirdTab),
					expectedGroupClassification);
			Thread.sleep(5000);

			List<WebElement> groupClassificationOptions = driver
					.findElements(GroupClassificationDropdownValueInThirdTab);

			boolean groupMatchFound = false;
			for (WebElement option : groupClassificationOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedGroupClassification)) {
					option.click();
					groupMatchFound = true;
					LoggerUtil.pass(
							"Expected Group Classification '" + expectedGroupClassification + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(groupMatchFound, "Expected option '" + expectedGroupClassification
					+ "' not found in group classification dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Group Classification selection failed → " + e.getMessage());
			softAssert.fail("Group Classification validation failed.");
		}

// STEP 3: Specific Grade
		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 5: Open 'Specific Grade' dropdown.");
			clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
			Thread.sleep(4000);

			LoggerUtil.info("STEP 6: Enter search text → " + expectedSpecificGrade);
			clearAndEnterText(waitForExpectedElement(SearchInputspecificgradeForThirdTab), expectedSpecificGrade);
			Thread.sleep(4000);

			List<WebElement> gradeOptions = driver.findElements(GradeListThirdTab);
			boolean gradeFound = false;

			for (WebElement option : gradeOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedSpecificGrade)) {
					option.click();
					gradeFound = true;
					LoggerUtil.pass("Expected Specific Grade '" + expectedSpecificGrade + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(gradeFound,
					"Expected Specific Grade '" + expectedSpecificGrade + "' not found in dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Specific Grade selection failed → " + e.getMessage());
			softAssert.fail("Specific Grade validation failed.");
		}

// STEP 4: UOM
		try {
			LoggerUtil.info("STEP 7: Open 'UOM' dropdown.");
			clickOnElement(CommodityDetailsPage.Uomdropdown);
			Thread.sleep(500);

			WebElement searchuom = waitForExpectedElement(CommodityDetailsPage.searchinputforuom);
			String expectedUom = "Mtr";
			clearAndEnterText(searchuom, expectedUom);
			searchuom.sendKeys(Keys.ENTER);
			Thread.sleep(500);
			LoggerUtil.pass("UOM '" + expectedUom + "' selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("UOM selection failed → " + e.getMessage());
			softAssert.fail("UOM selection failed.");
		}

// STEP 5: Scroll
		try {
			LoggerUtil.info("STEP 8: Scrolling window by 160px before Year selection...");
			((JavascriptExecutor) driver).executeScript("window.scrollBy(0, 160);");
			LoggerUtil.pass("Window scrolled successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Scroll failed → " + e.getMessage());
		}

// STEP 6: Year
		try {
			LoggerUtil.info("STEP 9: Selecting Year = '2025-2026'");
			clickOnElement(CommodityDetailsPage.selectyeardrop);
			Thread.sleep(500);
			WebElement yearsearch = waitForExpectedElement(CommodityDetailsPage.searchinputyear);
			clearAndEnterText(yearsearch, "2025-2026");
			yearsearch.sendKeys(Keys.ENTER);
			LoggerUtil.pass("Year '2025-2026' selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Year selection failed → " + e.getMessage());
			softAssert.fail("Year selection failed.");
		}

// STEP 7: Business Segment
		try {
			LoggerUtil.info("STEP 10: Selecting Business Segment = " + DataProp.getProperty("BusinessSegment"));
			clickOnElement(CommodityDetailsPage.businessSegbox);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
					DataProp.getProperty("BusinessSegment"));
			Thread.sleep(5000);
			clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
			LoggerUtil.pass("Business Segment  selected successfully." + DataProp.getProperty("BusinessSegment"));
		} catch (Exception e) {
			LoggerUtil.error("Business Segment selection failed → " + e.getMessage());
			softAssert.fail("Business Segment selection failed.");
		}

// STEP 8: Customer
		try {
			LoggerUtil.info("STEP 11: Selecting Customer checkbox.");
			clickOnElement(CommodityDetailsPage.customercheckbox);
			LoggerUtil.pass("Customer checkbox selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Customer checkbox selection failed → " + e.getMessage());
			softAssert.fail("Customer checkbox selection failed.");
		}

// STEP 9: Save and Toast Validation
		try {
			LoggerUtil.info("STEP 12: Clicking Save and validating toast.");
			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);

			String actualMessage = waitForExpectedElement(CommodityDetailsPage.ToastMessageForSaveThirdTab).getText();
			String expectedMessage = "Select Shape";

			LoggerUtil.info("Toast Message Displayed: " + actualMessage);

			if (expectedMessage.equals(actualMessage)) {
				LoggerUtil.pass("Toast matched ✅ Expected: " + expectedMessage + " | Actual: " + actualMessage);
			} else {
				LoggerUtil.fail("❌ Toast mismatch! Expected: " + expectedMessage + " | Actual: " + actualMessage);
			}
		} catch (Exception e) {
			LoggerUtil.error("Save & Toast validation failed → " + e.getMessage());
			softAssert.fail("Save operation failed.");
		}

		LoggerUtil.info("STEP 13: Execute all collected Soft Assertions.");
		softAssert.assertAll();
	}

	public static void SaveComDetailsWithoutSelectingYearDropDown(String searchComGrpName,
			String expectedGroupClassification, String expectedSpecificGrade) throws InterruptedException {
		SoftAssert softAssert = new SoftAssert();

// STEP 1: Commodity Group
		try {
			LoggerUtil.info("STEP 1: Open 'Commodity Group' dropdown.");
			clickOnElement(ClickingcommoditydropdownBtnThirdTab);
			Thread.sleep(1000);

			LoggerUtil.info("STEP 2: Enter search text → " + searchComGrpName);
			WebElement searchInput = waitForExpectedElement(enterSearchValueCommodityGrpThirdTab);
			clearAndEnterText(searchInput, searchComGrpName);
			Thread.sleep(2000);

			List<WebElement> filteredOptions = driver.findElements(CommoditydropDownlistThirdTab);
			softAssert.assertTrue(filteredOptions.size() > 0,
					"No options displayed after applying search filter: " + searchComGrpName);

			boolean commodityMatchFound = false;
			for (WebElement option : filteredOptions) {
				if (option.getText().trim().equalsIgnoreCase(searchComGrpName)) {
					option.click();
					commodityMatchFound = true;
					LoggerUtil.pass("Expected value '" + searchComGrpName + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(commodityMatchFound,
					"Expected option '" + searchComGrpName + "' not found in commodity group dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Commodity Group selection failed → " + e.getMessage());
			softAssert.fail("Commodity Group validation failed.");
		}

// STEP 2: Group Classification
		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 3: Open 'Group Classification' dropdown.");
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 4: Enter search text → " + expectedGroupClassification);
			clearAndEnterText(waitForExpectedElement(searchInputforgroupclassificationDropDownInThirdTab),
					expectedGroupClassification);
			Thread.sleep(5000);

			List<WebElement> groupClassificationOptions = driver
					.findElements(GroupClassificationDropdownValueInThirdTab);

			boolean groupMatchFound = false;
			for (WebElement option : groupClassificationOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedGroupClassification)) {
					option.click();
					groupMatchFound = true;
					LoggerUtil.pass(
							"Expected Group Classification '" + expectedGroupClassification + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(groupMatchFound, "Expected option '" + expectedGroupClassification
					+ "' not found in group classification dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Group Classification selection failed → " + e.getMessage());
			softAssert.fail("Group Classification validation failed.");
		}

// STEP 3: Specific Grade
		try {
			Thread.sleep(3000);
			clickOnElement(clickingAnotherWebElementCommodityDetailsTab);
			Thread.sleep(3000);

			LoggerUtil.info("STEP 5: Open 'Specific Grade' dropdown.");
			clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
			Thread.sleep(4000);

			LoggerUtil.info("STEP 6: Enter search text → " + expectedSpecificGrade);
			clearAndEnterText(waitForExpectedElement(SearchInputspecificgradeForThirdTab), expectedSpecificGrade);
			Thread.sleep(4000);

			List<WebElement> gradeOptions = driver.findElements(GradeListThirdTab);
			boolean gradeFound = false;

			for (WebElement option : gradeOptions) {
				if (option.getText().trim().equalsIgnoreCase(expectedSpecificGrade)) {
					option.click();
					gradeFound = true;
					LoggerUtil.pass("Expected Specific Grade '" + expectedSpecificGrade + "' found and selected.");
					break;
				}
			}
			softAssert.assertTrue(gradeFound,
					"Expected Specific Grade '" + expectedSpecificGrade + "' not found in dropdown.");
		} catch (Exception e) {
			LoggerUtil.error("Specific Grade selection failed → " + e.getMessage());
			softAssert.fail("Specific Grade validation failed.");
		}

// STEP 4: UOM
		try {
			LoggerUtil.info("STEP 7: Open 'UOM' dropdown.");
			clickOnElement(CommodityDetailsPage.Uomdropdown);
			Thread.sleep(500);

			WebElement searchuom = waitForExpectedElement(CommodityDetailsPage.searchinputforuom);
			String expectedUom = "Mtr";
			clearAndEnterText(searchuom, expectedUom);
			searchuom.sendKeys(Keys.ENTER);
			Thread.sleep(500);
			LoggerUtil.pass("UOM '" + expectedUom + "' selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("UOM selection failed → " + e.getMessage());
			softAssert.fail("UOM selection failed.");
		}

		try {
			LoggerUtil.info("Step 7: Selecting Shape = 'Sheet'");
			clickOnElement(ClickingShapedropdownForthirdTab);
			Thread.sleep(300);
			WebElement shapesearch = waitForExpectedElement(CommodityDetailsPage.searchinputforshape);
			clearAndEnterText(shapesearch, "Sheet");
			shapesearch.sendKeys(Keys.ENTER);
			LoggerUtil.pass("Shape set to Sheet");
		} catch (Exception e) {
			LoggerUtil.error("Step 7 failed: " + e.getMessage());
		}

// STEP 7: Business Segment
		try {
			LoggerUtil.info("STEP 10: Selecting Business Segment = " + DataProp.getProperty("BusinessSegment"));
			clickOnElement(CommodityDetailsPage.businessSegbox);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
					DataProp.getProperty("BusinessSegment"));
			Thread.sleep(5000);
			clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
			LoggerUtil.pass("Business Segment" + DataProp.getProperty("BusinessSegment") + " selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Business Segment selection failed → " + e.getMessage());
			softAssert.fail("Business Segment selection failed.");
		}

// STEP 8: Customer
		try {
			LoggerUtil.info("STEP 11: Selecting Customer checkbox.");
			clickOnElement(CommodityDetailsPage.customercheckbox);
			LoggerUtil.pass("Customer checkbox selected successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Customer checkbox selection failed → " + e.getMessage());
			softAssert.fail("Customer checkbox selection failed.");
		}

// STEP 9: Save and Toast Validation
		try {
			LoggerUtil.info("STEP 12: Clicking Save and validating toast.");
			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);

			String actualMessage = waitForExpectedElement(CommodityDetailsPage.ToastMessageForSaveThirdTab).getText();
			String expectedMessage = "Select Year";

			LoggerUtil.info("Toast Message Displayed: " + actualMessage);

			if (expectedMessage.equals(actualMessage)) {
				LoggerUtil.pass("Toast matched ✅ Expected: " + expectedMessage + " | Actual: " + actualMessage);
			} else {
				LoggerUtil.fail("❌ Toast mismatch! Expected: " + expectedMessage + " | Actual: " + actualMessage);
			}
		} catch (Exception e) {
			LoggerUtil.error("Save & Toast validation failed → " + e.getMessage());
			softAssert.fail("Save operation failed.");
		}

		LoggerUtil.info("STEP 13: Execute all collected Soft Assertions.");
		softAssert.assertAll();
	}

	////////////////////////////// Supplier Delta Allocation And Check Value Reflect
	////////////////////////////// On Excel //////////////////////////////

	public static void verifyingcalculationofsupplierallocation(String suppaprilrm, String suppcrap, String mayrmsupp,
			String mayscrapsupp, String junesupprm, String junesuppscrap, String julysupprm, String julusuppscrap,
			String augustsupprm, String augussuppscrap, String seprmsupp, String sepscrapsup, String octormsupp,
			String octscrapsup, String novrmsup, String novscrapsup, String decemberrmsup, String decscrapsup,
			String jansupprm, String janscrapsup, String febsupprm, String febscrapsup, String rmMarchsupp,
			String scrapmarchsupp, String searchval) throws InterruptedException {

		SoftAssert softAssert = new SoftAssert();
		LoggerUtil.info("🟩 Starting Supplier Allocation Data Entry (April → March)");

		try {
			// === Step 1: Enter Monthly Supplier RM & Scrap Dynamically ===
			String[] months = { "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar" };
			String[] rmValues = { suppaprilrm, mayrmsupp, junesupprm, julysupprm, augustsupprm, seprmsupp, octormsupp,
					novrmsup, decemberrmsup, jansupprm, febsupprm, rmMarchsupp };
			String[] scrapValues = { suppcrap, mayscrapsupp, junesuppscrap, julusuppscrap, augussuppscrap, sepscrapsup,
					octscrapsup, novscrapsup, decscrapsup, janscrapsup, febscrapsup, scrapmarchsupp };

			for (int i = 0; i < months.length; i++) {
				try {
					clearAndEnterText(
							waitForExpectedElement(
									CommodityDetailsPage.getDynamicSupplierDeltaLocator("manual", months[i], "RM")),
							rmValues[i]);
					LoggerUtil.info("Entered " + months[i] + " Supplier RM = " + rmValues[i]);

					clearAndEnterText(
							waitForExpectedElement(
									CommodityDetailsPage.getDynamicSupplierDeltaLocator("manual", months[i], "Scrap")),
							scrapValues[i]);
					LoggerUtil.info("Entered " + months[i] + " Supplier Scrap = " + scrapValues[i]);
				} catch (Exception e) {
					LoggerUtil.error("❌ Failed for " + months[i] + " → " + e.getMessage());
					softAssert.fail("Entry failed for " + months[i]);
				}
			}

			LoggerUtil.pass("✅ All Supplier RM and Scrap values entered successfully (April → March).");

		} catch (Exception e) {
			LoggerUtil.error("❌ Unexpected error during supplier allocation entry → " + e.getMessage());
			softAssert.fail("Supplier allocation data entry failed.");
		}

		// === Step 2: Save Supplier Allocation ===
		try {
			LoggerUtil.info("💾 Clicking Save button...");
			Thread.sleep(3000);
			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);
			Thread.sleep(4000);
			LoggerUtil.pass("✅ Save button clicked successfully.");
		} catch (Exception e) {
			LoggerUtil.error("❌ Save button click failed → " + e.getMessage());
			softAssert.fail("Save button click failed.");
		}

		// === Step 3: Refresh & Reopen Page for Validation ===
		try {
			LoggerUtil.info("🔄 Refreshing page after save...");
			driver.navigate().refresh();
			Thread.sleep(9000);

			clickOnElement(CommodityDetailsPage.ClickingViewbtn);
			Thread.sleep(7000);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterValueForSearchingCommodityGroupTab),
					searchval);
			LoggerUtil.info("🔍 Searched for Commodity Group = " + searchval);
			Thread.sleep(4000);

			clickOnElement(CommodityDetailsPage.ClickingEditbtnCommodityDetailsTable);
			Thread.sleep(14000);

			LoggerUtil.pass("✅ Page refreshed and Commodity Group record reopened successfully.");
		} catch (Exception e) {
			LoggerUtil.error("❌ Page refresh or search failed → " + e.getMessage());
			softAssert.fail("Page reload or search failed.");
		}

		LoggerUtil.info("🔎 Executing all collected Soft Assertions for Supplier Allocation validation...");
		softAssert.assertAll();
		LoggerUtil.info("🟩 Supplier Allocation Verification Completed Successfully.");
	}

	public static void verifReadExcelFileForGroupDelta(String expectedName, String groupclassvalue)
			throws InterruptedException {

		driver.navigate().refresh();

		Thread.sleep(9000);
		clickOnElement(CommodityDetailsPage.clickingExportAndImportButton);
		LoggerUtil.info("Clicked on Export and Import Button");
		Thread.sleep(3000);

		clickOnElement(CommodityDetailsPage.clickingGroupDeltaRadioButtonForExportingExcelFile);
		Thread.sleep(2000);

		clickOnElement(CommodityDetailsPage.clickingCommodityDropdownForExportImport);
		LoggerUtil.info("Commodity Dropdown opened");
		Thread.sleep(2000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdityDropDownForExport),
				expectedName);
		LoggerUtil.info("Searching for commodity: " + expectedName);
		Thread.sleep(2000);

		List<WebElement> checkboxListSelection = driver
				.findElements(CommodityDetailsPage.clickingCheckboxCommodityDropdown);
		List<WebElement> checkboxNameList = driver
				.findElements(CommodityDetailsPage.fetchingCheckboxCommodityGroupname);

		boolean found = false;
		for (int i = 0; i < checkboxNameList.size(); i++) {
			String flagGroupName = checkboxNameList.get(i).getText().trim();

			if (flagGroupName.equalsIgnoreCase(expectedName)) {
				checkboxListSelection.get(i).click();
				LoggerUtil.pass("Clicked on checkbox for Commodity Group: " + expectedName);
				LoggerUtil.info("Found Commodity Name: " + flagGroupName);
				found = true;
				break;
			}
		}

		if (!found) {
			LoggerUtil.fail("Commodity Group name not found in dropdown: " + expectedName);
		}

		Thread.sleep(2000);
		clickOnElement(CommodityDetailsPage.clickingGroupClassificationDropdownForExportAndImport);
		LoggerUtil.info("Group Classification Dropdown opened");
		Thread.sleep(3000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnteringGroupclassificationValue),
				groupclassvalue);
		LoggerUtil.info("Searching for Group Classification: " + groupclassvalue);
		Thread.sleep(3000);

		List<WebElement> groupclassificationName = driver
				.findElements(CommodityDetailsPage.fetchingNameGroupClassification);
		List<WebElement> selectingcheckboxgrpclass = driver
				.findElements(CommodityDetailsPage.ClickingCheckboxClassification);

		boolean founded = false;
		for (int i = 0; i < groupclassificationName.size(); i++) {
			String groupclassificationsName = groupclassificationName.get(i).getText().trim();

			if (groupclassificationsName.equals(groupclassvalue)) {
				selectingcheckboxgrpclass.get(i).click();
				LoggerUtil.pass("Clicked on checkbox for Group Classification: " + groupclassvalue);
				founded = true;
				Thread.sleep(6000);
				break;
			}
		}

		if (!founded) {
			LoggerUtil.fail("Group Classification not found in dropdown: " + groupclassvalue);
		}

		clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
		Thread.sleep(15000);

		getLatestCommodityDetailsTabFileGroupDelta();

		Thread.sleep(3000);

	}
//	for (WebElement row : rowslist) {
//		List<WebElement> columns = row.findElements(By.tagName("td"));
//		if (columns.size() >= 6 && columns.get(1).getText().equals(customercode)
//				&& columns.get(2).getText().equals(customername)
//				&& columns.get(3).getText().equals(customerlocation)
//				&& columns.get(4).getText().equals(businessDomain)
//				&& columns.get(5).getText().equals(businessSegments)) {
//
//			return true; // Data found
//		}
//	}

	public static final By FetichingRows = By.xpath("//table[@id='comodityDetailListTable']/tbody/tr");
	public static final By fetchingColomsData = By.xpath(".//td");

	public static void verifyFetchinganmeComdetailsTab(HashMap<String, String> Comdetailsname, String EnetringVaue)
			throws InterruptedException {
		SoftAssert softAssert = new SoftAssert();

		String expectedcommoditygrpname = Comdetailsname.get("commoditygroupvalue");
		String expectedclassificationname = Comdetailsname.get("GroupClassification");
		String expectedSpecificGrade = Comdetailsname.get("SpecificGrade");

		String actualcomgrpname = null;
		String actualclassification = null;
		String actualspecificgrade = null;

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(6000);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
				EnetringVaue);
		Thread.sleep(7000);

		List<WebElement> rows = driver.findElements(FetichingRows);
		for (WebElement row : rows) {
			List<WebElement> columns = row.findElements(By.tagName("td"));
			actualcomgrpname = columns.get(2).getText().trim();
			actualclassification = columns.get(3).getText().trim();
			actualspecificgrade = columns.get(4).getText().trim();
			break;
		}

		// Commodity Group
		softAssert.assertEquals(actualcomgrpname, expectedcommoditygrpname,
				"Commodity Group mismatch → Expected: " + expectedcommoditygrpname + " | Actual: " + actualcomgrpname);
		if (expectedcommoditygrpname.equals(actualcomgrpname)) {
			LoggerUtil.pass("Commodity Group matched → " + actualcomgrpname);
		} else {
			LoggerUtil.mismatch("Commodity Group mismatch → Expected: " + expectedcommoditygrpname + " | Actual: "
					+ actualcomgrpname);
		}

		// Group Classification
		softAssert.assertEquals(actualclassification, expectedclassificationname, "Classification mismatch → Expected: "
				+ expectedclassificationname + " | Actual: " + actualclassification);
		if (expectedclassificationname.equals(actualclassification)) {
			LoggerUtil.pass("Group Classification matched → " + actualclassification);
		} else {
			LoggerUtil.mismatch("Group Classification mismatch → Expected: " + expectedclassificationname
					+ " | Actual: " + actualclassification);
		}

		// Specific Grade
		softAssert.assertEquals(actualspecificgrade, expectedSpecificGrade,
				"Specific Grade mismatch → Expected: " + expectedSpecificGrade + " | Actual: " + actualspecificgrade);
		if (expectedSpecificGrade.equals(actualspecificgrade)) {
			LoggerUtil.pass("Specific Grade matched → " + actualspecificgrade);
		} else {
			LoggerUtil.mismatch("Specific Grade mismatch → Expected: " + expectedSpecificGrade + " | Actual: "
					+ actualspecificgrade);
		}

		LoggerUtil.info("STEP: Execute all collected assertions for ComdetailsTab.");
		softAssert.assertAll();
	}

	public static void VerifyUpdatedCommodityHasBeenSucessFullyUpdatedOrNot(HashMap<String, String> Comdetailsname,
			String EnetringVaue, String searchcommodityclassification, String selectcommoditygradevalue,
			String ExpectedToastMsg) throws InterruptedException {

		String expectedCommodityValue = Comdetailsname.get("commoditygroupvalue");
		String ExpectedGroupClassificationValue = Comdetailsname.get("GroupClassification");
		String ExpectedSpecificGradeValue = Comdetailsname.get("SpecificGrade");

		LoggerUtil.info("Step 1: Opening Commodity Details view page...");
		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(6000);

		LoggerUtil.info("Step 2: Searching for Commodity → " + EnetringVaue);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
				EnetringVaue);
		Thread.sleep(7000);

		// ✅ Step 3: Build column index map dynamically from header names
		WebElement headerRow = driver.findElement(By.xpath("//table[@id='comodityDetailListTable']//thead/tr[1]"));
		List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));
		Map<String, Integer> columnIndexMap = new HashMap<>();

		for (int i = 0; i < headerColumns.size(); i++) {
			String headerText = headerColumns.get(i).getText().trim();
			if (!headerText.isEmpty()) {
				columnIndexMap.put(headerText, i);
			}
		}
		LoggerUtil.info("Header Index Mapping: " + columnIndexMap);

		// ✅ Step 4: Validate required columns exist
		if (!columnIndexMap.containsKey("Commodity Group") || !columnIndexMap.containsKey("Sub Group")
				|| !columnIndexMap.containsKey("Grade")) {
			LoggerUtil.fail("❌ Required column(s) not found: Commodity Group / Sub Group / Grade");
			Assert.fail("Required table headers missing in Commodity table.");
		}

		int commodityColIndex = columnIndexMap.get("Commodity Group");
		int subGroupColIndex = columnIndexMap.get("Sub Group");
		int gradeColIndex = columnIndexMap.get("Grade");

		// ✅ Step 5: Validate rows exist
		List<WebElement> rows = driver.findElements(FetichingRows);
		int rowCount = rows.size();
		LoggerUtil.info("Total Rows Found: " + rowCount);
		if (rowCount == 0) {
			LoggerUtil.fail("❌ No rows found in Commodity Details table.");
			Assert.fail("Table has 0 rows, cannot proceed.");
		}

		boolean matchFound = false;

		// ✅ Step 6: Iterate through rows and match values
		for (WebElement row : rows) {
			List<WebElement> cols = row.findElements(By.tagName("td"));
			if (cols.size() <= Math.max(commodityColIndex, Math.max(subGroupColIndex, gradeColIndex))) {
				LoggerUtil.info("Skipping incomplete row...");
				continue;
			}

			String actualCommodity = cols.get(commodityColIndex).getText().trim();
			String actualGroupClassification = cols.get(subGroupColIndex).getText().trim();
			String actualSpecificGrade = cols.get(gradeColIndex).getText().trim();

			LoggerUtil.info("Row → Commodity: " + actualCommodity + ", Group: " + actualGroupClassification
					+ ", Grade: " + actualSpecificGrade);

			if (expectedCommodityValue.equalsIgnoreCase(actualCommodity)
					&& ExpectedGroupClassificationValue.equalsIgnoreCase(actualGroupClassification)
					&& ExpectedSpecificGradeValue.equalsIgnoreCase(actualSpecificGrade)) {

				WebElement editButton = row.findElement(By.xpath(".//a[i[contains(@class,'fa-edit')]]"));
				editButton.click();
				LoggerUtil.pass("✅ Match found and clicked Edit for: " + expectedCommodityValue);
				matchFound = true;
				break;
			}
		}

		if (!matchFound) {
			LoggerUtil.fail("❌ No matching record found for → Commodity: " + expectedCommodityValue + ", Group: "
					+ ExpectedGroupClassificationValue + ", Grade: " + ExpectedSpecificGradeValue);
			Assert.fail("No matching row found in Commodity Details table.");
		}

		// ✅ Step 7: Update Group Classification
		Thread.sleep(8000);
		try {
			LoggerUtil.info("Step 4: Selecting Group Classification → " + searchcommodityclassification);
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);
            clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchInputforcommodityDetailsTab), searchcommodityclassification);
            Thread.sleep(300);
			boolean gcFound = false;
			for (WebElement grpclasslistval : driver.findElements(CommodityDetailsPage.groupclassificationlist)) {
				if (grpclasslistval.getText().trim().equalsIgnoreCase(searchcommodityclassification)) {
					grpclasslistval.click();
					LoggerUtil.pass("Group Classification selected → " + searchcommodityclassification);
					gcFound = true;
					break;
				}
			}
			if (!gcFound) {
				LoggerUtil.fail("❌ Group Classification not found → " + searchcommodityclassification);
			}
		} catch (Exception e) {
			LoggerUtil.error("❌ Step 4 failed while selecting Group Classification → " + e.getMessage());
		}

		Thread.sleep(7000);

		// ✅ Step 8: Update Specific Grade
		LoggerUtil.info("Step 5: Selecting Specific Grade → " + selectcommoditygradevalue);
		clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
		
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchInputforcommodityDetailsTab), selectcommoditygradevalue);
		
		List<WebElement> comgradelist = driver.findElements(CommodityDetailsPage.specificgradelist);

		for (WebElement comgradelistval : comgradelist) {
			String comgrade = comgradelistval.getText().trim();
			if (comgrade.equalsIgnoreCase(selectcommoditygradevalue)) {
				try {
					comgradelistval.click();
					LoggerUtil.pass("Specific Grade selected → " + selectcommoditygradevalue);
				} catch (Exception e) {
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", comgradelistval);
					LoggerUtil.pass("Clicked Specific Grade via JS → " + selectcommoditygradevalue);
				}
				break;
			}
		}

		// ✅ Step 9: Click Update and verify toast
		clickOnElement(CommodityDetailsPage.ClickingUpdateBtnCommoidtyDetailsTab);
		Thread.sleep(5000);

		String updatedToastMsg = waitForExpectedElement(CommodityDetailsPage.ToastMessageForSaveThirdTab).getText();
		LoggerUtil.info("Toast Message Captured → " + updatedToastMsg);
		Assert.assertTrue(updatedToastMsg.contains(ExpectedToastMsg),
				"Expected toast message mismatch! Expected: " + ExpectedToastMsg + ", Actual: " + updatedToastMsg);

		LoggerUtil.pass("✅ Commodity successfully updated and verified. Toast: " + updatedToastMsg);
	}

	public static void VerifyFetchingUpdatedData(HashMap<String, String> UpdatedComdetailsname,
			String SearchingUpdatedValue) throws InterruptedException {

		String expectedGroupName = UpdatedComdetailsname.get("Commodity Group");
		String expectedClassificationName = UpdatedComdetailsname.get("Group classification");
		String expectedSpecificGradeName = UpdatedComdetailsname.get("Specific Grade");

		Thread.sleep(3000);
		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(6000);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
				SearchingUpdatedValue);
		Thread.sleep(7000);

		List<WebElement> rows = driver.findElements(FetichingRows);

		for (WebElement row : rows) {
			List<WebElement> cols = row.findElements(By.tagName("td"));

			String actualGroupName = cols.get(2).getText().trim();
			String actualClassificationName = cols.get(3).getText().trim();
			String actualSpecificGradeName = cols.get(4).getText().trim();

			LoggerUtil.info("===== Commodity Details Validation Report =====");
			LoggerUtil
					.info("Field: Commodity Group | Expected: " + expectedGroupName + " | Actual: " + actualGroupName);
			if (expectedGroupName.equals(actualGroupName)) {
				LoggerUtil.pass("Commodity Group matched successfully.");
			} else {
				LoggerUtil.fail("Commodity Group mismatch!");
			}

			LoggerUtil.info("Field: Group Classification | Expected: " + expectedClassificationName + " | Actual: "
					+ actualClassificationName);
			if (expectedClassificationName.equals(actualClassificationName)) {
				LoggerUtil.pass("Group Classification matched successfully.");
			} else {
				LoggerUtil.fail("Group Classification mismatch!");
			}

			LoggerUtil.info("Field: Specific Grade | Expected: " + expectedSpecificGradeName + " | Actual: "
					+ actualSpecificGradeName);
			if (expectedSpecificGradeName.equals(actualSpecificGradeName)) {
				LoggerUtil.pass("Specific Grade matched successfully.");
			} else {
				LoggerUtil.fail("Specific Grade mismatch!");
			}

			if (expectedGroupName.equals(actualGroupName) && expectedClassificationName.equals(actualClassificationName)
					&& expectedSpecificGradeName.equals(actualSpecificGradeName)) {
				LoggerUtil.pass(" Commodity Details have been successfully updated and all values fetched accurately.");
			} else {
				LoggerUtil.fail(" Commodity Details verification failed. Some values did not match.");
			}

			break;
		}
	}

	public static void VerifySaveAsNewDataHasBeenSucessFullyCreatedNewEntryOrNot(HashMap<String, String> Comdetailsname,
			String EnetringVaue, String searchcommodityclassification, String selectcommoditygradevalue,
			String ExpectedToastMsg) throws InterruptedException {

		String expectedCommodityValue = Comdetailsname.get("commoditygroupvalue");
		String expectedGroupClassificationValue = Comdetailsname.get("GroupClassification");
		String expectedSpecificGradeValue = Comdetailsname.get("SpecificGrade");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(6000);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
				EnetringVaue);
		Thread.sleep(7000);

		List<WebElement> rows = driver.findElements(FetichingRows);

		for (WebElement row : rows) {
			List<WebElement> cols = row.findElements(By.tagName("td"));

			String actualCommodityValue = cols.get(2).getText().trim();
			String actualGroupClassification = cols.get(3).getText().trim();
			String actualSpecificGrade = cols.get(4).getText().trim();

			LoggerUtil.info("===== Save As New - Row Data Validation Report =====");
			LoggerUtil.info("Field: Commodity Group | Expected: " + expectedCommodityValue + " | Actual: "
					+ actualCommodityValue);
			LoggerUtil.info("Field: Group Classification | Expected: " + expectedGroupClassificationValue
					+ " | Actual: " + actualGroupClassification);
			LoggerUtil.info("Field: Specific Grade | Expected: " + expectedSpecificGradeValue + " | Actual: "
					+ actualSpecificGrade);

			if (expectedCommodityValue.equals(actualCommodityValue)
					&& expectedGroupClassificationValue.equals(actualGroupClassification)
					&& expectedSpecificGradeValue.equals(actualSpecificGrade)) {
				LoggerUtil.pass("Row matched successfully. Clicking Edit button for Save As New...");

				WebElement editButton = row.findElement(By.xpath(".//a[i[contains(@class,'fa-edit')]]"));
				editButton.click();
				break;
			} else {
				LoggerUtil.fail("Row values did not match. Skipping this row...");
			}
		}

		Thread.sleep(9000);
		try {
			LoggerUtil.info("Step: Selecting Group Classification for Save As New → " + searchcommodityclassification);
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);
			 clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchInputforcommodityDetailsTab), searchcommodityclassification);
	            Thread.sleep(300);
			boolean gcFound = false;
			for (WebElement grpclasslistval : driver.findElements(CommodityDetailsPage.groupclassificationlist)) {
				if (grpclasslistval.getText().trim().equalsIgnoreCase(searchcommodityclassification)) {
					grpclasslistval.click();
					LoggerUtil.pass("Group Classification selected for Save As New → " + searchcommodityclassification);
					gcFound = true;
					break;
				}
			}
			if (!gcFound) {
				LoggerUtil
						.fail("Group Classification not found in Save As New flow → " + searchcommodityclassification);
			}
		} catch (Exception e) {
			LoggerUtil.error("Group Classification selection failed in Save As New: " + e.getMessage());
		}

		Thread.sleep(7000);

		clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);
		List<WebElement> comgradelist = driver.findElements(CommodityDetailsPage.specificgradelist);
		for (WebElement comgradelistval : comgradelist) {
			String comgrade = comgradelistval.getText().trim();
			if (comgrade.equalsIgnoreCase(selectcommoditygradevalue)) {
				try {
					comgradelistval.click();
					LoggerUtil.pass("Specific Grade selected for Save As New → " + selectcommoditygradevalue);
				} catch (Exception e) {
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", comgradelistval);
					LoggerUtil.pass(
							"Specific Grade selected via JS click for Save As New → " + selectcommoditygradevalue);
				}
				break;
			}
		}

		LoggerUtil.info("Clicking Save As New button in Commodity Details tab...");
		clickOnElement(CommodityDetailsPage.ClickingSaveasNewButtonForThirdTab);

		Thread.sleep(5000);
		String saveAsNewToastMsg = waitForExpectedElement(CommodityDetailsPage.ToastMessageForSaveThirdTab).getText();
		LoggerUtil.info("Toast Message after Save As New: " + saveAsNewToastMsg);

		if (saveAsNewToastMsg.contains(ExpectedToastMsg)) {
			LoggerUtil.pass("Toast message matched for Save As New → " + ExpectedToastMsg);
		} else {
			LoggerUtil.fail("Toast message mismatch for Save As New! Expected: " + ExpectedToastMsg + " | Actual: "
					+ saveAsNewToastMsg);
		}
	}

	public static void VerifyFetchingSaveAsNewData(

			HashMap<String, String> SaveAsNewComdetailsname,

			String SearchingUpdatedValue) throws InterruptedException {

		String expectedGroupName = SaveAsNewComdetailsname.get("Commodity Group");

		String expectedClassificationName = SaveAsNewComdetailsname.get("Group classification");

		String expectedSpecificGradeName = SaveAsNewComdetailsname.get("Specific Grade");

		LoggerUtil.info("Step 1: Opening Commodity Details page...");

		Thread.sleep(2000);

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);

		Thread.sleep(4000);

		// 🔄 Re-activate Commodity Details tab (AJAX refresh fix)

		try {

			By commodityDetailsTab = By.xpath("//a[contains(text(),'Commodity Details')]");

			Base.waitForElement(commodityDetailsTab, 10).click();

			LoggerUtil.info("Commodity Details tab clicked again to refresh grid.");

		} catch (Exception e) {

			LoggerUtil.info("Commodity Details tab already active.");

		}

		// 🔝 Scroll to top → Sticky header must be visible to Selenium

		((JavascriptExecutor) driver).executeScript("window.scrollTo(0,0);");

		Thread.sleep(700);

		LoggerUtil.info("Step 2: Searching for Commodity Value → " + SearchingUpdatedValue);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),

				SearchingUpdatedValue);

		Thread.sleep(3000);

		// ================================================================

		// 🔥 MOST IMPORTANT FIX – Reliable table header locator + explicit wait

		// ================================================================

		By headerRowBy = By.xpath("(//table[@id='comodityDetailListTable']//thead)[1]/tr[1]");

		WebElement headerRow;

		try {

			headerRow = Base.waitForElement(headerRowBy, 30);

			LoggerUtil.pass("Commodity Details table header located successfully.");

		} catch (Exception e) {

			LoggerUtil.error("❌ Commodity Details table header NOT FOUND after Save As New.");

			Assert.fail("Header not visible. Table not loaded.");

			return;

		}

		// Step 3: Fetch header columns dynamically

		List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));

		Map<String, Integer> columnIndexMap = new HashMap<>();

		for (int i = 0; i < headerColumns.size(); i++) {

			String headerText = headerColumns.get(i).getText().trim();

			if (!headerText.isEmpty()) {

				columnIndexMap.put(headerText, i);

			}

		}

		LoggerUtil.info("Header Column Mapping → " + columnIndexMap);

		// Step 4: Validate expected columns exist

		if (!columnIndexMap.containsKey("Commodity Group") ||

				!columnIndexMap.containsKey("Sub Group") ||

				!columnIndexMap.containsKey("Grade")) {

			LoggerUtil.fail("❌ Required table columns not found (Commodity Group / Sub Group / Grade)");

			Assert.fail("Table header missing required columns.");

		}

		int commodityColIndex = columnIndexMap.get("Commodity Group");

		int subGroupColIndex = columnIndexMap.get("Sub Group");

		int gradeColIndex = columnIndexMap.get("Grade");

		// Step 5: Get table rows

		List<WebElement> rows = driver.findElements(FetichingRows);

		int rowCount = rows.size();

		LoggerUtil.info("Total Rows Found: " + rowCount);

		if (rowCount == 0) {

			LoggerUtil.fail("❌ No rows found in Commodity table. Cannot verify Save As New data.");

			Assert.fail("Commodity table has 0 rows.");

		}

		// Step 6: Iterate through rows and validate values

		for (WebElement row : rows) {

			List<WebElement> cols = row.findElements(By.tagName("td"));

			if (cols.size() <= Math.max(commodityColIndex,

					Math.max(subGroupColIndex, gradeColIndex))) {

				LoggerUtil.info("Skipping incomplete row...");

				continue;

			}

			String actualGroupName = cols.get(commodityColIndex).getText().trim();

			String actualClassificationName = cols.get(subGroupColIndex).getText().trim();

			String actualSpecificGradeName = cols.get(gradeColIndex).getText().trim();

			LoggerUtil.info("===== Save As New - Commodity Details Validation Report =====");

			// Commodity Group

			LoggerUtil.info("Commodity Group | Expected: " + expectedGroupName + " | Actual: " + actualGroupName);

			if (expectedGroupName.equalsIgnoreCase(actualGroupName))

				LoggerUtil.pass("✔ Commodity Group matched.");

			else

				LoggerUtil.fail("✘ Commodity Group mismatch!");

			// Group Classification

			LoggerUtil.info("Group Classification | Expected: " + expectedClassificationName + " | Actual: "
					+ actualClassificationName);

			if (expectedClassificationName.equalsIgnoreCase(actualClassificationName))

				LoggerUtil.pass("✔ Group Classification matched.");

			else

				LoggerUtil.fail("✘ Group Classification mismatch!");

			// Specific Grade

			LoggerUtil.info("Specific Grade | Expected: " + expectedSpecificGradeName + " | Actual: "
					+ actualSpecificGradeName);

			if (expectedSpecificGradeName.equalsIgnoreCase(actualSpecificGradeName))

				LoggerUtil.pass("✔ Specific Grade matched.");

			else

				LoggerUtil.fail("✘ Specific Grade mismatch!");

			// Final Summary

			if (expectedGroupName.equalsIgnoreCase(actualGroupName)
					&& expectedClassificationName.equalsIgnoreCase(actualClassificationName)
					&& expectedSpecificGradeName.equalsIgnoreCase(actualSpecificGradeName)) {

				LoggerUtil.pass("🎉 Save As New commodity entry verified successfully.");

			} else {

				LoggerUtil.fail("❌ Save As New verification failed.");

			}

			break; // Validate only first matching row

		}

	}

	public static final By FetchingHeaderNamesCommodityDetailsTable = By
			.xpath("(//table[@id='comodityDetailListTable']//thead)[1]/tr[1]");

	public static void verifyOldDataAsItIsOrNot(HashMap<String, String> Comdetailsname, String EnetringVaue,
			String searchcommodityclassification, String selectcommoditygradevalue) throws InterruptedException {

		String expectedCommodityValue = Comdetailsname.get("commoditygroupvalue");
		String expectedGroupClassificationValue = Comdetailsname.get("GroupClassification");
		String expectedSpecificGradeValue = Comdetailsname.get("SpecificGrade");

		LoggerUtil.info("Step 1: Closing edit modal and navigating to Commodity Details table...");
		clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
		Thread.sleep(4000);
		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(6000);

		LoggerUtil.info("Step 2: Searching for Commodity → " + EnetringVaue);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
				EnetringVaue);
		Thread.sleep(7000);

		// ✅ Step 3: Build header-column index mapping
		WebElement headerRow = waitForExpectedElement(FetchingHeaderNamesCommodityDetailsTable);
		List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));
		Map<String, Integer> columnIndexMap = new HashMap<>();

		for (int i = 0; i < headerColumns.size(); i++) {
			String headerText = headerColumns.get(i).getText().trim();
			if (!headerText.isEmpty()) {
				columnIndexMap.put(headerText, i);
			}
		}

		LoggerUtil.info("Header Column Mapping → " + columnIndexMap);

		// ✅ Step 4: Validate required columns exist
		if (!columnIndexMap.containsKey("Commodity Group") || !columnIndexMap.containsKey("Sub Group")
				|| !columnIndexMap.containsKey("Grade")) {
			LoggerUtil.fail("❌ Required columns not found in table header (Commodity Group / Sub Group / Grade).");
			Assert.fail("Required headers missing in Commodity Details table.");
		}

		int commodityColIndex = columnIndexMap.get("Commodity Group");
		int subGroupColIndex = columnIndexMap.get("Sub Group");
		int gradeColIndex = columnIndexMap.get("Grade");

		// ✅ Step 5: Validate rows exist
		List<WebElement> rows = driver.findElements(FetichingRows);
		int rowCount = rows.size();
		LoggerUtil.info("Total Rows Found: " + rowCount);

		if (rowCount == 0) {
			LoggerUtil.fail("❌ No data rows found in Commodity Details table. Cannot verify old data.");
			Assert.fail("No table rows present for validation.");
		}

		boolean oldDataFound = false;

		// ✅ Step 6: Iterate through rows and match data
		for (WebElement row : rows) {
			List<WebElement> cols = row.findElements(By.tagName("td"));
			if (cols.size() <= Math.max(commodityColIndex, Math.max(subGroupColIndex, gradeColIndex))) {
				LoggerUtil.info("Skipping incomplete row (insufficient columns)...");
				continue;
			}

			String actualCommodityValue = cols.get(commodityColIndex).getText().trim();
			String actualGroupClassification = cols.get(subGroupColIndex).getText().trim();
			String actualSpecificGrade = cols.get(gradeColIndex).getText().trim();

			LoggerUtil.info("===== 🧾 Old Data Validation Report =====");
			LoggerUtil.info("Field: Commodity Group | Expected: " + expectedCommodityValue + " | Actual: "
					+ actualCommodityValue);
			LoggerUtil.info("Field: Group Classification | Expected: " + expectedGroupClassificationValue
					+ " | Actual: " + actualGroupClassification);
			LoggerUtil.info("Field: Specific Grade | Expected: " + expectedSpecificGradeValue + " | Actual: "
					+ actualSpecificGrade);

			boolean matchCommodity = expectedCommodityValue.equalsIgnoreCase(actualCommodityValue);
			boolean matchGroup = expectedGroupClassificationValue.equalsIgnoreCase(actualGroupClassification);
			boolean matchGrade = expectedSpecificGradeValue.equalsIgnoreCase(actualSpecificGrade);

			if (matchCommodity && matchGroup && matchGrade) {
				LoggerUtil.pass("✅ Old data is intact. 'Save As New' did not impact the original record.");
				oldDataFound = true;
				break;
			}
		}

		// ✅ Step 7: Final report
		if (!oldDataFound) {
			LoggerUtil
					.fail("❌ Old data is missing or modified! 'Save As New' may have overwritten the original entry.");
			Assert.fail("Old Commodity record not found or modified unexpectedly.");
		} else {
			LoggerUtil.pass("✅ Validation complete — Old record verified successfully.");
		}
	}

	public static final By clickingAddCustomer = By
			.xpath("//div[@class='col-md-4 px-1']/descendant::a[@id='addNewCustomer']");
	public static final By EnterCustomerCode = By.xpath("//input[@id='CustomerCode']");
	public static final By EnterCustomerName = By.xpath("//input[@id='CustomerName']");
	public static final By clickingBusinessSegDropDown = By
			.xpath("//select[@id='BusinessSegments']/following-sibling::div/button");
	public static final By EnterBusinessSegMentName = By
			.xpath("//*[@id='BusinessSegments']/following-sibling::div/div/div/input");
	public static final By clickingCheckboxForSeclectingBusinessSegment = By
			.xpath("//select[@id='BusinessSegments']/following-sibling::div/div/button/span/input");
	public static final By clickingSaveButtonCustomer = By.xpath("//button[@id='customerSave1']");
	public static final By FetchingToastmsg = By.xpath("//*[@id='toast-container']/div/div[2]");

	public static void VerifyAddCustomerToast(String EnterCustcode, String EnterCustname, String ExpectedToast)
			throws InterruptedException {

		Thread.sleep(3000);
		clickOnElement(clickingAddCustomer);
		Thread.sleep(2000);
		clearAndEnterText(waitForExpectedElement(EnterCustomerCode), EnterCustcode);
		Thread.sleep(3000);
		clearAndEnterText(waitForExpectedElement(EnterCustomerName), EnterCustname);
		Thread.sleep(5000);
		clickOnElement(clickingBusinessSegDropDown);
		Thread.sleep(3000);

		clearAndEnterText(waitForExpectedElement(EnterBusinessSegMentName), "plastic");
		Thread.sleep(5000);
		clickOnElement(clickingCheckboxForSeclectingBusinessSegment);
		Thread.sleep(4000);
		clickOnElement(clickingSaveButtonCustomer);
		Thread.sleep(2999);
		String actualToast = waitForExpectedElement(FetchingToastmsg).getText();
		System.out.print(actualToast);
		Assert.assertTrue(actualToast.contains(ExpectedToast));
		Thread.sleep(8000);

	}

	public static void enterRmandScrapvalueForcalculatingRmAndScrapvalueforsupplierAllocation(String aprmval,
			String aprscrval, String mayrmval, String mayscrapval, String junermval, String junescrval, String julrmval,
			String julscrval, String augrmval, String augscrval, String seprmval, String sepscrval, String octrmval,
			String octscrval, String novrmval, String novscrval, String decrmval, String decscrval, String janrmval,
			String janscrval, String febrmval, String febscrval, String marrmval, String marscrval,
			String ExpectedToast) throws InterruptedException {

		try {
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "RM")),
					aprmval);
			LoggerUtil.pass("Entered April RM: " + aprmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "Scrap")),
					aprscrval);
			LoggerUtil.pass("Entered April Scrap: " + aprscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("May", "RM")),
					mayrmval);
			LoggerUtil.pass("Entered May RM: " + mayrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("May", "Scrap")),
					mayscrapval);
			LoggerUtil.pass("Entered May Scrap: " + mayscrapval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jun", "RM")),
					junermval);
			LoggerUtil.pass("Entered June RM: " + junermval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jun", "Scrap")),
					junescrval);
			LoggerUtil.pass("Entered June Scrap: " + junescrval);

			// Q2: JULY – SEPTEMBER
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jul", "RM")),
					julrmval);
			LoggerUtil.pass("Entered July RM: " + julrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jul", "Scrap")),
					julscrval);
			LoggerUtil.pass("Entered July Scrap: " + julscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Aug", "RM")),
					augrmval);
			LoggerUtil.pass("Entered August RM: " + augrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Aug", "Scrap")),
					augscrval);
			LoggerUtil.pass("Entered August Scrap: " + augscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Sep", "RM")),
					seprmval);
			LoggerUtil.pass("Entered September RM: " + seprmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Sep", "Scrap")),
					sepscrval);
			LoggerUtil.pass("Entered September Scrap: " + sepscrval);

			// Q3: OCTOBER – DECEMBER
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Oct", "RM")),
					octrmval);
			LoggerUtil.pass("Entered October RM: " + octrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Oct", "Scrap")),
					octscrval);
			LoggerUtil.pass("Entered October Scrap: " + octscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Nov", "RM")),
					novrmval);
			LoggerUtil.pass("Entered November RM: " + novrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Nov", "Scrap")),
					novscrval);
			LoggerUtil.pass("Entered November Scrap: " + novscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Dec", "RM")),
					decrmval);
			LoggerUtil.pass("Entered December RM: " + decrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Dec", "Scrap")),
					decscrval);
			LoggerUtil.pass("Entered December Scrap: " + decscrval);

			// Q4: JANUARY – MARCH
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jan", "RM")),
					janrmval);
			LoggerUtil.pass("Entered January RM: " + janrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jan", "Scrap")),
					janscrval);
			LoggerUtil.pass("Entered January Scrap: " + janscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Feb", "RM")),
					febrmval);
			LoggerUtil.pass("Entered February RM: " + febrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Feb", "Scrap")),
					febscrval);
			LoggerUtil.pass("Entered February Scrap: " + febscrval);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Mar", "RM")),
					marrmval);
			LoggerUtil.pass("Entered March RM: " + marrmval);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Mar", "Scrap")),
					marscrval);
			LoggerUtil.pass("Entered March Scrap: " + marscrval);

			// Business Seg selection
			clickOnElement(CommodityDetailsPage.businessSegbox);
			LoggerUtil.info("Clicked on Business Segment box");
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
					DataProp.getProperty("BusinessSegment"));
			LoggerUtil.info("Searched Business Segment with: " + DataProp.getProperty("BusinessSegment"));
			Thread.sleep(3000);

			clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
			LoggerUtil.pass("Selected all Business Segment checkboxes");
			Thread.sleep(9000);

			clickOnElement(CommodityDetailsPage.customercheckbox);
			LoggerUtil.pass("Clicked on Customer checkbox");
			Thread.sleep(5000);

			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);
			Thread.sleep(3000);
			String actualToastSave = waitForExpectedElement(CommodityDetailsPage.toastmsg).getText();
			Thread.sleep(399);
			System.out.println(actualToastSave);
			Assert.assertTrue(actualToastSave.contains(ExpectedToast));

		} catch (Exception e) {
			LoggerUtil.error("Error while entering RM & Scrap values: " + e.getMessage());
			throw e;
		}
	}

	public static final By FetchingCommodityViewTableDataByRowIndexing = By
			.xpath("//table[@id='comodityDetailListTable']/tbody/tr");
	public static final By EnterSearchValueForCommodityGroupNameForExcelPriceUpdate = By
			.xpath("//select[@id='CommodityList1']/following-sibling::div/div/div/input[@placeholder='Search']");
	public static final By FetchingCommodityGroupListCheckBoxForPriceUpdate = By.xpath(
			"//select[@id='CommodityList1']/following-sibling::div/div/div/following-sibling::button/span/input");
	public static final By EnterSearchValueClassificationForPriceUpdate = By
			.xpath("//select[@id='CategoryList']/following-sibling::div/div/div/input");
	public static final By FetchingGrpclssificationCheckboxList = By
			.xpath("//select[@id='CategoryList']/following-sibling::div/div/button/span/input");

	public static void VerifyAllDataHasBeenSavedAccuratelyOrNot(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade, String EnetringSearchValue)
			throws InterruptedException {

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(5000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
				EnetringSearchValue);
		Thread.sleep(6000);

		List<WebElement> ValueCommodityDetailsrow = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

		for (WebElement row : ValueCommodityDetailsrow) {
			List<WebElement> colomns = row.findElements(By.tagName("td"));

			String actualCommodityGroupValue = colomns.get(2).getText().trim();
			String actualGroupClassificationvalue = colomns.get(3).getText().trim();
			String actualSpecificGradeValue = colomns.get(4).getText().trim();

			LoggerUtil.info("------ Verifying Row Data ------");
			LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
					+ actualCommodityGroupValue);
			LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
					+ actualGroupClassificationvalue);
			LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
					+ actualSpecificGradeValue);

			if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
					&& actualGroupClassificationvalue.equals(ExpectedGroupClassificationValue)
					&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

				LoggerUtil.pass(" All Values Matched for this row.");

				Thread.sleep(4000);
				clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
				Thread.sleep(2000);
				driver.navigate().refresh();
				Thread.sleep(5000);
				clickOnElement(CommodityDetailsPage.ClickingExportAndImportBtn);
				Thread.sleep(2000);
				clickOnElement(CommodityDetailsPage.clickingCommodityDropdownForExportImport);
				Thread.sleep(3000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueForCommodityGroupNameForExcelPriceUpdate),
						ExpectedCommodityGroupValue);
				Thread.sleep(3000);
				List<WebElement> CommodityGroupDropCheckoxlist = driver
						.findElements(FetchingCommodityGroupListCheckBoxForPriceUpdate);
				Thread.sleep(2000);
				WebElement CheckboxCommoditygroup = CommodityGroupDropCheckoxlist.get(0);
				Thread.sleep(2000);
				CheckboxCommoditygroup.click();
				clickOnElement(CommodityDetailsPage.clickingGroupClassificationDropdownForExportAndImport);
				Thread.sleep(2000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueClassificationForPriceUpdate),
						ExpectedGroupClassificationValue);
				Thread.sleep(3000);
				List<WebElement> listClassificationcheckbox = driver.findElements(FetchingGrpclssificationCheckboxList);
				Thread.sleep(3000);
				WebElement clickingCheckboxlist = listClassificationcheckbox.get(0);
				Thread.sleep(2000);
				clickingCheckboxlist.click();
				Thread.sleep(2000);
				clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
				Thread.sleep(15000);
				File filename = getLatestCommodityDetailsTabFile();
				Thread.sleep(3000);
				LoggerUtil.info("The Latest File Has been Found With Actual Path = " + filename);

			} else {
				LoggerUtil.mismatch("❌ Mismatch Found -> " + "Commodity Group (Expected: " + ExpectedCommodityGroupValue
						+ ", Actual: " + actualCommodityGroupValue + "), " + "Group Classification (Expected: "
						+ ExpectedGroupClassificationValue + ", Actual: " + actualGroupClassificationvalue + "), "
						+ "Specific Grade (Expected: " + ExpectedSpecificGradeValue + ", Actual: "
						+ actualSpecificGradeValue + ")");
			}
		}
	}

	public static void VerifyExcelAndUiDataHasBeenEqualOrNotForPriceUpdate(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade,
			HashMap<String, String> FetchingBaseRmAndScrapPrices) throws IOException {

		String uiCommodityGroup = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String uiGroupClassification = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String uiSpecificGrade = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		String uiBaseAprilRm = FetchingBaseRmAndScrapPrices.get("April Rm");
		String uiBaseAprilScrap = FetchingBaseRmAndScrapPrices.get("April Scrap");
		String uiBaseMayRm = FetchingBaseRmAndScrapPrices.get("May Rm");
		String uiBaseMayScrap = FetchingBaseRmAndScrapPrices.get("May Scrap");
		String uiBaseJuneRm = FetchingBaseRmAndScrapPrices.get("June Rm");
		String uiBaseJuneScrap = FetchingBaseRmAndScrapPrices.get("June Scrap");
		String uiBaseJulyRm = FetchingBaseRmAndScrapPrices.get("July Rm");
		String uiBaseJulyScrap = FetchingBaseRmAndScrapPrices.get("July Scrap");
		String uiBaseAugRm = FetchingBaseRmAndScrapPrices.get("August Rm");
		String uiBaseAugScrap = FetchingBaseRmAndScrapPrices.get("August Scrap");
		String uiBaseSepRm = FetchingBaseRmAndScrapPrices.get("September Rm");
		String uiBaseSepScrap = FetchingBaseRmAndScrapPrices.get("September Scrap");
		String uiBaseOctoberRm = FetchingBaseRmAndScrapPrices.get("October Rm");
		String uiBaseOctoberScrap = FetchingBaseRmAndScrapPrices.get("October Scrap");
		String uiBaseNovemberRm = FetchingBaseRmAndScrapPrices.get("November Rm");
		String uiBaseNovemberScrap = FetchingBaseRmAndScrapPrices.get("November Scrap ");
		String uiBaseDecemberRm = FetchingBaseRmAndScrapPrices.get("December Rm");
		String uiBaseDecemberScrap = FetchingBaseRmAndScrapPrices.get("December Scrap");
		String uiBaseJanRm = FetchingBaseRmAndScrapPrices.get("Jan Rm");
		String uiBaseJanScrap = FetchingBaseRmAndScrapPrices.get("Jan Scrap");
		String uiBaseFebRm = FetchingBaseRmAndScrapPrices.get("Feb Rm");
		String uiBaseFebScrap = FetchingBaseRmAndScrapPrices.get("Feb Scrap");
		String uiBaseMarchRm = FetchingBaseRmAndScrapPrices.get("March Rm");
		String uiBaseMarchScrap = FetchingBaseRmAndScrapPrices.get("March Scrap");

		BigDecimal aprilRmUi = new BigDecimal(uiBaseAprilRm);
		aprilRmUi = aprilRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal aprilScrapUi = new BigDecimal(uiBaseAprilScrap);
		aprilScrapUi = aprilScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal MayRmUi = new BigDecimal(uiBaseMayRm);
		MayRmUi = MayRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal MayScrapUi = new BigDecimal(uiBaseMayScrap);
		MayScrapUi = MayScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal juneRmUi = new BigDecimal(uiBaseJuneRm);
		juneRmUi = juneRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal juneScrapUi = new BigDecimal(uiBaseJuneScrap);
		juneScrapUi = juneScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal julyRmUi = new BigDecimal(uiBaseJulyRm);
		julyRmUi = julyRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal julyScrapUi = new BigDecimal(uiBaseJulyScrap);
		julyScrapUi = julyScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal AugRmui = new BigDecimal(uiBaseAugRm);
		AugRmui = AugRmui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal AugScrapui = new BigDecimal(uiBaseAugScrap);
		AugScrapui = AugScrapui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal SepRmUi = new BigDecimal(uiBaseSepRm);
		SepRmUi = SepRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal SepScrapUi = new BigDecimal(uiBaseSepScrap);
		SepScrapUi = SepScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal OctoberRmUi = new BigDecimal(uiBaseOctoberRm);
		OctoberRmUi = OctoberRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal OctoberScrapUi = new BigDecimal(uiBaseOctoberScrap);
		OctoberScrapUi = OctoberScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal NovemberRmUi = new BigDecimal(uiBaseNovemberRm);
		NovemberRmUi = NovemberRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal NovemberScrapui = new BigDecimal(uiBaseNovemberScrap);
		NovemberScrapui = NovemberScrapui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal DecemberRmUi = new BigDecimal(uiBaseDecemberRm);
		DecemberRmUi = DecemberRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal DecemberScrapUi = new BigDecimal(uiBaseDecemberScrap);
		DecemberScrapUi = DecemberScrapUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal janRmUi = new BigDecimal(uiBaseJanRm);
		janRmUi = janRmUi.setScale(3, RoundingMode.HALF_UP);

		BigDecimal janscrapui = new BigDecimal(uiBaseJanScrap);
		janscrapui = janscrapui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal FebRmui = new BigDecimal(uiBaseFebRm);
		FebRmui = FebRmui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal FebScrapui = new BigDecimal(uiBaseFebScrap);
		FebScrapui = FebScrapui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal Marchui = new BigDecimal(uiBaseMarchRm);
		Marchui = Marchui.setScale(3, RoundingMode.HALF_UP);

		BigDecimal Marchscrapui = new BigDecimal(uiBaseMarchScrap);
		Marchscrapui = Marchscrapui.setScale(3, RoundingMode.HALF_UP);

		// 1. Latest file fetch
		File latestFile = Base.getLatestCommodityDetailsTabFile();
		if (latestFile == null) {
			LoggerUtil.error("❌ No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			Sheet sheet = workbook.getSheetAt(0);
			Row row = sheet.getRow(3); // 4th row (0-based index = 3)

			// Commodity details from Excel
			String excelCommodityGroup = row.getCell(1).toString().trim();
			String excelGroupClassification = row.getCell(2).toString().trim();
			String excelSpecificGrade = row.getCell(6).toString().trim();

			// --- Commodity comparison ---
			ExcelUtil.logCompare("Commodity Group", uiCommodityGroup, excelCommodityGroup);
			ExcelUtil.logCompare("Group Classification", uiGroupClassification, excelGroupClassification);
			ExcelUtil.logCompare("Specific Grade", uiSpecificGrade, excelSpecificGrade);

			// RM & Scrap from Excel
			String ExcelActualAprilRmPrice = row.getCell(10).toString().trim();
			String ExcelActualAprilScrapPrice = row.getCell(11).toString().trim();
			String ExcelActualMayRmPrice = row.getCell(12).toString().trim();
			String ExcelActualMayScrapPrice = row.getCell(13).toString().trim();
			String ExcelActualJuneRm = row.getCell(14).toString().trim();
			String ExcelActualJuneScrap = row.getCell(15).toString().trim();
			String ExcelActualJulyRm = row.getCell(16).toString().trim();
			String ExcelActualJulyScrap = row.getCell(17).toString().trim();
			String ExcelActualAugustRm = row.getCell(18).toString().trim();
			String ExcelActualAugustScrap = row.getCell(19).toString().trim();
			String ExcelActualSeptemberRm = row.getCell(20).toString().trim();
			String ExcelActualSeptemberScrap = row.getCell(21).toString().trim();
			String ExcelActualOctoberRm = row.getCell(22).toString().trim();
			String ExcelActualOctoberScrap = row.getCell(23).toString().trim();
			String ExcelActualNovemberRm = row.getCell(24).toString().trim();
			String ExcelActualNovemberScrap = row.getCell(25).toString().trim();
			String ExcelActualDecemberRm = row.getCell(26).toString().trim();
			String ExcelActualDecemberScrap = row.getCell(27).toString().trim();
			String ExcelActualJanRm = row.getCell(28).toString().trim();
			String ExcelActualJanScrap = row.getCell(29).toString().trim();
			String ExcelActualFebRm = row.getCell(30).toString().trim();
			String ExcelActualFebScrap = row.getCell(31).toString().trim();
			String ExcelActualMarchRm = row.getCell(32).toString().trim();
			String ExcelActualMarchScrap = row.getCell(33).toString().trim();

			// Convert to BigDecimal with scale(3)
			BigDecimal ExcelAprilRm = new BigDecimal(ExcelActualAprilRmPrice).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelAprilScrap = new BigDecimal(ExcelActualAprilScrapPrice).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelMayRm = new BigDecimal(ExcelActualMayRmPrice).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelMayScrap = new BigDecimal(ExcelActualMayScrapPrice).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelJuneRm = new BigDecimal(ExcelActualJuneRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelJuneScrap = new BigDecimal(ExcelActualJuneScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelJulyRm = new BigDecimal(ExcelActualJulyRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelJulyScrap = new BigDecimal(ExcelActualJulyScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelAugustRm = new BigDecimal(ExcelActualAugustRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelAugustScrap = new BigDecimal(ExcelActualAugustScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelSeptemberRm = new BigDecimal(ExcelActualSeptemberRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelSeptemberScrap = new BigDecimal(ExcelActualSeptemberScrap).setScale(3,
					RoundingMode.HALF_UP);

			BigDecimal ExcelOctoberRm = new BigDecimal(ExcelActualOctoberRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelOctoberScrap = new BigDecimal(ExcelActualOctoberScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelNovemberRm = new BigDecimal(ExcelActualNovemberRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelNovemberScrap = new BigDecimal(ExcelActualNovemberScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelDecemberRm = new BigDecimal(ExcelActualDecemberRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelDecemberScrap = new BigDecimal(ExcelActualDecemberScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelJanRm = new BigDecimal(ExcelActualJanRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelJanScrap = new BigDecimal(ExcelActualJanScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelFebRm = new BigDecimal(ExcelActualFebRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelFebScrap = new BigDecimal(ExcelActualFebScrap).setScale(3, RoundingMode.HALF_UP);

			BigDecimal ExcelMarchRm = new BigDecimal(ExcelActualMarchRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelMarchScrap = new BigDecimal(ExcelActualMarchScrap).setScale(3, RoundingMode.HALF_UP);

			// --- RM & Scrap comparison ---
			// April
			ExcelUtil.logCompare("April RM", aprilRmUi, ExcelAprilRm);
			ExcelUtil.logCompare("April Scrap", aprilScrapUi, ExcelAprilScrap);

			// May
			ExcelUtil.logCompare("May RM", MayRmUi, ExcelMayRm);
			ExcelUtil.logCompare("May Scrap", MayScrapUi, ExcelMayScrap);

			// June
			ExcelUtil.logCompare("June RM", juneRmUi, ExcelJuneRm);
			ExcelUtil.logCompare("June Scrap", juneScrapUi, ExcelJuneScrap);

			// July
			ExcelUtil.logCompare("July RM", julyRmUi, ExcelJulyRm);
			ExcelUtil.logCompare("July Scrap", julyScrapUi, ExcelJulyScrap);

			// August
			ExcelUtil.logCompare("August RM", AugRmui, ExcelAugustRm);
			ExcelUtil.logCompare("August Scrap", AugScrapui, ExcelAugustScrap);

			// September
			ExcelUtil.logCompare("September RM", SepRmUi, ExcelSeptemberRm);
			ExcelUtil.logCompare("September Scrap", SepScrapUi, ExcelSeptemberScrap);

			// October
			ExcelUtil.logCompare("October RM", OctoberRmUi, ExcelOctoberRm);
			ExcelUtil.logCompare("October Scrap", OctoberScrapUi, ExcelOctoberScrap);

			// November
			ExcelUtil.logCompare("November RM", NovemberRmUi, ExcelNovemberRm);
			ExcelUtil.logCompare("November Scrap", NovemberScrapui, ExcelNovemberScrap);

			// December
			ExcelUtil.logCompare("December RM", DecemberRmUi, ExcelDecemberRm);
			ExcelUtil.logCompare("December Scrap", DecemberScrapUi, ExcelDecemberScrap);

			// January
			ExcelUtil.logCompare("January RM", janRmUi, ExcelJanRm);
			ExcelUtil.logCompare("January Scrap", janscrapui, ExcelJanScrap);

			// February
			ExcelUtil.logCompare("February RM", FebRmui, ExcelFebRm);
			ExcelUtil.logCompare("February Scrap", FebScrapui, ExcelFebScrap);

			// March
			ExcelUtil.logCompare("March RM", Marchui, ExcelMarchRm);
			ExcelUtil.logCompare("March Scrap", Marchscrapui, ExcelMarchScrap);

		}
	}

	public static void EnteringRmAndScrapInUiAndSaveData(String enteraprilrm, String enteraprilscrap,
			String ExpectedToast) throws InterruptedException {

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "RM")),
				enteraprilrm);
		LoggerUtil.pass("Entered April RM: " + enteraprilrm);
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "Scrap")),
				enteraprilscrap);
		LoggerUtil.pass("Entered April Scrap: " + enteraprilscrap);

		clickOnElement(CommodityDetailsPage.businessSegbox);
		LoggerUtil.info("Clicked on Business Segment box");
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
				DataProp.getProperty("BusinessSegment"));
		LoggerUtil.info("Searched Business Segment with: " + DataProp.getProperty("BusinessSegment"));
		Thread.sleep(3000);

		clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
		LoggerUtil.pass("Selected all Business Segment checkboxes");
		Thread.sleep(9000);

		clickOnElement(CommodityDetailsPage.customercheckbox);
		LoggerUtil.pass("Clicked on Customer checkbox");
		Thread.sleep(5000);

		clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);
		Thread.sleep(3000);
		String actualToastSave = waitForExpectedElement(CommodityDetailsPage.toastmsg).getText();
		Thread.sleep(399);
		System.out.println(actualToastSave);
		Assert.assertTrue(actualToastSave.contains(ExpectedToast));

	}

	public static void VerifyAllDataHasBeenSavedAccuratelyOrNotForGroupDelta(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade, String EnetringSearchValue)
			throws InterruptedException {

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(9000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
				EnetringSearchValue);
		Thread.sleep(8000);

		List<WebElement> ValueCommodityDetailsrow = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

		for (WebElement row : ValueCommodityDetailsrow) {
			List<WebElement> colomns = row.findElements(By.tagName("td"));

			String actualCommodityGroupValue = colomns.get(2).getText().trim();
			String actualGroupClassificationvalue = colomns.get(3).getText().trim();
			String actualSpecificGradeValue = colomns.get(4).getText().trim();

			LoggerUtil.info("------ Verifying Row Data ------");
			LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
					+ actualCommodityGroupValue);
			LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
					+ actualGroupClassificationvalue);
			LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
					+ actualSpecificGradeValue);

			if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
					&& actualGroupClassificationvalue.equals(ExpectedGroupClassificationValue)
					&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

				LoggerUtil.pass(" All Values Matched for this row.");

				Thread.sleep(4000);
				clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
				Thread.sleep(2000);
				driver.navigate().refresh();
				Thread.sleep(9000);
				clickOnElement(CommodityDetailsPage.ClickingExportAndImportBtn);
				Thread.sleep(2000);

				clickOnElement(CommodityDetailsPage.clickingGroupDeltaRadioButtonForExportingExcelFile);
				Thread.sleep(3000);
				clickOnElement(CommodityDetailsPage.clickingCommodityDropdownForExportImport);
				Thread.sleep(3000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueForCommodityGroupNameForExcelPriceUpdate),
						ExpectedCommodityGroupValue);
				Thread.sleep(3000);
				List<WebElement> CommodityGroupDropCheckoxlist = driver
						.findElements(FetchingCommodityGroupListCheckBoxForPriceUpdate);
				Thread.sleep(2000);
				WebElement CheckboxCommoditygroup = CommodityGroupDropCheckoxlist.get(0);
				Thread.sleep(2000);
				CheckboxCommoditygroup.click();
				clickOnElement(CommodityDetailsPage.clickingGroupClassificationDropdownForExportAndImport);
				Thread.sleep(2000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueClassificationForPriceUpdate),
						ExpectedGroupClassificationValue);
				Thread.sleep(3000);
				List<WebElement> listClassificationcheckbox = driver.findElements(FetchingGrpclssificationCheckboxList);
				Thread.sleep(3000);
				WebElement clickingCheckboxlist = listClassificationcheckbox.get(0);
				Thread.sleep(2000);
				clickingCheckboxlist.click();
				Thread.sleep(2000);
				clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
				Thread.sleep(15000);
				File filename = getLatestCommodityDetailsTabFileGroupDelta();
				Thread.sleep(3000);
				LoggerUtil.info("The Latest File Has been Found With Actual Path = " + filename);

			} else {
				LoggerUtil.mismatch("❌ Mismatch Found -> " + "Commodity Group (Expected: " + ExpectedCommodityGroupValue
						+ ", Actual: " + actualCommodityGroupValue + "), " + "Group Classification (Expected: "
						+ ExpectedGroupClassificationValue + ", Actual: " + actualGroupClassificationvalue + "), "
						+ "Specific Grade (Expected: " + ExpectedSpecificGradeValue + ", Actual: "
						+ actualSpecificGradeValue + ")");
			}
		}
	}

	public static void ReadingValueInSecondSheetAndVerifyAllUiValueDownLoadAccuratelyoRNotInGroupDeltaExcelFile(
			HashMap<String, String> fetchingRmAndScrapValues) throws FileNotFoundException, IOException {
		HashMap<String, String> SecondSheetRmAndScrap = new HashMap<String, String>();

		String ExpectedRm = fetchingRmAndScrapValues.get("April-Rm");
		String ExpectedScrap = fetchingRmAndScrapValues.get("April-Scrap");

		BigDecimal AprilRm = new BigDecimal(ExpectedRm);
		AprilRm = AprilRm.setScale(3, RoundingMode.HALF_UP);

		BigDecimal AprilScrap = new BigDecimal(ExpectedScrap);
		AprilScrap = AprilScrap.setScale(3, RoundingMode.HALF_UP);

		// 1. Latest file fetch
		File latestFile = Base.getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error("❌ No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			Sheet sheet = workbook.getSheetAt(1);

			String sheetname = workbook.getSheetAt(1).getSheetName();
			LoggerUtil.info("Latest Downloaded Excel File And Sheet Name Is = " + sheetname);

			Row row = sheet.getRow(3); // 4th row (0-based index = 3)

			// Commodity details from Excel
			String ActualAprilRm = row.getCell(10).toString().trim();
			String ActualAprilScrap = row.getCell(11).toString().trim();

			SecondSheetRmAndScrap.put("April Rm Second Sheet From Ui", ActualAprilRm);
			SecondSheetRmAndScrap.put("April Scrap Second Sheet Fronm Ui", ActualAprilScrap);

			BigDecimal ExcelRm = new BigDecimal(ActualAprilRm);
			BigDecimal ExcelScrap = new BigDecimal(ActualAprilScrap);

			ExcelUtil.logCompare("April-Rm", AprilRm, ExcelRm);
			ExcelUtil.logCompare("April-Scrap", AprilScrap, ExcelScrap);

		}

	}

	public static HashMap<String, String> fillCommodityGroupDeltaFile() throws InterruptedException {
		HashMap<String, String> FetchingRmAndScrapData = new HashMap<>();

		File latestFile = getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error(" No CommodityDetails Group Delta file found.");
			return FetchingRmAndScrapData;
		}

		String filePath = latestFile.getAbsolutePath();

		// Generate random values

		String AprilRm = faker.number().digits(5);

		String Aprilscrap = faker.number().digits(5);

		String period = "Apr";
		String year = "2026-2027";

		// Fill Excel with values
		ExcelFiller.setCellValue(filePath, 0, 4, 4, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(year));
		ExcelFiller.setCellValue(filePath, 0, 4, 5, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(period));
		ExcelFiller.setCellValue(filePath, 0, 4, 6, ExcelFiller.ValueType.INTEGER, Arrays.asList(AprilRm));
		ExcelFiller.setCellValue(filePath, 0, 4, 7, ExcelFiller.ValueType.INTEGER, Arrays.asList(Aprilscrap));

		// Store values in HashMap
		FetchingRmAndScrapData.put("April-Rm_FirstSheet", AprilRm);
		FetchingRmAndScrapData.put("April-scrap_FirstSheet", Aprilscrap);
		FetchingRmAndScrapData.put("Year For Group Delta ", year);
		LoggerUtil
				.info(" Filled Group Delta file with values → April RM: " + AprilRm + " | April Scrap: " + Aprilscrap);

		return FetchingRmAndScrapData;
	}

	public static HashMap<String, String> fillCommodityGroupDeltaFileForNegativeNumbers() throws InterruptedException {
		HashMap<String, String> FetchingRmAndScrapData = new HashMap<>();

		File latestFile = getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error(" No CommodityDetails Group Delta file found.");
			return FetchingRmAndScrapData;
		}

		String filePath = latestFile.getAbsolutePath();

		// Generate random values
		int randomRm = faker.number().numberBetween(1, 100);
		String AprilRm = String.valueOf(randomRm);

		int randomscrap = faker.number().numberBetween(1, 300);
		String Aprilscrap = String.valueOf(randomscrap);

		String period = "Apr";
		String year = "2026-2027";

		// Fill Excel with values
		ExcelFiller.setCellValue(filePath, 0, 4, 4, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(year));
		ExcelFiller.setCellValue(filePath, 0, 4, 5, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(period));
		ExcelFiller.setCellValue(filePath, 0, 4, 6, ExcelFiller.ValueType.INTEGER, Arrays.asList(AprilRm));
		ExcelFiller.setCellValue(filePath, 0, 4, 7, ExcelFiller.ValueType.INTEGER, Arrays.asList(Aprilscrap));

		// Store values in HashMap
		FetchingRmAndScrapData.put("April-Rm_FirstSheet", AprilRm);
		FetchingRmAndScrapData.put("April-scrap_FirstSheet", Aprilscrap);
		FetchingRmAndScrapData.put("Year For Group Delta ", year);
		LoggerUtil
				.info(" Filled Group Delta file with values → April RM: " + AprilRm + " | April Scrap: " + Aprilscrap);

		return FetchingRmAndScrapData;
	}

	public static HashMap<String, String> fillCommodityGroupDeltaFileForInValidMissingColumn()
			throws InterruptedException {
		HashMap<String, String> FetchingRmAndScrapData = new HashMap<>();

		File latestFile = getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error(" No CommodityDetails Group Delta file found.");
			return FetchingRmAndScrapData;
		}

		String filePath = latestFile.getAbsolutePath();

		// Generate random values
		int randomRm = faker.number().numberBetween(1, 100);
		String AprilRm = String.valueOf(randomRm);

		int randomscrap = faker.number().numberBetween(1, 300);
		String Aprilscrap = String.valueOf(randomscrap);

		String period = "Apr";
		String year = "2026-2027";

		// Fill Excel with values
		ExcelFiller.setCellValue(filePath, 0, 4, 6, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(year));
		ExcelFiller.setCellValue(filePath, 0, 4, 7, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(period));
		ExcelFiller.setCellValue(filePath, 0, 4, 8, ExcelFiller.ValueType.INTEGER, Arrays.asList(AprilRm));
		ExcelFiller.setCellValue(filePath, 0, 4, 9, ExcelFiller.ValueType.INTEGER, Arrays.asList(Aprilscrap));

		// Store values in HashMap
		FetchingRmAndScrapData.put("April-Rm_FirstSheet", AprilRm);
		FetchingRmAndScrapData.put("April-scrap_FirstSheet", Aprilscrap);
		FetchingRmAndScrapData.put("Year For Group Delta ", year);
		LoggerUtil
				.info(" Filled Group Delta file with values → April RM: " + AprilRm + " | April Scrap: " + Aprilscrap);

		return FetchingRmAndScrapData;
	}

	public static void VerifyReflectionOnSecondSheet(HashMap<String, String> FetchingRmAndScrapData,
			HashMap<String, String> fetchingRmAndScrapValues) throws FileNotFoundException, IOException {

		/////// User Eneterd Value In First Excel First Sheet ///////
		String EnterdValueOnFirstSheetRm = FetchingRmAndScrapData.get("April-Rm_FirstSheet");
		String EnterdValueOnFirstSheetScrap = FetchingRmAndScrapData.get("April-scrap_FirstSheet");

		BigDecimal EnetrdAprilRm = new BigDecimal(EnterdValueOnFirstSheetRm);
		EnetrdAprilRm = EnetrdAprilRm.setScale(3, RoundingMode.HALF_UP);

		BigDecimal EnterdAprilScrap = new BigDecimal(EnterdValueOnFirstSheetScrap);
		EnterdAprilScrap = EnterdAprilScrap.setScale(3, RoundingMode.HALF_UP);

///////////////////// Second Sheet Value From Ui April Rm And Scrap ///////////////////////////

		String SecondSheetExistAprilRm = fetchingRmAndScrapValues.get("April-Rm");
		String SecondSheetExistingAprilScrap = fetchingRmAndScrapValues.get("April-Scrap");

		BigDecimal AprilRmFromuiSecondSheet = new BigDecimal(SecondSheetExistAprilRm);
		AprilRmFromuiSecondSheet = AprilRmFromuiSecondSheet.setScale(3, RoundingMode.HALF_UP);

		BigDecimal AprilScrapFromuiSecondSheet = new BigDecimal(SecondSheetExistingAprilScrap);
		AprilScrapFromuiSecondSheet = AprilScrapFromuiSecondSheet.setScale(3, RoundingMode.HALF_UP);

		BigDecimal ExpectedAprilRmSecondSheetReflection = EnetrdAprilRm.add(AprilRmFromuiSecondSheet);

		BigDecimal ExpectedAprilScrapSecondsheetReflection = EnterdAprilScrap.add(AprilScrapFromuiSecondSheet);

		// 1. Latest file fetch
		File latestFile = Base.getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error(" No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			Sheet sheet = workbook.getSheetAt(1);

			String sheetname = workbook.getSheetAt(1).getSheetName();
			LoggerUtil.info("Latest Downloaded Excel File And Sheet Name Is = " + sheetname);

			Row row = sheet.getRow(3); // 4th row (0-based index = 3)

			DataFormatter formatter = new DataFormatter();
			FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();

			String ActualAprilRmFromExcel = formatter.formatCellValue(row.getCell(14), evaluator).trim();
			String ActualAprilScrapFromExcel = formatter.formatCellValue(row.getCell(15), evaluator).trim();

			// Convert safely into BigDecimal
			BigDecimal ActualAprilDelta = null;
			try {
				ActualAprilDelta = toBigDecimalSafe(ActualAprilRmFromExcel).setScale(3, RoundingMode.HALF_UP);
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			BigDecimal ActualScrapDelta = null;
			try {
				ActualScrapDelta = toBigDecimalSafe(ActualAprilScrapFromExcel).setScale(3, RoundingMode.HALF_UP);
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}

			// Compare with expected values
			ExcelUtil.logCompare("April RM Delta", ExpectedAprilRmSecondSheetReflection, ActualAprilDelta);
			ExcelUtil.logCompare("April Scrap Delta", ExpectedAprilScrapSecondsheetReflection, ActualScrapDelta);

		}

	}

	private static BigDecimal toBigDecimalSafe(String value) {
		try {
			if (value == null || value.trim().isEmpty() || value.equalsIgnoreCase("N/A") || value.equals("-")) {
				return BigDecimal.ZERO;
			}
			// Excel numbers sometimes come with commas or scientific notation
			value = value.replace(",", "").trim();

			return new BigDecimal(value);
		} catch (NumberFormatException e) {
			LoggerUtil.error("❌ Invalid number format from Excel: [" + value + "]");
			return BigDecimal.ZERO;
		}
	}

	public static void VerifyAllDataHasBeenSavedAccuratelyInUiOrNotForDirectPrice(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade, String EnetringSearchValue)
			throws InterruptedException {

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(9000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
				EnetringSearchValue);
		Thread.sleep(6000);

		List<WebElement> ValueCommodityDetailsrow = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

		for (WebElement row : ValueCommodityDetailsrow) {
			List<WebElement> colomns = row.findElements(By.tagName("td"));

			String actualCommodityGroupValue = colomns.get(2).getText().trim();
			String actualGroupClassificationvalue = colomns.get(3).getText().trim();
			String actualSpecificGradeValue = colomns.get(4).getText().trim();

			LoggerUtil.info("------ Verifying Row Data ------");
			LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
					+ actualCommodityGroupValue);
			LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
					+ actualGroupClassificationvalue);
			LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
					+ actualSpecificGradeValue);

			if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
					&& actualGroupClassificationvalue.equals(ExpectedGroupClassificationValue)
					&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

				LoggerUtil.pass(" All Values Matched for this row.");

				Thread.sleep(4000);
				clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
				Thread.sleep(2000);
				driver.navigate().refresh();
				Thread.sleep(9000);
				clickOnElement(CommodityDetailsPage.ClickingExportAndImportBtn);
				Thread.sleep(2000);

				clickOnElement(CommodityDetailsPage.clickingDirectCostRadioButtonForExportExcelFile);
				Thread.sleep(3000);
				clickOnElement(CommodityDetailsPage.clickingCommodityDropdownForExportImport);
				Thread.sleep(3000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueForCommodityGroupNameForExcelPriceUpdate),
						ExpectedCommodityGroupValue);
				Thread.sleep(3000);
				List<WebElement> CommodityGroupDropCheckoxlist = driver
						.findElements(FetchingCommodityGroupListCheckBoxForPriceUpdate);
				Thread.sleep(2000);
				WebElement CheckboxCommoditygroup = CommodityGroupDropCheckoxlist.get(0);
				Thread.sleep(2000);
				CheckboxCommoditygroup.click();
				clickOnElement(CommodityDetailsPage.clickingGroupClassificationDropdownForExportAndImport);
				Thread.sleep(2000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueClassificationForPriceUpdate),
						ExpectedGroupClassificationValue);
				Thread.sleep(3000);
				List<WebElement> listClassificationcheckbox = driver.findElements(FetchingGrpclssificationCheckboxList);
				Thread.sleep(3000);
				WebElement clickingCheckboxlist = listClassificationcheckbox.get(0);
				Thread.sleep(2000);
				clickingCheckboxlist.click();
				Thread.sleep(2000);
				clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
				Thread.sleep(15000);
				File filename = getLatestCommodityDetailsTabFileDirectCost();
				Thread.sleep(3000);
				LoggerUtil.info("The Latest File Has been Found With Actual Path = " + filename);

			} else {
				LoggerUtil.mismatch("❌ Mismatch Found -> " + "Commodity Group (Expected: " + ExpectedCommodityGroupValue
						+ ", Actual: " + actualCommodityGroupValue + "), " + "Group Classification (Expected: "
						+ ExpectedGroupClassificationValue + ", Actual: " + actualGroupClassificationvalue + "), "
						+ "Specific Grade (Expected: " + ExpectedSpecificGradeValue + ", Actual: "
						+ actualSpecificGradeValue + ")");
			}
		}
	}

	public static void ReadingValueInSecondSheetAndVerifyAllUiValueDownLoadAccuratelyoRNotInDirectPriceExcelFile(
			HashMap<String, String> fetchingRmAndScrapValues) throws FileNotFoundException, IOException {

		String ExpectedRm = fetchingRmAndScrapValues.get("April-Rm");
		String ExpectedScrap = fetchingRmAndScrapValues.get("April-Scrap");

		BigDecimal AprilRm = new BigDecimal(ExpectedRm).setScale(3, RoundingMode.HALF_UP);
		BigDecimal AprilScrap = new BigDecimal(ExpectedScrap).setScale(3, RoundingMode.HALF_UP);

		// 1. Latest file fetch
		File latestFile = Base.getLatestCommodityDetailsTabFileDirectCost();
		if (latestFile == null) {
			LoggerUtil.error("❌ No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			Sheet sheet = workbook.getSheetAt(1);
			String sheetname = sheet.getSheetName();
			LoggerUtil.info("Latest Downloaded Excel File And Sheet Name Is = " + sheetname);

			Row row = sheet.getRow(3); // 4th row (0-based index = 3)

			// ✅ Use DataFormatter + Evaluator
			DataFormatter formatter = new DataFormatter();
			FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();

			String ActualAprilRmStr = formatter.formatCellValue(row.getCell(10), evaluator).trim();
			String ActualAprilScrapStr = formatter.formatCellValue(row.getCell(11), evaluator).trim();

			// ✅ Safe conversion
			BigDecimal ExcelRm = toBigDecimalSafe(ActualAprilRmStr).setScale(3, RoundingMode.HALF_UP);
			BigDecimal ExcelScrap = toBigDecimalSafe(ActualAprilScrapStr).setScale(3, RoundingMode.HALF_UP);

			// ✅ Compare with report
			ExcelUtil.logCompare("April-Rm", AprilRm, ExcelRm);
			ExcelUtil.logCompare("April-Scrap", AprilScrap, ExcelScrap);
		}
	}

	public static HashMap<String, String> fillCommodityGroupDirectPriceExcelFile() throws InterruptedException {
		HashMap<String, String> FetchingRmAndScrapData = new HashMap<>();

		File latestFile = getLatestCommodityDetailsTabFileDirectCost();
		if (latestFile == null) {
			LoggerUtil.error(" No CommodityDetails Direct Cost file found.");
			return FetchingRmAndScrapData;
		}

		String filePath = latestFile.getAbsolutePath();

		// Generate random values
		int randomRm = faker.number().numberBetween(1, 100);
		String AprilRm = String.valueOf(randomRm);

		int randomscrap = faker.number().numberBetween(1, 300);
		String Aprilscrap = String.valueOf(randomscrap);

		String period = "Apr";
		String year = "2026-2027";

		// Fill Excel with values
		ExcelFiller.setCellValue(filePath, 0, 4, 7, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(year));
		ExcelFiller.setCellValue(filePath, 0, 4, 8, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(period));
		ExcelFiller.setCellValue(filePath, 0, 4, 9, ExcelFiller.ValueType.INTEGER, Arrays.asList(AprilRm));
		ExcelFiller.setCellValue(filePath, 0, 4, 10, ExcelFiller.ValueType.INTEGER, Arrays.asList(Aprilscrap));

		// Store values in HashMap
		FetchingRmAndScrapData.put("April-Rm_FirstSheet", AprilRm);
		FetchingRmAndScrapData.put("April-scrap_FirstSheet", Aprilscrap);

		LoggerUtil
				.info(" Filled Direct Price file with values → April RM: " + AprilRm + " | April Scrap: " + Aprilscrap);

		return FetchingRmAndScrapData;
	}

	public static void VerifyReflectionOnSecondSheetForDirectprice(HashMap<String, String> FetchingRmAndScrapData)
			throws FileNotFoundException, IOException {

		String ExpectedAprilRm = FetchingRmAndScrapData.get("April-Rm_FirstSheet");
		String ExpectedAprilScrap = FetchingRmAndScrapData.get("April-scrap_FirstSheet");

		BigDecimal AprilRmValueFirstSheet = new BigDecimal(ExpectedAprilRm);
		AprilRmValueFirstSheet = AprilRmValueFirstSheet.setScale(3, RoundingMode.HALF_UP);

		BigDecimal AprilScrapValueFirstSheet = new BigDecimal(ExpectedAprilScrap);
		AprilScrapValueFirstSheet = AprilScrapValueFirstSheet.setScale(3, RoundingMode.HALF_UP);

		// 1. Latest file fetch
		File latestFile = Base.getLatestCommodityDetailsTabFileDirectCost();
		if (latestFile == null) {
			LoggerUtil.error(" No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			Sheet sheet = workbook.getSheetAt(1);

			String sheetname = workbook.getSheetAt(1).getSheetName();
			LoggerUtil.info("Latest Downloaded Excel File And Sheet Name Is = " + sheetname);

			Row row = sheet.getRow(3); // 4th row (0-based index = 3)

			LoggerUtil.info("User Wants To Verify All Rm And Scrap Should  Reflects On " + sheetname
					+ " Sheet And Particular Column ");

			DataFormatter formatter = new DataFormatter();
			FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();

			String ActualAprilRmFromExcel = formatter.formatCellValue(row.getCell(14), evaluator).trim();
			String ActualAprilScrapFromExcel = formatter.formatCellValue(row.getCell(15), evaluator).trim();

			// Convert safely into BigDecimal
			BigDecimal ActualAprilDelta = null;
			try {
				ActualAprilDelta = toBigDecimalSafe(ActualAprilRmFromExcel).setScale(3, RoundingMode.HALF_UP);
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			BigDecimal ActualScrapDelta = null;
			try {
				ActualScrapDelta = toBigDecimalSafe(ActualAprilScrapFromExcel).setScale(3, RoundingMode.HALF_UP);
			} catch (Exception e) {

				e.printStackTrace();
			}

			ExcelUtil.logCompare("April RM Delta", AprilRmValueFirstSheet, ActualAprilDelta);
			ExcelUtil.logCompare("April Scrap Delta", AprilScrapValueFirstSheet, ActualScrapDelta);

		}

	}

	public static void VerifyAllDataHasBeenSavedAccuratelyInUiOrNotForNewGradeAddition(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade, String EnetringSearchValue)
			throws InterruptedException {

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(5000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
				EnetringSearchValue);
		Thread.sleep(6000);

		List<WebElement> ValueCommodityDetailsrow = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

		for (WebElement row : ValueCommodityDetailsrow) {
			List<WebElement> colomns = row.findElements(By.tagName("td"));

			String actualCommodityGroupValue = colomns.get(2).getText().trim();
			String actualGroupClassificationvalue = colomns.get(3).getText().trim();
			String actualSpecificGradeValue = colomns.get(4).getText().trim();

			LoggerUtil.info("------ Verifying Row Data ------");
			LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
					+ actualCommodityGroupValue);
			LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
					+ actualGroupClassificationvalue);
			LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
					+ actualSpecificGradeValue);

			if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
					&& actualGroupClassificationvalue.equals(ExpectedGroupClassificationValue)
					&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

				LoggerUtil.pass(" All Values Matched for this row.");

				Thread.sleep(4000);
				clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
				Thread.sleep(2000);
				driver.navigate().refresh();
				Thread.sleep(9000);
				clickOnElement(CommodityDetailsPage.ClickingExportAndImportBtn);
				Thread.sleep(2000);

				clickOnElement(CommodityDetailsPage.ClickingNewGradeAdditionRadioButton);
				Thread.sleep(3000);
				clickOnElement(CommodityDetailsPage.clickingCommodityDropdownForExportImport);
				Thread.sleep(3000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueForCommodityGroupNameForExcelPriceUpdate),
						ExpectedCommodityGroupValue);
				Thread.sleep(3000);
				List<WebElement> CommodityGroupDropCheckoxlist = driver
						.findElements(FetchingCommodityGroupListCheckBoxForPriceUpdate);
				Thread.sleep(2000);
				WebElement CheckboxCommoditygroup = CommodityGroupDropCheckoxlist.get(0);
				Thread.sleep(2000);
				CheckboxCommoditygroup.click();
				clickOnElement(CommodityDetailsPage.clickingGroupClassificationDropdownForExportAndImport);
				Thread.sleep(2000);
				clearAndEnterText(waitForExpectedElement(EnterSearchValueClassificationForPriceUpdate),
						ExpectedGroupClassificationValue);
				Thread.sleep(3000);
				List<WebElement> listClassificationcheckbox = driver.findElements(FetchingGrpclssificationCheckboxList);
				Thread.sleep(3000);
				WebElement clickingCheckboxlist = listClassificationcheckbox.get(0);
				Thread.sleep(2000);
				clickingCheckboxlist.click();
				Thread.sleep(2000);
				clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
				Thread.sleep(15000);
				File filename = getLatestCommodityDetailsTabFileDirectCost();
				Thread.sleep(3000);
				LoggerUtil.info("The Latest File Has been Found With Actual Path = " + filename);

			} else {
				LoggerUtil.mismatch("❌ Mismatch Found -> " + "Commodity Group (Expected: " + ExpectedCommodityGroupValue
						+ ", Actual: " + actualCommodityGroupValue + "), " + "Group Classification (Expected: "
						+ ExpectedGroupClassificationValue + ", Actual: " + actualGroupClassificationvalue + "), "
						+ "Specific Grade (Expected: " + ExpectedSpecificGradeValue + ", Actual: "
						+ actualSpecificGradeValue + ")");
			}
		}
	}

	///////////////////////////////// AutoOpenExcel And Save Automaticaly And Close
	///////////////////////////////// Again////////

	public static void importGroupDeltaFileAndCheckImpactOnUi() throws InterruptedException, IOException, AWTException {

		// Get the latest file path separately
		File latestFile = Base.getLatestCommodityDetailsTabFileGroupDelta();
		if (latestFile == null) {
			LoggerUtil.error(" No Group Delta file found for upload.");
			return;
		}

		String fullPath = latestFile.getAbsolutePath();
		Thread.sleep(3000);

		ExcelUtil.openSaveCloseExcelFile(fullPath);

		Thread.sleep(3000);
		clickOnElement(CommodityDetailsPage.clickingGroupDeltaRadioButtonForExportingExcelFile);
		Thread.sleep(3000);

		WebElement fileInput = driver.findElement(By.id("excelUpload"));
		((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

		LoggerUtil.info("Uploading file: " + fullPath);
		fileInput.sendKeys(fullPath);

		Thread.sleep(10000);

	}

	public static void VerifyExcelDataValueSavedInUiOrNot(HashMap<String, String> FetchComDetailsNameAndSpecificGrade,
			String EnetrCommodityGroupName) throws InterruptedException {

		Thread.sleep(2000);

		driver.navigate().refresh();
		Thread.sleep(9000);

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(9000);

		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
				EnetrCommodityGroupName);
		Thread.sleep(8000);

		// ⭐ SAFE: Stale-free list
		List<WebElement> ValueCommodityDetailsrow = safeFindElements(FetchingCommodityViewTableDataByRowIndexing);

		int rowIndex = 1;

		for (WebElement row : ValueCommodityDetailsrow) {

			// ⭐ SAFE: Stale row resolve
			row = refind(row, By.xpath("//table[@id='comodityDetailListTable']/tbody/tr[" + rowIndex + "]"));

			List<WebElement> colomns = row.findElements(By.tagName("td"));

			String actualCommodityGroupValue = colomns.get(2).getText().trim();
			String actualGroupClassificationvalue = colomns.get(3).getText().trim();
			String actualSpecificGradeValue = colomns.get(4).getText().trim();
			String AcutalYear = colomns.get(6).getText().trim();

			LoggerUtil.info("------ Verifying Row Data (" + rowIndex + ") ------");
			LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
					+ actualCommodityGroupValue);
			LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
					+ actualGroupClassificationvalue);
			LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
					+ actualSpecificGradeValue);
			LoggerUtil.info("Expected Year : " + AcutalYear);

			if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
					&& actualGroupClassificationvalue.equals(ExpectedGroupClassificationValue)
					&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

				LoggerUtil.pass(" ✔ All Values Matched for this row.");

				Thread.sleep(4000);

				// ⭐ SAFE click → No Intercepted error
				safeClick(waitForExpectedElement(CommodityDetailsPage.editbtncomdetails));

				break;
			}

			rowIndex++;
		}
	}

	private static List<WebElement> safeFindElements(By locator) {
		for (int i = 0; i < 3; i++) {
			try {
				return driver.findElements(locator);
			} catch (StaleElementReferenceException e) {
				LoggerUtil.warn("Retry safeFindElements due to STALE → " + locator);
			}
		}
		return driver.findElements(locator);
	}

	private static WebElement refind(WebElement element, By locator) {
		try {
			element.getText();
			return element;
		} catch (StaleElementReferenceException e) {
			return driver.findElement(locator);
		}
	}

	private static void safeClick(WebElement element) {
		try {
			element.click();
		} catch (Exception e) {
			((JavascriptExecutor) driver).executeScript("arguments[0].click();", element);
		}
	}

	public static final By FetchingAprilRmFromUiPage = By.xpath("//*[@id='apr']");
	public static final By fetchingAprilScrapFromUiPage = By.xpath("//*[@id='aprScrap']");

	public static void verifyRmPriceAndScrapPriceAreCorrectlyUploadedOrNotFromGroupDeltaExcelFile(
			HashMap<String, String> fetchingRmAndScrapValues, HashMap<String, String> FetchingRmAndScrapData)
			throws InterruptedException {

		LoggerUtil.info("========== Starting RM & Scrap Data Verification for April ==========");

		try {
			// 1. Fetch UI values
			String uiEnteredDataRm = fetchingRmAndScrapValues.get("April-Rm");
			String uiEnteredDataScrap = fetchingRmAndScrapValues.get("April-Scrap");

			LoggerUtil.info("Fetched from UI: April-Rm = " + uiEnteredDataRm + ", April-Scrap = " + uiEnteredDataScrap);

			// 2. Fetch Excel values
			String excelEnteredDataRm = FetchingRmAndScrapData.get("April-Rm_FirstSheet");
			String excelEnteredDataScrap = FetchingRmAndScrapData.get("April-scrap_FirstSheet");

			LoggerUtil.info("Fetched from Excel: April-Rm_FirstSheet = " + excelEnteredDataRm
					+ ", April-Scrap_FirstSheet = " + excelEnteredDataScrap);

			// 3. Parse and round all values
			BigDecimal uiEnteredRm = new BigDecimal(uiEnteredDataRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal uiEnteredScrap = new BigDecimal(uiEnteredDataScrap).setScale(3, RoundingMode.HALF_UP);
			BigDecimal excelEnteredRm = new BigDecimal(excelEnteredDataRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal excelEnteredScrap = new BigDecimal(excelEnteredDataScrap).setScale(3, RoundingMode.HALF_UP);

			LoggerUtil.info("Rounded values: UI-Rm = " + uiEnteredRm + ", UI-Scrap = " + uiEnteredScrap
					+ ", Excel-Rm = " + excelEnteredRm + ", Excel-Scrap = " + excelEnteredScrap);

			// 4. Calculate expected totals
			BigDecimal expectedRm = uiEnteredRm.add(excelEnteredRm);
			BigDecimal expectedScrap = uiEnteredScrap.add(excelEnteredScrap);

			LoggerUtil.info("Expected RM = UI + Excel = " + expectedRm);
			LoggerUtil.info("Expected Scrap = UI + Excel = " + expectedScrap);

			Thread.sleep(3000); // Reduced to 3s for efficiency

			// ================= RM VALIDATION ====================
			try {
				String rmFromUi = waitForExpectedElement(FetchingAprilRmFromUiPage).getAttribute("value").trim();
				LoggerUtil.info("Fetched actual RM from UI field: " + rmFromUi);

				BigDecimal actualRm = new BigDecimal(rmFromUi).setScale(3, RoundingMode.HALF_UP);
				LoggerUtil.info("Rounded Actual RM from UI: " + actualRm);

				if (expectedRm.compareTo(actualRm) == 0) {
					LoggerUtil.pass("✅ RM Data matched: Expected = " + expectedRm + ", Actual = " + actualRm);
				} else {
					LoggerUtil.mismatch("❌ RM Data mismatch: Expected = " + expectedRm + ", Actual = " + actualRm);
				}
			} catch (Exception e) {
				LoggerUtil.error("❌ Exception while validating RM data: " + e.getMessage());
			}

			// ================= SCRAP VALIDATION ====================
			try {
				String scrapFromUi = waitForExpectedElement(fetchingAprilScrapFromUiPage).getAttribute("value").trim();
				LoggerUtil.info("Fetched actual Scrap from UI field: " + scrapFromUi);

				BigDecimal actualScrap = new BigDecimal(scrapFromUi).setScale(3, RoundingMode.HALF_UP);
				LoggerUtil.info("Rounded Actual Scrap from UI: " + actualScrap);

				if (expectedScrap.compareTo(actualScrap) == 0) {
					LoggerUtil.pass("✅ Scrap Data matched: Expected = " + expectedScrap + ", Actual = " + actualScrap);
				} else {
					LoggerUtil.mismatch(
							"❌ Scrap Data mismatch: Expected = " + expectedScrap + ", Actual = " + actualScrap);
				}
			} catch (Exception e) {
				LoggerUtil.error("❌ Exception while validating Scrap data: " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.fail("❌ Critical Failure in RM & Scrap Verification: " + e.getMessage());
		}

		LoggerUtil.info("========== Completed RM & Scrap Data Verification for April ==========\n");
	}

	/////////////////////////// Import Direct Price ///////////////////

	public static void importDirectPriceExcelFileAndCheckImpactOnUi()
			throws InterruptedException, IOException, AWTException {

		// Get the latest file path separately
		File latestFile = Base.getLatestCommodityDetailsTabFileDirectCost();
		if (latestFile == null) {
			LoggerUtil.error(" No Direct Price file found for upload.");
			return;
		}

		String fullPath = latestFile.getAbsolutePath();
		Thread.sleep(3000);

		ExcelUtil.openSaveCloseExcelFile(fullPath);

		Thread.sleep(3000);
		clickOnElement(CommodityDetailsPage.clickingDirectCostRadioButtonForExportExcelFile);
		Thread.sleep(3000);

		WebElement fileInput = driver.findElement(By.id("excelUpload"));
		((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

		LoggerUtil.info("Uploading file: " + fullPath);
		fileInput.sendKeys(fullPath);

		Thread.sleep(10000);

	}

	//////////////////// User Wants To Verify All Value Should Match In Ui
	//////////////////// //////////////////////////////////////////

	public static void verifyRmPriceAndScrapPriceAreCorrectlyUploadedOrNotFromDirectPriceExcelFile(

			HashMap<String, String> FetchingRmAndScrapData) throws InterruptedException {

		LoggerUtil.info("========== Starting RM & Scrap Data Verification for April ==========");

		try {
			// 1. Fetch UI values

			// 2. Fetch Excel values
			String excelEnteredDataRm = FetchingRmAndScrapData.get("April-Rm_FirstSheet");
			String excelEnteredDataScrap = FetchingRmAndScrapData.get("April-scrap_FirstSheet");

			LoggerUtil.info("Fetched from Excel: April-Rm_FirstSheet = " + excelEnteredDataRm
					+ ", April-Scrap_FirstSheet = " + excelEnteredDataScrap);

			// 3. Parse and round all values

			BigDecimal excelEnteredRm = new BigDecimal(excelEnteredDataRm).setScale(3, RoundingMode.HALF_UP);
			BigDecimal excelEnteredScrap = new BigDecimal(excelEnteredDataScrap).setScale(3, RoundingMode.HALF_UP);

			LoggerUtil.info(", Excel-Rm = " + excelEnteredRm + ", Excel-Scrap = " + excelEnteredScrap);

			// 4. Calculate expected totals
			BigDecimal expectedRm = excelEnteredRm;
			BigDecimal expectedScrap = excelEnteredScrap;

			LoggerUtil.info("Expected RM  Excel = " + expectedRm);
			LoggerUtil.info("Expected Scrap Excel = " + expectedScrap);

			Thread.sleep(3000); // Reduced to 3s for efficiency

			// ================= RM VALIDATION ====================
			try {
				String rmFromUi = waitForExpectedElement(FetchingAprilRmFromUiPage).getAttribute("value").trim();
				LoggerUtil.info("Fetched actual RM from UI field: " + rmFromUi);

				BigDecimal actualRm = new BigDecimal(rmFromUi).setScale(3, RoundingMode.HALF_UP);
				LoggerUtil.info("Rounded Actual RM from UI: " + actualRm);

				if (expectedRm.compareTo(actualRm) == 0) {
					LoggerUtil.pass("✅ RM Data matched: Expected = " + expectedRm + ", Actual = " + actualRm);
				} else {
					LoggerUtil.mismatch("❌ RM Data mismatch: Expected = " + expectedRm + ", Actual = " + actualRm);
				}
			} catch (Exception e) {
				LoggerUtil.error("❌ Exception while validating RM data: " + e.getMessage());
			}

			// ================= SCRAP VALIDATION ====================
			try {
				String scrapFromUi = waitForExpectedElement(fetchingAprilScrapFromUiPage).getAttribute("value").trim();
				LoggerUtil.info("Fetched actual Scrap from UI field: " + scrapFromUi);

				BigDecimal actualScrap = new BigDecimal(scrapFromUi).setScale(3, RoundingMode.HALF_UP);
				LoggerUtil.info("Rounded Actual Scrap from UI: " + actualScrap);

				if (expectedScrap.compareTo(actualScrap) == 0) {
					LoggerUtil.pass("✅ Scrap Data matched: Expected = " + expectedScrap + ", Actual = " + actualScrap);
				} else {
					LoggerUtil.mismatch(
							"❌ Scrap Data mismatch: Expected = " + expectedScrap + ", Actual = " + actualScrap);
				}
			} catch (Exception e) {
				LoggerUtil.error("❌ Exception while validating Scrap data: " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.fail("❌ Critical Failure in RM & Scrap Verification: " + e.getMessage());
		}

		LoggerUtil.info("========== Completed RM & Scrap Data Verification for April ==========\n");
	}

	public static void SaveNewGradeAddition(String ExpectedToast) throws InterruptedException {

		clickOnElement(CommodityDetailsPage.businessSegbox);
		LoggerUtil.info("Clicked on Business Segment box");
		clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg),
				DataProp.getProperty("BusinessSegment"));
		LoggerUtil.info("Searched Business Segment with: " + DataProp.getProperty("BusinessSegment"));
		Thread.sleep(3000);

		clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
		LoggerUtil.pass("Selected all Business Segment checkboxes");
		Thread.sleep(9000);

		clickOnElement(CommodityDetailsPage.customercheckbox);
		LoggerUtil.pass("Clicked on Customer checkbox");
		Thread.sleep(5000);

		clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);
		Thread.sleep(3000);
		String actualToastSave = waitForExpectedElement(CommodityDetailsPage.toastmsg).getText();
		Thread.sleep(399);
		System.out.println(actualToastSave);
		Assert.assertTrue(actualToastSave.contains(ExpectedToast));

	}

	// Mk-2208-5-Mohali
	public static final By ClickingCustomerDropdownForExportingExcelFileNewGradeAddition = By
			.xpath("//select[@id='custcomm']/following-sibling::div/button");
	public static final By EnterAndSearchCustomerNameForCustomerDropdownValue = By.xpath(
			"//select[@id='custcomm']/following-sibling::div/div/div/input[@class='multiselect-search form-control']");
	public static final By ListClickingCheckboxCustomersForExportingNewGradeAddition = By
			.xpath("//select[@id='custcomm']/following-sibling::div/descendant::label/preceding-sibling::input");

	public static void VerifyAllDataHasBeenSavedAccuratelyInUiOrNotForNewGradeAddition(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade, String EnteringSearchValue,
			String EnteringCustomerName) throws InterruptedException {

		String ExpectedCommodityGroupValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGroupClassificationValue = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedSpecificGradeValue = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");

		try {
			clickOnElement(CommodityDetailsPage.ClickingViewbtn);
			Thread.sleep(5000);

			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
					EnteringSearchValue);
			Thread.sleep(6000);

			List<WebElement> ValueCommodityDetailsRow = driver
					.findElements(FetchingCommodityViewTableDataByRowIndexing);

			for (WebElement row : ValueCommodityDetailsRow) {
				List<WebElement> columns = row.findElements(By.tagName("td"));

				String actualCommodityGroupValue = columns.get(2).getText().trim();
				String actualGroupClassificationValue = columns.get(3).getText().trim();
				String actualSpecificGradeValue = columns.get(4).getText().trim();

				LoggerUtil.info("------ Verifying Row Data ------");
				LoggerUtil.info("Expected Commodity Group : " + ExpectedCommodityGroupValue + " | Actual : "
						+ actualCommodityGroupValue);
				LoggerUtil.info("Expected Group Classification : " + ExpectedGroupClassificationValue + " | Actual : "
						+ actualGroupClassificationValue);
				LoggerUtil.info("Expected Specific Grade : " + ExpectedSpecificGradeValue + " | Actual : "
						+ actualSpecificGradeValue);

				if (actualCommodityGroupValue.equals(ExpectedCommodityGroupValue)
						&& actualGroupClassificationValue.equals(ExpectedGroupClassificationValue)
						&& actualSpecificGradeValue.equals(ExpectedSpecificGradeValue)) {

					LoggerUtil.pass("✅ All Values Matched for this row.");

					Thread.sleep(4000);
					clickOnElement(CommodityDetailsPage.clickingCrossButtonCommodityDetailsTable);
					Thread.sleep(2000);
					driver.navigate().refresh();
					Thread.sleep(9000);

					clickOnElement(CommodityDetailsPage.ClickingExportAndImportBtn);
					Thread.sleep(2000);
					clickOnElement(CommodityDetailsPage.ClickingNewGradeAdditionRadioButtonForExportExcelFile);
					Thread.sleep(3000);

					clickOnElement(ClickingCustomerDropdownForExportingExcelFileNewGradeAddition);
					Thread.sleep(3000);
					clearAndEnterText(waitForExpectedElement(EnterAndSearchCustomerNameForCustomerDropdownValue),
							EnteringCustomerName);
					Thread.sleep(3000);

					List<WebElement> CheckboxListCustomer = driver
							.findElements(ListClickingCheckboxCustomersForExportingNewGradeAddition);
					Thread.sleep(2000);
					WebElement CheckboxCustomerName = CheckboxListCustomer.get(0);
					Thread.sleep(2000);
					CheckboxCustomerName.click();
					Thread.sleep(2000);

					clickOnElement(CommodityDetailsPage.clickingExportButtonForDownload);
					Thread.sleep(15000);

					File filename = getLatestCommodityDetailsTabFileNewGrade();
					Thread.sleep(3000);

					LoggerUtil.info("📂 The Latest File Has been Found With Actual Path = " + filename);

				} else {
					LoggerUtil.mismatch("❌ Mismatch Found -> " + "Commodity Group (Expected: "
							+ ExpectedCommodityGroupValue + ", Actual: " + actualCommodityGroupValue + "), "
							+ "Group Classification (Expected: " + ExpectedGroupClassificationValue + ", Actual: "
							+ actualGroupClassificationValue + "), " + "Specific Grade (Expected: "
							+ ExpectedSpecificGradeValue + ", Actual: " + actualSpecificGradeValue + ")");
				}
			}
		} catch (Exception e) {
			LoggerUtil
					.error("⚠️ Exception occurred in VerifyAllDataHasBeenSavedAccuratelyInUiOrNotForNewGradeAddition: "
							+ e.getMessage());
			throw e;
		}
	}

	public static void VerifyReadExcelDataForCustomerNameAsItIsFromUiOrNot(
			HashMap<String, String> fetchingRmAndScrapValues) throws FileNotFoundException, IOException {

		String ExpectedCustomerNameFromUi = fetchingRmAndScrapValues.get("CustomerName");

		// 1. Fetch the latest downloaded file
		File latestFile = Base.getLatestCommodityDetailsTabFileNewGrade();
		if (latestFile == null) {
			LoggerUtil.error(" No Excel file found in downloads folder.");
			return;
		}

		String fileName = latestFile.getName();
		String fileTime = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss").format(new Date(latestFile.lastModified()));

		LoggerUtil.info(" Latest downloaded Excel file: " + fileName + " (Saved at: " + fileTime + ")");

		try (FileInputStream fis = new FileInputStream(latestFile); Workbook workbook = new XSSFWorkbook(fis)) {

			// Reading first sheet
			Sheet sheet = workbook.getSheetAt(0);
			String sheetName = sheet.getSheetName();
			LoggerUtil.info(" Sheet Name: " + sheetName);

			// ⚠️ Row index is 0-based → Row 14 in Excel = getRow(13)
			Row row = sheet.getRow(13);

			if (row == null) {
				LoggerUtil.error(" Row 14 is empty in the Excel file.");
				return;
			}

			Cell cell = row.getCell(0); // Column A (Customer Name)
			if (cell == null) {
				LoggerUtil.error(" Cell A14 is empty in the Excel file.");
				return;
			}

			String ActualCustomerNameFromExcel = cell.toString().trim();

			// Comparison log
			ExcelUtil.logCompare("Verifying Customer Name From UI vs Excel", ExpectedCustomerNameFromUi,
					ActualCustomerNameFromExcel);

		} catch (Exception e) {
			LoggerUtil.error(" Exception while verifying Customer Name: " + e.getMessage());
			throw e;
		}
	}

	public static HashMap<String, String> FillingNewGradeAdditionForExcelFile(
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade) {

		HashMap<String, String> FetchingRmAndScrapData = new HashMap<>();

		String ComGrpValue = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String Grpclassification = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String specificGrade = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");
		String DensityValue = FetchComDetailsNameAndSpecificGrade.get("Density-From-Ui");

		File latestFile = getLatestCommodityDetailsTabFileNewGrade();
		if (latestFile == null) {
			LoggerUtil.error(" No CommodityDetails New Grade file found.");
			return FetchingRmAndScrapData;
		}

		String filePath = latestFile.getAbsolutePath();

		String Shape = "Plate";
		String period = "Jun";
		String year = "2026-2027";
		String uom = "Kg";

		String juneRm = faker.number().digits(3);
		String juneScrap = faker.number().digits(3);

		// Fill Excel with values
		ExcelFiller.setCellValue(filePath, 0, 2, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(ComGrpValue));// Commodity
																												// Group
		ExcelFiller.setCellValue(filePath, 0, 3, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(Grpclassification)); // Group
																														// classification
		ExcelFiller.setCellValue(filePath, 0, 4, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(specificGrade));// Specific
																													// grade
		ExcelFiller.setCellValue(filePath, 0, 5, 1, ExcelFiller.ValueType.STRING, Arrays.asList(DensityValue));// density
		ExcelFiller.setCellValue(filePath, 0, 6, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(Shape)); // Shape
		ExcelFiller.setCellValue(filePath, 0, 7, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(year));// Year
		ExcelFiller.setCellValue(filePath, 0, 8, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(period));// period
		ExcelFiller.setCellValue(filePath, 0, 10, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(uom));// uom After
																											// one
																											// column
																											// For
																											// period
		ExcelFiller.setCellValue(filePath, 0, 12, 5, ExcelFiller.ValueType.STRING, Arrays.asList(juneRm));// Base Price
		ExcelFiller.setCellValue(filePath, 0, 12, 6, ExcelFiller.ValueType.STRING, Arrays.asList(juneScrap));// Base
																												// Price
																												// Scrap

		// Store values in HashMap
		FetchingRmAndScrapData.put("june-Rm_FirstSheet", juneRm);
		FetchingRmAndScrapData.put("june-scrap_FirstSheet", juneScrap);
		FetchingRmAndScrapData.put("Excel-Shape", Shape);
		FetchingRmAndScrapData.put("Excel-Year", year);
		FetchingRmAndScrapData.put("Excel-Period", period);
		FetchingRmAndScrapData.put("Excel-Uom", uom);

		LoggerUtil.info(" Filled Direct Price file with values → April RM: " + juneRm + " | April Scrap: " + juneScrap);

		return FetchingRmAndScrapData;

	}

	public static void importNewGradeAdditionExcelFileAndCheckImpactOnUi()
			throws InterruptedException, IOException, AWTException {

		// Get the latest file path separately
		File latestFile = Base.getLatestCommodityDetailsTabFileNewGrade();
		if (latestFile == null) {
			LoggerUtil.error(" No Grade Addition  file found for upload.");
			return;
		}

		String fullPath = latestFile.getAbsolutePath();
		Thread.sleep(3000);

		ExcelUtil.openSaveCloseExcelFile(fullPath);

		Thread.sleep(3000);
		clickOnElement(CommodityDetailsPage.ClickingNewGradeAdditionRadioButtonForExportExcelFile);
		Thread.sleep(3000);

		WebElement fileInput = driver.findElement(By.id("excelUpload"));
		((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

		LoggerUtil.info("Uploading file: " + fullPath);
		fileInput.sendKeys(fullPath);

		Thread.sleep(10000);

	}

	public static final By GettingValueFromUiComGroupDrop = By.xpath(
			"//select[@id='commodityDrop']/following-sibling::span/descendant::span[@id='select2-commodityDrop-container']");
	public static final By GettingClassificationValueFromUiDrop = By.xpath(
			"//select[@id='materialDrop']/following-sibling::span/descendant::span[@id='select2-materialDrop-container']");
	public static final By GettingSpecificGradeValueFromuiDrop = By.xpath(
			"//select[@id='SpecificGrade']/following-sibling::span/descendant::span[@id='select2-SpecificGrade-container']");
	public static final By GettingUomDropdownValueFromUiDrop = By
			.xpath("//select[@id='uomDrop']/following-sibling::span/descendant::span[@id='select2-uomDrop-container']");
	public static final By GettingShapeDropdownFromUiDrop = By.xpath(
			"//select[@id='shapeDrop']/following-sibling::span/descendant::span[@id='select2-shapeDrop-container']");
	public static final By GettingYearDrodownValueFromUiDrop = By
			.xpath("//select[@id='Year']/following-sibling::span/descendant::span[@id='select2-Year-container']");
	public static final By GettingRmjuneValues = By.xpath("//input[@id='jun']");
	public static final By GettingScrapjuneValues = By.xpath("//input[@id='junScrap']");

	public static void VerifyValidateAllDataFromNewGradeExcelFileHasBeenImportedCorrectlyOrNot(
			HashMap<String, String> FetchingRmAndScrapData,
			HashMap<String, String> FetchComDetailsNameAndSpecificGrade) {

		// --- Actual values from UI ---
		String ActualComGrpFromUi = waitForExpectedElement(GettingValueFromUiComGroupDrop).getAttribute("title");
		String ActualGrpClass = waitForExpectedElement(GettingClassificationValueFromUiDrop).getAttribute("title");
		String ActualSpecificGrade = waitForExpectedElement(GettingSpecificGradeValueFromuiDrop).getAttribute("title");
		String ActualUomDropdown = waitForExpectedElement(GettingUomDropdownValueFromUiDrop).getAttribute("title");
		String ActualShapeDropdown = waitForExpectedElement(GettingShapeDropdownFromUiDrop).getAttribute("title");
		String ActualyearDropdown = waitForExpectedElement(GettingYearDrodownValueFromUiDrop).getAttribute("title");
		String ActualRmjune = waitForExpectedElement(GettingRmjuneValues).getAttribute("value");
		String ActualScrapjune = waitForExpectedElement(GettingScrapjuneValues).getAttribute("value");

		// --- Expected values from Excel ---
		String ExpectedComGrpValueFromExcel = FetchComDetailsNameAndSpecificGrade.get("Commodity GroupValue-Ui");
		String ExpectedGrpclassificationFromExcel = FetchComDetailsNameAndSpecificGrade.get("Group Classification-Ui");
		String ExpectedspecificGradeFromExcel = FetchComDetailsNameAndSpecificGrade.get("Specific Grade-Ui");
		String ExpectedDensityValueFromExcel = FetchComDetailsNameAndSpecificGrade.get("Density-From-Ui");
		String ExpecteduomfromExcel = FetchingRmAndScrapData.get("Excel-Uom");
		String ExpectedshapefromExcel = FetchingRmAndScrapData.get("Excel-Shape");
		String ExpectedyearFromExcel = FetchingRmAndScrapData.get("Excel-Year");
		String ExpectedjuneRmprice = FetchingRmAndScrapData.get("june-Rm_FirstSheet");
		String ExpectedjuneScrapprice = FetchingRmAndScrapData.get("june-scrap_FirstSheet");

		// --- Compare without stopping execution ---
		ExcelUtil.logCompare("Commodity Group", ActualComGrpFromUi, ExpectedComGrpValueFromExcel);
		ExcelUtil.logCompare("Group Classification", ActualGrpClass, ExpectedGrpclassificationFromExcel);
		ExcelUtil.logCompare("Specific Grade", ActualSpecificGrade, ExpectedspecificGradeFromExcel);
		ExcelUtil.logCompare("UOM", ActualUomDropdown, ExpecteduomfromExcel);
		ExcelUtil.logCompare("Shape", ActualShapeDropdown, ExpectedshapefromExcel);
		ExcelUtil.logCompare("Year", ActualyearDropdown, ExpectedyearFromExcel);
		ExcelUtil.logCompare("RM April", ActualRmjune, ExpectedjuneRmprice);
		ExcelUtil.logCompare("Scrap April", ActualScrapjune, ExpectedjuneScrapprice);

		LoggerUtil.info(" All Excel vs UI comparisons executed. Check report for mismatches.");
	}

	public static final By ClickingDomesticRadionBtn = By.xpath("//input[@id='domesticR']");
	public static final By ListColoumNameHeader = By
			.xpath("//table[@id='comodityDetailListTable']/thead/tr/th[contains(text,'')]");
	public static final By ListColoumNameParticularHeader = By
			.xpath("//table[@id='comodityDetailListTable']/tbody/tr/td[3]");
	public static final By ClickingImportedRadioBtn = By.xpath("//input[@id='importedR']");
	public static final By clickingYearlyRadioBtn = By.xpath("//input[@id='yearlyR']");

	public static void verifyRadioButtonsIsDependOnYearlyDomesticAndImported(String nameHeader,
			String expectedColomName) throws InterruptedException {

		Thread.sleep(2000);
		clickOnElement(CommodityDetailsPage.ClickingViewbtn);
		Thread.sleep(3000);

		// Get all headers
		List<WebElement> headers = driver.findElements(ListColoumNameHeader);

		for (int i = 0; i < headers.size(); i++) {
			String headerText = headers.get(i).getText().trim();

			if (headerText.equalsIgnoreCase(nameHeader)) {
				// Get all rows
				List<WebElement> rows = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

				for (WebElement row : rows) {
					List<WebElement> cols = row.findElements(By.tagName("td"));
					String actualValue = cols.get(i).getText().trim();

					if (actualValue.equals(expectedColomName)) {
						LoggerUtil.pass(" Match found under header '" + nameHeader + "' → " + actualValue);
					} else {
						LoggerUtil.mismatch(" Mismatch under header '" + nameHeader + "' → Expected: "
								+ expectedColomName + " | Actual: " + actualValue);
					}
				}
			}
		}
	}
	public static void verifyYearColumnForYearlyToggle(String headerName) throws InterruptedException {

	    clickOnElement(CommodityDetailsPage.ClickingViewbtn);
	    Thread.sleep(7000);
	    List<WebElement> headers = driver.findElements(ListColoumNameHeader);
	    int yearColumnIndex = -1;

	    // Step 1: Find Year column index
	    for (int i = 0; i < headers.size(); i++) {
	        if (headers.get(i).getText().trim().equalsIgnoreCase(headerName)) {
	            yearColumnIndex = i;
	            break;
	        }
	    }

	    if (yearColumnIndex == -1) {
	        LoggerUtil.fail("Year column not found in table");
	        return;
	    }

	    LoggerUtil.pass("Year column found at index: " + yearColumnIndex);

	    // Step 2: Validate Year values
	    List<WebElement> rows = driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

	    for (WebElement row : rows) {

	        List<WebElement> cols = row.findElements(By.tagName("td"));
	        String actualYear = cols.get(yearColumnIndex).getText().trim();

	        // Empty check
	        if (actualYear.isEmpty()) {
	            LoggerUtil.mismatch("Year value is EMPTY under Year column");
	            continue;
	        }

	        // Format check: YYYY-YYYY
	        if (!actualYear.matches("\\d{4}-\\d{4}")) {
	            LoggerUtil.mismatch("Invalid Year format → " + actualYear);
	            continue;
	        }

	        LoggerUtil.pass("Valid Year value found → " + actualYear);
	    }
	}

	public void VerifySearchInputForCommodityDetailsTab(String enterSearchValue) {

	    try {
	        clickOnElement(CommodityDetailsPage.ClickingViewbtn);
	        LoggerUtil.info("Clicked on View button in Commodity Details tab.");

	        waitForUIBlockersToDisappear();

	        Base.clearAndEnterText(
	                Base.waitForExpectedElement(
	                        CommodityDetailsPage.enterSearchValueCommodityDetailsTab),
	                enterSearchValue);

	        LoggerUtil.info("Entered search value: " + enterSearchValue);

	        Thread.sleep(3000);

	        List<WebElement> rows =
	                Base.driver.findElements(FetchingCommodityViewTableDataByRowIndexing);

	        // CASE 1: No rows displayed → VALID for special characters
	        if (rows.isEmpty()) {
	            LoggerUtil.pass("No rows displayed for search value: '" + enterSearchValue
	                    + "' (Expected behavior)");
	            return;
	        }

	        boolean matchFound = false;

	        for (WebElement row : rows) {
	            List<WebElement> columns = row.findElements(By.tagName("td"));

	            if (columns.size() < 5) {
	                continue;
	            }

	            String commodityGroup = columns.get(2).getText().trim();
	            String classification = columns.get(3).getText().trim();
	            String specificGrade  = columns.get(4).getText().trim();

	            LoggerUtil.info("Row Data → Group: " + commodityGroup
	                    + ", Classification: " + classification
	                    + ", Specific Grade: " + specificGrade);

	            if (commodityGroup.equalsIgnoreCase(enterSearchValue)
	                    || classification.equalsIgnoreCase(enterSearchValue)
	                    || specificGrade.equalsIgnoreCase(enterSearchValue)) {

	                matchFound = true;
	            }
	        }

	        if (matchFound) {
	            LoggerUtil.pass("Table filtered correctly for search value: " + enterSearchValue);
	        } else {
	            LoggerUtil.pass("No exact match found for search value: '" + enterSearchValue
	                    + "' (Expected behavior)");
	        }

	    } catch (Exception e) {
	        LoggerUtil.error("Error occurred in VerifySearchInputForCommodityDetailsTab → "
	                + e.getMessage());
	    }
	}

	public static final By ClickingBopTypeDropdownBop = By.xpath(
			"//select[@id='BopEntry_BopType']/following-sibling::span/descendant::span[@id='select2-BopEntry_BopType-container']");
	public static final By listvalueofBopDropdownBop = By.xpath("//ul[@id='select2-BopEntry_BopType-results']/li");
	public static final By EnterSearchValueBopTypeBop = By.xpath("//input[@class='select2-search__field']");
	public static final By ClickingRadioBtnYearlyBop = By
			.xpath("//div[@class='col-sm-6 pe-0 flex_end']/div/label/input");
	public static final By EnteringPartDescriptionValueBop = By.xpath("//input[@id='BopEntry_ChildPartDescInHouse']");
	public static final By EnetrPartNumberValueBop = By.xpath("//input[@id='BopEntry_PartNoInHouse']");
	public static final By ClickingUomDropBop = By.xpath("//span[@id='select2-BopEntry_UomInHouse-container']");
	public static final By ClickingSupplierDropdownBop = By
			.xpath("//span[@id='select2-BopEntry_SupplierInhouse-container']");
	public static final By ListValueUomBop = By.xpath("//ul[@id='select2-BopEntry_UomInHouse-results']/li");
	public static final By EnteringSuppliernameInSearchBoxBop = By.xpath("//input[@class='select2-search__field']");
	public static final By SuppnameListBop = By.xpath("//ul[@id='select2-BopEntry_SupplierInhouse-results']/li");
	public static final By ClickingCommodityGroupDropdownBop = By
			.xpath("//span[@id='select2-BopEntry_CommodityGroupInhouse-container']");
	public static final By EnteringCommodityGrpValueBop = By.xpath("//input[@class='select2-search__field']");
	public static final By SelectingCommgrpvalueindropdownBop = By
			.xpath("//ul[@id='select2-BopEntry_CommodityGroupInhouse-results']/li");
	public static final By clickingClassificationDropdownBOp = By
			.xpath("//span[@id='select2-BopEntry_TypeofMaterialInhouse-container']");
	public static final By EnterSearchValuegrpclassficationBop = By.xpath("//input[@class='select2-search__field']");
	public static final By classificaitonvaluesbop = By
			.xpath("//ul[@id='select2-BopEntry_TypeofMaterialInhouse-results']/li");
	public static final By clickingYearDropdownBop = By.xpath("//span[@id='select2-BopEntry_year-container']");
	public static final By EnterYearValueBop = By.xpath("//input[@class='select2-search__field']");
	public static final By EnterlistvalueyearBop = By.xpath("//ul[@id='select2-BopEntry_year-results']/li");
	public static final By clickingDropdowyearNAmeAndQuaterlyBop = By.xpath("//select[@id='BopEntry_period']");
	public static final By selectdropdownyearBop = By.xpath("//select[@id='BopEntry_period']");
	public static final By clickingspecificgrafedropdownBop = By
			.xpath("//span[@id='select2-BopEntry_RmGrade-container']");
	public static final By EntersearchvaluespecificgradeBop = By.xpath("//input[@class='select2-search__field']");
	public static final By listvalueSpecificgradeBop = By.xpath("//ul[@id='select2-BopEntry_RmGrade-results']/li");
	public static final By clickingSaveBtnBop = By.xpath("//button[@id='SaveBOPEntry']");
	public static final By toastmsgforBop = By.xpath("//div[@id='toast-container']/div/div[2]");
	public static final By EnterSearchBoxForBopInhouse = By.xpath("//div[@id='table1_filter']/label/input");
	public static final By FetchingDataFromRowsBopTable = By.xpath("//table[@id='table1']/tbody/tr");
	public static final By FetchingRmValueFromRmCellBox = By.xpath("//input[@id='BopEntry_RmRateInHouse']");
	public static final By FetchBopcategoryDropdownValue = By
			.xpath("//span[@id='select2-BopEntry_BopEntryType-container']");
	public static final By clickingYearDrodpown = By.xpath("//span[@id='select2-BopEntry_year-container']");
	public static final By SelectingYearDropdown = By.xpath("//ul[@id='select2-BopEntry_year-results']/li");

	public void VerifySaveBopDataForInhouse(String EnterBopName, String EnterPartDescValue, String EnterPartnumValue,
			String Enteruomname, String Enteringyear, String Enteringperiod, String EnterSuppname)
			throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));

		try {
			driver.navigate().refresh();
			LoggerUtil.info("Starting BOP Inhouse Save Verification...");

			Thread.sleep(15000);
			// ---- BOP Type ----
			WebElement dropdown = driver.findElement(ClickingBopTypeDropdownBop);

			Actions action = new Actions(driver);

			action.moveToElement(dropdown).click().perform();
			;

			LoggerUtil.info("Clicked on BOP Type dropdown using Actions");

			clearAndEnterText(waitForExpectedElement(EnterSearchValueBopTypeBop), EnterBopName);
			LoggerUtil.info("Entered BOP Name in search: " + EnterBopName);

			for (WebElement bopDropdown : driver.findElements(listvalueofBopDropdownBop)) {
				String valueText = bopDropdown.getText().trim();
				if (valueText.equalsIgnoreCase(EnterBopName)) {
					bopDropdown.click();
					LoggerUtil.pass("Selected BOP Type: " + valueText);
					break;
				}
			}

			clearAndEnterText(waitForExpectedElement(EnteringPartDescriptionValueBop), EnterPartDescValue);
			LoggerUtil.info("Entered Part Description: " + EnterPartDescValue);

			clearAndEnterText(waitForExpectedElement(EnetrPartNumberValueBop), EnterPartnumValue);
			LoggerUtil.info("Entered Part Number: " + EnterPartnumValue);

			// ---- UOM ----
			clickOnElement(ClickingUomDropBop);
			for (WebElement uom : driver.findElements(ListValueUomBop)) {
				if (uom.getText().trim().equals(Enteruomname)) {
					uom.click();
					LoggerUtil.info("Selected UOM: " + Enteruomname);
					break;
				}
			}

			// ---- Year ----
			clickOnElement(ClickingRadioBtnYearlyBop);
			clickOnElement(clickingYearDrodpown);
			selectBootStrapDropDown(driver.findElements(SelectingYearDropdown), Enteringyear);

			// ---- Period ----
			clickOnElement(clickingDropdowyearNAmeAndQuaterlyBop);
			Thread.sleep(3000);
			selectDropDownValue(selectdropdownyearBop, Enteringperiod, "visibleText");

			Thread.sleep(5000);
			// wait.until(ExpectedConditions.visibilityOfElementLocated(ClickingSupplierDropdownBop));
			// ---- Supplier ----
			clickOnElement(ClickingSupplierDropdownBop);
			clearAndEnterText(waitForExpectedElement(EnteringSuppliernameInSearchBoxBop), EnterSuppname);
			for (WebElement supp : driver.findElements(SuppnameListBop)) {
				if (supp.getText().trim().equals(EnterSuppname)) {
					supp.click();
					LoggerUtil.info("Selected Supplier: " + EnterSuppname);
					break;
				}
			}

			// ---- Commodity Group ----
			clickOnElement(ClickingCommodityGroupDropdownBop);
			LoggerUtil.info("Clicked Commodity Group dropdown");

			String expectedValue =
			        DataProp.getProperty("CommodityGroupDropdownValueBopMaster").trim();

			clearAndEnterText(
			        waitForExpectedElement(EnteringCommodityGrpValueBop),
			        expectedValue);

			LoggerUtil.info("Entered Commodity Group value: " + expectedValue);

			Thread.sleep(2000); // wait for dropdown suggestions

			boolean valueSelected = false;

			List<WebElement> options =
			        driver.findElements(SelectingCommgrpvalueindropdownBop);

			for (WebElement option : options) {

			    String actualText = option.getText().trim();

			    LoggerUtil.info("Dropdown option found: " + actualText);

			    if (actualText.equalsIgnoreCase(expectedValue)) {
			        option.click();
			        LoggerUtil.pass("Selected Commodity Group: " + actualText);
			        valueSelected = true;
			        break;
			    }
			}

			if (!valueSelected) {
			    LoggerUtil.fail(
			            "Commodity Group NOT selected. Expected: '" + expectedValue
			            + "' | Available options: " + options.size());
			}

			// ---- Classification ----
			clickOnElement(clickingClassificationDropdownBOp);
			clearAndEnterText(waitForExpectedElement(EnterSearchValuegrpclassficationBop),
					DataProp.getProperty("GroupClassificationBopData"));
			for (WebElement cls : driver.findElements(classificaitonvaluesbop)) {
				if (cls.getText().trim().equals(DataProp.getProperty("GroupClassificationBopData"))) {
					cls.click();
					LoggerUtil.info("Selected Classification: " + DataProp.getProperty("GroupClassificationBopData"));
					break;
				}
			}

			// ---- Specific Grade ----
			clickOnElement(clickingspecificgrafedropdownBop);
			clearAndEnterText(waitForExpectedElement(EntersearchvaluespecificgradeBop),
					DataProp.getProperty("SpecificGradeBopData"));
			for (WebElement grade : driver.findElements(listvalueSpecificgradeBop)) {
				if (grade.getText().trim().contains(DataProp.getProperty("SpecificGradeBopData"))) {
					grade.click();
					LoggerUtil.info("Selected Specific Grade: " + DataProp.getProperty("SpecificGradeBopData"));
					break;
				}
			}

			// ---- Capture Values ----
			String BopCategoryDropdown = waitForExpectedElement(FetchBopcategoryDropdownValue).getText();
			String ExpectedRmType = waitForExpectedElement(FetchingRmValueFromRmCellBox).getAttribute("value");

			// ---- Save ----
			clickOnElement(clickingSaveBtnBop);
			List<WebElement> toastList = driver.findElements(toastmsgforBop);
			if (!toastList.isEmpty()) {
				LoggerUtil.pass("Toast message displayed: " + toastList.get(0).getText().trim());
			} else {
				LoggerUtil.fail("Toast message not found after Save action");
			}

			Thread.sleep(5000);
			// ---- Verify in Table ----
			// wait.until(ExpectedConditions.visibilityOfElementLocated(EnterSearchBoxForBopInhouse));
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxForBopInhouse), EnterBopName);

			LoggerUtil.info("User Wants To Verify All Values Save In Table AS it Is Or Not");

			Thread.sleep(9000);
			// wait.until(ExpectedConditions.visibilityOfElementLocated(FetchingDataFromRowsBopTable));
			for (WebElement row : driver.findElements(FetchingDataFromRowsBopTable)) {
				List<WebElement> coloms = row.findElements(By.tagName("td"));

				String ActualBopTypename = coloms.get(0).getText().trim();
				String ActualPartDesc = coloms.get(1).getText().trim();
				
				String ActualPartNumber = coloms.get(3).getText().trim();
				String ActualBopCategory = coloms.get(6).getText().trim();
				String ActualSuppliername = coloms.get(7).getText().trim();

				validateValue("BOP Name", EnterBopName, ActualBopTypename);
				validateValue("Part Description", EnterPartDescValue, ActualPartDesc);
			
				validateValue("Part Number", EnterPartnumValue, ActualPartNumber);
				validateValue("BOP Category", BopCategoryDropdown, ActualBopCategory);
				validateValue("Supplier Name", EnterSuppname, ActualSuppliername);
			}

			LoggerUtil.pass("✅ BOP Inhouse data saved and verified successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while saving/verifying BOP Inhouse data: " + e.getMessage());
			throw e;
		}
	}

	/** 🔧 Helper method for validations */
	public void validateValue(String field, String expected, String actual) {
		if (expected.equals(actual)) {
			LoggerUtil.pass(field + " matched. Expected = " + expected + ", Actual = " + actual);
		} else {
			LoggerUtil.fail(field + " mismatch ❌. Expected = " + expected + ", Actual = " + actual);
		}
	}

	public static final By EnterPartDescriptionValue = By.xpath("//*[@id='BopEntry_PartDescriptionImported']");
	public static final By clickingBopCategoryDropdown = By
			.xpath("//span[@id='select2-BopEntry_BopEntryType-container']");
	public static final By CategoriesDropdownValues = By.xpath("//ul[@id='select2-BopEntry_BopEntryType-results']/li");
	public static final By EnterSearchValuesBopcategories = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");
	public static final By EnteringPartNumberValue = By.xpath("//input[@id='BopEntry_partnoimported']");
	public static final By clickingSuppdropdownBop = By.xpath("//span[@id='select2-BopEntry_Supplier-container']");
	public static final By ListValueSupplierBop = By.xpath("//*[@id='select2-BopEntry_Supplier-results']/li");
	public static final By ClickSaveButtonForBop = By.xpath("//button[@id='SaveBOPEntry']");
	public static final By EnteringSearchValueForBopImported = By.xpath("//div[@id='table1_filter']/descendant::input");
	public static final By FetchTableDataRows = By.xpath("//table[@id='table1']/descendant::tbody/tr[1]/td");
	public static final By ClickingUpdateButton = By.xpath("//button[@name='UpdateBOPEntry']");

	public void VerifySaveAndUpdateImported(String EnterBopName, String BopcategoriesDropdownName,
			String EneteringPartDescription, String Eneterpartnumber, String EnterNewBopName)
			throws InterruptedException {

		driver.navigate().refresh();
		LoggerUtil.info("=== Starting BOP Imported Save & Update Verification ===");

		Thread.sleep(15000);

		Actions action = new Actions(driver);

// ---- BOP Type (Save Flow) ----
		WebElement dropdown = driver.findElement(ClickingBopTypeDropdownBop);
		action.moveToElement(dropdown).click().perform();
		LoggerUtil.info("Clicked on BOP Type dropdown using Actions");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(EnterSearchValueBopTypeBop));
		clearAndEnterText(waitForExpectedElement(EnterSearchValueBopTypeBop), EnterBopName);
		LoggerUtil.info("Entered BOP Name in search: " + EnterBopName);

		for (WebElement bopDropdown : driver.findElements(listvalueofBopDropdownBop)) {
			String valueText = bopDropdown.getText().trim();
			if (valueText.equalsIgnoreCase(EnterBopName)) {
				bopDropdown.click();
				LoggerUtil.pass("Selected BOP Type: " + valueText);
				break;
			}
		}

// ---- BOP Category ----
		WebElement Bopcategroydrop = driver.findElement(clickingBopCategoryDropdown);
		action.moveToElement(Bopcategroydrop).click().perform();
		clearAndEnterText(waitForExpectedElement(EnterSearchValuesBopcategories), BopcategoriesDropdownName);

		for (WebElement Categoriesname : driver.findElements(CategoriesDropdownValues)) {
			String actualcatefirname = Categoriesname.getText().trim();
			if (actualcatefirname.equals(BopcategoriesDropdownName)) {
				action.moveToElement(Categoriesname).click().perform();
				LoggerUtil.pass("Selected BOP Category: " + actualcatefirname);
				break;
			}
		}

// ---- Description & Part Number ----
		clearAndEnterText(waitForExpectedElement(EnterPartDescriptionValue), EneteringPartDescription);
		clearAndEnterText(waitForExpectedElement(EnteringPartNumberValue), Eneterpartnumber);

		Thread.sleep(2000);
		clickOnElement(clickingSuppdropdownBop);
		Thread.sleep(2000);

		List<WebElement> SupplistValue = driver.findElements(ListValueSupplierBop);
		action.moveToElement(SupplistValue.get(0)).click().perform();

		Thread.sleep(2000);
		clickOnElement(ClickSaveButtonForBop);
		LoggerUtil.info("Clicked Save button");

		Thread.sleep(7000);
    scrollToElement(waitForExpectedElement(EnteringSearchValueForBopImported));
    Thread.sleep(3000);
// ✅ Search after Save
		WebElement searchBox = waitForExpectedElement(EnteringSearchValueForBopImported);
		searchBox.clear();
		searchBox.sendKeys(EnterBopName);
		searchBox.sendKeys(Keys.ENTER);
		LoggerUtil.info("Searched for BOP Name after Save: " + EnterBopName);

// ✅ Wait until row with BOP Name appears
		WebDriverWait waitRows = new WebDriverWait(driver, Duration.ofSeconds(15));
		waitRows.until(ExpectedConditions
				.textToBePresentInElementLocated(By.xpath("//table[@id='table1']/tbody/tr[1]/td[1]"), EnterBopName));

// ---- Verify Saved Row ----
		List<WebElement> rows = driver.findElements(By.xpath("//table[@id='table1']/tbody/tr"));
		boolean saveVerified = false;

		for (WebElement row : rows) {
			String actualBopTypeName = row.findElement(By.xpath("./td[1]")).getText().trim();
			String actualPartDescription = row.findElement(By.xpath("./td[2]")).getText().trim();
			String actualBopCategoryName = row.findElement(By.xpath("./td[7]")).getText().trim();

			if (actualBopTypeName.equalsIgnoreCase(EnterBopName)
					&& actualBopCategoryName.equalsIgnoreCase(BopcategoriesDropdownName)) {

				LoggerUtil.pass("BOP Type matches expected: " + EnterBopName);
				LoggerUtil.pass("BOP Category matches expected: " + BopcategoriesDropdownName);

				if (actualPartDescription.equalsIgnoreCase(EneteringPartDescription)) {
					LoggerUtil.pass("Part Description matches expected: " + EneteringPartDescription);
				}

// ---- Click Edit Button
				WebElement clickingEditBtn = row.findElement(By.xpath("./td[10]//a[1]"));
				clickingEditBtn.click();
				LoggerUtil.info("Clicked Edit button for update");
				Thread.sleep(4000);

				saveVerified = true;
				break;
			}
		}

		if (!saveVerified) {
			LoggerUtil.mismatch("Save Verification Failed! Row not found for BOP: " + EnterBopName);
			return;
		}

// ---- Update Flow ----

		Thread.sleep(7000);
		WebElement BopdropdownForUpdate = driver.findElement(ClickingBopTypeDropdownBop);
		action.moveToElement(BopdropdownForUpdate).click().perform();
		LoggerUtil.info("Clicked on BOP Type dropdown for Update");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(EnterSearchValueBopTypeBop));
		clearAndEnterText(waitForExpectedElement(EnterSearchValueBopTypeBop), EnterNewBopName);
		LoggerUtil.info("Entered new BOP Name in search: " + EnterNewBopName);

		for (WebElement bopDropdown : driver.findElements(listvalueofBopDropdownBop)) {
			String valueText = bopDropdown.getText().trim();
			if (valueText.equalsIgnoreCase(EnterNewBopName)) {
				bopDropdown.click();
				LoggerUtil.pass("Selected Updated BOP Type: " + valueText);
				break;
			}
		}

		Thread.sleep(2000);
		clickOnElement(ClickingUpdateButton);
		LoggerUtil.pass("Clicked Update button successfully");

		Thread.sleep(4000);

// ✅ Search after Update
		WebElement searchBoxUpdate = waitForExpectedElement(EnteringSearchValueForBopImported);
		searchBoxUpdate.clear();
		searchBoxUpdate.sendKeys(EnterNewBopName);
		searchBoxUpdate.sendKeys(Keys.ENTER);
		LoggerUtil.info("Searched for Updated BOP Name: " + EnterNewBopName);

// ✅ Wait until updated row appears
		waitRows.until(ExpectedConditions
				.textToBePresentInElementLocated(By.xpath("//table[@id='table1']/tbody/tr[1]/td[1]"), EnterNewBopName));

// ---- Verify Updated Row ----
		List<WebElement> updatedRows = driver.findElements(By.xpath("//table[@id='table1']/tbody/tr"));
		boolean updateVerified = false;

		for (WebElement row : updatedRows) {
			String updatedBopType = row.findElement(By.xpath("./td[1]")).getText().trim();
			if (updatedBopType.equalsIgnoreCase(EnterNewBopName)) {
				LoggerUtil.pass("Update successful! BOP Type updated to: " + EnterNewBopName);
				updateVerified = true;
				break;
			}
		}

		if (!updateVerified) {
			LoggerUtil.mismatch("Update Failed! Expected new BOP Type not found: " + EnterNewBopName);
		}

		LoggerUtil.info("=== Save + Update BOP Imported Verification Completed ===");
	}

	/////////////////////////////////// OHP
	/////////////////////////////////// Master////////////////////////////////////////////////////

	public static final By findingHeaderTextOHP = By
			.xpath("//div[@class='main-content app-content']/div/descendant::h6[contains(text(),'')]");

	public static void VerifyTitlePageOfOhpMaster(String ExpectedHeader) {
		try {
// Step 1: Get and log page title
			try {
				String actualTitleOfUi = driver.getTitle();
				LoggerUtil.info("Page Title fetched: " + actualTitleOfUi);
			} catch (Exception e) {
				LoggerUtil.error("Failed to fetch Page Title: " + e.getMessage());
			}

			// Step 2: Get and log current URL
			try {
				String actualUrl = driver.getCurrentUrl();
				LoggerUtil.info("Page URL fetched: " + actualUrl);
			} catch (Exception e) {
				LoggerUtil.error("Failed to fetch Page URL: " + e.getMessage());
			}

			// Step 3: Validate Header
			try {
				String actualHeaderOhp = waitForExpectedElement(findingHeaderTextOHP).getText().trim();
				LoggerUtil.info("Page Header fetched: " + actualHeaderOhp);

				if (actualHeaderOhp.contains(ExpectedHeader)) {
					LoggerUtil.pass("Header validation successful → Expected: " + ExpectedHeader + " | Found: "
							+ actualHeaderOhp);
				} else {
					LoggerUtil
							.mismatch("Header mismatch → Expected: " + ExpectedHeader + " | Found: " + actualHeaderOhp);
				}
			} catch (Exception e) {
				LoggerUtil.error("Failed to validate Page Header: " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.error("Unexpected error in VerifyTitlePageOfOhpMaster: " + e.getMessage());
		}
	}
//////////////////////////////////////////////////////////////////////Customer Page//////////////////////////////////////////////////////////////////////////////////////////////

	public void VerifyDataBusinessDomainAndSegmentAreSaveOrNot(String expectedCategoryName) {
		try {
			LoggerUtil.info("Step 1: Waiting for search box");
			WebElement searchBox = waitForElement(EnterSearchboxForBusinessSegAndDomainTab, 20);

			LoggerUtil.info("Step 2: Entering search value: " + expectedCategoryName);
			clearAndEnterText(searchBox, expectedCategoryName);

			LoggerUtil.info("Step 3: Waiting for table rows to load");
			List<WebElement> tableRows = waitForTableRows(FetchingTableRowsFromBusinessDomAndSegTabTableSupp, 20);

			boolean matchFound = false;

			LoggerUtil.info("Step 4: Iterating over table rows");
			for (WebElement row : tableRows) {
				List<WebElement> columns = row.findElements(By.tagName("td"));

				// Skip invalid rows
				if (columns.size() < 3) {
					LoggerUtil.info("Skipping row with insufficient columns: " + row.getText());
					continue;
				}

				String actualCategoryType = columns.get(1).getText().trim();
				String actualCategoryName = columns.get(2).getText().trim();

				LoggerUtil.info(
						"Row → CategoryType: [" + actualCategoryType + "], CategoryName: [" + actualCategoryName + "]");

				// Match condition
				if ((actualCategoryType.equals("Business Domain") || actualCategoryType.equals("Business Segments"))
						&& actualCategoryName.equals(expectedCategoryName)) {

					LoggerUtil.pass("Match found → Type: " + actualCategoryType + ", Name: " + actualCategoryName);
					matchFound = true;
					break;
				}
			}

			if (!matchFound) {
				LoggerUtil.fail("No matching Business Domain/Segment record found for: " + expectedCategoryName);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error in VerifyDataBusinessDomainAndSegmentAreSaveOrNot: " + e.getMessage());
		}
	}

	private List<WebElement> waitForTableRows(By locator, int timeoutSeconds) throws InterruptedException {
		for (int i = 0; i < timeoutSeconds * 2; i++) { // retries every 500ms
			List<WebElement> rows = driver.findElements(locator);
			if (rows.size() > 0) {
				return rows;
			}
			Thread.sleep(500);
		}
		throw new RuntimeException("No rows found for locator: " + locator);
	}

	public void VerifyDataBusinessSegmentAreSaveOrNot(String EnteringValueForCategoryBusinessDomAndSeg) {
		try {

			LoggerUtil.info("Step 1: Waiting for search box visibility");
			// wait.until(ExpectedConditions.visibilityOfElementLocated(EnterSearchboxForBusinessSegAndDomainTab));

			LoggerUtil.info("Step 2: Entering search value: " + EnteringValueForCategoryBusinessDomAndSeg);
			clearAndEnterText(waitForExpectedElement(EnterSearchboxForBusinessSegAndDomainTab),
					EnteringValueForCategoryBusinessDomAndSeg);

			Thread.sleep(5000);
			LoggerUtil.info("Step 3: Waiting for table rows to load");
			wait.until(
					ExpectedConditions.visibilityOfElementLocated(FetchingTableRowsFromBusinessDomAndSegTabTableSupp));

			List<WebElement> tableRows = driver.findElements(FetchingTableRowsFromBusinessDomAndSegTabTableSupp);
			boolean matchFound = false;

			LoggerUtil.info("Step 4: Iterating over table rows");
			for (WebElement row : tableRows) {
				List<WebElement> columns = row.findElements(By.tagName("td"));

				// Skip rows with fewer than 3 columns
				if (columns.size() < 3) {
					LoggerUtil.info("Skipping row with insufficient columns: " + row.getText());
					continue;
				}

				String actualCategoryType = columns.get(1).getText().trim();
				String actualCategoryName = columns.get(2).getText().trim();

				LoggerUtil.info(
						"Row → CategoryType: [" + actualCategoryType + "], CategoryName: [" + actualCategoryName + "]");

				if (actualCategoryType.equals("Business Domain")
						&& actualCategoryName.equals(EnteringValueForCategoryBusinessDomAndSeg)) {
					LoggerUtil.pass("All values matched successfully → Business Domain: " + actualCategoryName);
					matchFound = true;
					break; // stop loop after first match
				}
			}

			if (!matchFound) {
				LoggerUtil.fail(
						"No matching Business Segmenet record found for: " + EnteringValueForCategoryBusinessDomAndSeg);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error in VerifyDataBusinessDomainAndSegmentAreSaveOrNot: " + e.getMessage());
		}
	}

	public void VerifyEditButtonFunctionalityForBusinessDomAndSegTabSupp(String expectedCategoryName) {
	    try {
	        LoggerUtil.info("Step 1: Waiting for search box visibility");
	        Thread.sleep(1000);

	        LoggerUtil.info("Step 2: Entering search value: " + expectedCategoryName);
	        clearAndEnterText(
	                waitForExpectedElement(EnterSearchboxForBusinessSegAndDomainTab),
	                expectedCategoryName
	        );
	        Thread.sleep(2000);

	        LoggerUtil.info("Step 3: Waiting for table rows to load");
	        waitForUIBlockersToDisappear();
	        Thread.sleep(500);

	        List<WebElement> tableRows =
	                driver.findElements(FetchingTableRowsFromBusinessDomAndSegTabTableSupp);

	        boolean matchFound = false;

	        LoggerUtil.info("Step 4: Iterating over table rows");
	        for (WebElement row : tableRows) {

	            List<WebElement> columns = row.findElements(By.tagName("td"));

	            if (columns.size() < 4) {
	                LoggerUtil.info("Skipping row with insufficient columns");
	                continue;
	            }

	            String actualCategoryType = columns.get(1).getText().trim();
	            String actualCategoryName = columns.get(2).getText().trim();

	            LoggerUtil.info("Row → CategoryType: [" + actualCategoryType +
	                    "], CategoryName: [" + actualCategoryName + "]");

	            if ((actualCategoryType.equals("Business Domain")
	                    || actualCategoryType.equals("Business Segments"))
	                    && actualCategoryName.equals(expectedCategoryName)) {

	                matchFound = true;
	                LoggerUtil.pass("Match found → Type: " + actualCategoryType +
	                        ", Name: " + actualCategoryName);

	                try {
	                    // Step 5: Click Edit button
	                    WebElement editButton =
	                            columns.get(3).findElements(By.tagName("a")).get(0);

	                    LoggerUtil.info("Clicking Edit button for matched row");
	                    editButton.click();

	                    // Step 6: Let UI settle
	                    waitForUIBlockersToDisappear();
	                    Thread.sleep(500);

	                    // Step 7: Fetch popup fields using retryFind (NO WebDriverWait)
	                    WebElement typeDropdown =
	                            retryFind(By.xpath("//select[@id='Type']"), 5, 500);

	                    WebElement nameInput =
	                            retryFind(By.xpath("//input[@id='Name']"), 5, 500);

	                    // Step 8: Capture popup values
	                    Select select = new Select(typeDropdown);
	                    String selectedType =
	                            select.getFirstSelectedOption().getText().trim();

	                    String nameInBox =
	                            nameInput.getAttribute("value").trim();

	                    LoggerUtil.info("Modal → Type: [" + selectedType +
	                            "], Name: [" + nameInBox + "]");

	                    // Step 9: Compare values
	                    if (selectedType.equals(actualCategoryType)
	                            && nameInBox.equals(actualCategoryName)) {

	                        LoggerUtil.pass(
	                                "Edit popup values match table values → Edit button working correctly"
	                        );
	                    } else {
	                        LoggerUtil.fail(
	                                "Mismatch! Table → Type: " + actualCategoryType +
	                                ", Name: " + actualCategoryName +
	                                " | Popup → Type: " + selectedType +
	                                ", Name: " + nameInBox
	                        );
	                    }

	                } catch (Exception e) {
	                    LoggerUtil.error(
	                            "Error while verifying Edit popup values: " + e.getMessage()
	                    );
	                }

	                break; // stop after first match
	            }
	        }

	        if (!matchFound) {
	            LoggerUtil.fail(
	                    "No matching Business Domain/Segment record found for: " + expectedCategoryName
	            );
	        }

	    } catch (Exception e) {
	        LoggerUtil.error(
	                "Error in VerifyEditButtonFunctionalityForBusinessDomAndSegTabSupp: "
	                        + e.getMessage()
	        );
	    }
	}

	
	
	private WebElement retryFind(By locator, int retries, int waitMillis) {
	    for (int i = 0; i < retries; i++) {
	        try {
	            WebElement ele = driver.findElement(locator);
	            if (ele.isDisplayed()) {
	                return ele;
	            }
	        } catch (Exception ignored) {}
	        try {
	            Thread.sleep(waitMillis);
	        } catch (InterruptedException e) {
	            Thread.currentThread().interrupt();
	        }
	    }
	    throw new RuntimeException("Element not found: " + locator);
	}


	public void VerifyResetButtonInBusinessDomainAndSegmentForm(String newType, String newName) {
	    try {
	        LoggerUtil.info("Step 1: Waiting for form fields visibility");

	        // Let UI settle
	        waitForUIBlockersToDisappear();
	        Thread.sleep(500);

	        // Fetch fields using retryFind (NO WebDriverWait)
	        WebElement typeDropdown =
	                retryFind(By.id("Type"), 5, 500);

	        WebElement nameInput =
	                retryFind(By.id("Name"), 5, 500);

	        // Step 2: Enter values
	        LoggerUtil.info("Step 2: Selecting Type: " + newType);
	        Select select = new Select(typeDropdown);
	        select.selectByVisibleText(newType);

	        LoggerUtil.info("Step 3: Entering Name: " + newName);
	        nameInput.clear();
	        nameInput.sendKeys(newName);

	        // Verify entered values
	        String enteredType =
	                select.getFirstSelectedOption().getText().trim();
	        String enteredName =
	                nameInput.getAttribute("value").trim();

	        LoggerUtil.info(
	                "Entered Values → Type: [" + enteredType +
	                "], Name: [" + enteredName + "]"
	        );

	        // Step 4: Click Reset button
	        LoggerUtil.info("Step 4: Clicking Reset button");
	        WebElement resetBtn =
	                retryFind(
	                        By.xpath("//button[@onclick='resetbusinessDomainSegments()']"),
	                        5,
	                        500
	                );
	        resetBtn.click();

	        // Step 5: Verify reset
	        waitForUIBlockersToDisappear();
	        Thread.sleep(500);

	        String afterResetType =
	                new Select(typeDropdown).getFirstSelectedOption().getText().trim();

	        String afterResetName =
	                nameInput.getAttribute("value").trim();

	        LoggerUtil.info(
	                "After Reset → Type: [" + afterResetType +
	                "], Name: [" + afterResetName + "]"
	        );

	        if (afterResetType.equals("Select") && afterResetName.isEmpty()) {
	            LoggerUtil.pass(
	                    "Reset button working correctly → Fields reset to default"
	            );
	        } else {
	            LoggerUtil.fail(
	                    "Reset button not working → Type: " + afterResetType +
	                    ", Name: " + afterResetName
	            );
	        }

	    } catch (Exception e) {
	        LoggerUtil.error(
	                "Error in VerifyResetButtonInBusinessDomainAndSegmentForm: "
	                        + e.getMessage()
	        );
	    }
	}


	/////////////////////////////////////////////////////// Supplier Allocation And
	/////////////////////////////////////////////////////// Verification For
	/////////////////////////////////////////////////////// CommodityDetailsPage/////////////////////////////////////////////////////////////////////////////////////
	public static final By FetchingCommodityDetailsTableRows = By
			.xpath("//table[@id='comodityDetailListTable']/tbody/tr");
	public static final By FetchingHeaderNamesCommodityDetailsPage = By
			.xpath("(//table[@id='comodityDetailListTable']/thead/tr)[1]");
	public static final By FilternamelistForCommodityDetailsPage = By.xpath("//div[@id='chkddd']/label");

	public Map<String, String> verifySupplierAllocationForCommodityDetailsPage(String SearchSupplierName)
			throws InterruptedException {

		Map<String, String> rowDataInCommodityDetailsViewTablePage = new HashMap<>();

		try {
			// Step 1: Click View button
			clickOnElement(CommodityDetailsPage.ClickingViewbtn);
			LoggerUtil.pass("✅ Clicked on View button in Commodity Details tab");
			Thread.sleep(7000);

			// Step 2: Click Search Filter
			clickOnElement(ClickingSearchFilterCommodityDetailsTabbtn);
			LoggerUtil.pass("✅ Clicked on Search Filter button");

			Thread.sleep(3000);
			// Step 3: Select Suppliers filter
			List<WebElement> labels = driver.findElements(FilternamelistForCommodityDetailsPage);
			boolean supplierFilterFound = false;
			for (WebElement label : labels) {
				if (label.getText().trim().equalsIgnoreCase("Suppliers")) {
					label.click();
					supplierFilterFound = true;
					LoggerUtil.pass("✅ Selected 'Suppliers' filter");
					break;
				}
			}
			if (!supplierFilterFound) {
				LoggerUtil.fail("❌ 'Suppliers' filter not found");
			}

			// Step 4: Build header -> index mapping (UPDATED WITH WARNINGS)
			List<WebElement> headernames = driver.findElements(By.tagName("th"));
			Map<String, Integer> StoreHeaderName = new HashMap<>();

			for (int i = 0; i < headernames.size(); i++) {

				String headerText = headernames.get(i).getText().trim();

				// ---- Commodity Group (flexible) ----
				if (headerText.equalsIgnoreCase("Commodity Group")
						|| headerText.replace(" ", "").equalsIgnoreCase("CommodityGroup")) {
					StoreHeaderName.put("Commodity Group", i);
					continue;
				}

				// ---- Group Classification (flexible) ----
				if (headerText.equalsIgnoreCase("Group Classification")
						|| headerText.replace(" ", "").equalsIgnoreCase("GroupClassification")) {
					StoreHeaderName.put("Group Classification", i);
					continue;
				}

				// ---- Specific Grade - exact ----
				if (headerText.equalsIgnoreCase("Specific Grade")) {
					StoreHeaderName.put("Specific Grade", i);
					LoggerUtil.pass("Header found: Specific Grade");
					continue;
				}

				// ---- Specific Grade - incorrect spellings with WARNING ----
				if (headerText.equalsIgnoreCase("Specfic Grade") || headerText.equalsIgnoreCase("Spefic Grade")
						|| headerText.equalsIgnoreCase("Specifc Grade")) {

					LoggerUtil.warn("⚠️ WARNING: Incorrect header name detected → '" + headerText
							+ "'. Expected: 'Specific Grade'. Auto-mapped.");

					StoreHeaderName.put("Specific Grade", i);
					continue;
				}

				// ---- Only 'Grade' present ----
				if (headerText.equalsIgnoreCase("Grade")) {
					LoggerUtil.warn("⚠️ WARNING: Header 'Grade' found instead of 'Specific Grade'. Auto-mapped.");
					StoreHeaderName.put("Specific Grade", i);
					continue;
				}

				// Default direct mapping
				StoreHeaderName.put(headerText, i);
			}

			LoggerUtil.info("ℹ️ Table headers mapped: " + StoreHeaderName.keySet());
            Thread.sleep(3000);
			// Step 5: Enter supplier name in search box
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.EnterSearchValueForCommdetailTable),
					SearchSupplierName);
			LoggerUtil.pass(" Entered supplier name in search box: " + SearchSupplierName);

			Thread.sleep(9000);
			// Step 6: Wait until supplier row is visible
			String rowXpath = "//table//tr[.//td[contains(normalize-space(),'" + SearchSupplierName + "')]]";
			// wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(rowXpath)));
			LoggerUtil.pass(" Supplier row found for: " + SearchSupplierName);

			// Step 7: Fetch data from supplier row
			List<WebElement> columns = driver.findElement(By.xpath(rowXpath)).findElements(By.tagName("td"));

			if (StoreHeaderName.containsKey("Commodity Group")) {
				String value = columns.get(StoreHeaderName.get("Commodity Group")).getText().trim();
				rowDataInCommodityDetailsViewTablePage.put("CommodityGroup", value);
				LoggerUtil.pass(" Commodity Group fetched: " + value);
			}
			if (StoreHeaderName.containsKey("Group Classification")) {
				String value = columns.get(StoreHeaderName.get("Group Classification")).getText().trim();
				rowDataInCommodityDetailsViewTablePage.put("GroupClassification", value);
				LoggerUtil.pass(" Group Classification fetched: " + value);
			}
			if (StoreHeaderName.containsKey("Specific Grade")) {
				String value = columns.get(StoreHeaderName.get("Specific Grade")).getText().trim();
				rowDataInCommodityDetailsViewTablePage.put("SpecificGrade", value);
				LoggerUtil.pass(" Specific Grade fetched: " + value);
			}
			if (StoreHeaderName.containsKey("Suppliers")) {
				String value = columns.get(StoreHeaderName.get("Suppliers")).getText().trim();
				rowDataInCommodityDetailsViewTablePage.put("Suppliers", value);
				LoggerUtil.pass(" Supplier fetched: " + value);
			}

			LoggerUtil.info(" Data fetched for Supplier '" + SearchSupplierName + "' → "
					+ rowDataInCommodityDetailsViewTablePage);

			// Step 8: Click Edit button
			String editXpath = rowXpath + "//i[contains(@class,'fa-edit')]/parent::a";
			WebElement editBtn = waitForExpectedElement(By.xpath(editXpath));
			editBtn.click();
			LoggerUtil.pass(" Clicked Edit button for supplier: " + SearchSupplierName);

			
			Thread.sleep(23000);

		} catch (Exception e) {
			LoggerUtil.error(" Error in verifySupplierAllocationForCommodityDetailsPage: " + e.getMessage());
		}

		return rowDataInCommodityDetailsViewTablePage;
	}

/////////////////////////////////////////////////////////////Supplier Page For RmTable Allocation Code//////////////////////////////////////////////////////////////////////////	

	public static final By checkboxoptionsForRmAllocationSupplierPage = By
			.xpath("//div[@id='rmdata']/table/tbody/descendant::input[contains(@id,'rmdata')]");
	public static final By tableRowDataFromSupplierPage = By.xpath("//table[@id='rmdatatable']/tbody/tr");

	public static HashMap<String, String> verifyFetchingRmDataInSupplierMasterTableForVerifyRmAllocation() {

		HashMap<String, String> rowData = new HashMap<>();

		try {
			// Same locators – NO CHANGE
			List<WebElement> checkboxList = driver
					.findElements(By.xpath("//table[@id='rmdatatable']//tbody//input[@type='checkbox']"));

			List<WebElement> rowList = driver.findElements(By.xpath("//table[@id='rmdatatable']//tbody/tr"));

			int selectedIndex = -1;

			// Find FIRST selected checkbox
			for (int i = 0; i < checkboxList.size(); i++) {
				if (checkboxList.get(i).isSelected()) {
					selectedIndex = i;
					break;
				}
			}

			if (selectedIndex == -1) {
				LoggerUtil.error("❌ NO RM ROW SELECTED IN TABLE. HashMap EMPTY.");
				return rowData;
			}

			// Get that selected row
			WebElement selectedRow = rowList.get(selectedIndex);
			List<WebElement> cols = selectedRow.findElements(By.tagName("td"));

			// Map: 2 = Commodity Group, 3 = Group Classification, 4 = Specific Grade
			String commodityGroup = cols.get(2).getText().trim();
			String groupClassification = cols.get(3).getText().trim();
			String specificGrade = cols.get(4).getText().trim();

			rowData.put("CommodityGroup", commodityGroup);
			rowData.put("GroupClassification", groupClassification);
			rowData.put("SpecificGrade", specificGrade);

			LoggerUtil.pass("✔ RM DATA STORED FROM SUPPLIER MASTER → " + rowData);

		} catch (Exception e) {
			LoggerUtil.error("❌ ERROR fetching RM Allocation: " + e.getMessage());
		}

		return rowData;
	}

	//////////////////////////////////////////////////////////// Fetching Ui Data In
	//////////////////////////////////////////////////////////// CommodityDetailsPage
	//////////////////////////////////////////////////////////// For Supplier
	//////////////////////////////////////////////////////////// Allocation
	//////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	public static final By EnterSupplierNameInSearchBoxCommodityDetailsTabUi = By
			.xpath("//input[@id='myInputSupplier']");

	public static final By fetchingSupplierNameList = By
			.xpath("//table[@id='rmSupplier']/tbody/tr/descendant::label/input");

	public static final By fetchingCommgroup = By.xpath(
			"//select[@id='commodityDrop']/following-sibling::span/descendant::span[@id='select2-commodityDrop-container']");

	public static final By FetchingDataFromGroupclassification = By.xpath(
			"//select[@id='materialDrop']/following-sibling::span/descendant::span[@id='select2-materialDrop-container']");

	public static final By fetchingSpecificGradedata = By.xpath(
			"//select[@id='SpecificGrade']/following-sibling::span/descendant::span[@id='select2-SpecificGrade-container']");

	public static final By FetchingSupplierRow = By.xpath("//table[@id='rmSupplier']/tbody/tr");

	public void VerifyFetchingUiData(HashMap<String, String> rowDataInSupplierPage,
			Map<String, String> rowDataInCommodityDetailsViewTablePage, String EnterSupplierName, String EnterSuppCode,
			String EnetrSupplocation) throws InterruptedException {

		LoggerUtil.info("🔍 DEBUG: Supplier HashMap in VerifyFetchingUiData → " + rowDataInSupplierPage);

		// Expected values from Supplier RM Allocation table
		String expectedCommodityGroup = rowDataInSupplierPage.getOrDefault("CommodityGroup", "").trim();
		String expectedGroupClassification = rowDataInSupplierPage.getOrDefault("GroupClassification", "").trim();
		String expectedSpecificGrade = rowDataInSupplierPage.getOrDefault("SpecificGrade", "").trim();

		// Actual values from Commodity Details UI
		String actualCommodityGroup = waitForExpectedElement(fetchingCommgroup).getText().trim();
		String actualGroupClassification = waitForExpectedElement(FetchingDataFromGroupclassification).getText().trim();
		String actualSpecificGrade = waitForExpectedElement(fetchingSpecificGradedata).getText().trim();

		LoggerUtil.info("🔎 ==== Validating Commodity Details Tab Data ====");
		Thread.sleep(2000);

		// =========================
		// COMMODITY GROUP VALIDATION
		// =========================
		if (!expectedCommodityGroup.isEmpty()) {
			if (actualCommodityGroup.equals(expectedCommodityGroup)) {
				LoggerUtil.pass("[Commodity Group] Expected: " + expectedCommodityGroup + " | Actual: "
						+ actualCommodityGroup + " | Result: ✅ MATCH");
			} else {
				LoggerUtil.fail("[Commodity Group] Expected: " + expectedCommodityGroup + " | Actual: "
						+ actualCommodityGroup + " | Result: ❌ MISMATCH");
			}
		} else {
			LoggerUtil.warn("[Commodity Group] ⚠ SKIPPED (Supplier HashMap did not contain a value)");
		}

		// ===============================
		// GROUP CLASSIFICATION VALIDATION
		// ===============================
		if (!expectedGroupClassification.isEmpty()) {
			if (actualGroupClassification.equals(expectedGroupClassification)) {
				LoggerUtil.pass("[Group Classification] Expected: " + expectedGroupClassification + " | Actual: "
						+ actualGroupClassification + " | Result: ✅ MATCH");
			} else {
				LoggerUtil.fail("[Group Classification] Expected: " + expectedGroupClassification + " | Actual: "
						+ actualGroupClassification + " | Result: ❌ MISMATCH");
			}
		} else {
			LoggerUtil.warn("[Group Classification] ⚠ SKIPPED (Supplier HashMap did not contain a value)");
		}

		// =========================
		// SPECIFIC GRADE VALIDATION
		// =========================
		if (!expectedSpecificGrade.isEmpty()) {
			if (actualSpecificGrade.equals(expectedSpecificGrade)) {
				LoggerUtil.pass("[Specific Grade] Expected: " + expectedSpecificGrade + " | Actual: "
						+ actualSpecificGrade + " | Result: ✅ MATCH");
			} else {
				LoggerUtil.fail("[Specific Grade] Expected: " + expectedSpecificGrade + " | Actual: "
						+ actualSpecificGrade + " | Result: ❌ MISMATCH");
			}
		} else {
			LoggerUtil.warn("[Specific Grade] ⚠ SKIPPED (Supplier HashMap did not contain a value)");
		}

		// -----------------------------
		// Validate Supplier Allocation
		// -----------------------------
		String suppinfo = EnterSupplierName + "-" + EnterSuppCode + "-" + EnetrSupplocation;
		clearAndEnterText(waitForExpectedElement(EnterSupplierNameInSearchBoxCommodityDetailsTabUi), suppinfo);

		List<WebElement> SuppRows = driver.findElements(FetchingSupplierRow);
		boolean supplierFound = false;

		for (WebElement rowSupp : SuppRows) {
			String styleAttr = rowSupp.getAttribute("style").trim();
			if (!styleAttr.contains("display: none")) {

				String supplierText = rowSupp.getText().trim();

				if (supplierText.equalsIgnoreCase(suppinfo)) {
					supplierFound = true;
					WebElement checkbox = rowSupp.findElement(By.tagName("input"));

					if (checkbox.isSelected()) {
						LoggerUtil.pass("[Supplier Allocation] MATCHED: " + supplierText);
					} else {
						LoggerUtil.fail("[Supplier Allocation] Expected: " + suppinfo + " | Actual: " + supplierText
								+ " | Checkbox: NOT Selected");
					}
					break;
				}
			}
		}

		if (!supplierFound) {
			LoggerUtil.fail("[Supplier Allocation] Expected: " + suppinfo + " | Actual: Not Found | Result: ❌ FAIL");
		}

		LoggerUtil.info("✅ ==== Validation Completed for Supplier: " + suppinfo + " ====");
	}

	///////////////////////////////////////////////////////////////// ProcessAllocation
	///////////////////////////////////////////////////////////////// From Supplier
	///////////////////////////////////////////////////////////////// Page
	///////////////////////////////////////////////////////////////// ////////////////////////////////////////////////

	public static final By FetchingHeaderNamesSupplierPage = By.xpath("//table[@id='processdatatable']/thead/tr");

	public static final By checkboxlistSupplierPageForProcessAllocation = By
			.xpath("//table[@id='processdatatable']/tbody/tr/td/div/input[@type='checkbox']");

	public static HashMap<String, String> TableColoumnValueVerifyFetchDataFromSupplierPageForProcessAllocation() {

		Map<String, Integer> headerIndexMap = new HashMap<>();

		WebElement headers = driver.findElement(FetchingHeaderNamesSupplierPage);
		List<WebElement> headerRow = headers.findElements(By.tagName("th"));
		for (int i = 0; i < headerRow.size(); i++) {
			String headername = headerRow.get(i).getText().trim();
			headerIndexMap.put(headername, i);
			LoggerUtil.info("Header " + i + " : " + headername);
		}

		HashMap<String, String> SupplierTableColoumnValueForProcessAllocation = new HashMap<>();

		// First row
		WebElement colcoumnsValue = driver.findElement(By.xpath("//table[@id='processdatatable']/tbody/tr[1]"));
		List<WebElement> coloumnvalues = colcoumnsValue.findElements(By.tagName("td"));

		// Process Name
		if (headerIndexMap.containsKey("Process Name")) {
			int colIndex = headerIndexMap.get("Process Name");
			String processNameValue = coloumnvalues.get(colIndex).getText().trim();
			SupplierTableColoumnValueForProcessAllocation.put("Process Name", processNameValue);
			LoggerUtil.pass("[Process Name] fetched: " + processNameValue);
		}

		// UOM
		if (headerIndexMap.containsKey("UOM")) {
			int colIndex = headerIndexMap.get("UOM");
			String uomValue = coloumnvalues.get(colIndex).getText().trim();
			SupplierTableColoumnValueForProcessAllocation.put("UOM", uomValue);
			LoggerUtil.pass("[UOM] fetched: " + uomValue);
		}

		if (headerIndexMap.containsKey("Rate")) {

			int colIndex = headerIndexMap.get("Rate");
			String RateColoumnValue = coloumnvalues.get(colIndex).getText().trim();
			SupplierTableColoumnValueForProcessAllocation.put("Rate", RateColoumnValue);
			LoggerUtil.pass("[Rate] fetched: " + RateColoumnValue);
		}
		if (headerIndexMap.containsKey("Delta")) {
			int colIndex = headerIndexMap.get("Delta");
			String DeltaColoumnValue = coloumnvalues.get(colIndex).getText().trim();
			SupplierTableColoumnValueForProcessAllocation.put("Delta", DeltaColoumnValue);
			LoggerUtil.pass("[Delta] Fetched =" + DeltaColoumnValue);

		}

		return SupplierTableColoumnValueForProcessAllocation;

	}

///////////////////////////////////////////////////////////////Supplier Allocation For Process Master/////////////////////////////////////////////////////////////////////		

	public static final By clickingViewButtonProcessMaster = By
			.xpath("//button[contains(text(),'View') and @class='btn btn-primary pull-right']");

	public static final By clickingButtonsByNameProcessMaster = By
			.xpath("//button[contains(text(),'') and @class='btn btn-primary pull-right']");

	public static final By EnterValueInSearchBoxProcessMaster = By.xpath("//input[@id='searchBoxProcess1']");

	public static final By FetchingTableHeader = By.xpath("//table[@id='unitTable1']/thead/tr");
	public static final By processMasterTableRow = By.xpath("//table[@id='unitTable1']/tbody/tr");

	public static final By clickingEditBtn = By.xpath("//*[@id='unitTable1']/tbody/tr[1]/td[2]/a[1]/i");

	public static void ClickingButtonProcessMasterByName(List<WebElement> ele, String value) {
		boolean buttonFound = false;

		try {
			for (WebElement button : ele) {
				String buttonName = button.getText().trim();

				if (buttonName.equalsIgnoreCase(value)) {
					buttonFound = true;

					// Scroll into view before clicking
					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block: 'center'});",
							button);
					Thread.sleep(300);

					try {
						// Try normal click
						button.click();
						LoggerUtil.pass("✅ Clicked on '" + value + "' button successfully.");
					} catch (ElementClickInterceptedException e) {
						// JS fallback
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", button);
						LoggerUtil.warn("⚠ Element intercepted — performed JS click on '" + value + "' button.");
					}

					break; // stop once found
				}
			}

			if (!buttonFound) {
				LoggerUtil.fail("❌ '" + value + "' button not found on Process Master page.");
				Assert.fail("'" + value + "' button missing in current UI.");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while clicking '" + value + "' button: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public void VerifySupplierAllocationInProcessMaster(String EnterValueInSearchBoxprocessMaster)
			throws InterruptedException {
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(15));

		Thread.sleep(9000);
		// wait.until(ExpectedConditions.elementToBeClickable(clickingViewButtonProcessMaster));
		clickOnElement(clickingViewButtonProcessMaster);

		Thread.sleep(8000);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(EnterValueInSearchBoxProcessMaster));
		clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxProcessMaster),
				EnterValueInSearchBoxprocessMaster);

		Thread.sleep(7000); // Add sleep to let page load, but this is not ideal. Prefer wait.

		// ✅ Fetch header names with index
		WebElement TableHeaderRow = driver.findElement(FetchingTableHeader);
		List<WebElement> TableHeadercoloumns = TableHeaderRow.findElements(By.tagName("th"));

		HashMap<String, Integer> FetchHeaderNameProcessMasterTable = new HashMap<>();
		for (int i = 0; i < TableHeadercoloumns.size(); i++) {
			String ActualHeader = TableHeadercoloumns.get(i).getText().trim();
			FetchHeaderNameProcessMasterTable.put(ActualHeader, i);
			System.out.println("Header Found: " + ActualHeader + " | Index: " + i);
		}

		// ✅ Now fetch row data
		WebElement RowProcessMasterTable = driver.findElement(processMasterTableRow);
		List<WebElement> ColoumnList = RowProcessMasterTable.findElements(By.tagName("td"));

		HashMap<String, String> TableDataFromRows = new HashMap<>();
		for (int i = 0; i < ColoumnList.size(); i++) {
			String ActualValue = ColoumnList.get(i).getText().trim();
			String Header = TableHeadercoloumns.get(i).getText().trim();
			TableDataFromRows.put(Header, ActualValue);
		}

		if (FetchHeaderNameProcessMasterTable.containsKey("Supplier Name")) {
			String SupplierNameValue = ColoumnList.get(FetchHeaderNameProcessMasterTable.get("Supplier Name")).getText()
					.trim();

			if (EnterValueInSearchBoxprocessMaster.equals(SupplierNameValue)) {
				if (FetchHeaderNameProcessMasterTable.containsKey("Process Name")) {
					String ProcessName = ColoumnList.get(FetchHeaderNameProcessMasterTable.get("Process Name"))
							.getText().trim();
					TableDataFromRows.put("Process Name", ProcessName);
				}

				if (FetchHeaderNameProcessMasterTable.containsKey("Process Rate")) {
					String ProcessRate = ColoumnList.get(FetchHeaderNameProcessMasterTable.get("Process Rate"))
							.getText().trim();
					TableDataFromRows.put("Process Rate", ProcessRate);
				}

				if (FetchHeaderNameProcessMasterTable.containsKey("Unit")) {
					String Unit = ColoumnList.get(FetchHeaderNameProcessMasterTable.get("Unit")).getText().trim();
					TableDataFromRows.put("Unit", Unit);
				}

				if (FetchHeaderNameProcessMasterTable.containsKey("Supplier Name")) {
					String SupplierName = ColoumnList.get(FetchHeaderNameProcessMasterTable.get("Supplier Name"))
							.getText().trim();
					TableDataFromRows.put("Supplier Name", SupplierName);
				}

				// Define the actionIndex
				int actionIndex = FetchHeaderNameProcessMasterTable.get("Action"); 

				if (FetchHeaderNameProcessMasterTable.containsKey("Action")) {
					
					WebElement editLink = RowProcessMasterTable.findElement(
							By.xpath(".//td[" + (actionIndex + 1) + "]//i[contains(@class,'fa-edit')]/parent::a"));

					// Wait for edit icon to be clickable
					WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));

					// Try clicking the edit link
					try {
						editLink.click();
						LoggerUtil.info("Clicked on Edit icon in Process Master Action column");
					} catch (Exception e) {
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", editLink);
						LoggerUtil.info("Clicked on Edit icon in Process Master Action column using JS fallback");
					}
				}
			}
		}

		
		LoggerUtil.info("---- Process Master Table Data ----");
		for (String key : TableDataFromRows.keySet()) {
			LoggerUtil.info(key + " = " + TableDataFromRows.get(key));
		}
	}

	public static final By FetchingTableHeaderRowPath = By.xpath("//table[@id='ohpdatatable']/thead/tr");
	public static final By FetchingTableRow = By.xpath("//table[@id='ohpdatatable']/tbody/tr[1]");

	public void VerifyOhpDataFetchingFromSupplierOhpAllocation() {
		// Wait until table header is visible
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
		WebElement fetchHeaderName = wait
				.until(ExpectedConditions.visibilityOfElementLocated(FetchingTableHeaderRowPath));

		// Fetching column names of table header
		List<WebElement> fetchColoumnnamesOfTableHeader = fetchHeaderName.findElements(By.tagName("th"));
		HashMap<String, Integer> coloumnnameinfo = new HashMap<>();

		// Loop to extract column names and their index
		for (int i = 0; i < fetchColoumnnamesOfTableHeader.size(); i++) {
			String names = fetchColoumnnamesOfTableHeader.get(i).getText().trim();
			coloumnnameinfo.put(names, i);
			LoggerUtil.info("Column: " + names + " | Index: " + i);
		}

		// Fetch row data
		WebElement fetchrow = driver.findElement(FetchingTableRow);
		List<WebElement> fetchingColoumns = fetchrow.findElements(By.tagName("td"));

		HashMap<String, String> MapColoumn = new HashMap<>();

		// Check if "Nomenclature" column exists and fetch its value
		if (coloumnnameinfo.containsKey("Nomenclature")) {
			String value = fetchingColoumns.get(coloumnnameinfo.get("Nomenclature")).getText().trim();
			MapColoumn.put("Nomenclature", value);
			LoggerUtil.info("Nomenclature Value: " + value); // Log the fetched value for Nomenclature
		}

		// Optionally, fetch and log other columns here (if needed)
		// Example:
		if (coloumnnameinfo.containsKey("Supplier")) {
			String supplierValue = fetchingColoumns.get(coloumnnameinfo.get("Supplier")).getText().trim();
			MapColoumn.put("Supplier", supplierValue);
			LoggerUtil.info("Supplier Value: " + supplierValue); // Log the fetched value for Supplier
		}

		// Logging the entire map of column data
		LoggerUtil.info("Fetched Column Data: " + MapColoumn);

		// Click Save button for Supplier
		try {
			WebElement clickingSavebtn = wait
					.until(ExpectedConditions.elementToBeClickable(By.xpath("//button[@onclick='savesupplier()']")));
			clickingSavebtn.click();
			LoggerUtil.pass("✅ Clicked Save button for Supplier");
			driver.navigate().refresh();
			Thread.sleep(2000);
		} catch (Exception e) {
			LoggerUtil.error("Failed to click Save button for Supplier: " + e.getMessage());
		}
	}

	public static final By FetchHeadersName = By.xpath("//table[@id='example1']/thead/tr");
	public static final By FetchTableRow = By.xpath("//table[@id='example1']/tbody/tr[1]");
	public static final By FetchingSupplierNameList = By.xpath(
			"//table[@id='rmSupplier']/tbody/tr[not(contains(@style, 'display: none'))]/td/input/following-sibling::input");

	public void VerifySupplierNameHasBeenAllocateOrNot(String EnetrSearchValue) throws InterruptedException {

		// Implicit Wait
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(15));

		Thread.sleep(9000); // Wait for the view button to appear
		// Wait for and click the View button
		clickOnElement(OHPMaster_PageClass.ClickingViewBtn);

		Thread.sleep(5000); // Wait for search filter to load
		// Wait for the search filter to be visible and clear & enter the value

		clearAndEnterText(waitForExpectedElement(OHPMaster_PageClass.EnterSearchFilter), EnetrSearchValue);

		Thread.sleep(3000); // Wait after entering search value
		// Wait for table to load after search
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
		WebElement headerRow = waitForExpectedElement(FetchHeadersName);
		List<WebElement> headerColoumnsName = headerRow.findElements(By.tagName("th"));

		// Store column names and their indices
		HashMap<String, Integer> storeName = new HashMap<>();
		for (int i = 0; i < headerColoumnsName.size(); i++) {
			String headername = headerColoumnsName.get(i).getText().trim();
			storeName.put(headername, i);
			LoggerUtil.info("Column: " + headername + " | Index: " + i);
		}

		// Fetch the table row data
		WebElement row = driver.findElement(FetchTableRow);
		List<WebElement> fetchingColoumns = row.findElements(By.tagName("td"));
		HashMap<String, String> FetchColoumnValue = new HashMap<>();

		// Check for Nomenclature and Suppliers, and add their values
		boolean isNomenclatureValid = false;
		boolean isSupplierValid = false;

		if (storeName.containsKey("Nomenclature")) {
			String actualColoumnValuesOfNomenClature = fetchingColoumns.get(storeName.get("Nomenclature")).getText()
					.trim();
			FetchColoumnValue.put("NomenClature", actualColoumnValuesOfNomenClature);
			isNomenclatureValid = true; // Valid if found
		}

		if (storeName.containsKey("Suppliers")) {
			String ActualColoumnValueforSuppliername = fetchingColoumns.get(storeName.get("Suppliers")).getText()
					.trim();
			FetchColoumnValue.put("Suppliers", ActualColoumnValueforSuppliername);
			isSupplierValid = true; // Valid if found
		}

		// If both Nomenclature and Suppliers are valid, check if Action column exists
		if (isNomenclatureValid && isSupplierValid && storeName.containsKey("Action")) {
			try {
				// Clicking on Edit icon inside the Action column (Using relative XPath)
				WebElement editLink = row.findElement(By.xpath("//*[@id='ohpDetails1']/tr[1]/td[6]/a[1]/span/i"));

				editLink.click();
				LoggerUtil.info("Clicked on Edit icon in OHP Master Action column");
				Thread.sleep(6000); // Wait after clicking, ideally replace with explicit wait
			} catch (Exception e) {
				LoggerUtil.error("Failed to click Edit icon: " + e.getMessage());
			}
		} else {
			LoggerUtil.info("Nomenclature or Supplier is not valid, or Action column not found. Edit click skipped.");
		}

		// Search for Supplier in another module
		OHPMaster_PageClass.ClickingOptionRightHandThreeOptions("Supplier");

		WebElement SearchSupplierNameInSuppleirmodule = driver.findElement(By.xpath("//input[@id='myInputSupplier']"));
		SearchSupplierNameInSuppleirmodule.sendKeys(EnetrSearchValue);

		List<WebElement> fetchingList = driver.findElements(FetchingSupplierNameList);
		boolean supplierFound = false; // To track if the supplier is found

		for (WebElement suppName : fetchingList) {
			// Get the visible supplier name (after trimming any extra spaces)
			String supp = suppName.getText().trim();

			// Normalize and compare supplier names (case-insensitive, trimmed)
			String normalizedSearchValue = EnetrSearchValue.trim().toLowerCase(); // Trim and convert to lowercase
			String normalizedSupplierName = supp.trim().toLowerCase(); // Normalize the supplier name

			if (normalizedSupplierName.contains(normalizedSearchValue)) {
				LoggerUtil.pass("Supplier Name Has Been Fetched Successfully: " + supp);

				// Now, select the checkbox corresponding to this supplier (if needed)
				WebElement checkbox = suppName.findElement(By.xpath("preceding-sibling::input[@type='checkbox']"));
				if (!checkbox.isSelected()) {
					checkbox.click(); // Click the checkbox to select it if not already checked
					LoggerUtil.pass("Supplier Checkbox Selected: " + supp);
				}

				supplierFound = true;
				break; // Stop the loop once the supplier is found
			}

			if (!supplierFound) {
				LoggerUtil.error("No Supplier Name Has Been Found");
				
				
			}

			// Log the table data
			LoggerUtil.info("---- OHP Master Table Data ----");
			for (String key : FetchColoumnValue.keySet()) {
				LoggerUtil.info(key + " = " + FetchColoumnValue.get(key));
			}
		}
	}

	public HashMap<String, String> StoredSupplierinfoVerifyEditButtons(String supplierCode, String supplierNode,
			String supplierlocation, String EnterEmailid, String EnterEmailid2, String Entermanagernamefield)
			throws InterruptedException {

		HashMap<String, String> StoredSupplierinfo = new HashMap<>();
		try {
			// Supplier Tab
			clickOnElement(SupplierMasterPage.suppliersecondtab);
			LoggerUtil.info("✅ Clicked on Supplier second tab");

			// Supplier Code
			clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suupliercode), supplierCode);
			LoggerUtil.info(" Entered Supplier Code: " + supplierCode);

			// Supplier Name
			clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suppliername), supplierNode);
			LoggerUtil.info(" Entered Supplier Name: " + supplierNode);

			// Supplier Location
			clearAndEnterText(waitForExpectedElement(SupplierMasterPage.supplerlocation), supplierlocation);
			LoggerUtil.info(" Entered Supplier Location: " + supplierlocation);

			// Business Domain
			clickOnElement(SupplierMasterPage.businnessdomaidropdown);
			clearAndEnterText(waitForExpectedElement(SupplierMasterPage.businessDomainSearch),
					DataProp.getProperty("BusinessSegment"));
			clickOnElement(SupplierMasterPage.businessDomainCheckBox);
			LoggerUtil.info(" Selected Business Domain: " + DataProp.getProperty("BusinessSegment"));

			// Business Segment
			clickOnElement(SupplierMasterPage.businesssegmentdropdown);
			clearAndEnterText(waitForExpectedElement(SupplierMasterPage.businesSegmentSearch), "sachindra1");
			clickOnElement(SupplierMasterPage.businessSegmentCheckBox);
			LoggerUtil.info(" Selected Business Segment: sachindra1");

			// Save Supplier
			WebElement clickingSavebtn = driver.findElement(By.xpath("//button[@onclick='savesupplier()']"));
			clickingSavebtn.click();
			LoggerUtil.info(" Clicked Save button for Supplier");

			Thread.sleep(7000);

			// Storing the correct values in the HashMap
			StoredSupplierinfo.put("SupplierCode", supplierCode); // Correct key-value pair
			StoredSupplierinfo.put("SupplierName", supplierNode);
			StoredSupplierinfo.put("SupplierLocation", supplierlocation);

			StoredSupplierinfo.put("BusinessSegment", "sachindra1");
			StoredSupplierinfo.put("BusinessDomain", "rishi");

		} catch (Exception e) {
			LoggerUtil.error("❌ Error during Supplier RM input process: " + e.getMessage());
		}

		return StoredSupplierinfo;
	}

	public static final By ClickingEditButtonSupplierMaster = By
			.xpath("//table[@id='example1']/descendant::i[@class='fas fa-edit']");
	By noMatchingRecordsMsg = By.xpath("//td[contains(@class,'dataTables_empty') and contains(text(),'No matching records')]");

	public void VerifyEditButtonFunctionality(String Enetrvalue,
	        HashMap<String, String> StoredSupplierinfo) throws InterruptedException {

	    Thread.sleep(10000);

	    clearAndEnterText(
	            waitForExpectedElement(SupplierMasterPage.EnterSearchValueInSupplierMaster),
	            Enetrvalue);

	    Thread.sleep(6000);

	    // 🔹 CASE 1: No matching records found → FAIL clearly
	    if (driver.findElements(noMatchingRecordsMsg).size() > 0) {

	        String noDataText = driver.findElement(noMatchingRecordsMsg).getText().trim();

	        LoggerUtil.fail(
	                "Supplier search failed. No matching records found for search value: "
	                        + Enetrvalue + " | Table message: " + noDataText);

	        return; // ❗ Stop execution – do NOT click Edit
	    }

	    // 🔹 CASE 2: Record found → proceed
	    LoggerUtil.info("Supplier record found for search value: " + Enetrvalue);

	    
	    // Click Edit button
	    clickOnElement(ClickingEditButtonSupplierMaster);
	    LoggerUtil.info("Clicking Edit Button");
	    Thread.sleep(5000);

	    // Fetch actual values
	    String ActualSupplierCode =
	            waitForExpectedElement(SupplierMasterPage.suupliercode)
	                    .getAttribute("value").trim();

	    String ActualSupplierName =
	            waitForExpectedElement(SupplierMasterPage.suppliername)
	                    .getAttribute("value").trim();

	    String ActualBusinessDomain =
	            waitForExpectedElement(SupplierMasterPage.businnessdomaidropdown)
	                    .getText().trim();

	    String ActualBusinessSeg =
	            waitForExpectedElement(SupplierMasterPage.businesssegmentdropdown)
	                    .getText().trim();

	    // 🔹 Comparisons (unchanged logic)
	    if (StoredSupplierinfo.get("SupplierCode").equals(ActualSupplierCode)) {
	        LoggerUtil.info("Correct Supplier Code: " + ActualSupplierCode);
	    } else {
	        LoggerUtil.mismatch("Supplier Code mismatch. Expected: "
	                + StoredSupplierinfo.get("SupplierCode")
	                + ", Actual: " + ActualSupplierCode);
	    }

	    if (StoredSupplierinfo.get("SupplierName").equals(ActualSupplierName)) {
	        LoggerUtil.info("Correct Supplier Name: " + ActualSupplierName);
	    } else {
	        LoggerUtil.mismatch("Supplier Name mismatch. Expected: "
	                + StoredSupplierinfo.get("SupplierName")
	                + ", Actual: " + ActualSupplierName);
	    }

	    if (StoredSupplierinfo.get("BusinessDomain").equals(ActualBusinessDomain)) {
	        LoggerUtil.info("Correct Business Domain: " + ActualBusinessDomain);
	    } else {
	        LoggerUtil.mismatch("Business Domain mismatch. Expected: "
	                + StoredSupplierinfo.get("BusinessDomain")
	                + ", Actual: " + ActualBusinessDomain);
	    }

	    if (StoredSupplierinfo.get("BusinessSegment").equals(ActualBusinessSeg)) {
	        LoggerUtil.info("Correct Business Segment: " + ActualBusinessSeg);
	    } else {
	        LoggerUtil.mismatch("Business Segment mismatch. Expected: "
	                + StoredSupplierinfo.get("BusinessSegment")
	                + ", Actual: " + ActualBusinessSeg);
	    }
	}


	public static final By clickingSubmitBtnpopup = By.xpath("//button[@id='btnsubmit']");
	public static final By clickingUpdateBtnSupplierMaster = By.xpath("//button[@id='btnUpdate']");

	public void UpdateButtonFuctionality(String supplierCode, String supplierNode,
	        HashMap<String, String> StoredSupplierinfo) throws InterruptedException {

	    clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suupliercode), supplierCode);
	    LoggerUtil.pass("Entered Supplier Code: " + supplierCode);

	    clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suppliername), supplierNode);
	    LoggerUtil.pass("Entered Supplier Name: " + supplierNode);

	    clickOnElement(clickingUpdateBtnSupplierMaster);
	    Thread.sleep(2000);

	   

	    // 🔍 Search updated supplier
	    clearAndEnterText(
	            waitForExpectedElement(SupplierMasterPage.EnterSearchValueInSupplierMaster),
	            supplierNode);

	    Thread.sleep(4000);

	    // 🔴 GUARD CONDITION – No matching records
	    if (driver.findElements(noMatchingRecordsMsg).size() > 0) {

	        String noDataText = driver.findElement(noMatchingRecordsMsg).getText().trim();

	        LoggerUtil.fail(
	                "Update verification failed. Supplier not found after update."
	                        + " Search value: " + supplierNode
	                        + " | Table message: " + noDataText);

	        return; // ⛔ Stop execution here
	    }

	    // ✅ Record found → proceed
	    LoggerUtil.info("Supplier record found after update for search value: " + supplierNode);

	    // Click Edit button
	    clickOnElement(ClickingEditButtonSupplierMaster);
	    Thread.sleep(5000);

	    // Fetch actual values
	    String ActualSupplierCode =
	            waitForExpectedElement(SupplierMasterPage.suupliercode)
	                    .getAttribute("value").trim();

	    String ActualSupplierName =
	            waitForExpectedElement(SupplierMasterPage.suppliername)
	                    .getAttribute("value").trim();

	    String ActualBusinessDomain =
	            waitForExpectedElement(SupplierMasterPage.businnessdomaidropdown)
	                    .getText().trim();

	    String ActualBusinessSeg =
	            waitForExpectedElement(SupplierMasterPage.businesssegmentdropdown)
	                    .getText().trim();

	    // Comparisons
	    if (StoredSupplierinfo.get("SupplierCode").equals(ActualSupplierCode)) {
	        LoggerUtil.info("Correct Supplier Code: " + ActualSupplierCode);
	    } else {
	        LoggerUtil.mismatch("Supplier Code mismatch. Expected: "
	                + StoredSupplierinfo.get("SupplierCode")
	                + ", Actual: " + ActualSupplierCode);
	    }

	    if (StoredSupplierinfo.get("SupplierName").equals(ActualSupplierName)) {
	        LoggerUtil.info("Correct Supplier Name: " + ActualSupplierName);
	    } else {
	        LoggerUtil.mismatch("Supplier Name mismatch. Expected: "
	                + StoredSupplierinfo.get("SupplierName")
	                + ", Actual: " + ActualSupplierName);
	    }

	    if (StoredSupplierinfo.get("BusinessDomain").equals(ActualBusinessDomain)) {
	        LoggerUtil.info("Correct Business Domain: " + ActualBusinessDomain);
	    } else {
	        LoggerUtil.mismatch("Business Domain mismatch. Expected: "
	                + StoredSupplierinfo.get("BusinessDomain")
	                + ", Actual: " + ActualBusinessDomain);
	    }

	    if (StoredSupplierinfo.get("BusinessSegment").equals(ActualBusinessSeg)) {
	        LoggerUtil.info("Correct Business Segment: " + ActualBusinessSeg);
	    } else {
	        LoggerUtil.mismatch("Business Segment mismatch. Expected: "
	                + StoredSupplierinfo.get("BusinessSegment")
	                + ", Actual: " + ActualBusinessSeg);
	    }
	}

	public static final By clickingSaveAsNewBtnSupplierMaster = By.xpath("//button[@id='btnSaveAsNew']");

	public void SaveAsNewButtonFuctionality(String supplierCode, String supplierNode,
	        HashMap<String, String> StoredSupplierinfo) throws InterruptedException {

	    HashMap<String, String> StoredNewValue = new HashMap<>();

	    LoggerUtil.info("===== Starting Save As New Button Functionality =====");

	    // ----------------------------------------------------
	    // Step 1: Enter Supplier Code
	    // ----------------------------------------------------
	    clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suupliercode), supplierCode);
	    LoggerUtil.info("Entered Supplier Code: " + supplierCode);

	    // ----------------------------------------------------
	    // Step 2: Enter Supplier Name
	    // ----------------------------------------------------
	    clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suppliername), supplierNode);
	    LoggerUtil.info("Entered Supplier Name: " + supplierNode);

	    StoredNewValue.put("New Supplier Code", supplierCode);
	    StoredNewValue.put("New Supplier Name", supplierNode);

	    Thread.sleep(9000);

	    // ----------------------------------------------------
	    // Step 3: Click Save As New
	    // ----------------------------------------------------
	    clickOnElement(clickingSaveAsNewBtnSupplierMaster);
	    Thread.sleep(2000);

	    // ----------------------------------------------------
	    // Step 4: Capture Toast Message
	    // ----------------------------------------------------
	    String actualToastmsg = waitForExpectedElement(toastMessage).getText().trim();
	    LoggerUtil.info("Toast Message after Save As New → " + actualToastmsg);

	    // ----------------------------------------------------
	    // Step 5: VERIFY TABLE / SEARCH INPUT AVAILABILITY
	    // (Known bug handling – do not proceed if table not loaded)
	    // ----------------------------------------------------
	    Thread.sleep(6000);

	    if (driver.findElements(SupplierMasterPage.EnterSearchValueInSupplierMaster).isEmpty()) {

	        LoggerUtil.error(
	                "KNOWN ISSUE: Supplier table/search input not loaded after Save As New. "
	              + "User cannot proceed further. Exiting method safely.");

	        return; // ⛔ EXIT – no Edit / validation possible
	    }

	    // ----------------------------------------------------
	    // Step 6: Enter search value (SAFE)
	    // ----------------------------------------------------
	    clearAndEnterText(
	            waitForExpectedElement(SupplierMasterPage.EnterSearchValueInSupplierMaster),
	            supplierNode);

	    Thread.sleep(4000);

	    // ----------------------------------------------------
	    // Step 7: Check if record exists before Edit
	    // ----------------------------------------------------
	    if (driver.findElements(noMatchingRecordsMsg).size() > 0) {

	        String noDataText = driver.findElement(noMatchingRecordsMsg).getText().trim();
	        LoggerUtil.fail(
	                "Supplier not found after Save As New. Search value: "
	              + supplierNode + " | Table message: " + noDataText);

	        return; // ⛔ EXIT
	    }

	    // ----------------------------------------------------
	    // Step 8: Click Edit Button
	    // ----------------------------------------------------
	    clickOnElement(ClickingEditButtonSupplierMaster);
	    LoggerUtil.info("Clicked Edit Button after Save As New");
	    Thread.sleep(5000);

	    // ----------------------------------------------------
	    // Step 9: Fetch actual values
	    // ----------------------------------------------------
	    String ActualSupplierCode =
	            waitForExpectedElement(SupplierMasterPage.suupliercode)
	                    .getAttribute("value").trim();

	    String ActualSupplierName =
	            waitForExpectedElement(SupplierMasterPage.suppliername)
	                    .getAttribute("value").trim();

	    String ActualBusinessDomain =
	            waitForExpectedElement(SupplierMasterPage.businnessdomaidropdown)
	                    .getText().trim();

	    String ActualBusinessSeg =
	            waitForExpectedElement(SupplierMasterPage.businesssegmentdropdown)
	                    .getText().trim();

	    // ----------------------------------------------------
	    // Step 10: Validation (unchanged)
	    // ----------------------------------------------------
	    validateAndLog("Supplier Code",
	            StoredNewValue.get("New Supplier Code"), ActualSupplierCode);

	    validateAndLog("Supplier Name",
	            StoredNewValue.get("New Supplier Name"), ActualSupplierName);

	    validateAndLog("Business Domain",
	            StoredSupplierinfo.get("BusinessDomain"), ActualBusinessDomain);

	    validateAndLog("Business Segment",
	            StoredSupplierinfo.get("BusinessSegment"), ActualBusinessSeg);

	    LoggerUtil.info("===== Save As New Button Functionality Completed =====");
	}

	/**
	 * Common reusable validation for report logging
	 */
	private void validateAndLog(String fieldName, String expected, String actual) {
		if (expected != null && expected.equals(actual)) {
			LoggerUtil.pass("PASS - " + fieldName + " matched. Expected & Actual: " + expected);
		} else {
			LoggerUtil.mismatch("FAIL - " + fieldName + " mismatch. Expected: " + expected + ", Actual: " + actual);
		}

	}

	public static final By clickingResetButton = By.xpath("//button[@onclick='resetAllControls()']");

	public void VerifyResetButtonFunctionality(String supplierCode, String supplierNode, String supplierlocation)
			throws InterruptedException {

		clickOnElement(SupplierMasterPage.suppliersecondtab);
		LoggerUtil.info(" Clicked on Supplier second tab");

		// Supplier Code
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suupliercode), supplierCode);
		LoggerUtil.info(" Entered Supplier Code: " + supplierCode);

		// Supplier Name
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.suppliername), supplierNode);
		LoggerUtil.info(" Entered Supplier Name: " + supplierNode);

		// Supplier Location
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.supplerlocation), supplierlocation);
		LoggerUtil.info(" Entered Supplier Location: " + supplierlocation);

		// Business Domain
		clickOnElement(SupplierMasterPage.businnessdomaidropdown);
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.businessDomainSearch), "rishi");
		clickOnElement(SupplierMasterPage.businessDomainCheckBox);
		LoggerUtil.info(" Selected Business Domain: rishi");

		// Business Segment
		clickOnElement(SupplierMasterPage.businesssegmentdropdown);
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.businesSegmentSearch), "sachindra1");
		clickOnElement(SupplierMasterPage.businessSegmentCheckBox);
		LoggerUtil.info(" Selected Business Segment: sachindra1");

		Thread.sleep(8000);
		clickOnElement(clickingResetButton);

		// wait.until(ExpectedConditions.visibilityOfElementLocated(SupplierMasterPage.suupliercode));
		String actualCodevalue = waitForExpectedElement(SupplierMasterPage.suupliercode).getAttribute("value");
		String ActualSuppname = waitForExpectedElement(SupplierMasterPage.suppliername).getAttribute("value");

		String ActualSuppLocatiom = waitForExpectedElement(SupplierMasterPage.supplerlocation).getAttribute("value");
		String ActualBusinessDomainName = waitForExpectedElement(SupplierMasterPage.businnessdomaidropdown).getText();

		verifyResetButtonFunctionality("Supplier Code", "", actualCodevalue);
		verifyResetButtonFunctionality("Supplier Name", "", ActualSuppname);
		verifyResetButtonFunctionality("Supplier Location", "", ActualSuppLocatiom);
		verifyResetButtonFunctionality("Business Domain", "None Selected", ActualBusinessDomainName);

	}

	private void verifyResetButtonFunctionality(String fieldName, String expectedValue, String actualValue) {
		// Normalize nulls
		if (expectedValue == null)
			expectedValue = "";
		if (actualValue == null)
			actualValue = "";

		// Special handling for dropdowns
		if ("None Selected".equals(expectedValue)) {
			expectedValue = "None Selected";
		}
		if ("None Selected".equals(actualValue)) {
			actualValue = "None Selected";
		}

		// Compare
		boolean isMatching = expectedValue.equals(actualValue);

		if (isMatching) {
			LoggerUtil.pass(fieldName + " -> Actual Value: [" + actualValue + "] is Equal to Expected Value: ["
					+ expectedValue + "]");
		} else {
			LoggerUtil.mismatch(
					fieldName + " -> Mismatch! Expected: [" + expectedValue + "], Actual: [" + actualValue + "]");
		}
	}

	public void ExportSupplierexcelfile(HashMap<String, Integer> ColoumnsName) throws InterruptedException {

		clickOnElement(SupplierMasterPage.clickexporandimporttbtn);
		Thread.sleep(2000);
		clickOnElement(SupplierMasterPage.exportbtn);
		Thread.sleep(15000);
		getLatestSupplierMasterFile();

		VerifyReadHeaderNameExcelFileOfSupplierMaster(ColoumnsName);

	}

	private void VerifyReadHeaderNameExcelFileOfSupplierMaster(HashMap<String, Integer> uiHeadersMap) {
		File file = getLatestSupplierMasterFile();
		if (file == null) {
			LoggerUtil.mismatch("❌ No SupplierMaster file found in downloads folder.");
			return;
		}

		String expectedSheetName = "Supplier List";
		int headerRowIndex = 1; // Excel header row index
		List<String> excelHeaders = ExcelUtil.readAndVerifySheetAndColumns(file.getAbsolutePath(), expectedSheetName,
				headerRowIndex);

		LoggerUtil.pass(" Sheet name verified: " + expectedSheetName);

		// Convert UI map keys into a list (ordered by index)
		List<String> uiHeaders = new ArrayList<>(uiHeadersMap.size());
		for (int i = 0; i < uiHeadersMap.size(); i++) {
			String headerName = "";
			for (Map.Entry<String, Integer> entry : uiHeadersMap.entrySet()) {
				if (entry.getValue() == i) {
					headerName = entry.getKey();
					break;
				}
			}
			uiHeaders.add(headerName);
		}

		// Compare counts
		if (uiHeaders.size() != excelHeaders.size()) {
			LoggerUtil.mismatch(
					" Header count mismatch. UI Count: " + uiHeaders.size() + ", Excel Count: " + excelHeaders.size());
		}

		// Compare headers one by one (order-sensitive)
		for (int i = 0; i < Math.min(uiHeaders.size(), excelHeaders.size()); i++) {
			String uiHeader = uiHeaders.get(i).trim();
			String excelHeader = excelHeaders.get(i).trim();

			if (uiHeader.equalsIgnoreCase(excelHeader)) {
				LoggerUtil.pass("Header[" + (i + 1) + "] matched: UI=[" + uiHeader + "], Excel=[" + excelHeader + "]");
			} else {
				LoggerUtil.mismatch(
						"Header[" + (i + 1) + "] mismatch. UI=[" + uiHeader + "], Excel=[" + excelHeader + "]");
			}
		}
	}

	public static final By FethcinHeaderRowSupplierPage = By.xpath("//table[@id='example1']/thead/tr");

	public HashMap<String, Integer> ReadTableAndMatchWithExcelSheet() {

		WebElement headerRow = driver.findElement(FethcinHeaderRowSupplierPage);
		List<WebElement> fetchColoumnsName = headerRow.findElements(By.tagName("th"));
		HashMap<String, Integer> ColoumnsName = new HashMap<String, Integer>();
		for (int i = 0; i < fetchColoumnsName.size(); i++) {

			String ActualNames = fetchColoumnsName.get(i).getText().trim();

			ColoumnsName.put(ActualNames, i);

		}

		System.out.println(ColoumnsName);

		return ColoumnsName;
	}

	public void exportandimportnewdata(HashMap<String, Integer> ColoumnsName) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		LoggerUtil.info(" Clicking on Export & Import button.");
		clickOnElement(SupplierMasterPage.clickexporandimporttbtn);

		LoggerUtil.info("Clicking on 'Export Master Allocation - New Supplier'.");
		clickOnElement(SupplierMasterPage.exportmasterallocationnewsupplire);

		Thread.sleep(6000);
		LoggerUtil.info("Selecting dropdown while exporting new Excel file.");
		clickOnElement(SupplierMasterPage.clickdropdwnwhileexportingnewexcelfile);

		LoggerUtil.info("Entering data in dropdown → 141235");
		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.enterdatadropdownvalue), "141235");

		LoggerUtil.info("Selecting 'All' option in dropdown.");
		clickOnElement(SupplierMasterPage.clickdropdiwnselectallwhileexportingnewfile);

		LoggerUtil.info("Selecting yearly checkbox.");
		clickOnElement(SupplierMasterPage.clickyearlycheckboxwhileExportingnewData);

		Thread.sleep(10000);

//		wait.until(
//				ExpectedConditions.elementToBeClickable(SupplierMasterPage.clickfirstDropdownwhileExpoertingnewfile));
		LoggerUtil.info("Selecting first dropdown value (Material = CRCA-007).");
		clickOnElement(SupplierMasterPage.clickfirstDropdownwhileExpoertingnewfile);

		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.entervalueinfirstdropdown), "CRCA-007");
		clickOnElement(SupplierMasterPage.clickfirstvalueindropdown);

//		wait.until(
//				ExpectedConditions.elementToBeClickable(SupplierMasterPage.clicksecondDropdownwhileExportingNewfile));
		LoggerUtil.info("Selecting second dropdown value (Process = Process-1).");
		clickOnElement(SupplierMasterPage.clicksecondDropdownwhileExportingNewfile);

		// clickOnElement(SupplierMasterPage.clicksecondDropdownwhileExportingNewfile);

		clearAndEnterText(waitForExpectedElement(SupplierMasterPage.searchvalueforsecoddropdown), "Process-1");
		Thread.sleep(1000);
		// wait.until(ExpectedConditions.elementToBeClickable(SupplierMasterPage.clickseconddropdownvalue));
		clickOnElement(SupplierMasterPage.clickseconddropdownvalue);
		Thread.sleep(2000);
		LoggerUtil.info("Selecting third dropdown value.");
		clickOnElement(SupplierMasterPage.clickthirdDropdownwhileExportingNewfile);
		Thread.sleep(2000);
		clickOnElement(SupplierMasterPage.clickthirdvalue);
		Thread.sleep(2000);

		LoggerUtil.info("Clicking on Export button.");
		clickOnElement(SupplierMasterPage.exportbtn);
		Thread.sleep(2000);

		Thread.sleep(15000);

		clickOnElement(By.xpath("//button[contains(text(),'Export/Import')]"));
		Thread.sleep(2000);
		clickOnElement(By.xpath("//button[contains(text(),'Export/Import')]"));
		Thread.sleep(2000);
		clickOnElement(By.id("newsup"));
		Thread.sleep(2000);
		getLatestSupplierMasterFile();

		VerifyReadHeaderNameExcelFileOfSupplierMasteForNewFiler(ColoumnsName);

		fillSupplierSheet();

	}

	private void VerifyReadHeaderNameExcelFileOfSupplierMasteForNewFiler(HashMap<String, Integer> uiHeadersMap) {
		File file = getLatestSupplierMasterFile();
		if (file == null) {
			LoggerUtil.mismatch("❌ No SupplierMaster file found in downloads folder.");
			return;
		}

		String expectedSheetName = "Supplier List";
		int headerRowIndex = 1; // Excel header row index
		List<String> excelHeaders = ExcelUtil.readAndVerifySheetAndColumns(file.getAbsolutePath(), expectedSheetName,
				headerRowIndex);

		LoggerUtil.pass("✅ Sheet name verified: " + expectedSheetName);

		// Convert UI map keys into a list (ordered by index)
		List<String> uiHeaders = new ArrayList<>(uiHeadersMap.size());
		for (int i = 0; i < uiHeadersMap.size(); i++) {
			String headerName = "";
			for (Map.Entry<String, Integer> entry : uiHeadersMap.entrySet()) {
				if (entry.getValue() == i) {
					headerName = entry.getKey();
					break;
				}
			}
			uiHeaders.add(headerName);
		}

		// Compare counts (but do not stop execution)
		if (uiHeaders.size() != excelHeaders.size()) {
			LoggerUtil.mismatch(
					"⚠ Header count mismatch. UI Count: " + uiHeaders.size() + ", Excel Count: " + excelHeaders.size());
		}

		// Compare headers where both UI and Excel exist
		int minCount = Math.min(uiHeaders.size(), excelHeaders.size());
		for (int i = 0; i < minCount; i++) {
			String uiHeader = uiHeaders.get(i).trim();
			String excelHeader = excelHeaders.get(i).trim();

			if (uiHeader.equalsIgnoreCase(excelHeader)) {
				LoggerUtil.pass("Header[" + (i + 1) + "] matched: UI=[" + uiHeader + "], Excel=[" + excelHeader + "]");
			} else {
				LoggerUtil.mismatch(
						"Header[" + (i + 1) + "] mismatch. UI=[" + uiHeader + "], Excel=[" + excelHeader + "]");
			}
		}

		// Extra Excel headers beyond UI count
		if (excelHeaders.size() > uiHeaders.size()) {
			for (int i = uiHeaders.size(); i < excelHeaders.size(); i++) {
				LoggerUtil.mismatch(
						"Header[" + (i + 1) + "] present in Excel only: [" + excelHeaders.get(i).trim() + "]");
			}
		}

		// Extra UI headers beyond Excel count
		if (uiHeaders.size() > excelHeaders.size()) {
			for (int i = excelHeaders.size(); i < uiHeaders.size(); i++) {
				LoggerUtil.mismatch("Header[" + (i + 1) + "] present in UI only: [" + uiHeaders.get(i).trim() + "]");
			}
		}
	}

	public String fillSupplierSheet() {
		LoggerUtil.info("STEP 1: Fetching latest Supplier Master Excel file.");

		HashMap<String, String> StoreExcelData = new HashMap<String, String>();

		File latestFile = getLatestSupplierMasterFile();
		if (latestFile == null) {
			LoggerUtil.fail("No Supplier Master file found in downloads directory.");
			return null;
		}

		String filePath = latestFile.getAbsolutePath();
		LoggerUtil.info("Latest Supplier Master file found: " + filePath);

		try {

			String supplierCode = faker.number().digits(4);
			String supplierName = faker.name().lastName();
			String supplierLocation = faker.country().capital();
			String businessDomain = "rishi123";
			String rm = "Yes";
			String process = "Yes";

			LoggerUtil.info("STEP 2: Writing supplier data → Code: " + supplierCode + ", Name: " + supplierName
					+ ", Location: " + supplierLocation + ", Domain: " + businessDomain + ", RM: " + rm + ", Process: "
					+ process);

			// Fill Excel
			ExcelFiller.setCellValue(filePath, 0, 2, 1, ExcelFiller.ValueType.STRING, Arrays.asList(supplierCode));
			ExcelFiller.setCellValue(filePath, 0, 2, 2, ExcelFiller.ValueType.STRING, Arrays.asList(supplierName));
			ExcelFiller.setCellValue(filePath, 0, 2, 3, ExcelFiller.ValueType.STRING, Arrays.asList(supplierLocation));
			ExcelFiller.setCellValue(filePath, 0, 2, 4, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(businessDomain));
			ExcelFiller.setCellValue(filePath, 0, 2, 6, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(rm));
			ExcelFiller.setCellValue(filePath, 0, 2, 7, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(process));
			ExcelFiller.setCellValue(filePath, 0, 2, 8, ExcelFiller.ValueType.DROPDOWN, Arrays.asList("Yes"));

			StoreExcelData.put("Supplier Code", supplierCode);
			StoreExcelData.put("Supplier Name", supplierName);
			StoreExcelData.put("Supplier Location ", supplierLocation);
			StoreExcelData.put("Business Domain", businessDomain);
			StoreExcelData.put("Rm", rm);
			StoreExcelData.put("Process", process);

			return latestFile.getName();

		} catch (Exception e) {
			LoggerUtil.error("Error occurred while filling Supplier Excel Sheet → " + e.getMessage());
			LoggerUtil.fail("Failed to update Supplier Master Excel file: " + latestFile.getName());
			return null;
		}

	}

	public void importNewSupplierMasterExcel() throws InterruptedException, IOException, AWTException {

		File latestFile = Base.getLatestSupplierMasterFile();
		if (latestFile == null) {

			LoggerUtil.error(" No Group Delta file found for upload.");
			return;
		}
		String fullPath = latestFile.getAbsolutePath();
		Thread.sleep(3000);
		ExcelUtil.openSaveCloseExcelFile(fullPath);

		LoggerUtil.info("Excel file ready for import: " + fullPath);

		try {
			LoggerUtil.info("STEP 2: Locating Excel upload input element (id=excelUploadSup).");
			WebElement fileInput = driver.findElement(By.id("excelUploadSup"));

			LoggerUtil.info("STEP 3: Making file input visible via JavaScript.");
			((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

			LoggerUtil.info("STEP 4: Uploading file → " + fullPath);
			fileInput.sendKeys(fullPath);

			LoggerUtil.info("STEP 5: Waiting for processing...");
			Thread.sleep(5000);

			final String expectedToast = "File imported successfully";
			String actualToast = "(toast not found)";

			try {
				LoggerUtil.info("STEP 6: Capturing import toast message for report.");
				actualToast = waitForExpectedElement(SupplierMasterPage.ImportToastMsgSupplierPage).getText().trim();
				LoggerUtil.info("Toast captured → \"" + actualToast + "\"");

				if (expectedToast.equalsIgnoreCase(actualToast)) {
					LoggerUtil.pass("Toast validation PASSED | Expected: \"" + expectedToast + "\" | Actual: \""
							+ actualToast + "\"");
				} else {
					LoggerUtil.fail("Toast validation FAILED | Expected: \"" + expectedToast + "\" | Actual: \""
							+ actualToast + "\"");
				}
			} catch (Exception toastEx) {
				LoggerUtil.error("Toast capture failed: " + toastEx.getMessage());
				LoggerUtil.fail("Toast validation SKIPPED | Expected: \"" + expectedToast + "\" | Actual: \""
						+ actualToast + "\"");
			}

			try {
				((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'none';", fileInput);
			} catch (Exception ignore) {
				// ignore
			}

			LoggerUtil.pass("Supplier Master Excel import flow completed for file → " + fullPath);
		} catch (Exception e) {
			LoggerUtil.error("Error during Supplier Master Excel import: " + e.getMessage());
			LoggerUtil.fail("Failed to import Supplier Master Excel file → " + fullPath);
		}

		LoggerUtil.info("===== SUPPLIER MASTER IMPORT: END =====");
	}

	public static final By VerifyTableHeaderNameForBusinessSegmentAndDomain = By
			.xpath("//table[@id='businessdomainSegmentsTable']/thead/tr");

	public static final By FetchingTableRowBusinessDomainAndSegMent = By
			.xpath("//table[@id='businessdomainSegmentsTable']/tbody/tr[1]");

	public static final By EnterValueSearchBoxForBusinessDomainAndSegMentPage = By
			.xpath("//input[@aria-controls='businessdomainSegmentsTable']");

	public HashMap<String, String> VerifyDataSaveOrNotInBusinessDomainAndSegMent(String EnterValueSearchBox) {

		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForBusinessDomainAndSegMentPage),
				EnterValueSearchBox);

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(15));

		WebElement row = driver.findElement(VerifyTableHeaderNameForBusinessSegmentAndDomain);

		List<WebElement> headersColoumnName = row.findElements(By.tagName("th"));

		HashMap<String, Integer> storedColoumnName = new HashMap<>();

		for (int i = 0; i < headersColoumnName.size(); i++) {

			String coloumnName = headersColoumnName.get(i).getText().trim();
			storedColoumnName.put(coloumnName, i);
		}

		System.out.println("Header Map: " + storedColoumnName);

		WebElement tableRow = driver.findElement(FetchingTableRowBusinessDomainAndSegMent);
		List<WebElement> coloumnsValue = tableRow.findElements(By.tagName("td"));

		HashMap<String, String> actualValues = new HashMap<>();

		if (storedColoumnName.containsKey("Category Type")) {
			int index = storedColoumnName.get("Category Type");
			String categoryTypeValue = coloumnsValue.get(index).getText().trim();
			actualValues.put("Category Type", categoryTypeValue);
			System.out.println("Category Type = " + categoryTypeValue);
		} else {
			System.out.println(" Column 'Category Type' not found in table header!");
		}

		if (storedColoumnName.containsKey("Category Name")) {
			int index = storedColoumnName.get("Category Name");
			String categoryNameValue = coloumnsValue.get(index).getText().trim();
			actualValues.put("Category Name", categoryNameValue);
			System.out.println("Category Name = " + categoryNameValue);
		} else {
			System.out.println(" Column 'Category Name' not found in table header!");
		}

		return actualValues;
	}

	public static final By FetchingDropdownOption = By.xpath("");
	public static final By ClickingResetButtonBusinessDomainAndSegmentTab = By
			.xpath("//button[@onclick='resetbusinessDomainSegments()']");

	public void VerifyResetButtonFunctionality(String categoryname) throws InterruptedException {

		Thread.sleep(3000);
		LoggerUtil.info("Step 2: Selecting Business Segment dropdown value");
		Supplier.businesssegmentSelectDropdownByValue();

		LoggerUtil.info("Step 3: Entering category name: " + categoryname);
		clearAndEnterText(waitForExpectedElement(Supplier.enetrcategoryname), categoryname);

		LoggerUtil.info("Step 4: Entering value in Search Box: " + categoryname);
		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForBusinessDomainAndSegMentPage), categoryname);

		LoggerUtil.info("Step 5: Capturing values before reset");
		WebElement BusinessDomainAndSegmentdropdown = waitForExpectedElement(
				Supplier.CategoryTypeDropdownBusinessSegAndDomain);
		Select drodoption = new Select(BusinessDomainAndSegmentdropdown);

		String categoryTypeValue = drodoption.getFirstSelectedOption().getText().trim();
		String categoryNameValue = waitForExpectedElement(Supplier.enetrcategoryname).getAttribute("value");
		String SearchBox = waitForExpectedElement(EnterValueSearchBoxForBusinessDomainAndSegMentPage)
				.getAttribute("value");

		LoggerUtil.info("Captured Before Reset → CategoryType: " + categoryTypeValue + " | CategoryName: "
				+ categoryNameValue + " | SearchBox: " + SearchBox);

		LoggerUtil.info("Step 6: Clicking Reset Button");
		clickOnElement(ClickingResetButtonBusinessDomainAndSegmentTab);

		LoggerUtil.info("Step 7: Capturing values after reset");
		String ActualcategoryTypeValue = drodoption.getFirstSelectedOption().getText().trim();
		String ActualcategoryNameValue = waitForExpectedElement(Supplier.enetrcategoryname).getAttribute("value");
		String ActualSearchBox = waitForExpectedElement(EnterValueSearchBoxForBusinessDomainAndSegMentPage)
				.getAttribute("value");

		LoggerUtil.info("Captured After Reset → CategoryType: " + ActualcategoryTypeValue + " | CategoryName: "
				+ ActualcategoryNameValue + " | SearchBox: " + ActualSearchBox);

		LoggerUtil.info("Step 8: Verifying reset functionality for each field");
		verifyResetButtonFunctionalityForBusinessDomainAndSegMent("Category Type", "Select", ActualcategoryTypeValue);
		verifyResetButtonFunctionalityForBusinessDomainAndSegMent("Category Name", "", ActualcategoryNameValue);
		verifyResetButtonFunctionalityForBusinessDomainAndSegMent("Search Box", "", ActualSearchBox);

		LoggerUtil.pass(" Reset Button functionality verified successfully.");
	}

	private void verifyResetButtonFunctionalityForBusinessDomainAndSegMent(String fieldName, String expectedValue,
			String actualValue) {
		// Normalize nulls
		if (expectedValue == null)
			expectedValue = "";
		if (actualValue == null)
			actualValue = "";

		// Special handling for dropdowns
		if ("Select".equals(expectedValue)) {
			expectedValue = "Select";
		}
		if ("Select".equals(actualValue)) {
			actualValue = "Select";
		}

		// Compare
		boolean isMatching = expectedValue.equals(actualValue);

		if (isMatching) {
			LoggerUtil.pass(fieldName + " -> Actual Value: [" + actualValue + "] is Equal to Expected Value: ["
					+ expectedValue + "]");
		} else {
			LoggerUtil.mismatch(
					fieldName + " -> Mismatch! Expected: [" + expectedValue + "], Actual: [" + actualValue + "]");
		}
	}

	// MK-18102
	public static final By clickingDeleteBtnBusinessDomainAndSegmentTab = By
			.xpath("//table[@id='businessdomainSegmentsTable']/tbody/tr/td/a/i[@class='fas fa-trash-o']");

	public void VerifyDeleteCastingData(String entercategoryname, String ExpectedMessage) throws InterruptedException {

		Thread.sleep(2000); // Adding a small wait before entering text
		LoggerUtil.info("Step 1: Entering category name in Search Box: " + entercategoryname);
		clearAndEnterText(waitForExpectedElement(EnterSearchboxForBusinessSegAndDomainTab), entercategoryname);
		Thread.sleep(2000);
		LoggerUtil.info("Step 2: Waiting for Delete button(s) to be visible");

		LoggerUtil.info("Step 3: Clicking first Delete button from the list");
		List<WebElement> deleteButtons = driver.findElements(clickingDeleteBtnBusinessDomainAndSegmentTab);
		WebElement deleteBtn = deleteButtons.get(0);
		deleteBtn.click();
		Thread.sleep(2000);
		LoggerUtil.info("Step 4: Capturing alert text before accepting");
		String alertText = driver.switchTo().alert().getText();
		LoggerUtil.info(" Alert message displayed: " + alertText);

		LoggerUtil.info("Step 5: Accepting the alert");
		driver.switchTo().alert().accept();

		LoggerUtil.pass(" Delete casting data flow executed successfully for Category Name: " + entercategoryname);

		// Capturing the actual message displayed in the toast
		String ActualMsgToast = waitForExpectedElement(Supplier.toastmessage).getText();

		// Log the actual and expected messages for better visibility
		LoggerUtil.info("Actual message displayed in toast: " + ActualMsgToast);
		LoggerUtil.info("Expected message: " + ExpectedMessage);

		// Print the message to the console as well
		System.out.println("Actual message: " + ActualMsgToast);
		System.out.println("Expected message: " + ExpectedMessage);

		// Assert the expected and actual messages match
		Assert.assertTrue(ActualMsgToast.contains(ExpectedMessage),
				"Toast message doesn't match. Actual: " + ActualMsgToast + ", Expected: " + ExpectedMessage);
	}

	public void SaveNewCustomer(String custCode, String custNode, String custlocation, String ExpectedToast)
	        throws InterruptedException {

	    LoggerUtil.info("Step 1: Entering Customer Code: " + custCode);
	    clearAndEnterText(waitForExpectedElement(CustomerMasterPage.customercode), custCode);

	    LoggerUtil.info("Step 2: Entering Customer Name: " + custNode);
	    clearAndEnterText(waitForExpectedElement(CustomerMasterPage.customername), custNode);

	    LoggerUtil.info("Step 3: Entering Customer Location: " + custlocation);
	    clearAndEnterText(waitForExpectedElement(CustomerMasterPage.customerlocation), custlocation);

	    LoggerUtil.info("Step 4: Selecting Business Domain");
	    clickOnElement(CustomerMasterPage.businnessdomaidropdown);
	    clearAndEnterText(waitForExpectedElement(CustomerMasterPage.businessDomainSearch), "rishi");
	    clickOnElement(CustomerMasterPage.businessDomainCheckBox);

	    LoggerUtil.info("Step 5: Selecting Business Segment");
	    clickOnElement(CustomerMasterPage.businesssegmentdropdown);
	    clearAndEnterText(waitForExpectedElement(CustomerMasterPage.businesSegmentSearch), "sachindra1");
	    clickOnElement(CustomerMasterPage.businessSegmentCheckBox);

	    Thread.sleep(9000);

	    LoggerUtil.info("Step 6: Clicking Save button on Customer Page");
	    clickOnElement(CustomerMasterPage.savebuttoncustomerpage);

	    LoggerUtil.info("Step 7: Waiting for toast message");
	    WebElement toastElement = waitForExpectedElement(CustomerMasterPage.toastmessage);
	    String actualToast = toastElement.getText().trim();

	    LoggerUtil.info("Actual Toast Message: " + actualToast);
	    LoggerUtil.info("Expected Toast Message: " + ExpectedToast);

	    // ✅ Conditional validation instead of Assert
	    if (actualToast.contains(ExpectedToast)) {

	        LoggerUtil.pass(
	                "Customer data entered and saved successfully → Code: " + custCode +
	                ", Name: " + custNode +
	                ", Location: " + custlocation
	        );

	    } else {

	        LoggerUtil.fail(
	                "Customer save failed. Toast message mismatch. " +
	                "Expected: [" + ExpectedToast + "] | Actual: [" + actualToast + "]"
	        );

	        
	    }
	}


	public static final By EnterValueSearchBox = By.xpath("//div[@id='example1_filter']//input");
	public static final By HeaderRow = By.xpath("//table[@id='example1']/thead/tr");
	public static final By TableRow = By.xpath("//table[@id='example1']/tbody/tr");
	
	public static boolean isSearchBoxAvailable(By searchBoxLocator, int timeoutSeconds) {
	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(timeoutSeconds));
	        wait.until(ExpectedConditions.presenceOfElementLocated(searchBoxLocator));
	        return driver.findElement(searchBoxLocator).isDisplayed();
	    } catch (Exception e) {
	        return false;
	    }
	}

	public static HashMap<String, String> VerifyDeleteButton(String EnterCustomerName, String expectedMessage)
			throws InterruptedException {

		LoggerUtil.info("Step 1: Validating Customer Search box availability");

		if (!isSearchBoxAvailable(EnterValueSearchBox, 10)) {
		    LoggerUtil.fail("Customer Search box not loaded after Save. Grid not ready.");
		   
		    return new HashMap<>();
		}

		LoggerUtil.pass("Customer Search box is available");

		LoggerUtil.info("Step 2: Entering Customer Name in Search Box: " + EnterCustomerName);
		clearAndEnterText(driver.findElement(EnterValueSearchBox), EnterCustomerName);

		// Wait for the table header to become visible before proceeding
		LoggerUtil.info("Step 2: Waiting for table header row");
		WebElement headRow = driver.findElement(HeaderRow);
		// wait.until(ExpectedConditions.visibilityOf(headRow));

		LoggerUtil.info("Step 3: Fetching table headers");
		List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));
		// wait.until(ExpectedConditions.visibilityOfAllElements(headerColumns));

		HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
		for (int i = 0; i < headerColumns.size(); i++) {
			String columnName = headerColumns.get(i).getText().trim();
			storeHeaderColumnNameInfo.put(columnName, i);
		}
		LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

		// Wait for the first table row to become visible
		LoggerUtil.info("Step 4: Waiting for table row");
		WebElement tableRow = driver.findElement(TableRow);
		// wait.until(ExpectedConditions.visibilityOf(tableRow));

		List<WebElement> columnValues = tableRow.findElements(By.tagName("td"));
		// wait.until(ExpectedConditions.visibilityOfAllElements(columnValues));

		HashMap<String, String> tablesValue = new HashMap<>();

		// Fetch values column by column based on the header map
		if (storeHeaderColumnNameInfo.containsKey("Customer Code")) {
			String customerCodeValue = columnValues.get(storeHeaderColumnNameInfo.get("Customer Code")).getText()
					.trim();
			tablesValue.put("Customer Code", customerCodeValue);
			LoggerUtil.info("Fetched Customer Code: " + customerCodeValue);
		}
		if (storeHeaderColumnNameInfo.containsKey("Customer Name")) {
			String customerName = columnValues.get(storeHeaderColumnNameInfo.get("Customer Name")).getText().trim();
			tablesValue.put("Customer Name", customerName);
			LoggerUtil.info("Fetched Customer Name: " + customerName);
		}
		if (storeHeaderColumnNameInfo.containsKey("Customer Location")) {
			String customerLocation = columnValues.get(storeHeaderColumnNameInfo.get("Customer Location")).getText()
					.trim();
			tablesValue.put("Customer Location", customerLocation);
			LoggerUtil.info("Fetched Customer Location: " + customerLocation);
		}
		if (storeHeaderColumnNameInfo.containsKey("Business Domain")) {
			String customerBusinessDomain = columnValues.get(storeHeaderColumnNameInfo.get("Business Domain")).getText()
					.trim();
			tablesValue.put("Business Domain", customerBusinessDomain);
			LoggerUtil.info("Fetched Business Domain: " + customerBusinessDomain);
		}
		if (storeHeaderColumnNameInfo.containsKey("Business Segment")) {
			String customerBusinessSegment = columnValues.get(storeHeaderColumnNameInfo.get("Business Segment"))
					.getText().trim();
			tablesValue.put("Business Segment", customerBusinessSegment);
			LoggerUtil.info("Fetched Business Segment: " + customerBusinessSegment);
		}

		// Step 5: Clicking the Delete button for the row
		LoggerUtil.info("Step 5: Clicking Delete button for the row");
		try {
			// Ensure that the action column is visible and contains a delete button
			WebElement actionColumn = columnValues.get(columnValues.size() - 1);
			// wait.until(ExpectedConditions.elementToBeClickable(actionColumn)); // Ensure
			// it's clickable

			// Find and click the delete button
			WebElement deleteButton = actionColumn.findElement(By.cssSelector("i.fas.fa-trash-o"));
			deleteButton.click();

			LoggerUtil.pass("Delete button clicked successfully for Customer: " + EnterCustomerName);

			// Handle the alert
			String alertText = driver.switchTo().alert().getText();
			LoggerUtil.info("⚠️ Alert displayed: " + alertText);
			driver.switchTo().alert().accept();

			// Verify the toast message
			String actualToast = waitForExpectedElement(CustomerMasterPage.toastmessage).getText().trim();
			LoggerUtil.info("Toast displayed: " + actualToast);

			// Check if the toast message matches the expected one
			if (actualToast.contains(expectedMessage)) {
				LoggerUtil.pass("✅ Toast message verified successfully → Expected: " + expectedMessage + " | Actual: "
						+ actualToast);
			} else {
				LoggerUtil.mismatch("Toast message mismatch!", expectedMessage, actualToast);
			}

		} catch (Exception e) {
			LoggerUtil.fail("❌ Failed during Delete operation: " + e.getMessage());
		}

		// Return the table values fetched
		return tablesValue;
	}

	public static HashMap<String, String> VerifyEditButton(String EnterCustomerName)
	        throws InterruptedException {

	    HashMap<String, String> tablesValue = new HashMap<>();

	    LoggerUtil.info("Step 0: Validating Customer Search box availability");

	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        wait.until(ExpectedConditions.presenceOfElementLocated(EnterValueSearchBox));

	        if (!driver.findElement(EnterValueSearchBox).isDisplayed()) {
	            LoggerUtil.fail("Customer Search box is not visible. Cannot proceed with Edit validation.");
	          
	            return tablesValue;
	        }

	        LoggerUtil.pass("Customer Search box is available");

	    } catch (Exception e) {
	        LoggerUtil.fail("Customer Search box not loaded. Grid not ready for Edit action.");
	        LoggerUtil.error("Search box exception: " + e.getMessage());
	       
	        return tablesValue;
	    }

	    // --------------------------------------------------
	    // STEP 1 → Enter Customer Name in Search Box
	    // --------------------------------------------------
	    LoggerUtil.info("Step 1: Entering Customer Name in Search Box: " + EnterCustomerName);
	    clearAndEnterText(driver.findElement(EnterValueSearchBox), EnterCustomerName);

	    // --------------------------------------------------
	    // STEP 2 → Fetch Table Headers
	    // --------------------------------------------------
	    LoggerUtil.info("Step 2: Waiting for table header row");
	    WebElement headRow = driver.findElement(HeaderRow);

	    LoggerUtil.info("Step 3: Fetching table headers");
	    List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));
	    Thread.sleep(4000);

	    HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
	    for (int i = 0; i < headerColumns.size(); i++) {
	        String columnName = headerColumns.get(i).getText().trim();
	        storeHeaderColumnNameInfo.put(columnName, i);
	    }
	    LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

	    // --------------------------------------------------
	    // STEP 3 → Fetch First Table Row Values
	    // --------------------------------------------------
	    LoggerUtil.info("Step 4: Waiting for table row");
	    WebElement tableRow = driver.findElement(TableRow);
	    List<WebElement> columnValues = tableRow.findElements(By.tagName("td"));

	    if (storeHeaderColumnNameInfo.containsKey("Customer Code")) {
	        String customerCodeValue =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Code")).getText().trim();
	        tablesValue.put("Customer Code", customerCodeValue);
	        LoggerUtil.info("Fetched Customer Code: " + customerCodeValue);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Name")) {
	        String customerName =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Name")).getText().trim();
	        tablesValue.put("Customer Name", customerName);
	        LoggerUtil.info("Fetched Customer Name: " + customerName);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Location")) {
	        String customerLocation =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Location")).getText().trim();
	        tablesValue.put("Customer Location", customerLocation);
	        LoggerUtil.info("Fetched Customer Location: " + customerLocation);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Business Domain")) {
	        String customerBusinessDomain =
	                columnValues.get(storeHeaderColumnNameInfo.get("Business Domain")).getText().trim();
	        tablesValue.put("Business Domain", customerBusinessDomain);
	        LoggerUtil.info("Fetched Business Domain: " + customerBusinessDomain);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Business Segment")) {
	        String customerBusinessSegment =
	                columnValues.get(storeHeaderColumnNameInfo.get("Business Segment")).getText().trim();
	        tablesValue.put("Business Segment", customerBusinessSegment);
	        LoggerUtil.info("Fetched Business Segment: " + customerBusinessSegment);
	    }

	    // --------------------------------------------------
	    // STEP 4 → Click Edit Button
	    // --------------------------------------------------
	    LoggerUtil.info("Step 5: Clicking Edit button for the row");

	    try {
	        WebElement actionColumn = columnValues.get(columnValues.size() - 1);
	        WebElement editButton = actionColumn.findElement(By.cssSelector("i.fas.fa-edit"));
	        editButton.click();
	        LoggerUtil.pass("Edit button clicked successfully for Customer: " + EnterCustomerName);

	    } catch (Exception e) {
	        LoggerUtil.fail("Failed to click Edit button: " + e.getMessage());
	       
	    }

	    return tablesValue;
	}

	public void VerifyFetchingValueFromAllCell(HashMap<String, String> TablesValue) throws InterruptedException {

		// Expected values from table (HashMap)
		String expectedCustomerCode = TablesValue.get("Customer Code");
		String expectedCustomerName = TablesValue.get("Customer Name");
		String expectedCustomerLocation = TablesValue.get("Customer Location");
		String expectedBusinessDomain = TablesValue.get("Business Domain");
		String expectedBusinessSegment = TablesValue.get("Business Segment");

		Thread.sleep(3000);

		// Actual values from UI
		String actualCustomerCode = waitForExpectedElement(CustomerMasterPage.customercode).getAttribute("value")
				.trim();
		String actualCustomerName = waitForExpectedElement(CustomerMasterPage.customername).getAttribute("value")
				.trim();
		String actualCustomerLocation = waitForExpectedElement(CustomerMasterPage.customerlocation)
				.getAttribute("value").trim();

		String actualBusinessDomain = waitForExpectedElement(CustomerMasterPage.businnessdomaidropdown)
				.findElement(By.tagName("span")).getText().trim();

		String actualBusinessSegment = waitForExpectedElement(CustomerMasterPage.businesssegmentdropdown)
				.findElement(By.tagName("span")).getText().trim();

		// Comparison
		compareValues("Customer Code", expectedCustomerCode, actualCustomerCode);
		compareValues("Customer Name", expectedCustomerName, actualCustomerName);
		compareValues("Customer Location", expectedCustomerLocation, actualCustomerLocation);
		compareValues("Business Domain", expectedBusinessDomain, actualBusinessDomain);
		compareValues("Business Segment", expectedBusinessSegment, actualBusinessSegment);
	}

	public static HashMap<String, String> VerifySaveAsNewData(String enterCustomerCode, String enterCustomerName,
			String expectedPopup) {

		HashMap<String, String> saveAsNewCustomerInfo = new HashMap<>();

		try {
			LoggerUtil.info("Step 1: Entering Customer Code: " + enterCustomerCode);
			clearAndEnterText(waitForExpectedElement(CustomerMasterPage.customercode), enterCustomerCode);

			LoggerUtil.info("Step 2: Entering Customer Name: " + enterCustomerName);
			clearAndEnterText(waitForExpectedElement(CustomerMasterPage.customername), enterCustomerName);

			LoggerUtil.info("Step 3: Clicking 'Save As New' button");
			clickOnElement(CustomerMasterPage.saveasnewbtn);

			LoggerUtil.info("Step 4: Capturing toast message after Save As New action");
			String actualSaveAsNew = waitForExpectedElement(CustomerMasterPage.toastmessage).getText().trim();
			LoggerUtil.info("Toast message displayed: " + actualSaveAsNew);

			if (actualSaveAsNew.equals(expectedPopup)) {
				LoggerUtil.pass("✅ Save As New toast verified successfully → Expected: " + expectedPopup + " | Actual: "
						+ actualSaveAsNew);
			} else {
				LoggerUtil.mismatch("❌ Save As New toast mismatch!", expectedPopup, actualSaveAsNew);
			}

			// Store entered values
			saveAsNewCustomerInfo.put("Customer Code", enterCustomerCode);
			saveAsNewCustomerInfo.put("Customer Name", enterCustomerName);

		} catch (Exception e) {
			LoggerUtil.fail("❌ Exception during Save As New flow: " + e.getMessage());
		}

		return saveAsNewCustomerInfo;
	}

	public static void VerifySaveAsNewDataButtonAndVerifyTableData(String EnterCustomerName)
	        throws InterruptedException {

	    LoggerUtil.info("Step 0: Validating Customer Search box availability");

	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        wait.until(ExpectedConditions.presenceOfElementLocated(EnterValueSearchBox));

	        if (!driver.findElement(EnterValueSearchBox).isDisplayed()) {
	            LoggerUtil.fail("Customer Search box is not visible. Cannot proceed with Save As New validation.");
	            
	            return;
	        }

	        LoggerUtil.pass("Customer Search box is available");

	    } catch (Exception e) {
	        LoggerUtil.fail("Customer Search box not loaded. Grid not ready for Save As New validation.");
	        LoggerUtil.error("Search box exception: " + e.getMessage());
	        
	        return;
	    }

	    // --------------------------------------------------
	    // STEP 1 → Enter Customer Name in Search Box
	    // --------------------------------------------------
	    LoggerUtil.info("Step 1: Entering Customer Name in Search Box: " + EnterCustomerName);
	    clearAndEnterText(driver.findElement(EnterValueSearchBox), EnterCustomerName);

	    // --------------------------------------------------
	    // STEP 2 → Fetch Table Headers
	    // --------------------------------------------------
	    LoggerUtil.info("Step 2: Waiting for table header row");
	    WebElement headRow = driver.findElement(HeaderRow);

	    LoggerUtil.info("Step 3: Fetching table headers");
	    List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));
	    Thread.sleep(2000);

	    HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
	    for (int i = 0; i < headerColumns.size(); i++) {
	        String columnName = headerColumns.get(i).getText().trim();
	        storeHeaderColumnNameInfo.put(columnName, i);
	    }
	    LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

	    // --------------------------------------------------
	    // STEP 3 → Fetch First Table Row
	    // --------------------------------------------------
	    LoggerUtil.info("Step 4: Waiting for table row");
	    WebElement tableRow = driver.findElement(TableRow);
	    List<WebElement> columnValues = tableRow.findElements(By.tagName("td"));

	    HashMap<String, String> tablesValue = new HashMap<>();

	    if (storeHeaderColumnNameInfo.containsKey("Customer Code")) {
	        String customerCodeValue =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Code")).getText().trim();
	        tablesValue.put("Customer Code", customerCodeValue);
	        LoggerUtil.info("Fetched Customer Code: " + customerCodeValue);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Name")) {
	        String customerName =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Name")).getText().trim();
	        tablesValue.put("Customer Name", customerName);
	        LoggerUtil.info("Fetched Customer Name: " + customerName);
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Location")) {
	        String customerLocation =
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Location")).getText().trim();
	        tablesValue.put("Customer Location", customerLocation);
	        LoggerUtil.info("Fetched Customer Location: " + customerLocation);
	    }

	    // --------------------------------------------------
	    // STEP 4 → Click Edit Button (Save As New Flow)
	    // --------------------------------------------------
	    LoggerUtil.info("Step 5: Clicking Edit button for the row");

	    try {
	        WebElement actionColumn = columnValues.get(columnValues.size() - 1);
	        WebElement editButton = actionColumn.findElement(By.cssSelector("i.fas.fa-edit"));
	        editButton.click();
	        LoggerUtil.pass("Edit button clicked successfully for Customer: " + EnterCustomerName);

	    } catch (Exception e) {
	        LoggerUtil.fail("Failed to click Edit button during Save As New validation: " + e.getMessage());
	        
	    }
	}


	public void VerifyFetchingSaveAsNewValueForSaveAsNew(HashMap<String, String> saveAsNewCustomerInfo)
			throws InterruptedException {

		String expectedCustomerCode = saveAsNewCustomerInfo.get("Customer Code");
		String expectedCustomerName = saveAsNewCustomerInfo.get("Customer Name");

		LoggerUtil.info("Step: Verifying Save As New values in form fields");

		Thread.sleep(2000);

		String actualCustomerCode = waitForExpectedElement(CustomerMasterPage.customercode).getAttribute("value")
				.trim();
		String actualCustomerName = waitForExpectedElement(CustomerMasterPage.customername).getAttribute("value")
				.trim();

		compareValues("Customer Code", expectedCustomerCode, actualCustomerCode);
		compareValues("Customer Name", expectedCustomerName, actualCustomerName);
	}

	private void compareValues(String fieldName, String expected, String actual) {
		if (expected != null && expected.equals(actual)) {
			LoggerUtil.pass("✅ " + fieldName + " matched → Expected: " + expected + " | Actual: " + actual);
		} else {
			LoggerUtil.mismatch(fieldName, expected, actual);
		}
	}

	public static final By ClickingImportAndExportButtonCustomerPage = By
			.xpath("//button[@data-target='#exportModalForCustomers']");
	public static final By ClickingDownloadExcelSecondDownloadButtonFileForCustomerPage = By
			.xpath("//button[@onclick='ExportNewAddition()']/i");

	public void VerifyDownloadExcelFileAndExportButton(String expectedMsg) throws InterruptedException {
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));

		LoggerUtil.info("Step 1: Clicking Export button on Customer Page");
		clickOnElement(ClickingImportAndExportButtonCustomerPage);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(ClickingImportAndExportButtonCustomerPage));

		LoggerUtil.info("Step 2: Clicking Download Excel button");
		clickOnElement(ClickingDownloadExcelSecondDownloadButtonFileForCustomerPage);

		LoggerUtil.info("Step 3: Capturing toast message after download click");
		String actualToastMsg = waitForExpectedElement(CustomerMasterPage.toastmessage).getText().trim();
		LoggerUtil.info("Toast message displayed: " + actualToastMsg);

		if (actualToastMsg.equals(expectedMsg)) {
			LoggerUtil.pass(
					"Toast message verified successfully → Expected: " + expectedMsg + " | Actual: " + actualToastMsg);

			LoggerUtil.info("Step 4: Waiting for file download");
			Thread.sleep(12000);

			File filename = getLatestCustomerMasterFIle();
			if (filename != null) {
				String filePath = filename.getAbsolutePath();
				LoggerUtil.pass(" File downloaded successfully → " + filePath);
			} else {
				LoggerUtil.fail(" File download failed: No matching file found in downloads folder.");
			}
		} else {
			LoggerUtil.mismatch(" Toast message mismatch!", expectedMsg, actualToastMsg);
		}
	}

	public void VerifyReadCustomerMasterExcelFile() {
		try {

			File file = getLatestCustomerMasterFIle();
			if (file == null) {
				LoggerUtil.fail("❌ No Customer Master Excel file found in downloads.");
				return;
			}

			String filePath = file.getAbsolutePath();
			LoggerUtil.info("Reading Excel File: " + filePath);

			ExcelUtil.printSheetSummary(filePath);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error in VerifyReadCustomerMasterExcelFile: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By clickingImportButtonFunctionalityCustomerMasterPage = By.xpath("//button[@id='Import']");

	public static final By clickingRadioButtonForNewMasterAllocation = By.xpath("//input[@id='newsup']");
	public static final By clickingyearlyRadioBtn = By.xpath("//input[@id='Yearly']");
	public static final By ClcikingRmSelectionDropdownBtn = By
			.xpath("//select[@id='Domyearly']/following-sibling::div/button");
	public static final By clickingProcessDropdownBtn = By
			.xpath("//select[@id='Processdropdown']/following-sibling::div/button");
	public static final By clickingOhpDropDownBtn = By
			.xpath("//select[@id='ohpcustomernew']/following-sibling::div/button");
	public static final By clickingCheckboxForSelectingRmGrade = By
			.xpath("//select[@id='Domyearly']/following-sibling::div/div/button/following-sibling::button/span/input");
	public static final By clickingCheckboxSelectingForProcessMaster = By.xpath(
			"//select[@id='Processdropdown']/following-sibling::div/div/button/following-sibling::button/span/input");
	public static final By clickingCheckboxesSeletingForOhpMaster = By.xpath(
			"//select[@id='ohpcustomernew']/following-sibling::div/div/button/following-sibling::button/span/input");

	private void selectingRmGradeSelectop() {

		;

		List<WebElement> checklistValue = driver.findElements(clickingCheckboxForSelectingRmGrade);

		WebElement selectingvalueoFRmGrader = checklistValue.get(1);

		selectingvalueoFRmGrader.click();

	}

	private void SelectingProcessDropdown() {

		List<WebElement> checklistValue = driver.findElements(clickingCheckboxSelectingForProcessMaster);

		WebElement selectingvalueoFProcess = checklistValue.get(1);

		selectingvalueoFProcess.click();

	}

	private void SelectingOhpMaster() {

		List<WebElement> checklistValue = driver.findElements(clickingCheckboxesSeletingForOhpMaster);

		WebElement selectingvalueoFOhpMaster = checklistValue.get(1);

		selectingvalueoFOhpMaster.click();

	}

	public void clickElementUsingJS(By locator) {
		try {
			WebElement element = waitForExpectedElement(locator); // your wait wrapper
			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("arguments[0].click();", element);
			LoggerUtil.pass("Clicked element using JavaScript: " + locator.toString());
		} catch (Exception e) {
			LoggerUtil
					.fail("❌ Failed to click element using JavaScript: " + locator.toString() + " | " + e.getMessage());
		}
	}

	public void VerifyImportButton() throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(35));
		LoggerUtil.info("Step 1: Clicking Export button on Customer Page");
		clickOnElement(ClickingImportAndExportButtonCustomerPage);

		clickOnElement(clickingRadioButtonForNewMasterAllocation);

		clickOnElement(clickingyearlyRadioBtn);

		Thread.sleep(8000);

		clickElementUsingJS(ClcikingRmSelectionDropdownBtn);
		Thread.sleep(2000);
		selectingRmGradeSelectop();

		Thread.sleep(9000);

		clickElementUsingJS(clickingProcessDropdownBtn);

		SelectingProcessDropdown();
		Thread.sleep(9000);

		clickElementUsingJS(clickingOhpDropDownBtn);
		SelectingOhpMaster();

		clickOnElement(ClickingDownloadExcelSecondDownloadButtonFileForCustomerPage);

		Thread.sleep(15000);

	}

	public static HashMap<String, String> ExcelFillerValueInCustomerExcelFile() {
		HashMap<String, String> customerData = new HashMap<>();

		File file = getLatestCustomerMasterFIle();
		if (file == null) {
			LoggerUtil.fail("❌ File not Found!");
			return customerData;
		}

		String latestfile = file.getAbsolutePath();

		// Faker Data
		String customerCode = faker.number().digits(3);
		String customerName = faker.name().firstName() + faker.letterify("??????");
		String rawLocation = faker.country().capital();
		String customerLocation = rawLocation.replaceAll("'/', '-',''', and '_'.", "");
		String businessDomain = "rishi";
		String businessSeg = "sachindra1";
		String rm = "Yes";
		String process = "No";
		String ohp = "Yes";

		try {
			// Write values in Excel (Row 2 = index 2 → 3rd row)
			ExcelFiller.setCellValue(latestfile, 0, 2, 1, ValueType.STRING, Arrays.asList(customerCode));
			ExcelFiller.setCellValue(latestfile, 0, 2, 2, ValueType.STRING, Arrays.asList(customerName));
			ExcelFiller.setCellValue(latestfile, 0, 2, 3, ValueType.STRING, Arrays.asList(customerLocation));
			ExcelFiller.setCellValue(latestfile, 0, 2, 4, ValueType.DROPDOWN, Arrays.asList(businessDomain));
			ExcelFiller.setCellValue(latestfile, 0, 2, 5, ValueType.DROPDOWN, Arrays.asList(businessSeg));
			ExcelFiller.setCellValue(latestfile, 0, 2, 6, ValueType.DROPDOWN, Arrays.asList(rm));
			ExcelFiller.setCellValue(latestfile, 0, 2, 7, ValueType.DROPDOWN, Arrays.asList(process));
			ExcelFiller.setCellValue(latestfile, 0, 2, 8, ValueType.DROPDOWN, Arrays.asList(ohp));

			LoggerUtil.pass("✅ Excel file updated successfully at: " + latestfile);

		} catch (Exception e) {
			LoggerUtil.fail("❌ Error while writing Excel: " + e.getMessage());
			e.printStackTrace();
		}

		// Save in map
		customerData.put("Customer-Code", customerCode);
		customerData.put("Customer-Name", customerName);
		customerData.put("Customer-Location", customerLocation);
		customerData.put("Business-Domain", businessDomain);
		customerData.put("Business-Segment", businessSeg);
		customerData.put("Raw-Material", rm);
		customerData.put("Process", process);
		customerData.put("Ohp", ohp);

		// Report summary
		LoggerUtil.info("📑 Customer Excel File Path: " + latestfile);
		LoggerUtil.info("📊 Data written in Excel Row 2: " + "Customer-Code=" + customerCode + ", " + "Customer-Name="
				+ customerName + ", " + "Customer-Location=" + customerLocation + ", " + "Business-Domain="
				+ businessDomain + ", " + "Business-Segment=" + businessSeg + ", " + "Raw-Material=" + rm + ", "
				+ "Process=" + process + ", " + "Ohp=" + ohp);

		// Debug print first 5 rows
		ExcelUtil.printAllRows(latestfile, 5);

		return customerData;
	}

	public void ImportCustomerExcelFile(String expectedMsg) {
		try {
			LoggerUtil.info(" Step 1: Getting latest Customer Excel file path...");
			String fullPath = getLatestCustomerExcelFilePath();

			if (fullPath == null || fullPath.isEmpty()) {
				LoggerUtil.fail(" No file path found for Customer Excel import.");
				return;
			}

			LoggerUtil.pass(" File path found: " + fullPath);

			// Step 2: Locate file input (hidden element)
			LoggerUtil.info(" Step 2: Locating hidden file input field (excelUploadNew)...");
			WebElement fileInput = driver.findElement(By.id("excelUploadNew"));

			// Step 3: Make it visible using JavaScript
			LoggerUtil.info(" Step 3: Making file input visible using JS...");
			((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

			// Step 4: Upload file
			LoggerUtil.info(" Step 4: Uploading file → " + fullPath);
			fileInput.sendKeys(fullPath);

			

		} catch (Exception e) {
			LoggerUtil.fail(" Exception during ImportCustomerExcelFile → " + e.getMessage());
			e.printStackTrace();
		}
	}

	private static String getLatestCustomerExcelFilePath() {
		File file = getLatestCustomerMasterFIle();
		if (file == null) {
			LoggerUtil.error(" No Customer Master Excel file found!");
			return null;
		}
		return file.getAbsolutePath();
	}

	public void VerifyAllFetchedImportedSucessFullyOrNot(HashMap<String, String> CustomerDataFromExcel)
			throws InterruptedException {

		// Expected values from table (HashMap)
		String expectedCustomerCode = CustomerDataFromExcel.get("Customer-Code");
		String expectedCustomerName = CustomerDataFromExcel.get("Customer-Name");
		String expectedCustomerLocation = CustomerDataFromExcel.get("Customer-Location");
		String expectedBusinessDomain = CustomerDataFromExcel.get("Business-Domain");
		String expectedBusinessSegment = CustomerDataFromExcel.get("Business-Segment");

		Thread.sleep(3000);

		// Actual values from UI
		String actualCustomerCode = waitForExpectedElement(CustomerMasterPage.customercode).getAttribute("value")
				.trim();
		String actualCustomerName = waitForExpectedElement(CustomerMasterPage.customername).getAttribute("value")
				.trim();
		String actualCustomerLocation = waitForExpectedElement(CustomerMasterPage.customerlocation)
				.getAttribute("value").trim();

		String actualBusinessDomain = waitForExpectedElement(CustomerMasterPage.businnessdomaidropdown)
				.findElement(By.tagName("span")).getText().trim();

		String actualBusinessSegment = waitForExpectedElement(CustomerMasterPage.businesssegmentdropdown)
				.findElement(By.tagName("span")).getText().trim();

		// Comparison
		compareValues("Customer Code", expectedCustomerCode, actualCustomerCode);
		compareValues("Customer Name", expectedCustomerName, actualCustomerName);
		compareValues("Customer Location", expectedCustomerLocation, actualCustomerLocation);
		compareValues("Business Domain", expectedBusinessDomain, actualBusinessDomain);
		compareValues("Business Segment", expectedBusinessSegment, actualBusinessSegment);

	}

	public void PreventDeletionOfCustomerWithCostingEntries(
	        String EnterCustomerName,
	        String expectedMessage
	) throws InterruptedException {

	    // --------------------------------------------------
	    // STEP 0 → Validate Search Box Availability
	    // --------------------------------------------------
	    LoggerUtil.info("Step 0: Validating Customer Search box availability");

	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        wait.until(ExpectedConditions.presenceOfElementLocated(EnterValueSearchBox));

	        if (!driver.findElement(EnterValueSearchBox).isDisplayed()) {
	            LoggerUtil.fail("Customer Search box is not visible. Cannot proceed with Delete validation.");
	            return;
	        }

	        LoggerUtil.pass("Customer Search box is available");

	    } catch (Exception e) {
	        LoggerUtil.fail("Customer Search box not loaded. Grid not ready for Delete validation.");
	        LoggerUtil.error("Search box exception: " + e.getMessage());
	        return;
	    }

	    // --------------------------------------------------
	    // STEP 1 → Enter Customer Name in Search Box
	    // --------------------------------------------------
	    LoggerUtil.info("Step 1: Entering Customer Name in Search Box: " + EnterCustomerName);
	    clearAndEnterText(driver.findElement(EnterValueSearchBox), EnterCustomerName);

	    Thread.sleep(3000);

	    // --------------------------------------------------
	    // STEP 2 → Fetch Table Headers
	    // --------------------------------------------------
	    LoggerUtil.info("Step 2: Waiting for table header row");
	    WebElement headRow = driver.findElement(HeaderRow);

	    LoggerUtil.info("Step 3: Fetching table headers");
	    List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));
	    Thread.sleep(2000);

	    HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
	    for (int i = 0; i < headerColumns.size(); i++) {
	        String columnName = headerColumns.get(i).getText().trim();
	        storeHeaderColumnNameInfo.put(columnName, i);
	    }
	    LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

	    // --------------------------------------------------
	    // STEP 3 → Fetch Table Row
	    // --------------------------------------------------
	    LoggerUtil.info("Step 4: Waiting for table row");
	    WebElement tableRow = driver.findElement(TableRow);
	    List<WebElement> columnValues = tableRow.findElements(By.tagName("td"));

	    if (storeHeaderColumnNameInfo.containsKey("Customer Code")) {
	        LoggerUtil.info("Fetched Customer Code: " +
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Code")).getText().trim());
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Name")) {
	        LoggerUtil.info("Fetched Customer Name: " +
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Name")).getText().trim());
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Customer Location")) {
	        LoggerUtil.info("Fetched Customer Location: " +
	                columnValues.get(storeHeaderColumnNameInfo.get("Customer Location")).getText().trim());
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Business Domain")) {
	        LoggerUtil.info("Fetched Business Domain: " +
	                columnValues.get(storeHeaderColumnNameInfo.get("Business Domain")).getText().trim());
	    }

	    if (storeHeaderColumnNameInfo.containsKey("Business Segment")) {
	        LoggerUtil.info("Fetched Business Segment: " +
	                columnValues.get(storeHeaderColumnNameInfo.get("Business Segment")).getText().trim());
	    }

	    // --------------------------------------------------
	    // STEP 4 → Click Delete Button (Expected to be Blocked)
	    // --------------------------------------------------
	    LoggerUtil.info("Step 5: Clicking Delete button for the row");

	    try {
	        WebElement actionColumn = columnValues.get(columnValues.size() - 1);
	        WebElement deleteButton = actionColumn.findElement(By.cssSelector("i.fas.fa-trash-o"));
	        deleteButton.click();

	        LoggerUtil.pass("Delete button clicked for Customer: " + EnterCustomerName);

	        // Handle alert
	        String alertText = driver.switchTo().alert().getText();
	        LoggerUtil.info("Alert displayed: " + alertText);
	        driver.switchTo().alert().accept();

	        // Verify toast message
	        String actualToast =
	                waitForExpectedElement(CustomerMasterPage.toastmessage).getText().trim();

	        LoggerUtil.info("Toast displayed: " + actualToast);

	        if (actualToast.contains(expectedMessage)) {
	            LoggerUtil.pass(
	                    "Deletion correctly prevented. Expected message displayed → " + expectedMessage
	            );
	        } else {
	            LoggerUtil.mismatch(
	                    "Toast message mismatch during deletion prevention",
	                    expectedMessage,
	                    actualToast
	            );
	        }

	    } catch (Exception e) {
	        LoggerUtil.fail("Failed during Delete prevention validation: " + e.getMessage());
	    }
	}

	// getLastNonEmptyRowOnly

	public void VeriDataConsistencyExcelFile(HashMap<String, String> expectedData) {
		File file = getLatestCustomerMasterFIle();
		if (file == null) {
			LoggerUtil.fail("❌ No Customer Master Excel file found in downloads.");
			return;
		}

		String filePath = file.getAbsolutePath();
		LoggerUtil.info("📂 Reading Excel File: " + filePath);

		// Get last non-empty row as Map (columnName -> cellValue)
		HashMap<String, String> lastRowData = ExcelUtil.getLastNonEmptyRowOnly(filePath);

		if (lastRowData == null || lastRowData.isEmpty()) {
			LoggerUtil.fail("❌ No data found in the last row of Excel.");
			return;
		}

		LoggerUtil.info("🔎 Last Row Data from Excel: " + lastRowData);

		// Compare each expected field
		for (String key : expectedData.keySet()) {
			String expectedValue = expectedData.get(key);
			String actualValue = lastRowData.getOrDefault(key, "").trim();

			if (expectedValue.equalsIgnoreCase(actualValue)) {
				LoggerUtil.pass(
						"✅ Column [" + key + "] matched. Expected = " + expectedValue + " | Actual = " + actualValue);
			} else {
				LoggerUtil.fail(
						"❌ Column [" + key + "] mismatch. Expected = " + expectedValue + " | Actual = " + actualValue);
			}
		}
	}

	public static Map<String, HashMap<String, String>> VerifyDuplicateDataInExcelFileAndCheckUi() {
		HashMap<String, String> customerData = new HashMap<>();
		HashMap<String, String> duplicateCustomerData = new HashMap<>();
		Map<String, HashMap<String, String>> result = new HashMap<>();

		File file = getLatestCustomerMasterFIle();
		if (file == null) {
			LoggerUtil.fail("❌ File not Found!");
			return result;
		}

		String latestfile = file.getAbsolutePath();
		LoggerUtil.info("📂 Latest Excel File Found: " + latestfile);

		// Faker Data (Original)
		String customerCode = faker.number().digits(3);
		String customerName = faker.name().firstName() + faker.letterify("??????");
		String rawLocation = faker.country().capital();
		String customerLocation = rawLocation.replaceAll("'/', '-',''', and '_'.", "");
		String businessDomain = "rishi";
		String businessSeg = "sachindra1";
		String rm = "Yes";
		String process = "No";
		String ohp = "Yes";

		// Faker Data (Duplicate)
		String duplicateCustomerCode = faker.number().digits(3);
		String duplicateCustomerName = faker.name().firstName() + faker.letterify("??????");
		String duplicateRawLocation = faker.country().capital();
		String duplicateCustomerLocation = duplicateRawLocation.replaceAll("'/', '-',''', and '_'.", "");
		String duplicateBusinessDomain = "rishi";
		String duplicateBusinessSeg = "sachindra1";
		String duplicateRm = "Yes";
		String duplicateProcess = "No";
		String duplicateOhp = "Yes";

		try {
			// Write Original Data (Row 2 → index 2)
			ExcelFiller.setCellValue(latestfile, 0, 2, 1, ValueType.STRING, Arrays.asList(customerCode));
			ExcelFiller.setCellValue(latestfile, 0, 2, 2, ValueType.STRING, Arrays.asList(customerName));
			ExcelFiller.setCellValue(latestfile, 0, 2, 3, ValueType.STRING, Arrays.asList(customerLocation));
			ExcelFiller.setCellValue(latestfile, 0, 2, 4, ValueType.DROPDOWN, Arrays.asList(businessDomain));
			ExcelFiller.setCellValue(latestfile, 0, 2, 5, ValueType.DROPDOWN, Arrays.asList(businessSeg));
			ExcelFiller.setCellValue(latestfile, 0, 2, 6, ValueType.DROPDOWN, Arrays.asList(rm));
			ExcelFiller.setCellValue(latestfile, 0, 2, 7, ValueType.DROPDOWN, Arrays.asList(process));
			ExcelFiller.setCellValue(latestfile, 0, 2, 8, ValueType.DROPDOWN, Arrays.asList(ohp));

			LoggerUtil.info(" Writing Original Data to Excel → Row 2");

			// Write Duplicate Data (Row 3 → index 3)
			ExcelFiller.setCellValue(latestfile, 0, 3, 1, ValueType.STRING, Arrays.asList(duplicateCustomerCode));
			ExcelFiller.setCellValue(latestfile, 0, 3, 2, ValueType.STRING, Arrays.asList(duplicateCustomerName));
			ExcelFiller.setCellValue(latestfile, 0, 3, 3, ValueType.STRING, Arrays.asList(duplicateCustomerLocation));
			ExcelFiller.setCellValue(latestfile, 0, 3, 4, ValueType.DROPDOWN, Arrays.asList(duplicateBusinessDomain));
			ExcelFiller.setCellValue(latestfile, 0, 3, 5, ValueType.DROPDOWN, Arrays.asList(duplicateBusinessSeg));
			ExcelFiller.setCellValue(latestfile, 0, 3, 6, ValueType.DROPDOWN, Arrays.asList(duplicateRm));
			ExcelFiller.setCellValue(latestfile, 0, 3, 7, ValueType.DROPDOWN, Arrays.asList(duplicateProcess));
			ExcelFiller.setCellValue(latestfile, 0, 3, 8, ValueType.DROPDOWN, Arrays.asList(duplicateOhp));

			LoggerUtil.info(" Writing Duplicate Data to Excel → Row 3");

			// Write Duplicate Data Again (Row 4 → index 4)
			ExcelFiller.setCellValue(latestfile, 0, 4, 1, ValueType.STRING, Arrays.asList(duplicateCustomerCode));
			ExcelFiller.setCellValue(latestfile, 0, 4, 2, ValueType.STRING, Arrays.asList(duplicateCustomerName));
			ExcelFiller.setCellValue(latestfile, 0, 4, 3, ValueType.STRING, Arrays.asList(duplicateCustomerLocation));
			ExcelFiller.setCellValue(latestfile, 0, 4, 4, ValueType.DROPDOWN, Arrays.asList(duplicateBusinessDomain));
			ExcelFiller.setCellValue(latestfile, 0, 4, 5, ValueType.DROPDOWN, Arrays.asList(duplicateBusinessSeg));
			ExcelFiller.setCellValue(latestfile, 0, 4, 6, ValueType.DROPDOWN, Arrays.asList(duplicateRm));
			ExcelFiller.setCellValue(latestfile, 0, 4, 7, ValueType.DROPDOWN, Arrays.asList(duplicateProcess));
			ExcelFiller.setCellValue(latestfile, 0, 4, 8, ValueType.DROPDOWN, Arrays.asList(duplicateOhp));

			LoggerUtil.info(" Writing Duplicate Data Again to Excel → Row 4");

			LoggerUtil.pass(" Excel file updated successfully with Original + Duplicate data at: " + latestfile);

		} catch (Exception e) {
			LoggerUtil.fail(" Error while writing Excel: " + e.getMessage());
			e.printStackTrace();
		}

		// Save in map (Original)
		customerData.put("Customer-Code", customerCode);
		customerData.put("Customer-Name", customerName);
		customerData.put("Customer-Location", customerLocation);
		customerData.put("Business-Domain", businessDomain);
		customerData.put("Business-Segment", businessSeg);
		customerData.put("Raw-Material", rm);
		customerData.put("Process", process);
		customerData.put("Ohp", ohp);

		LoggerUtil.info(" Original Data Saved in Map: " + customerData);

		// Save in map (Duplicate)
		duplicateCustomerData.put("Customer-Code", duplicateCustomerCode);
		duplicateCustomerData.put("Customer-Name", duplicateCustomerName);
		duplicateCustomerData.put("Customer-Location", duplicateCustomerLocation);
		duplicateCustomerData.put("Business-Domain", duplicateBusinessDomain);
		duplicateCustomerData.put("Business-Segment", duplicateBusinessSeg);
		duplicateCustomerData.put("Raw-Material", duplicateRm);
		duplicateCustomerData.put("Process", duplicateProcess);
		duplicateCustomerData.put("Ohp", duplicateOhp);

		LoggerUtil.info(" Duplicate Data Saved in Map: " + duplicateCustomerData);

		// Add both into result
		result.put("Original", customerData);
		result.put("Duplicate", duplicateCustomerData);

		// Debug print
		LoggerUtil.info(" Customer Excel File Path: " + latestfile);
		LoggerUtil.info(" Original Data Row 2: " + customerData);
		LoggerUtil.info(" Duplicate Data Row 3/4: " + duplicateCustomerData);
		// Debug first 5 rows
		ExcelUtil.printAllRows(latestfile, 5);

		return result;
	}

	public void ImportDuplicateCustomerExcelFile(String expectedMsg) {
		try {
			LoggerUtil.info(" Step 1: Getting latest Customer Excel file path...");
			String fullPath = getLatestCustomerExcelFilePath();

			if (fullPath == null || fullPath.isEmpty()) {
				LoggerUtil.fail(" No file path found for Customer Excel import.");
				return;
			}

			LoggerUtil.pass(" File path found: " + fullPath);

			// Step 2: Locate file input (hidden element)
			LoggerUtil.info(" Step 2: Locating hidden file input field (excelUploadNew)...");
			WebElement fileInput = driver.findElement(By.id("excelUploadNew"));

			// Step 3: Make it visible using JavaScript
			LoggerUtil.info(" Step 3: Making file input visible using JS...");
			((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

			// Step 4: Upload file
			LoggerUtil.info(" Step 4: Uploading file → " + fullPath);
			fileInput.sendKeys(fullPath);

			// Step 5: Verify toast message
			LoggerUtil.info(" Step 5: Waiting for toast message...");
			String actualToastMsg = waitForExpectedElement(CustomerMasterPage.Duplicatetoastmessage).getText().trim();

			if (actualToastMsg.contains(expectedMsg)) {
				LoggerUtil
						.pass(" Import successful. Expected: [" + expectedMsg + "] | Actual: [" + actualToastMsg + "]");
			} else {
				LoggerUtil.mismatch(" Toast mismatch!", expectedMsg, actualToastMsg);
			}

		} catch (Exception e) {
			LoggerUtil.fail(" Exception during ImportCustomerExcelFile → " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static HashMap<String, String> VerifyEditButtonForDuplicateAndUniqueData(
	        HashMap<String, String> customerData) throws InterruptedException {

	    HashMap<String, String> tablesValue = new HashMap<>();

	    if (customerData == null || customerData.isEmpty()) {
	        LoggerUtil.fail("Provided customerData map is null/empty");
	        return tablesValue;
	    }

	    Thread.sleep(9000);

	    // --------------------------------------------------
	    // STEP 0 → Extract Customer Name
	    // --------------------------------------------------
	    String customerNameToSearch = customerData.get("Customer-Name");
	    LoggerUtil.info("Step 0: Customer Name from map: " + customerNameToSearch);

	    if (customerNameToSearch == null || customerNameToSearch.isEmpty()) {
	        LoggerUtil.fail("Customer Name missing in map: " + customerData);
	        return tablesValue;
	    }

	    // --------------------------------------------------
	    // STEP 1 → Validate Search Box Availability
	    // --------------------------------------------------
	    LoggerUtil.info("Step 1: Validating Customer Search box availability");

	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        wait.until(ExpectedConditions.presenceOfElementLocated(EnterValueSearchBox));

	        if (!driver.findElement(EnterValueSearchBox).isDisplayed()) {
	            LoggerUtil.fail("Customer Search box is not visible. Cannot proceed with Edit validation.");
	            return tablesValue;
	        }

	        LoggerUtil.pass("Customer Search box is available");

	    } catch (Exception e) {
	        LoggerUtil.fail("Customer Search box not loaded. Grid not ready for Edit validation.");
	        LoggerUtil.error("Search box exception: " + e.getMessage());
	        return tablesValue;
	    }

	    // --------------------------------------------------
	    // STEP 2 → Enter Customer Name in Search Box
	    // --------------------------------------------------
	    LoggerUtil.info("Step 2: Entering Customer Name in Search Box: " + customerNameToSearch);
	    clearAndEnterText(driver.findElement(EnterValueSearchBox), customerNameToSearch);

	    try {
	        // --------------------------------------------------
	        // STEP 3 → Fetch Table Headers
	        // --------------------------------------------------
	        WebElement headRow = driver.findElement(HeaderRow);
	        List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));

	        HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
	        for (int i = 0; i < headerColumns.size(); i++) {
	            storeHeaderColumnNameInfo.put(headerColumns.get(i).getText().trim(), i);
	        }

	        LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

	        // --------------------------------------------------
	        // STEP 4 → Fetch Table Row Values
	        // --------------------------------------------------
	        WebElement tableRow = driver.findElement(TableRow);
	        List<WebElement> columnValues = tableRow.findElements(By.tagName("td"));

	        for (String key : storeHeaderColumnNameInfo.keySet()) {
	            String value =
	                    columnValues.get(storeHeaderColumnNameInfo.get(key)).getText().trim();
	            tablesValue.put(key, value);
	            LoggerUtil.info("Fetched [" + key + "] → " + value);
	        }

	        // --------------------------------------------------
	        // STEP 5 → Click Edit Button
	        // --------------------------------------------------
	        WebElement actionColumn = columnValues.get(columnValues.size() - 1);
	        WebElement editButton = actionColumn.findElement(By.cssSelector("i.fas.fa-edit"));
	        editButton.click();

	        LoggerUtil.pass("Edit button clicked successfully for Customer: " + customerNameToSearch);
	        return tablesValue;

	    } catch (Exception e) {
	        LoggerUtil.fail(
	                "Failed to click Edit button for Customer [" + customerNameToSearch + "] → " + e.getMessage()
	        );
	        return tablesValue;
	    }
	}

	public static HashMap<String, String> VerifyForDuplicateData(
	        HashMap<String, String> customerData) throws InterruptedException {

	    HashMap<String, String> tablesValue = new HashMap<>();

	    if (customerData == null || customerData.isEmpty()) {
	        LoggerUtil.fail("Provided customerData map is null/empty");
	        return tablesValue;
	    }

	    Thread.sleep(9000);

	    // --------------------------------------------------
	    // STEP 0 → Extract Customer Name
	    // --------------------------------------------------
	    String customerNameToSearch = customerData.get("Customer-Name");
	    LoggerUtil.info("Step 0: Searching for Duplicate Customer Name → " + customerNameToSearch);

	    if (customerNameToSearch == null || customerNameToSearch.isEmpty()) {
	        LoggerUtil.fail("Customer Name missing in provided map: " + customerData);
	        return tablesValue;
	    }

	    // --------------------------------------------------
	    // STEP 1 → Validate Search Box Availability
	    // --------------------------------------------------
	    LoggerUtil.info("Step 1: Validating Customer Search box availability");

	    try {
	        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
	        wait.until(ExpectedConditions.presenceOfElementLocated(EnterValueSearchBox));

	        if (!driver.findElement(EnterValueSearchBox).isDisplayed()) {
	            LoggerUtil.fail("Customer Search box is not visible. Cannot proceed with duplicate validation.");
	            return tablesValue;
	        }

	        LoggerUtil.pass("Customer Search box is available");

	    } catch (Exception e) {
	        LoggerUtil.fail("Customer Search box not loaded. Grid not ready for duplicate validation.");
	        LoggerUtil.error("Search box exception: " + e.getMessage());
	        return tablesValue;
	    }

	    // --------------------------------------------------
	    // STEP 2 → Enter Customer Name in Search Box
	    // --------------------------------------------------
	    LoggerUtil.info("Step 2: Entering Customer Name in Search Box: " + customerNameToSearch);
	    clearAndEnterText(driver.findElement(EnterValueSearchBox), customerNameToSearch);

	    // --------------------------------------------------
	    // STEP 3 → Fetch Table Headers
	    // --------------------------------------------------
	    LoggerUtil.info("Step 3: Waiting for table header row");
	    WebElement headRow = driver.findElement(HeaderRow);

	    LoggerUtil.info("Step 4: Capturing table headers");
	    List<WebElement> headerColumns = headRow.findElements(By.tagName("th"));

	    HashMap<String, Integer> storeHeaderColumnNameInfo = new HashMap<>();
	    for (int i = 0; i < headerColumns.size(); i++) {
	        storeHeaderColumnNameInfo.put(headerColumns.get(i).getText().trim(), i);
	    }
	    LoggerUtil.info("Table Header Map: " + storeHeaderColumnNameInfo);

	    // --------------------------------------------------
	    // STEP 4 → Validate Duplicate Not Saved
	    // --------------------------------------------------
	    try {
	        LoggerUtil.info("Step 5: Checking for 'No matching records found' message");

	        WebElement noRecordElement = driver.findElement(
	                By.xpath("//table[@id='example1']/tbody//td[contains(text(),'No matching records found')]"));

	        if (noRecordElement != null && noRecordElement.isDisplayed()) {
	            String msg = noRecordElement.getText().trim();
	            LoggerUtil.pass("Duplicate data NOT saved (as expected). UI Message → " + msg);
	            return tablesValue;
	        }

	    } catch (Exception e) {
	        LoggerUtil.fail(
	                "Duplicate data appears in table → It should NOT have been saved. Customer → "
	                        + customerNameToSearch
	        );
	    }

	    return tablesValue;
	}

	public void VerifyAllFetchedImportedSucessFullyOrNotForDuplicateAndUniqueData(
			Map<String, HashMap<String, String>> customerDataFromExcel) throws InterruptedException {

		HashMap<String, String> expectedOriginal = customerDataFromExcel.get("Original");

		Thread.sleep(3000);

		LoggerUtil.info(" Verifying data for UNIQUE (Original) entry...");

		// Actual values from UI (Unique entry)
		String actualCustomerCode = waitForExpectedElement(CustomerMasterPage.customercode).getAttribute("value")
				.trim();
		String actualCustomerName = waitForExpectedElement(CustomerMasterPage.customername).getAttribute("value")
				.trim();
		String actualCustomerLocation = waitForExpectedElement(CustomerMasterPage.customerlocation)
				.getAttribute("value").trim();

		String actualBusinessDomain = waitForExpectedElement(CustomerMasterPage.businnessdomaidropdown)
				.findElement(By.tagName("span")).getText().trim();

		String actualBusinessSegment = waitForExpectedElement(CustomerMasterPage.businesssegmentdropdown)
				.findElement(By.tagName("span")).getText().trim();

		// Comparison (Original data)
		compareValues("Customer-Code", expectedOriginal.get("Customer-Code"), actualCustomerCode);
		compareValues("Customer-Name", expectedOriginal.get("Customer-Name"), actualCustomerName);
		compareValues("Customer-Location", expectedOriginal.get("Customer-Location"), actualCustomerLocation);
		compareValues("Business-Domain", expectedOriginal.get("Business-Domain"), actualBusinessDomain);
		compareValues("Business-Segment", expectedOriginal.get("Business-Segment"), actualBusinessSegment);

		LoggerUtil.info(" Unique entry verified successfully.");

	}

	/////////////////////////////////////////////////////////////////////// Process
	/////////////////////////////////////////////////////////////////////// Master//////////////////////////////////////////////////////

	public static final By FetchingProcessMasterHeader = By
			.xpath("//form[@id='processForm']/descendant::h3[contains(text(),'')]");

	public void VerifyProcessMasterLoadTime() {
		LoggerUtil.info(" Navigated to Process Master Page");

		// Capture page title
		String actualTitle = driver.getTitle();
		LoggerUtil.info(" Page Title: " + actualTitle);

		String ExpectedTitle = "process Master";

		if (actualTitle.contains(ExpectedTitle)) {

			LoggerUtil.pass("Title Of The Process Master is Correct ");
		} else {

			LoggerUtil.error("Title Of The Process Master Is incorrect");
		}

		// Define expected headers (as per requirement)
		List<String> expectedHeaders = Arrays.asList("Process Master", "Process Details", "RM Input Category*",
				"Suppliers", "Supplier Specific Delta", "Customers", "Customer Specific Delta");

		// Start time
		long startTime = System.currentTimeMillis();

		// Fetch headers from UI
		List<WebElement> headersElements = driver.findElements(FetchingProcessMasterHeader);
		List<String> actualHeaders = headersElements.stream().map(e -> e.getText().trim())
				.filter(name -> !name.isEmpty()).collect(Collectors.toList());

		long endTime = System.currentTimeMillis();
		long loadTime = endTime - startTime;

		// Log headers
		LoggerUtil.info(" Expected Headers of UI : " + expectedHeaders);
		LoggerUtil.info(" Actual Headers from UI: " + actualHeaders);

		// Compare Expected vs Actual
		if (expectedHeaders.equals(actualHeaders)) {
			LoggerUtil.pass(" Headers matched perfectly with expected values.");
		} else {
			LoggerUtil.fail(" Header mismatch detected!");

			// Detailed difference check
			for (int i = 0; i < Math.min(expectedHeaders.size(), actualHeaders.size()); i++) {
				String expected = expectedHeaders.get(i);
				String actual = actualHeaders.get(i);
				if (!expected.equals(actual)) {
					LoggerUtil.error(" Mismatch at column " + (i + 1) + ": Expected='" + expected + "' | Actual='"
							+ actual + "'");
				} else {
					LoggerUtil.info(" Match at column " + (i + 1) + ": " + actual);
				}
			}

			// Extra check: size mismatch
			if (expectedHeaders.size() != actualHeaders.size()) {
				LoggerUtil.error(" Header count mismatch! Expected=" + expectedHeaders.size() + " | Actual="
						+ actualHeaders.size());
			}
		}

		// Log load time
		LoggerUtil.info(" Process Master headers load time: " + loadTime + " ms");
	}

	// Hourly

	public static final By clickingUomDropdownProcessMaster = By.xpath("//select[@id='uomDrop']");

	public static final By listValueRmInputCategoryProcessMaster = By.xpath("//div[@id='rmData']/descendant::label");

	public static final By clickingBusinesSegDropdownbtnProcessMaster = By
			.xpath("//select[@id='SupplierSegment']/following-sibling::div/button");

	public static final By EnterSearchBoxBusinessSegNameProcessMaster = By.xpath(
			"//select[@id='SupplierSegment']/following-sibling::div/div/descendant::input[@class='multiselect-search form-control']");

	public static final By ListBusinessSegCheckboxProcessMaster = By
			.xpath("//select[@id='SupplierSegment']/following-sibling::div/div/descendant::input[@type='checkbox']");

	public static final By CheckboxNamesListProcessMaster = By
			.xpath("//select[@id='SupplierSegment']/following-sibling::div/div/descendant::label");

	public static final By clickingSaveButtonProcessMaster = By.id("processSave");

	public void VerifySaveWithoutMandatoryFieldForProcessName(String EnterProcessRate, String EneterBusinessSegName,
			String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		// Step 1: Enter Process Rate
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 1: Entered Process Rate: " + EnterProcessRate);

		// Step 2: Select UOM (Unit of Measurement)
		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		LoggerUtil.info("Step 2: Selected UOM 'Hourly'");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));

		// Step 3: Fetch RM Input Category List and Select Value
		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		ArrayList<String> ArrayName = new ArrayList<>();
		boolean checkboxnamefound = false;

		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			ArrayName.add(Actualname);

			LoggerUtil.info("Fetched RM Name: " + Actualname);

			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				WebElement Rmcheckboxes = Rm.findElement(By.tagName("input"));
				Rmcheckboxes.click();
				Thread.sleep(4000); // Wait after clicking checkbox
				checkboxnamefound = true;
				LoggerUtil.info("Checkbox for '" + Actualname + "' clicked.");
				break;
			}
		}

		if (!checkboxnamefound) {
			LoggerUtil.fail(" RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
		}

		// Step 4: Search and Select Business Segment
		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 4: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		// Fetch all checkboxes and names
		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		// Step 5: Loop over names and click corresponding checkbox
		boolean businessSegFound = false;
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) { // case-insensitive check
				LoggerUtil.info("Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass(" Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail(" Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		// Step 6: Save the Process and verify toast message
		clickOnElement(clickingSaveButtonProcessMaster);
		LoggerUtil.info("Step 6: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 7: Toast Message after Save: " + ActualToastWarning);

		// Step 7: Assert if the expected message is present in toast
		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				"Expected message not found in toast: " + ExpectedMsg + " but got: " + ActualToastWarning);

		LoggerUtil.pass(" Save operation successful without mandatory field for Process Name.");
	}

	public void VerifySaveWithoutMandatoryFieldForProcessRate(String EnterProcessName, String EneterBusinessSegName,
			String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		// Step 1: Enter Process Name
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

		// Step 2: Enter Process Rate

		// Step 3: Select UOM (Unit of Measurement)
		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		LoggerUtil.info("Step 3: Selected UOM 'Hourly'");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));

		// Step 4: Fetch RM Input Category List and Select Value
		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		ArrayList<String> ArrayName = new ArrayList<>();
		boolean checkboxnamefound = false;

		LoggerUtil.info("Step 4: Fetching RM Input Category List...");
		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			ArrayName.add(Actualname);

			LoggerUtil.info("Fetched RM Name: " + Actualname);

			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				WebElement Rmcheckboxes = Rm.findElement(By.tagName("input"));
				Rmcheckboxes.click();
				Thread.sleep(4000); // Wait after clicking checkbox
				checkboxnamefound = true;
				LoggerUtil.info("✅ Checkbox for '" + Actualname + "' clicked.");
				break;
			}
		}

		if (!checkboxnamefound) {
			LoggerUtil.fail("❌ RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
		}

		// Step 5: Search and Select Business Segment
		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 5: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		// Fetch all checkboxes and names
		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		boolean businessSegFound = false;
		LoggerUtil.info("Step 6: Searching for Business Segment...");
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) { // case-insensitive check
				LoggerUtil.info("✅ Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass("✅ Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail("❌ Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		// Step 7: Save the Process and verify toast message
		clickOnElement(clickingSaveButtonProcessMaster);
		LoggerUtil.info("Step 7: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 8: Toast Message after Save: " + ActualToastWarning);

		// Step 8: Assert if the expected message is present in the toast
		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				"❌ Expected message not found in toast: Expected=" + ExpectedMsg + " but got=" + ActualToastWarning);

		LoggerUtil.pass("✅ Save operation successful without mandatory field for Process Name.");
	}

	public void VerifySaveWithoutMandatoryFieldForWithoutUnit(String EnterProcessName, String EnterProcessRate,
			String EneterBusinessSegName, String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		// Step 1: Enter Process Name
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

		// Step 2: Enter Process Rate
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 2: Entered Process Rate: " + EnterProcessRate);

		// Step 3: Wait for UOM dropdown and fetch RM Input Category
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));
		LoggerUtil.info("Step 3: UOM Dropdown is visible. Selecting RM Input Category.");

		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		ArrayList<String> ArrayName = new ArrayList<>();
		boolean checkboxnamefound = false;

		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			ArrayName.add(Actualname);

			LoggerUtil.info("Fetched RM Name: " + Actualname);

			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				WebElement Rmcheckboxes = Rm.findElement(By.tagName("input"));
				Rmcheckboxes.click();
				Thread.sleep(4000); // Wait after clicking checkbox
				checkboxnamefound = true;
				LoggerUtil.info(" Checkbox for '" + Actualname + "' clicked.");
				break;
			}
		}

		if (!checkboxnamefound) {
			LoggerUtil.fail(" RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
		}

		// Step 4: Search and Select Business Segment
		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 4: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		boolean businessSegFound = false;
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) { // case-insensitive check
				LoggerUtil.info(" Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass(" Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail(" Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		// Step 5: Save the Process and verify toast message
		clickOnElement(clickingSaveButtonProcessMaster);
		LoggerUtil.info("Step 5: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 6: Toast Message after Save: " + ActualToastWarning);

		// Step 6: Assert if the expected message is present in toast
		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				" Expected message not found in toast: Expected=" + ExpectedMsg + " but got: " + ActualToastWarning);

		LoggerUtil.pass(" Save operation successful without mandatory field for Process Name.");
	}

	public static final By FetchingSupplierLNameistBusinessSegTab = By
			.xpath("//table[@id='rmSupplier']/tbody/tr//label");

	public void VerifySaveWithoutMandatoryFieldForWithoutRmInput(String EnterProcessName, String EnterProcessRate,
			String EneterBusinessSegName, String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		// Step 1: Enter Process Name
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

		// Step 2: Enter Process Rate
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 2: Entered Process Rate: " + EnterProcessRate);

		// Step 3: Select UOM (Unit of Measurement)
		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));
		LoggerUtil.info("Step 3: Selected UOM 'Hourly'");

		// Step 4: Search and Select Business Segment
		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));
		LoggerUtil.info("Step 4: Business Segment dropdown clicked.");

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 4: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		// Step 5: Loop through Business Segments and select checkbox
		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		boolean businessSegFound = false;
		LoggerUtil.info("Step 5: Searching for Business Segment...");
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) {
				LoggerUtil.info(" Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass(" Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail(" Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		// Step 6: Wait for Supplier Tab
		LoggerUtil.info("Step 6: Supplier list tab is now visible.");

		Thread.sleep(6000);
		// Step 7: Click Save Button and verify toast message
		clickOnElement(clickingSaveButtonProcessMaster);
		LoggerUtil.info("Step 7: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 8: Toast Message after Save: " + ActualToastWarning);

		// Step 8: Assert if the expected message is present in the toast
		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				" Expected message not found in toast: Expected=" + ExpectedMsg + " but got=" + ActualToastWarning);

		LoggerUtil.pass(" Save operation successful without mandatory field for Process Name.");
	}

	public void VerifySaveWithoutMandatoryFieldSupplier(String EnterProcessName, String EnterProcessRate,
			String EneterBusinessSegName, String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);
		// Step 1: Enter Process Rate
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 1: Entered Process Rate: " + EnterProcessRate);

		// Step 2: Select UOM (Unit of Measurement)
		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		LoggerUtil.info("Step 2: Selected UOM 'Hourly'");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));

		// Step 3: Fetch RM Input Category List and Select Value
		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		ArrayList<String> ArrayName = new ArrayList<>();
		boolean checkboxnamefound = false;

		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			ArrayName.add(Actualname);

			LoggerUtil.info("Fetched RM Name: " + Actualname);

			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				WebElement Rmcheckboxes = Rm.findElement(By.tagName("input"));
				Rmcheckboxes.click();
				Thread.sleep(4000); // Wait after clicking checkbox
				checkboxnamefound = true;
				LoggerUtil.info("Checkbox for '" + Actualname + "' clicked.");
				break;
			}
		}

		if (!checkboxnamefound) {
			LoggerUtil.fail(" RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
		}

		// Step 4: Search and Select Business Segment
		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 4: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		// Fetch all checkboxes and names
		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		// Step 5: Loop over names and click corresponding checkbox
		boolean businessSegFound = false;
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) { // case-insensitive check
				LoggerUtil.info("Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass(" Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail(" Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		// Step 6: Save the Process and verify toast message
		clickOnElement(clickingSaveButtonProcessMaster);
		LoggerUtil.info("Step 6: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 7: Toast Message after Save: " + ActualToastWarning);

		// Step 7: Assert if the expected message is present in toast
		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				"Expected message not found in toast: " + ExpectedMsg + " but got: " + ActualToastWarning);

		LoggerUtil.pass(" Save operation successful without mandatory field Supplier Or Customer");
	}

	public static final By clickingSuppleirDeltaDropdownProcessMaster = By
			.xpath("//select[@id='SupplierSpecificDelta']/following-sibling::div/button");
	public static final By DropdownValuesSuppleirSpecificDeltaProcessMaster = By
			.xpath("//select[@id='SupplierSpecificDelta']/option");
	public static final By SelectingDropdownForSuppDeltaProcessMasterByName = By
			.xpath("//select[@id='SupplierSpecificDelta']/following-sibling::div/div/button/span/label");
	public static final By EnterDeltaTableHeaderRow = By.xpath("//table[@id='comodityRMDeltaTable']/thead/tr");
	public static final By SupplierNameDeltaTable = By.xpath("//table[@id='comodityRMDeltaTable']/tbody");

	public static HashMap<String, String> VerifySaveProcessWithSupplierSpecificDelta(String EnterProcessName,
			String EnterProcessRate, String EneterBusinessSegName, String EnterDeltaVAlue, String ExpectedMsg)
			throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));

		HashMap<String, String> EnterDataUi = new HashMap<String, String>();

		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 1: Entered Process Rate: " + EnterProcessRate);

		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		LoggerUtil.info("Step 2: Selected UOM 'Hourly'");

		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));

		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		ArrayList<String> ArrayName = new ArrayList<>();
		boolean checkboxnamefound = false;

		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			ArrayName.add(Actualname);

			LoggerUtil.info("Fetched RM Name: " + Actualname);

			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				WebElement Rmcheckboxes = Rm.findElement(By.tagName("input"));
				Rmcheckboxes.click();
				Thread.sleep(4000);
				checkboxnamefound = true;
				LoggerUtil.info("Checkbox for '" + Actualname + "' clicked.");
				break;
			}
		}

		if (!checkboxnamefound) {
			LoggerUtil.fail(" RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
		}

		clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingBusinesSegDropdownbtnProcessMaster));

		clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster), EneterBusinessSegName);
		LoggerUtil.info("Step 4: Entered Business Segment Name in search box: " + EneterBusinessSegName);

		// Validate that the list is not null and not empty
		List<WebElement> checkboxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
		List<WebElement> namesCheckbox = driver.findElements(CheckboxNamesListProcessMaster);

		// Validation for null or empty lists
		if (checkboxes == null || namesCheckbox == null || checkboxes.size() == 0 || namesCheckbox.size() == 0) {
			LoggerUtil.fail("Business Segment dropdown is empty or not loaded properly.");

		}

		boolean businessSegFound = false;
		for (int i = 0; i < namesCheckbox.size(); i++) {
			String name = namesCheckbox.get(i).getText().trim();

			if (EneterBusinessSegName.equalsIgnoreCase(name)) {
				LoggerUtil.info("Found Business Segment: " + name);
				WebElement checkboxToClick = checkboxes.get(i);
				checkboxToClick.click();
				LoggerUtil.pass("Checkbox clicked successfully for Business Segment: " + name);
				businessSegFound = true;
				break;
			}
		}

		if (!businessSegFound) {
			LoggerUtil.fail("Business Segment '" + EneterBusinessSegName + "' not found.");
		}

		List<WebElement> SupplierDelta = driver.findElements(DropdownValuesSuppleirSpecificDeltaProcessMaster);

		ArrayList<String> Dropvalues = new ArrayList<String>();

		for (WebElement suppdeltaname : SupplierDelta) {

			String suppname = suppdeltaname.getText().trim();

			Dropvalues.add(suppname);

		}
		System.out.println(Dropvalues);

		WebElement elementToScrollTo = waitForExpectedElement(clickingSuppleirDeltaDropdownProcessMaster);

		// Use JavaScript to scroll to the element
		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("arguments[0].scrollIntoView(true);", elementToScrollTo);

		// Optional: If you want to ensure no further scrolling happens,
		// you can also stop the scrolling at that point.
		Thread.sleep(1000); // Optional: small delay to wait after scroll, adjust as needed

		// Log the action
		LoggerUtil.info("Scrolled to the Supplier Delta Dropdown in Process Master successfully.");

		clickOnElement(clickingSuppleirDeltaDropdownProcessMaster);

		Thread.sleep(2000);

		List<WebElement> supplierDeltaLabels = driver.findElements(SelectingDropdownForSuppDeltaProcessMasterByName);

		for (WebElement label : supplierDeltaLabels) {
			String deltaName = label.getText().trim();
			System.out.println(deltaName);
			if (deltaName.equals("Select all")) {

				WebElement checkbox = label.findElement(By.xpath("./preceding-sibling::input[@type='checkbox']"));
				if (!checkbox.isSelected()) {
					checkbox.click();
				}
				break;
			}
		}

		WebElement Row = driver.findElement(EnterDeltaTableHeaderRow);
		List<WebElement> ListHeadersColoumn = Row.findElements(By.tagName("th"));

		HashMap<String, Integer> headersNameInfo = new HashMap<>();
		for (WebElement name : ListHeadersColoumn) {
			String coloumnname = name.getText().trim();
			headersNameInfo.put(coloumnname, ListHeadersColoumn.indexOf(name));
		}

		LoggerUtil.info("Captured Header Names: " + headersNameInfo);

		// Table body
		WebElement supplierTable = driver.findElement(SupplierNameDeltaTable);
		List<WebElement> allRows = supplierTable.findElements(By.xpath(".//tr"));
		HashMap<Integer, String> supplierNameInfo = new HashMap<>();

		if (headersNameInfo.containsKey("Supplier Name")) {
			int supplierIndex = headersNameInfo.get("Supplier Name") + 1;
			int deltaIndex = headersNameInfo.containsKey("Delta") ? headersNameInfo.get("Delta") + 1 : -1;
			int landedPriceIndex = headersNameInfo.containsKey("Landed Price") ? headersNameInfo.get("Landed Price") + 1
					: -1;

			for (int row = 0; row < allRows.size(); row++) {
				WebElement currentRow = allRows.get(row);

				// Read Supplier Name
				WebElement supplierCell = currentRow.findElement(By.xpath(
						"./td[" + supplierIndex + "]/input[@class='form-control deltaSupplierName readonlyClass']"));
				String suppName = supplierCell.getAttribute("title").trim();
				supplierNameInfo.put(row + 1, suppName);
				LoggerUtil.info("Row " + (row + 1) + " Supplier Name = " + suppName);

				// Match target suppliers
				if (suppName.equals("0801-Celesta") || suppName.equals("Chris 57-Deeannqikrh")
						|| suppName.equals("Lacy 22-Maxinekavjj")) {

					// 1️⃣ Enter Delta
					WebElement deltaInput = currentRow.findElement(By.xpath("./td/input[@id='deltaRMApr']"));
					deltaInput.clear();
					deltaInput.sendKeys(EnterDeltaVAlue);
					deltaInput.sendKeys(Keys.TAB);
					LoggerUtil.pass("Matched Supplier '" + suppName + "' → Entered Delta = " + EnterDeltaVAlue);

					// Wait for Landed Price to update (optional)
					Thread.sleep(1000);

					// 2️⃣ Read Landed Price (UI value)
					if (landedPriceIndex != -1) {
						try {
							WebElement landedPriceCell = currentRow.findElement(
									By.xpath("./td[" + landedPriceIndex + "]//input[contains(@class,'form-control')]"));
							String landedPriceText = landedPriceCell.getAttribute("value").trim();

							double actualLandedPrice = 0.0;
							try {
								actualLandedPrice = Double.parseDouble(landedPriceText);
							} catch (NumberFormatException e) {
								LoggerUtil.warn("Landed Price is not a valid number for supplier: " + suppName);
							}

							// 3️⃣ Calculate expected Landed Price = Delta + Process Rate
							double deltaVal = Double.parseDouble(EnterDeltaVAlue);
							double processRateVal = Double.parseDouble(EnterProcessRate);
							double expectedLanded = deltaVal + processRateVal;

							if (Math.abs(expectedLanded - actualLandedPrice) < 0.001) {
								LoggerUtil.pass(" Landed Price calculation correct for supplier '" + suppName
										+ "' → Expected: " + expectedLanded + " | Actual: " + actualLandedPrice);
							} else {
								LoggerUtil.fail(" Landed Price mismatch for supplier '" + suppName + "' → Expected: "
										+ expectedLanded + " | Actual: " + actualLandedPrice);
							}

						} catch (Exception e) {
							LoggerUtil.warn("Unable to read Landed Price for supplier: " + suppName);
						}
					}
				}
			}
		}

		// Header confirmation
		if (headersNameInfo.containsKey("Delta")) {
			LoggerUtil.info("Header verified for Delta column.");
		}
		if (headersNameInfo.containsKey("Landed Price")) {
			LoggerUtil.info("Header verified for Landed Price column.");
		}

		EnterDataUi.put("Process-Name", EnterProcessName);
		EnterDataUi.put("Process-Rate", EnterProcessRate);
		EnterDataUi.put("BusinessSeg", EneterBusinessSegName);
		EnterDataUi.put("EnterDeltaVAlue", EnterDeltaVAlue);

		List<WebElement> ButtonsListProcessMaster = driver.findElements(clickingButtonsByNameProcessMaster);

		ClickingButtonProcessMasterByName(ButtonsListProcessMaster, "Save");
		LoggerUtil.info("Step 6: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 7: Toast Message after Save: " + ActualToastWarning);

		ClickingButtonProcessMasterByName(ButtonsListProcessMaster, "View");

		Assert.assertTrue(ActualToastWarning.contains(ExpectedMsg),
				"Expected message not found in toast: " + ExpectedMsg + " but got: " + ActualToastWarning);

		LoggerUtil.pass(" Save operation successful with mandatory field Supplier Delta");

		return EnterDataUi;

	}

	public static final By EntervlueSearchboxProcessMasterPage = By
			.xpath("//div[@id='process-view-list']/descendant::input[@class='form-control']");
	public static final By FetchingHeaderRow = By.xpath("//table[@id='unitTable1']/thead/tr");

	public static final By FethchingTableRow = By.xpath("//table[@id='unitTable1']/tbody/tr");

	public HashMap<String, String> FetchingDataProcessMaster(String EnterProceName) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));

		clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProceName);

		// wait.until(ExpectedConditions.visibilityOfElementLocated(EntervlueSearchboxProcessMasterPage));

		Thread.sleep(5000);

		WebElement Row = driver.findElement(FetchingHeaderRow);

		List<WebElement> Coloumns = Row.findElements(By.tagName("th"));

		HashMap<String, Integer> HeaderRowinfo = new HashMap<String, Integer>();

		for (WebElement Coloumn : Coloumns) {

			String coloumnsnameheader = Coloumn.getText().trim();

			HeaderRowinfo.put(coloumnsnameheader, Coloumns.indexOf(Coloumn));

		}
		System.out.println(HeaderRowinfo);

		WebElement TableRow = driver.findElement(FethchingTableRow);

		List<WebElement> TableData = TableRow.findElements(By.tagName("td"));

		HashMap<String, String> StoreTableInfo = new HashMap<String, String>();

		if (HeaderRowinfo.containsKey("S.No")) {

			LoggerUtil.info("S.No Table Row Has Been Fetched");

		}
		if (HeaderRowinfo.containsKey("Process Name")) {

			String TableProcessNameValue = TableData.get(HeaderRowinfo.get("Process Name")).getText().trim();

			StoreTableInfo.put("Process Name", TableProcessNameValue);

		}

		if (HeaderRowinfo.containsKey("Process Rate")) {

			String TableProcessNameValue = TableData.get(HeaderRowinfo.get("Process Rate")).getText().trim();

			StoreTableInfo.put("Process Rate", TableProcessNameValue);

		}

		if (HeaderRowinfo.containsKey("Supplier Name")) {

			String TableProcessNameValue = TableData.get(HeaderRowinfo.get("Supplier Name")).getText().trim();

			StoreTableInfo.put("Supplier Name", TableProcessNameValue);

		}

		if (HeaderRowinfo.containsKey("Business Segment")) {

			String TableProcessNameValue = TableData.get(HeaderRowinfo.get("Business Segment")).getText().trim();

			StoreTableInfo.put("Business Segment", TableProcessNameValue);

		}

		Thread.sleep(6000);
		if (HeaderRowinfo.containsKey("Action")) {
			int actionIndex = HeaderRowinfo.get("Action");

			WebElement actionColumn = TableData.get(actionIndex);
			WebElement editButton = actionColumn.findElement(By.cssSelector("i.fas.fa-edit"));

			editButton.click();

			LoggerUtil.info("Clicked Edit button in Action column.");
		}
		Thread.sleep(15000);

		return StoreTableInfo;

	}

	public void VerifyFetchingDataFromUi(
	        String expectedname,
	        String expectedRate,
	        String EnterDeltaVAlue,
	        String BusinessValue) {

	    // --------------------------------------------------
	    // Process Name Validation
	    // --------------------------------------------------
	    String actualProcessName =
	            waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue)
	                    .getAttribute("value");

	    if (actualProcessName.equals(expectedname)) {
	        LoggerUtil.info("✅ Process Name Matched → Expected: " + expectedname +
	                " | Found: " + actualProcessName);
	    } else {
	        LoggerUtil.error("❌ Process Name Mismatch → Expected: " + expectedname +
	                " | Found: " + actualProcessName);
	    }

	    // --------------------------------------------------
	    // Process Rate Validation (FIXED: numeric-safe)
	    // --------------------------------------------------
	    String actualProcessRate =
	            waitForExpectedElement(ProcessMasterPage.EnterProcessRate)
	                    .getAttribute("value");

	    try {
	        BigDecimal actualRate =
	                new BigDecimal(actualProcessRate).setScale(3, RoundingMode.HALF_UP);
	        BigDecimal expectedRateBD =
	                new BigDecimal(expectedRate).setScale(3, RoundingMode.HALF_UP);

	        if (actualRate.compareTo(expectedRateBD) == 0) {
	            LoggerUtil.info("✅ Process Rate Matched → Expected: " +
	                    expectedRateBD + " | Found: " + actualRate);
	        } else {
	            LoggerUtil.error("❌ Process Rate Mismatch → Expected: " +
	                    expectedRateBD + " | Found: " + actualRate);
	        }

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Process Rate is not numeric → Found: " + actualProcessRate);
	    }

	    // --------------------------------------------------
	    // UOM Validation
	    // --------------------------------------------------
	    Select uomDropdown =
	            new Select(waitForExpectedElement(clickingUomDropdownProcessMaster));

	    String actualUomDropdown =
	            uomDropdown.getFirstSelectedOption().getText().trim();
	    String expectedUom = "Hourly";

	    if (actualUomDropdown.equals(expectedUom)) {
	        LoggerUtil.info("✅ UOM Matched → Expected: " +
	                expectedUom + " | Found: " + actualUomDropdown);
	    } else {
	        LoggerUtil.error("❌ UOM Mismatch → Expected: " +
	                expectedUom + " | Found: " + actualUomDropdown);
	    }

	    // --------------------------------------------------
	    // Business Segment Validation
	    // --------------------------------------------------
	    String actualBusinessSegment =
	            waitForExpectedElement(clickingBusinesSegDropdownbtnProcessMaster)
	                    .getAttribute("title").trim();

	    if (actualBusinessSegment.equals(BusinessValue)) {
	        LoggerUtil.info("✅ Business Segment Matched → Expected: " +
	                BusinessValue + " | Found: " + actualBusinessSegment);
	    } else {
	        LoggerUtil.error("❌ Business Segment Mismatch → Expected: " +
	                BusinessValue + " | Found: " + actualBusinessSegment);
	    }

	    // --------------------------------------------------
	    // Supplier Delta & Landed Price Validation
	    // --------------------------------------------------
	    BigDecimal expectedDelta =
	            new BigDecimal(EnterDeltaVAlue).setScale(3, RoundingMode.HALF_UP);

	    BigDecimal processRate =
	            new BigDecimal(expectedRate).setScale(3, RoundingMode.HALF_UP);

	    BigDecimal tolerance = new BigDecimal("0.001");

	    WebElement headerRow = driver.findElement(EnterDeltaTableHeaderRow);
	    List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));

	    HashMap<String, Integer> headersNameInfo = new HashMap<>();
	    for (int i = 0; i < headerColumns.size(); i++) {
	        headersNameInfo.put(headerColumns.get(i).getText().trim(), i);
	    }

	    WebElement supplierTable = driver.findElement(SupplierNameDeltaTable);
	    List<WebElement> allRows = supplierTable.findElements(By.xpath(".//tr"));

	    int checkedCount = 0, passCount = 0, failCount = 0;

	    if (headersNameInfo.containsKey("Supplier Name")
	            && headersNameInfo.containsKey("Delta")
	            && headersNameInfo.containsKey("Landed Price")) {

	        int supplierIndex = headersNameInfo.get("Supplier Name") + 1;
	        int deltaIndex = headersNameInfo.get("Delta") + 1;
	        int landedPriceIndex = headersNameInfo.get("Landed Price") + 1;

	        for (int row = 0; row < allRows.size(); row++) {

	            WebElement currentRow = allRows.get(row);

	            WebElement supplierCell = currentRow.findElement(By.xpath(
	                    "./td[" + supplierIndex +
	                            "]/input[@class='form-control deltaSupplierName readonlyClass']"));

	            String suppName = supplierCell.getAttribute("title").trim();

	            WebElement deltaCell =
	                    currentRow.findElement(By.xpath("./td[" + deltaIndex + "]//input"));

	            String deltaValue = deltaCell.getAttribute("title").trim();
	            BigDecimal actualDeltaValue = BigDecimal.ZERO;

	            try {
	                actualDeltaValue =
	                        new BigDecimal(deltaValue).setScale(3, RoundingMode.HALF_UP);
	            } catch (Exception e) {
	                LoggerUtil.error("Row " + (row + 1) +
	                        " Supplier '" + suppName +
	                        "' → Delta not numeric: " + deltaValue);
	            }

	            WebElement landedPriceCell =
	                    currentRow.findElement(By.xpath(
	                            "./td[" + landedPriceIndex +
	                                    "]//input[contains(@class,'form-control')]"));

	            String landedPriceValue =
	                    landedPriceCell.getAttribute("value").trim();

	            BigDecimal actualLandedPrice = BigDecimal.ZERO;

	            try {
	                actualLandedPrice =
	                        new BigDecimal(landedPriceValue)
	                                .setScale(3, RoundingMode.HALF_UP);
	            } catch (Exception e) {
	                LoggerUtil.error("Row " + (row + 1) +
	                        " Supplier '" + suppName +
	                        "' → Landed not numeric: " + landedPriceValue);
	            }

	            BigDecimal expectedLanded =
	                    expectedDelta.add(processRate)
	                            .setScale(3, RoundingMode.HALF_UP);

	            if (suppName.equals("0801-Celesta")
	                    || suppName.equals("Chris 57-Deeannqikrh")
	                    || suppName.equals("Lacy 22-Maxinekavjj")) {

	                checkedCount++;

	                if (actualDeltaValue.compareTo(expectedDelta) == 0) {
	                    LoggerUtil.pass("✅ Delta Matched for '" +
	                            suppName + "' → " + actualDeltaValue);
	                } else {
	                    LoggerUtil.fail("❌ Delta Mismatch for '" +
	                            suppName + "' → Expected " +
	                            expectedDelta + ", Found " + actualDeltaValue);
	                    failCount++;
	                }

	                BigDecimal diff =
	                        actualLandedPrice.subtract(expectedLanded).abs();

	                if (diff.compareTo(tolerance) <= 0) {
	                    LoggerUtil.pass("✅ Landed Price Correct for '" +
	                            suppName + "' → Expected: " +
	                            expectedLanded + ", Actual: " + actualLandedPrice);
	                    passCount++;
	                } else {
	                    LoggerUtil.fail("❌ Landed Price Incorrect for '" +
	                            suppName + "' → Expected: " +
	                            expectedLanded + ", Actual: " + actualLandedPrice);
	                    failCount++;
	                }

	            } else {
	                LoggerUtil.info("ℹ️ Skipping supplier '" +
	                        suppName + "' — not in validation list.");
	            }
	        }

	        LoggerUtil.info("===== Validation Summary =====");
	        LoggerUtil.info("Total Suppliers Checked: " + checkedCount);
	        LoggerUtil.info("✅ Passed: " + passCount + " | ❌ Failed: " + failCount);
	        LoggerUtil.info("=============================");

	    } else {
	        LoggerUtil.error("❌ Required headers missing: 'Supplier Name', 'Delta', or 'Landed Price'.");
	    }
	}


	public void clickingCustomerNames(String customerName) {

	    LoggerUtil.info("Step 1: Fetching customer name list from the page.");

	    JavascriptExecutor js = (JavascriptExecutor) driver;

	    try {
	        List<WebElement> customerRows =
	                driver.findElements(By.xpath("//table[@id='rmCustomer']/tbody/tr"));

	        boolean found = false;

	        for (WebElement row : customerRows) {

	            // Re-locate every time (prevents stale)
	            WebElement label = row.findElement(By.xpath(".//label"));
	            String actualName = label.getText().trim();

	            if (actualName.equalsIgnoreCase(customerName)) {

	                LoggerUtil.info("Match found for customer: " + customerName);

	                WebElement checkbox = label.findElement(By.xpath("./input"));

	                // 🔑 CRITICAL FIX
	                js.executeScript(
	                        "arguments[0].scrollIntoView({block:'center'});", checkbox);

	                Thread.sleep(300);

	                // JS click bypasses overlay / header / footer
	                js.executeScript("arguments[0].click();", checkbox);

	                LoggerUtil.pass("Successfully clicked checkbox for customer: " + customerName);
	                found = true;
	                break;
	            }
	        }

	        if (!found) {
	            LoggerUtil.fail("Customer not found in list: " + customerName);
	        }

	    } catch (Exception e) {
	        LoggerUtil.fail(
	                "Exception occurred while clicking customer name '" + customerName + "': "
	                        + e.getMessage());
	    }
	}


	public static final By FetchingCustomerNameProcessMaster = By
			.xpath("//table[@id='rmCustomer']/tbody/descendant::label");
	public static final By CustomerSpecificDeltaDropdownProcessMaster = By
			.xpath("//select[@id='CustomerSpecificDelta']");
	public static final By FetchingTableHeaderNamesCustomerSpecificDelta = By
			.xpath("//table[@id='comodityRMDeltaTableCustomer']/thead/tr");
	public static final By clickingCustomerSpecificDeltaDropdown = By
			.xpath("//select[@id='CustomerSpecificDelta']/following-sibling::div/button");
	public static final By EnterVAlueSearchBoxCustomerSpecificDelta = By
			.xpath("//div[@class='multiselect-container dropdown-menu show']/descendant::input[@type='search']");
	public static final By ListCustomerSpecificDeltaName = By
			.xpath("//div[@class='multiselect-container dropdown-menu show']/descendant::label");
	public static final By FethcCustomerSpecifiDeltaTableBodyValueProcessMaster = By
			.xpath("//table[@id='comodityRMDeltaTableCustomer']/tbody");

	public void VeifyAndSaveCustomerSpecificDelta(String EnterProcessName, String EnterProcessRate,
			String Customernamevalue, String CustomernamesecondValue, String SearchCustomerForCustomerSpecificDelta,
			String EnterSpecificDelta, String ExpectedMsg) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(30));
		LoggerUtil.info("===== Starting verification of Customer Specific Delta process =====");

		// Step 1: Enter Process Name
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
		LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

		// Step 2: Enter Process Rate
		clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
		LoggerUtil.info("Step 2: Entered Process Rate: " + EnterProcessRate);

		// Step 3: Select UOM
		selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
		LoggerUtil.pass("Step 3: Selected UOM as 'Hourly'");
		// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));

		// Step 4: Select RM
		LoggerUtil.info("Step 4: Selecting RM Category: 'Extrusion Rubber & Plastic Hoses'");
		List<WebElement> RmLists = driver.findElements(listValueRmInputCategoryProcessMaster);
		boolean checkboxnamefound = false;

		for (WebElement Rm : RmLists) {
			String Actualname = Rm.getText().trim();
			if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
				Rm.findElement(By.tagName("input")).click();
				Thread.sleep(2000);
				checkboxnamefound = true;
				LoggerUtil.pass("Checkbox for '" + Actualname + "' clicked successfully.");
				break;
			}
		}
		if (!checkboxnamefound) {
			LoggerUtil.fail("RM Name 'Extrusion Rubber & Plastic Hoses' not found in the list.");
			Assert.fail("RM Name not found: Extrusion Rubber & Plastic Hoses");
		}

		// Step 5: Select multiple customers
		LoggerUtil.info("Step 5: Selecting customers: " + Customernamevalue + " & " + CustomernamesecondValue);
		clickingCustomerNames(Customernamevalue);
		clickingCustomerNames(CustomernamesecondValue);
		Thread.sleep(3000);

		WebElement elementToScrollTo = waitForExpectedElement(clickingCustomerSpecificDeltaDropdown);

		// Use JavaScript to scroll to the element
		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("arguments[0].scrollIntoView(true);", elementToScrollTo);

		// Optional: If you want to ensure no further scrolling happens,
		// you can also stop the scrolling at that point.
		Thread.sleep(1000); // Optional: small delay to wait after scroll, adjust as needed

		// Log the action
		LoggerUtil.info("Scrolled to the Supplier Delta Dropdown in Process Master successfully.");

		// Step 7: Search & select customer from Customer Specific Delta
		LoggerUtil.info("Step 7: Clicking on 'Customer Specific Delta' dropdown.");
		clickOnElement(clickingCustomerSpecificDeltaDropdown);

		LoggerUtil.info("Step 8: Searching for customer in Customer Specific Delta list: "
				+ SearchCustomerForCustomerSpecificDelta);
		List<WebElement> CustomerDeltaNames = driver.findElements(ListCustomerSpecificDeltaName);
		boolean customerFound = false;

		for (WebElement Customername : CustomerDeltaNames) {
			String CustomerNameText = Customername.getText().trim();
			if (CustomerNameText.equalsIgnoreCase(SearchCustomerForCustomerSpecificDelta)) {
				Customername.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Successfully selected customer: " + SearchCustomerForCustomerSpecificDelta);
				customerFound = true;
				break;
			}
		}
		if (!customerFound) {
			LoggerUtil.fail(
					"Customer not found in 'Customer Specific Delta' list: " + SearchCustomerForCustomerSpecificDelta);
			Assert.fail("Customer not found in 'Customer Specific Delta' selection list.");
		}

		// Step 9: Validate correct customers and enter Delta values
		LoggerUtil.info("Step 9: Validating each 'Customer Name' row and entering Delta values accordingly.");

		// Locate the table body
		WebElement tableBody = driver.findElement(By.id("DeltaTableBodyCustomer"));
		List<WebElement> tableRows = tableBody.findElements(By.tagName("tr"));

		// Normalize expected names for flexible match
		String normalizedFirst = Customernamevalue.replaceAll("[^a-zA-Z0-9]", "").toLowerCase();
		String normalizedSecond = CustomernamesecondValue.replaceAll("[^a-zA-Z0-9]", "").toLowerCase();

		boolean firstFound = false;
		boolean secondFound = false;

		for (WebElement row : tableRows) {
			// ✅ Fetch visible customer name input
			WebElement nameInput = row.findElement(By.cssSelector("input.deltaCustomerName"));
			String customerTitle = nameInput.getAttribute("title") != null ? nameInput.getAttribute("title").trim()
					: "";
			String customerValue = nameInput.getAttribute("value") != null ? nameInput.getAttribute("value").trim()
					: "";

			String actualCustomerName = !customerTitle.isEmpty() ? customerTitle : customerValue;
			String normalizedActual = actualCustomerName.replaceAll("[^a-zA-Z0-9]", "").toLowerCase();

			LoggerUtil.info("Checking Customer Row: " + actualCustomerName);

			// ✅ If this row matches the first expected customer
			if (normalizedActual.contains(normalizedFirst) || normalizedFirst.contains(normalizedActual)) {
				firstFound = true;
				LoggerUtil.pass("Matched first customer → " + Customernamevalue + " ≈ " + actualCustomerName);

				try {
					WebElement deltaInput = row.findElement(By.cssSelector("input.deltaRMAprCustomer"));
					deltaInput.clear();
					deltaInput.sendKeys(EnterSpecificDelta); // example value — can be parameterized
					LoggerUtil.pass("Entered Delta" + EnterSpecificDelta + "for customer: " + CustomernamesecondValue);
				} catch (NoSuchElementException e) {
					LoggerUtil.warn("Delta input not found for customer: " + Customernamevalue);
				}
			}

			// ✅ If this row matches the second expected customer
			if (normalizedActual.contains(normalizedSecond) || normalizedSecond.contains(normalizedActual)) {
				secondFound = true;
				LoggerUtil.pass("Matched second customer → " + CustomernamesecondValue + " ≈ " + actualCustomerName);

				try {
					WebElement deltaInput = row.findElement(By.cssSelector("input.deltaRMAprCustomer"));
					deltaInput.clear();
					deltaInput.sendKeys(EnterSpecificDelta); // example value — can be parameterized
					LoggerUtil.pass("Entered Delta" + EnterSpecificDelta + "for customer: " + CustomernamesecondValue);
				} catch (NoSuchElementException e) {
					LoggerUtil.warn("Delta input not found for customer: " + CustomernamesecondValue);
				}
			}
		}

		// ✅ Final verification summary
		if (firstFound && secondFound) {
			LoggerUtil.pass("Both customers validated and Delta values entered successfully.");
		} else if (firstFound) {
			LoggerUtil.warn("⚠️ Only first customer found (" + Customernamevalue + "); second missing ("
					+ CustomernamesecondValue + ").");
		} else if (secondFound) {
			LoggerUtil.warn("⚠️ Only second customer found (" + CustomernamesecondValue + "); first missing ("
					+ Customernamevalue + ").");
		} else {
			LoggerUtil.fail("❌ Neither customer found in Customer Specific Delta table.");
			Assert.fail("No customers matched in Customer Specific Delta table.");
		}

		List<WebElement> ButtonsListProcessMaster = driver.findElements(clickingButtonsByNameProcessMaster);

		ClickingButtonProcessMasterByName(ButtonsListProcessMaster, "Save");
		LoggerUtil.info("Step 6: Save button clicked.");

		String ActualToastWarning = waitForExpectedElement(ProcessMasterPage.toastMessage).getText();
		LoggerUtil.info("Step 7: Toast Message after Save: " + ActualToastWarning);

		ClickingButtonProcessMasterByName(ButtonsListProcessMaster, "View");

	}

	public void VerifyFetchingDataFromUiForCustomerSpecificDelta(
	        String expectedname,
	        String expectedRate,
	        String EnetrFirstCustomerName,
	        String EnetrSecondCustomerName) {

	    // --------------------------------------------------
	    // Process Name Validation
	    // --------------------------------------------------
	    String actualProcessName =
	            waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue)
	                    .getAttribute("value");

	    if (actualProcessName.equals(expectedname)) {
	        LoggerUtil.info("✅ Process Name Matched → Expected: " +
	                expectedname + " | Found: " + actualProcessName);
	    } else {
	        LoggerUtil.error("❌ Process Name Mismatch → Expected: " +
	                expectedname + " | Found: " + actualProcessName);
	    }

	    // --------------------------------------------------
	    // Process Rate Validation (FIXED: numeric-safe)
	    // --------------------------------------------------
	    String actualProcessRate =
	            waitForExpectedElement(ProcessMasterPage.EnterProcessRate)
	                    .getAttribute("value");

	    try {
	        BigDecimal actualRate =
	                new BigDecimal(actualProcessRate).setScale(3, RoundingMode.HALF_UP);
	        BigDecimal expectedRateBD =
	                new BigDecimal(expectedRate).setScale(3, RoundingMode.HALF_UP);

	        if (actualRate.compareTo(expectedRateBD) == 0) {
	            LoggerUtil.info("✅ Process Rate Matched → Expected: " +
	                    expectedRateBD + " | Found: " + actualRate);
	        } else {
	            LoggerUtil.error("❌ Process Rate Mismatch → Expected: " +
	                    expectedRateBD + " | Found: " + actualRate);
	        }

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Process Rate is not numeric → Found: " + actualProcessRate);
	    }

	    // --------------------------------------------------
	    // UOM Validation
	    // --------------------------------------------------
	    Select uomDropdown =
	            new Select(waitForExpectedElement(clickingUomDropdownProcessMaster));

	    String actualUomDropdown =
	            uomDropdown.getFirstSelectedOption().getText().trim();
	    String expectedUom = "Hourly";

	    if (actualUomDropdown.equals(expectedUom)) {
	        LoggerUtil.info("✅ UOM Matched → Expected: " +
	                expectedUom + " | Found: " + actualUomDropdown);
	    } else {
	        LoggerUtil.error("❌ UOM Mismatch → Expected: " +
	                expectedUom + " | Found: " + actualUomDropdown);
	    }

	    // --------------------------------------------------
	    // Customer Checkbox Validation
	    // --------------------------------------------------
	    verifyCustomerCheckboxStillSelected(EnetrFirstCustomerName);
	    verifyCustomerCheckboxStillSelected(EnetrSecondCustomerName);

	    // --------------------------------------------------
	    // Scroll to Customer Specific Delta Section
	    // --------------------------------------------------
	    JavascriptExecutor js = (JavascriptExecutor) driver;
	    js.executeScript("window.scrollBy(0, 550);");

	    // --------------------------------------------------
	    // Customer Specific Delta Dropdown Validation
	    // --------------------------------------------------
	    String actualCustomerSpecificDeltaValue =
	            waitForExpectedElement(clickingCustomerSpecificDeltaDropdown)
	                    .getAttribute("title");

	    if (!actualCustomerSpecificDeltaValue.equals("None selected")) {
	        LoggerUtil.pass("✅ Customer Specific Delta Dropdown is not null → " +
	                actualCustomerSpecificDeltaValue);
	    } else {
	        LoggerUtil.error("❌ Customer Specific Delta Dropdown is null");
	    }
	}


	public void verifyCustomerCheckboxStillSelected(String expectedCustomerName) {
		try {
			LoggerUtil.info("Step: Verifying that checkbox for customer '" + expectedCustomerName
					+ "' is still selected after Edit.");

			// Build XPath that matches checkbox inside label containing the name text
			String xpath = "//label[contains(normalize-space(),'" + expectedCustomerName
					+ "')]/input[@type='checkbox']";

			WebElement checkbox = driver.findElement(By.xpath(xpath));

			if (checkbox.isSelected()) {
				LoggerUtil.pass("Verified — Checkbox for customer '" + expectedCustomerName
						+ "' is still selected after Edit.");
			} else {
				LoggerUtil.fail("Checkbox for customer '" + expectedCustomerName + "' is NOT selected after Edit.");
			}

		} catch (NoSuchElementException e) {
			LoggerUtil.fail("Customer '" + expectedCustomerName + "' not found while verifying checkbox selection.");
		} catch (Exception e) {
			LoggerUtil.error("Error while verifying checkbox selection for customer '" + expectedCustomerName + "': "
					+ e.getMessage());
			e.printStackTrace();
		}
	}

	public HashMap<String, String> VerifyDeleteFunctionalityWithNewData(String EnterProceName,
			String ExpectedProcessName, String ExpectedProcessRate, String ExpectedBusinessSegname)
			throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));
		LoggerUtil.info("===== Starting Delete Functionality Verification for Process Master =====");

		HashMap<String, String> StoreTableInfo = new HashMap<>();

		try {
			// Step 1: Search for Process
			LoggerUtil.info("Step 1: Searching for Process → " + EnterProceName);
			clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProceName);
			// wait.until(ExpectedConditions.visibilityOfElementLocated(EntervlueSearchboxProcessMasterPage));
			Thread.sleep(5000);

			// Step 2: Capture table headers
			WebElement Row = driver.findElement(FetchingHeaderRow);
			List<WebElement> Coloumns = Row.findElements(By.tagName("th"));
			HashMap<String, Integer> HeaderRowinfo = new HashMap<>();

			for (WebElement Coloumn : Coloumns) {
				String headerName = Coloumn.getText().trim();
				HeaderRowinfo.put(headerName, Coloumns.indexOf(Coloumn));
			}
			LoggerUtil.info("Fetched Table Headers: " + HeaderRowinfo);

			// Step 3: Fetch table row data
			WebElement TableRow = driver.findElement(FethchingTableRow);
			List<WebElement> TableData = TableRow.findElements(By.tagName("td"));

			if (HeaderRowinfo.containsKey("Process Name")) {
				String value = TableData.get(HeaderRowinfo.get("Process Name")).getText().trim();
				StoreTableInfo.put("Process Name", value);
			}

			if (HeaderRowinfo.containsKey("Process Rate")) {
				String value = TableData.get(HeaderRowinfo.get("Process Rate")).getText().trim();
				StoreTableInfo.put("Process Rate", value);
			}

			if (HeaderRowinfo.containsKey("Business Segment")) {
				String value = TableData.get(HeaderRowinfo.get("Business Segment")).getText().trim();
				StoreTableInfo.put("Business Segment", value);
			}

			// Step 4: Extract actual values
			String ActualProcessName = StoreTableInfo.getOrDefault("Process Name", "");
			String ActualProcessRate = StoreTableInfo.getOrDefault("Process Rate", "");
			String ActualBusinessSegment = StoreTableInfo.getOrDefault("Business Segment", "");

			LoggerUtil.info("Fetched From Table → Process Name: " + ActualProcessName + " | Rate: " + ActualProcessRate
					+ " | Business Segment: " + ActualBusinessSegment);

			// Step 5: Verify values and perform delete
			if (ActualProcessName.contains(ExpectedProcessName) && ActualProcessRate.contains(ExpectedProcessRate)
					&& ActualBusinessSegment.contains(ExpectedBusinessSegname)) {

				LoggerUtil.pass("✅ Matching row found for deletion: " + ExpectedProcessName);
				Thread.sleep(4000);

				if (HeaderRowinfo.containsKey("Action")) {
					int actionIndex = HeaderRowinfo.get("Action");
					WebElement actionColumn = TableData.get(actionIndex);

					// Scroll to delete button
					JavascriptExecutor js = (JavascriptExecutor) driver;
					js.executeScript("arguments[0].scrollIntoView({block: 'center'});", actionColumn);

					WebElement deleteButton = actionColumn.findElement(By.cssSelector(".fas.fa-trash-o"));

					deleteButton.click();
					LoggerUtil.info("Clicked on Delete icon for matching process.");

					// Step 6: Handle alert
					try {

						Alert alert = driver.switchTo().alert();
						String alertText = alert.getText().trim();
						LoggerUtil.info("Alert displayed: " + alertText);

						if (alertText.equals("Are you sure you want to delete this?")) {
							alert.accept();

							String ActulaToastmessage = waitForExpectedElement(ProcessMasterPage.toastMessage)
									.getText();

							if (ActulaToastmessage.equals("Process details deleted successfully."))
								;
							{

								LoggerUtil.pass("Toast Message Getting Correct ....");
							}

							LoggerUtil.pass("✅ Alert confirmed successfully.");
						} else {
							LoggerUtil.warn("⚠ Unexpected alert message: " + alertText);
							alert.dismiss();
							LoggerUtil.info("Alert dismissed due to text mismatch.");
						}

					} catch (NoAlertPresentException e) {
						LoggerUtil.error("❌ No alert appeared after clicking Delete: " + e.getMessage());
					}

					// Step 7: Verify record deletion
					Thread.sleep(4000);
					clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProceName);
					Thread.sleep(3000);

					List<WebElement> rowsAfterDelete = driver.findElements(By.xpath("//table//tbody/tr"));
					if (rowsAfterDelete.isEmpty()) {
						LoggerUtil.pass("✅ Record successfully deleted for Process: " + ExpectedProcessName);
					} else {
						String tableText = driver.findElement(By.xpath("//table//tbody")).getText();
						if (!tableText.contains(ExpectedProcessName)) {
							LoggerUtil.pass(
									"✅ Verified deletion — Process no longer visible in table: " + ExpectedProcessName);
						} else {
							LoggerUtil.fail("❌ Record still visible after delete attempt → " + ExpectedProcessName);
						}
					}

				} else {
					LoggerUtil.warn("⚠️ 'Action' column not found in the table header info.");
				}

			} else {
				LoggerUtil.error("❌ Search Filter returned non-matching data → Process or Rate mismatch.");
				LoggerUtil.info("Expected: " + ExpectedProcessName + " | " + ExpectedProcessRate + " | "
						+ ExpectedBusinessSegname);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception occurred during Delete Functionality verification: " + e.getMessage());
			e.printStackTrace();
		}

		LoggerUtil.info("===== Delete Functionality Verification Completed =====");
		return StoreTableInfo;
	}

	// 21112024

	public void VerifyDeleteFunctionalityWithNewData(String EnterProceName) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));
		LoggerUtil.info("===== Starting Delete Verification (Record Should NOT Delete) =====");

		try {

			List<WebElement> ButtonsListProcessMaster = driver.findElements(clickingButtonsByNameProcessMaster);
			ClickingButtonProcessMasterByName(ButtonsListProcessMaster, "View");

			// Step 1: Search for Process
			LoggerUtil.info("Step 1: Searching for Process → " + EnterProceName);
			clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProceName);
			// wait.until(ExpectedConditions.visibilityOfElementLocated(EntervlueSearchboxProcessMasterPage));
			Thread.sleep(4000);

			// Step 2: Capture table headers
			WebElement Row = driver.findElement(FetchingHeaderRow);
			List<WebElement> Coloumns = Row.findElements(By.tagName("th"));
			HashMap<String, Integer> HeaderRowinfo = new HashMap<>();

			for (WebElement Coloumn : Coloumns) {
				HeaderRowinfo.put(Coloumn.getText().trim(), Coloumns.indexOf(Coloumn));
			}
			LoggerUtil.info("Fetched Table Headers: " + HeaderRowinfo);

			// Step 3: Read Process Name from Table
			WebElement TableRow = driver.findElement(FethchingTableRow);
			List<WebElement> TableData = TableRow.findElements(By.tagName("td"));
			String ActualProcessName = "";

			if (HeaderRowinfo.containsKey("Process Name")) {
				ActualProcessName = TableData.get(HeaderRowinfo.get("Process Name")).getText().trim();
			}

			LoggerUtil.info("Fetched Process Name from table: " + ActualProcessName);

			// Step 4: Match process name only
			if (ActualProcessName.equalsIgnoreCase(EnterProceName)) {
				LoggerUtil.pass("Matching Process Found: " + EnterProceName);

				if (HeaderRowinfo.containsKey("Action")) {
					int actionIndex = HeaderRowinfo.get("Action");
					WebElement actionColumn = TableData.get(actionIndex);

					// Scroll into view
					JavascriptExecutor js = (JavascriptExecutor) driver;
					js.executeScript("arguments[0].scrollIntoView({block: 'center'});", actionColumn);

					// Step 5: Click delete icon
					WebElement deleteButton = actionColumn.findElement(By.cssSelector(".fas.fa-trash-o"));

					deleteButton.click();
					LoggerUtil.info("Clicked on Delete icon for process: " + EnterProceName);

					// Step 6: Handle confirmation alert
					try {

						Alert alert = driver.switchTo().alert();
						String alertText = alert.getText().trim();
						LoggerUtil.info("Alert displayed: " + alertText);

						if (alertText.equals("Are you sure you want to delete this?")) {
							alert.accept();
							LoggerUtil.pass("Alert accepted successfully.");
						} else {
							LoggerUtil.warn("Unexpected alert message: " + alertText);
							alert.dismiss();
						}

					} catch (NoAlertPresentException e) {
						LoggerUtil.error("No alert appeared after clicking Delete: " + e.getMessage());
					}

					// Step 7: Validate toast and confirm record not deleted
					Thread.sleep(3000);
					String actualToastMsg = "";
					String expectedToastMsg = "This process is also Used in Costing";

					try {
						WebElement toast = waitForExpectedElement(ProcessMasterPage.toastMessage);
						actualToastMsg = toast.getText().trim();
						LoggerUtil.info("Toast message displayed: " + actualToastMsg);
					} catch (Exception e) {
						LoggerUtil.warn("No toast message appeared after delete attempt.");
					}

					// ✅ Toast message comparison
					if (actualToastMsg.equals(expectedToastMsg)) {
						LoggerUtil.pass("Toast Message Matched → Expected: " + expectedToastMsg + " | Found: "
								+ actualToastMsg);
					} else {
						LoggerUtil.fail("Toast Message Mismatch → Expected: " + expectedToastMsg + " | Found: "
								+ actualToastMsg);
					}

				} else {
					LoggerUtil.warn("'Action' column not found in table header.");
				}

			} else {
				LoggerUtil.error("Process not found in table for delete verification → " + EnterProceName);
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception during Delete Verification (Should NOT Delete): " + e.getMessage());
			e.printStackTrace();
		}

		LoggerUtil.info("===== Delete (Should NOT Delete) Verification Completed =====");
	}

	public static HashMap<String, String> VerifySaveProcessWithSupplierSpecificDeltaForResetButton(
	        String EnterProcessName,
	        String EnterProcessRate,
	        String EneterBusinessSegName,
	        String EnterDeltaVAlue) throws InterruptedException {

	    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));
	    LoggerUtil.info("===== Starting Supplier Specific Delta + Reset Button Verification =====");

	    HashMap<String, String> EnterDataUi = new HashMap<>();

	    try {
	        // --------------------------------------------------
	        // Step 1: Enter Process Name
	        // --------------------------------------------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
	        LoggerUtil.info("Step 1: Entered Process Name: " + EnterProcessName);

	        // --------------------------------------------------
	        // Step 2: Enter Process Rate
	        // --------------------------------------------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
	        LoggerUtil.info("Step 2: Entered Process Rate: " + EnterProcessRate);

	        // --------------------------------------------------
	        // Step 3: Select UOM
	        // --------------------------------------------------
	        selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
	        LoggerUtil.info("Step 3: Selected UOM 'Hourly'");

	        // --------------------------------------------------
	        // Step 4: Select RM Category
	        // --------------------------------------------------
	        boolean checkboxnamefound = false;
	        for (WebElement Rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
	            String Actualname = Rm.getText().trim();
	            if (Actualname.equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
	                Rm.findElement(By.tagName("input")).click();
	                checkboxnamefound = true;
	                LoggerUtil.pass("RM Category selected: " + Actualname);
	                break;
	            }
	        }
	        if (!checkboxnamefound)
	            LoggerUtil.fail("RM 'Extrusion Rubber & Plastic Hoses' not found!");

	        // --------------------------------------------------
	        // Step 5: Select Business Segment
	        // --------------------------------------------------
	        clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
	        clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster),
	                EneterBusinessSegName);

	        List<WebElement> names = driver.findElements(CheckboxNamesListProcessMaster);
	        List<WebElement> boxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);
	        boolean businessSegFound = false;
	        for (int i = 0; i < names.size(); i++) {
	            if (names.get(i).getText().trim().equalsIgnoreCase(EneterBusinessSegName)) {
	                boxes.get(i).click();
	                businessSegFound = true;
	                LoggerUtil.pass("Business Segment selected: " + EneterBusinessSegName);
	                break;
	            }
	        }
	        if (!businessSegFound)
	            LoggerUtil.fail("Business Segment '" + EneterBusinessSegName + "' not found.");

	        Thread.sleep(4000);

	        // --------------------------------------------------
	        // Step 6: Supplier Specific Delta → Select All (SAFE)
	        // --------------------------------------------------
	        clickOnElement(clickingSuppleirDeltaDropdownProcessMaster);

	        for (WebElement label : driver.findElements(SelectingDropdownForSuppDeltaProcessMasterByName)) {
	            if (label.getText().trim().equalsIgnoreCase("Select all")) {

	                WebElement checkbox =
	                        label.findElement(By.xpath("./preceding-sibling::input[@type='checkbox']"));

	                // ✅ CRITICAL FIX: scroll into safe zone (avoids sticky footer)
	                ((JavascriptExecutor) driver).executeScript(
	                        "arguments[0].scrollIntoView({block:'center'});", checkbox);
	                Thread.sleep(300);

	                if (!checkbox.isSelected()) {
	                    checkbox.click();
	                }

	                LoggerUtil.pass("All suppliers selected from Supplier Specific Delta dropdown.");
	                break;
	            }
	        }

	        // ✅ CLOSE dropdown to avoid overlay issues
	        clickOnElement(clickingSuppleirDeltaDropdownProcessMaster);
	        LoggerUtil.info("Supplier Specific Delta dropdown closed.");

	        // --------------------------------------------------
	        // Step 7: Enter Delta & Verify Landed Price
	        // --------------------------------------------------
	        WebElement Row = driver.findElement(EnterDeltaTableHeaderRow);
	        List<WebElement> headers = Row.findElements(By.tagName("th"));
	        HashMap<String, Integer> headerIndex = new HashMap<>();
	        for (int i = 0; i < headers.size(); i++)
	            headerIndex.put(headers.get(i).getText().trim(), i);

	        WebElement supplierTable = driver.findElement(SupplierNameDeltaTable);
	        List<WebElement> allRows = supplierTable.findElements(By.xpath(".//tr"));

	        for (WebElement row : allRows) {
	            WebElement supplierCell = row.findElement(By.xpath(
	                    "./td[" + (headerIndex.get("Supplier Name") + 1) +
	                            "]/input[@class='form-control deltaSupplierName readonlyClass']"));

	            String suppName = supplierCell.getAttribute("title").trim();

	            if (suppName.equals("0801-Celesta")
	                    || suppName.equals("Chris 57-Deeannqikrh")
	                    || suppName.equals("Lacy 22-Maxinekavjj")) {

	                WebElement deltaInput = row.findElement(By.xpath("./td/input[@id='deltaRMApr']"));
	                deltaInput.clear();
	                deltaInput.sendKeys(EnterDeltaVAlue);
	                deltaInput.sendKeys(Keys.TAB);

	                LoggerUtil.pass("Entered Delta = " + EnterDeltaVAlue + " for Supplier: " + suppName);

	                Thread.sleep(800);

	                WebElement landedCell = row.findElement(By.xpath(
	                        "./td[" + (headerIndex.get("Landed Price") + 1) +
	                                "]//input[contains(@class,'form-control')]"));

	                double expectedLanded =
	                        Double.parseDouble(EnterDeltaVAlue) + Double.parseDouble(EnterProcessRate);
	                double actualLanded =
	                        landedCell.getAttribute("value").isEmpty()
	                                ? 0.0
	                                : Double.parseDouble(landedCell.getAttribute("value"));

	                if (Math.abs(expectedLanded - actualLanded) < 0.001) {
	                    LoggerUtil.pass("Landed correct for " + suppName +
	                            " → Expected: " + expectedLanded + " | Found: " + actualLanded);
	                } else {
	                    LoggerUtil.fail("Landed mismatch for " + suppName +
	                            " → Expected: " + expectedLanded + " | Found: " + actualLanded);
	                }
	            }
	        }

	        // --------------------------------------------------
	        // Step 8: Click Reset
	        // --------------------------------------------------
	        List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);
	        ClickingButtonProcessMasterByName(buttons, "Reset");
	        LoggerUtil.info("Step 8: Clicked Reset button.");
	        Thread.sleep(2500);

	        LoggerUtil.info("===== Reset Button Verification Completed =====");

	        EnterDataUi.put("Process-Name", EnterProcessName);
	        EnterDataUi.put("Process-Rate", EnterProcessRate);
	        EnterDataUi.put("BusinessSeg", EneterBusinessSegName);
	        EnterDataUi.put("EnterDeltaVAlue", EnterDeltaVAlue);
            scrollToElement(waitForExpectedElement(clickingUomDropdownProcessMaster));
	        
	    } catch (Exception e) {
	        LoggerUtil.error("❌ Exception occurred during Reset verification: " + e.getMessage());
	        e.printStackTrace();
	    }

	    return EnterDataUi;
	}

	public void verifyCustomerUncheckedAfterReset(String Customernamevalue) {
		try {
			LoggerUtil.info("Verifying customer checkbox is unchecked after Reset: " + Customernamevalue);

			// Re-fetch the customer list fresh from the DOM after Reset
			List<WebElement> CustomerLists = driver.findElements(FetchingCustomerNameProcessMaster);
			boolean customerFound = false;

			for (WebElement CustomerName : CustomerLists) {
				String customername = CustomerName.getText().trim();

				if (customername.equals(Customernamevalue)) {
					customerFound = true;
					LoggerUtil.info("Customer found for verification: " + Customernamevalue);

					// Locate the corresponding checkbox
					WebElement Customercheck = CustomerName.findElement(By.tagName("input"));

					// ✅ Verify checkbox is *not selected*
					if (!Customercheck.isSelected()) {
						LoggerUtil
								.pass("✅ Customer checkbox for '" + Customernamevalue + "' is unchecked after Reset.");
					} else {
						LoggerUtil.fail(
								"❌ Customer checkbox for '" + Customernamevalue + "' is still selected after Reset.");
					}
					break;
				}
			}

			if (!customerFound) {
				LoggerUtil.warn("⚠️ Customer '" + Customernamevalue + "' not found while verifying reset state.");
			}

		} catch (StaleElementReferenceException e) {
			LoggerUtil.warn("⚠ DOM refreshed. Retrying to verify checkbox state for: " + Customernamevalue);

			try {
				WebElement refreshedCheckbox = driver.findElement(
						By.xpath("//label[contains(.,'" + Customernamevalue + "')]/input[@type='checkbox']"));

				if (!refreshedCheckbox.isSelected()) {
					LoggerUtil.pass("✅ Customer checkbox for '" + Customernamevalue
							+ "' is unchecked after Reset (verified post refresh).");
				} else {
					LoggerUtil.fail("❌ Customer checkbox for '" + Customernamevalue
							+ "' is still checked after Reset (verified post refresh).");
				}

			} catch (Exception ex) {
				LoggerUtil.error(
						"❌ Unable to re-verify checkbox for customer '" + Customernamevalue + "': " + ex.getMessage());
			}
		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while verifying checkbox for '" + Customernamevalue + "': " + e.getMessage());
		}
	}
	

	public void VeifyAndSaveCustomerSpecificDeltaForResetButton(
	        String EnterProcessName,
	        String EnterProcessRate,
	        String Customernamevalue,
	        String CustomernamesecondValue,
	        String SearchCustomerForCustomerSpecificDelta,
	        String EnterSpecificDelta) throws InterruptedException {

	    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(30));
	    LoggerUtil.info("===== Starting verification of Customer Specific Delta + Reset Button functionality =====");

	    JavascriptExecutor js = (JavascriptExecutor) driver;

	    try {
	        // ---------------- STEP 1 → Process Name ----------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
	        LoggerUtil.pass("Step 1: Entered Process Name → " + EnterProcessName);

	        // ---------------- STEP 2 → Process Rate ----------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
	        LoggerUtil.pass("Step 2: Entered Process Rate → " + EnterProcessRate);

	        // ---------------- STEP 3 → UOM ----------------
	        selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
	        LoggerUtil.pass("Step 3: Selected UOM → 'Hourly'");

	        // ---------------- STEP 4 → RM Category ----------------
	        boolean rmFound = false;
	        for (WebElement rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
	            if (rm.getText().trim().equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
	                WebElement chk = rm.findElement(By.tagName("input"));
	                js.executeScript("arguments[0].scrollIntoView({block:'center'});", chk);
	                js.executeScript("arguments[0].click();", chk);
	                rmFound = true;
	                LoggerUtil.pass("RM Category selected → Extrusion Rubber & Plastic Hoses");
	                break;
	            }
	        }
	        if (!rmFound) {
	            LoggerUtil.fail("RM Category not found");
	            return;
	        }

	        // ---------------- STEP 5 → Select Customers ----------------
	        clickingCustomerNames(Customernamevalue);
	        clickingCustomerNames(CustomernamesecondValue);

	        // ⚠ DOM refresh happens here
	        Thread.sleep(1500);

	        // ---------------- STEP 6 → Customer Specific Delta Dropdown ----------------
	        LoggerUtil.info("Opening Customer Specific Delta dropdown");

	        // ALWAYS re-locate before click (prevents stale)
	        WebElement deltaDropdownBtn = waitForExpectedElement(
	                By.xpath("//select[@id='CustomerSpecificDelta']/following-sibling::div/button"));

	        js.executeScript("arguments[0].scrollIntoView({block:'center'});", deltaDropdownBtn);
	        js.executeScript("arguments[0].click();", deltaDropdownBtn);

	        Thread.sleep(800);

	        boolean customerFound = false;
	        List<WebElement> deltaOptions = driver.findElements(
	                By.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//label"));

	        for (WebElement label : deltaOptions) {
	            if (label.getText().trim().equalsIgnoreCase(SearchCustomerForCustomerSpecificDelta)) {
	                WebElement checkbox = label.findElement(By.xpath("./preceding-sibling::input"));
	                js.executeScript("arguments[0].click();", checkbox);
	                LoggerUtil.pass("Selected customer in Customer Specific Delta → " + SearchCustomerForCustomerSpecificDelta);
	                customerFound = true;
	                break;
	            }
	        }

	        if (!customerFound) {
	            LoggerUtil.fail("Customer not found in Customer Specific Delta dropdown → "
	                    + SearchCustomerForCustomerSpecificDelta);
	            return;
	        }

	        // ---------------- STEP 7 → Enter Delta Values ----------------
	        WebElement tableBody = waitForExpectedElement(By.id("DeltaTableBodyCustomer"));
	        List<WebElement> rows = tableBody.findElements(By.tagName("tr"));

	        boolean first = false, second = false;

	        for (WebElement row : rows) {
	            String name = row.findElement(By.cssSelector("input.deltaCustomerName"))
	                    .getAttribute("title").trim();

	            if (name.equalsIgnoreCase(Customernamevalue)
	                    || name.equalsIgnoreCase(CustomernamesecondValue)) {

	                WebElement deltaInput = row.findElement(By.cssSelector("input.deltaRMAprCustomer"));
	                deltaInput.clear();
	                deltaInput.sendKeys(EnterSpecificDelta);

	                LoggerUtil.pass("Entered Delta " + EnterSpecificDelta + " for Customer → " + name);

	                if (name.equalsIgnoreCase(Customernamevalue)) first = true;
	                if (name.equalsIgnoreCase(CustomernamesecondValue)) second = true;
	            }
	        }

	        if (first && second)
	            LoggerUtil.pass("Both customers found and delta entered successfully");
	        else
	            LoggerUtil.warn("One or more customers missing in delta table");

	        // ---------------- STEP 8 → RESET ----------------
	        WebElement resetBtn = driver.findElements(clickingButtonsByNameProcessMaster)
	                .stream()
	                .filter(b -> b.getText().trim().equalsIgnoreCase("Reset"))
	                .findFirst()
	                .orElse(null);

	        if (resetBtn != null) {
	            js.executeScript("arguments[0].scrollIntoView({block:'center'});", resetBtn);
	            js.executeScript("arguments[0].click();", resetBtn);
	            LoggerUtil.pass("Clicked Reset button");
	        } else {
	            LoggerUtil.fail("Reset button not found");
	            return;
	        }

	        Thread.sleep(2000);

	        // ---------------- STEP 9 → VALIDATIONS ----------------
	        if (waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue)
	                .getAttribute("value").isEmpty())
	            LoggerUtil.pass("Process Name cleared after Reset");
	        else
	            LoggerUtil.fail("Process Name NOT cleared after Reset");

	        if (waitForExpectedElement(ProcessMasterPage.EnterProcessRate)
	                .getAttribute("value").isEmpty())
	            LoggerUtil.pass("Process Rate cleared after Reset");
	        else
	            LoggerUtil.fail("Process Rate NOT cleared after Reset");

	        String deltaDropdownText = waitForExpectedElement(
	                By.xpath("//select[@id='CustomerSpecificDelta']/following-sibling::div/button"))
	                .getText().trim();

	        if (deltaDropdownText.equalsIgnoreCase("None selected"))
	            LoggerUtil.pass("Customer Specific Delta dropdown reset correctly");
	        else
	            LoggerUtil.fail("Customer Specific Delta dropdown NOT reset → " + deltaDropdownText);

	        scrollToElement(waitForExpectedElement(clickingUomDropdownProcessMaster));
	        LoggerUtil.info("===== Customer Specific Delta Reset Verification Completed =====");

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Exception during Customer Specific Delta Reset Verification: " + e.getMessage());
	        e.printStackTrace();
	    }
	}



	public HashMap<String, String> VerifySaveForSupplier(
	        String EnterProcessName,
	        String EnterProcessRate,
	        String EneterBusinessSegName) {

	    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));
	    LoggerUtil.info("===== Starting Save Verification for Supplier Specific Delta =====");

	    HashMap<String, String> StoreTableInfo = new HashMap<>();

	    try {
	        // Step 1: Enter Process Name
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
	        LoggerUtil.pass("Step 1: Entered Process Name → " + EnterProcessName);

	        // Step 2: Enter Process Rate
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
	        LoggerUtil.pass("Step 2: Entered Process Rate → " + EnterProcessRate);

	        // Step 3: Select UOM
	        selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
	        LoggerUtil.pass("Step 3: Selected UOM → 'Hourly'");

	        // Step 4: Select RM Category
	        boolean rmFound = false;
	        for (WebElement Rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
	            if (Rm.getText().trim().equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {
	                ((JavascriptExecutor) driver)
	                        .executeScript("arguments[0].scrollIntoView({block:'center'});",
	                                Rm.findElement(By.tagName("input")));
	                ((JavascriptExecutor) driver)
	                        .executeScript("arguments[0].click();",
	                                Rm.findElement(By.tagName("input")));
	                rmFound = true;
	                LoggerUtil.pass("Step 4: Selected RM Category → Extrusion Rubber & Plastic Hoses");
	                break;
	            }
	        }
	        if (!rmFound) LoggerUtil.fail("RM Category not found");

	        // Step 5: Select Business Segment
	        clickOnElement(clickingBusinesSegDropdownbtnProcessMaster);
	        clearAndEnterText(waitForExpectedElement(EnterSearchBoxBusinessSegNameProcessMaster),
	                EneterBusinessSegName);

	        List<WebElement> names = driver.findElements(CheckboxNamesListProcessMaster);
	        List<WebElement> boxes = driver.findElements(ListBusinessSegCheckboxProcessMaster);

	        for (int i = 0; i < names.size(); i++) {
	            if (names.get(i).getText().trim().equalsIgnoreCase(EneterBusinessSegName)) {
	                ((JavascriptExecutor) driver).executeScript("arguments[0].click();", boxes.get(i));
	                LoggerUtil.pass("Step 5: Business Segment selected → " + EneterBusinessSegName);
	                break;
	            }
	        }

	        Thread.sleep(4000);

	        // Step 6: Click Save
	        ClickingButtonProcessMasterByName(driver.findElements(clickingButtonsByNameProcessMaster), "Save");
	        LoggerUtil.pass("Clicked on 'Save' button successfully.");

	        // Step 7: Toast validation (SAFE)
	        String toastMsg = waitForExpectedElement(ProcessMasterPage.toastMessage).getText().trim();
	        if (toastMsg.toLowerCase().contains("saved successfully")) {
	            LoggerUtil.pass("Toast message validated → " + toastMsg);
	        } else {
	            LoggerUtil.fail("Unexpected toast message → " + toastMsg);
	        }

	        // Step 8: View
	        ClickingButtonProcessMasterByName(driver.findElements(clickingButtonsByNameProcessMaster), "View");
	        LoggerUtil.pass("Clicked on 'View' button.");

	        Thread.sleep(4000);

	        // Step 9: Table validation (DECIMAL SAFE)
	        clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProcessName);
	        Thread.sleep(6000);

	        WebElement headerRow = driver.findElement(FetchingHeaderRow);
	        List<WebElement> headers = headerRow.findElements(By.tagName("th"));
	        HashMap<String, Integer> headerIndex = new HashMap<>();

	        for (int i = 0; i < headers.size(); i++)
	            headerIndex.put(headers.get(i).getText().trim(), i);

	        WebElement row = driver.findElement(FethchingTableRow);
	        List<WebElement> data = row.findElements(By.tagName("td"));

	        String processName = data.get(headerIndex.get("Process Name")).getText().trim();
	        BigDecimal actualRate =
	                new BigDecimal(data.get(headerIndex.get("Process Rate")).getText().trim());
	        BigDecimal expectedRate =
	                new BigDecimal(EnterProcessRate);

	        String businessSegment = data.get(headerIndex.get("Business Segment")).getText().trim();

	        if (processName.equalsIgnoreCase(EnterProcessName)
	                && actualRate.compareTo(expectedRate) == 0
	                && businessSegment.equalsIgnoreCase(EneterBusinessSegName)) {

	            LoggerUtil.pass("Verified table data → "
	                    + processName + " | " + actualRate + " | " + businessSegment);
	        } else {
	            LoggerUtil.fail("Table mismatch → "
	                    + processName + " | " + actualRate + " | " + businessSegment);
	        }

	        // Step 10: Edit
	        WebElement editBtn = data.get(headerIndex.get("Action"))
	                .findElement(By.cssSelector("i.fas.fa-edit"));
	        ((JavascriptExecutor) driver).executeScript("arguments[0].click();", editBtn);
	        LoggerUtil.pass("Clicked Edit button.");

	    } catch (Exception e) {
	        LoggerUtil.error("Exception during Save verification: " + e.getMessage());
	    }

	    return StoreTableInfo;
	}


	public void VerifyEnterNewDataInProcessNameAndSaveAsNew(String EnterProcessName, String EnterProcessRate,
			String EneterBusinessSegName) throws InterruptedException {

		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));
		LoggerUtil.info("===== Starting 'Save As New' Process Verification =====");

		try {
			// ===============================
			// Step 1: Enter Process Name
			// ===============================
			clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
			LoggerUtil.pass("Step 1: Entered Process Name → " + EnterProcessName);

			// ===============================
			// Step 2: Enter Process Rate
			// ===============================
			clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
			LoggerUtil.pass("Step 2: Entered Process Rate → " + EnterProcessRate);

			// ===============================
			// Step 3: Select UOM
			// ===============================
			selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
			// wait.until(ExpectedConditions.visibilityOfElementLocated(clickingUomDropdownProcessMaster));
			LoggerUtil.pass("Step 3: Selected UOM → 'Hourly'");

			// ===============================
			// Step 4: Select RM Category
			// ===============================
			LoggerUtil.info("Step 4: Selecting RM Category → 'Wiring Harness Assembly Cost Estimator'");
			boolean rmFound = false;

			for (WebElement Rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
				String Actualname = Rm.getText().trim();

				if (Actualname.equalsIgnoreCase("Wiring Harness Assembly Cost Estimator")) {
					try {
						WebElement checkbox = Rm.findElement(By.tagName("input"));

						// Scroll into view
						((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block: 'center'});",
								checkbox);
						Thread.sleep(500);

						// Try normal click first
						try {
							checkbox.click();
							LoggerUtil.pass("✅ Selected RM Category via normal click → " + Actualname);
						} catch (ElementClickInterceptedException e) {
							// JS fallback if click intercepted
							((JavascriptExecutor) driver).executeScript("arguments[0].click();", checkbox);
							LoggerUtil
									.warn("⚠ Element intercepted — JS click performed for RM Category → " + Actualname);
						}

						rmFound = true;
						break;

					} catch (Exception e) {
						LoggerUtil.error("❌ Exception while selecting RM '" + Actualname + "': " + e.getMessage());
					}
				}
			}

			if (!rmFound) {
				LoggerUtil.fail("❌ RM 'Wiring Harness Assembly Cost Estimator' not found in the list.");
				Assert.fail("RM Name not found in available list.");
			}

			// ===============================
			// Step 5: Select Business Segment
			// ===============================
			LoggerUtil.info("Step 5: Selecting Business Segment → " + EneterBusinessSegName);

			// ===============================
			// Step 6: Click 'Save As New' Button
			// ===============================
			Thread.sleep(3000);
			List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);
			ClickingButtonProcessMasterByName(buttons, "Save As New");
			LoggerUtil.info("Step 6: Clicked on 'Save As New' button.");

			// ===============================
			// Step 7: Validate Toast Message
			// ===============================
			try {
				WebElement toast = waitForExpectedElement(ProcessMasterPage.toastMessage);
				String actualToast = toast.getText().trim();
				String expectedToast = "Process details saved successfully.";

				if (actualToast.equalsIgnoreCase(expectedToast)) {
					LoggerUtil.pass("✅ Toast message matched → " + actualToast);
				} else {
					LoggerUtil.fail(
							"❌ Unexpected toast → Expected: '" + expectedToast + "', Found: '" + actualToast + "'");
				}
			} catch (Exception e) {
				LoggerUtil.error("❌ Unable to fetch toast message: " + e.getMessage());
			}

			LoggerUtil.info("===== 'Save As New' Process Verification Completed Successfully =====");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception occurred during 'Save As New' Process Verification: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public HashMap<String, String> VerifySaveForCustomer(
	        String enterProcessName,
	        String enterProcessRate,
	        String firstCustomer,
	        String secondCustomer) {

	    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(20));
	    LoggerUtil.info("===== Starting SAVE verification for CUSTOMER =====");

	    HashMap<String, String> tableData = new HashMap<>();

	    try {

	        // ---------------- STEP 1: Enter Process Name ----------------
	        clearAndEnterText(
	                waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue),
	                enterProcessName
	        );
	        LoggerUtil.pass("Entered Process Name → " + enterProcessName);

	        // ---------------- STEP 2: Enter Process Rate ----------------
	        clearAndEnterText(
	                waitForExpectedElement(ProcessMasterPage.EnterProcessRate),
	                enterProcessRate
	        );
	        LoggerUtil.pass("Entered Process Rate → " + enterProcessRate);

	        // ---------------- STEP 3: Select UOM ----------------
	        selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
	        LoggerUtil.pass("Selected UOM → Hourly");

	        // ---------------- STEP 4: Select RM Category ----------------
	        boolean rmFound = false;
	        for (WebElement rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
	            if (rm.getText().trim().equalsIgnoreCase("Extrusion Rubber & Plastic Hoses")) {

	                WebElement chk = rm.findElement(By.tagName("input"));
	                ((JavascriptExecutor) driver)
	                        .executeScript("arguments[0].scrollIntoView({block:'center'});", chk);
	                ((JavascriptExecutor) driver)
	                        .executeScript("arguments[0].click();", chk);

	                rmFound = true;
	                LoggerUtil.pass("Selected RM Category → Extrusion Rubber & Plastic Hoses");
	                break;
	            }
	        }

	        if (!rmFound) {
	            LoggerUtil.fail("RM Category not found");
	            return tableData;
	        }

	        // ---------------- STEP 5: Select Customers ----------------
	        clickingCustomerNames(firstCustomer);
	        clickingCustomerNames(secondCustomer);
	        LoggerUtil.pass("Selected Customers → " + firstCustomer + ", " + secondCustomer);

	        // ---------------- STEP 6: Save ----------------
	        ClickingButtonProcessMasterByName(
	                driver.findElements(clickingButtonsByNameProcessMaster), "Save");
	        LoggerUtil.pass("Clicked Save button");

	        // ---------------- STEP 7: View ----------------
	        ClickingButtonProcessMasterByName(
	                driver.findElements(clickingButtonsByNameProcessMaster), "View");
	        LoggerUtil.pass("Clicked View button");

	        Thread.sleep(7000);

	        // ---------------- STEP 8: Search ----------------
	        clearAndEnterText(
	                waitForExpectedElement(EntervlueSearchboxProcessMasterPage),
	                enterProcessName
	        );
	        Thread.sleep(3000);

	        // ---------------- STEP 9: Read Table (STALE SAFE) ----------------
	        WebElement headerRow = driver.findElement(FetchingHeaderRow);
	        List<WebElement> headers = headerRow.findElements(By.tagName("th"));

	        HashMap<String, Integer> headerIndex = new HashMap<>();
	        for (int i = 0; i < headers.size(); i++) {
	            headerIndex.put(headers.get(i).getText().trim(), i);
	        }

	        WebElement row = driver.findElement(FethchingTableRow);
	        List<WebElement> cells = row.findElements(By.tagName("td"));

	        String actualName =
	                cells.get(headerIndex.get("Process Name")).getText().trim();
	        String actualRateText =
	                cells.get(headerIndex.get("Process Rate")).getText().trim();
	        String actualBusiness =
	                cells.get(headerIndex.get("Customer Name")).getText().trim();

	        tableData.put("Process Name", actualName);
	        tableData.put("Process Rate", actualRateText);
	        tableData.put("Customer Name", actualBusiness);

	        // ---------------- STEP 10: DECIMAL-SAFE VALIDATION ----------------
	        BigDecimal expectedRate = new BigDecimal(enterProcessRate);
	        BigDecimal actualRate = new BigDecimal(actualRateText);

	        if (actualName.equalsIgnoreCase(enterProcessName)
	                && expectedRate.compareTo(actualRate) == 0
	                && actualBusiness.contains(firstCustomer)) {

	            LoggerUtil.pass(
	                    "Table validation PASSED → "
	                            + actualName + " | "
	                            + actualRate + " | "
	                            + actualBusiness
	            );
	        } else {
	            LoggerUtil.fail(
	                    "Table validation FAILED → Expected: "
	                            + enterProcessName + "/" + enterProcessRate + "/" + firstCustomer
	                            + " | Found: "
	                            + actualName + "/" + actualRate + "/" + actualBusiness
	            );
	        }

	        // ---------------- STEP 11: Edit ----------------
	        if (headerIndex.containsKey("Action")) {
	            WebElement editBtn =
	                    cells.get(headerIndex.get("Action"))
	                            .findElement(By.cssSelector("i.fas.fa-edit"));

	            ((JavascriptExecutor) driver).executeScript("arguments[0].click();", editBtn);
	            LoggerUtil.pass("Clicked Edit button");
	        }

	        LoggerUtil.info("===== CUSTOMER SAVE VERIFICATION COMPLETED =====");

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Exception during customer save verification → " + e.getMessage());
	        e.printStackTrace();
	    }

	    return tableData;
	}

	public void VerifyUpdateButtonForUpdatingValues(
	        String EnterProcessName,
	        String EnterProcessRate,
	        String Customernamevalue,
	        String CustomernamesecondValue) {

	    driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(25));
	    LoggerUtil.info("===== Starting Save & Update Button Verification for CUSTOMER =====");

	    try {

	        // ---------------- STEP 1: Process Name ----------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue), EnterProcessName);
	        LoggerUtil.pass("Entered Process Name → " + EnterProcessName);

	        // ---------------- STEP 2: Process Rate ----------------
	        clearAndEnterText(waitForExpectedElement(ProcessMasterPage.EnterProcessRate), EnterProcessRate);
	        LoggerUtil.pass("Entered Process Rate → " + EnterProcessRate);

	        // ---------------- STEP 3: UOM ----------------
	        selectDropDownValue(clickingUomDropdownProcessMaster, "Hourly", "visibleText");
	        LoggerUtil.pass("UOM Selected → Hourly");

	        // ---------------- STEP 4: RM Category ----------------
	        boolean rmFound = false;
	        for (WebElement rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
	            if (rm.getText().trim().equalsIgnoreCase("Standard Shapes")) {

	                WebElement chk = rm.findElement(By.tagName("input"));
	                ((JavascriptExecutor) driver)
	                        .executeScript("arguments[0].scrollIntoView({block:'center'});", chk);
	                ((JavascriptExecutor) driver).executeScript("arguments[0].click();", chk);

	                rmFound = true;
	                LoggerUtil.pass("RM Category Selected → Standard Shapes");
	                break;
	            }
	        }
	        if (!rmFound) {
	            LoggerUtil.fail("RM 'Standard Shapes' not found");
	            return;
	        }

	        // ---------------- STEP 5: Select Customers ----------------
	        clickingCustomerNames(Customernamevalue);
	        clickingCustomerNames(CustomernamesecondValue);
	        LoggerUtil.pass("Customers selected → " + Customernamevalue + ", " + CustomernamesecondValue);

	        // ---------------- STEP 6: Update ----------------
	        List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);
	        ClickingButtonProcessMasterByName(buttons, "Update");
	        LoggerUtil.pass("Clicked Update button");

	        Thread.sleep(3000);
	        // ---------------- STEP 7: View ----------------
	        ClickingButtonProcessMasterByName(buttons, "View");
	        LoggerUtil.pass("Clicked View button");
	        Thread.sleep(6000);

	        // ---------------- STEP 8: Search ----------------
	        clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), EnterProcessName);
	        Thread.sleep(4000);

	        // ---------------- STEP 9: TABLE READ (STALE SAFE) ----------------
	        WebElement headerRow = driver.findElement(FetchingHeaderRow);
	        List<WebElement> headers = headerRow.findElements(By.tagName("th"));

	        HashMap<String, Integer> headerIndex = new HashMap<>();
	        for (int i = 0; i < headers.size(); i++) {
	            headerIndex.put(headers.get(i).getText().trim(), i);
	        }

	        WebElement dataRow = driver.findElement(FethchingTableRow);
	        List<WebElement> cells = dataRow.findElements(By.tagName("td"));

	        String uiProcessName =
	                cells.get(headerIndex.get("Process Name")).getText().trim();
	        String uiProcessRateText =
	                cells.get(headerIndex.get("Process Rate")).getText().trim();

	        // ---------------- STEP 10: DECIMAL SAFE VALIDATION ----------------
	        BigDecimal expectedRate = new BigDecimal(EnterProcessRate);
	        BigDecimal actualRate = new BigDecimal(uiProcessRateText);

	        if (uiProcessName.equalsIgnoreCase(EnterProcessName)
	                && expectedRate.compareTo(actualRate) == 0) {

	            LoggerUtil.pass("Table verification passed → "
	                    + uiProcessName + " | " + actualRate);
	        } else {
	            LoggerUtil.fail("Table mismatch → Expected: "
	                    + EnterProcessName + "/" + EnterProcessRate
	                    + " | Found: "
	                    + uiProcessName + "/" + actualRate);
	        }

	        // ---------------- STEP 11: Edit ----------------
	        if (headerIndex.containsKey("Action")) {
	            WebElement editBtn =
	                    cells.get(headerIndex.get("Action"))
	                            .findElement(By.cssSelector("i.fas.fa-edit"));

	            ((JavascriptExecutor) driver).executeScript("arguments[0].click();", editBtn);
	            LoggerUtil.pass("Clicked Edit button");
	        }

	        Thread.sleep(3000);

	        // ---------------- STEP 12: Verify Fields After Edit ----------------
	        String actualName =
	                waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue)
	                        .getAttribute("value").trim();

	        String actualRate1 =
	                waitForExpectedElement(ProcessMasterPage.EnterProcessRate)
	                        .getAttribute("value").trim();

	        if (actualName.equalsIgnoreCase(EnterProcessName)) {
	            LoggerUtil.pass("Process Name retained after Edit");
	        } else {
	            LoggerUtil.fail("Process Name mismatch after Edit");
	        }

	        if (new BigDecimal(actualRate1).compareTo(new BigDecimal(EnterProcessRate)) == 0) {
	            LoggerUtil.pass("Process Rate retained after Edit");
	        } else {
	            LoggerUtil.fail("Process Rate mismatch after Edit");
	        }

	        // ---------------- STEP 13: Customer Retention ----------------
	        boolean firstFound = false, secondFound = false;

	        for (WebElement cust : driver.findElements(FetchingCustomerNameProcessMaster)) {
	            String name = cust.getText().trim();
	            WebElement chk = cust.findElement(By.tagName("input"));

	            if (name.equalsIgnoreCase(Customernamevalue)) {
	                if (chk.isSelected()) {
	                    firstFound = true;
	                    LoggerUtil.pass("Customer retained → " + Customernamevalue);
	                }
	            }

	            if (name.equalsIgnoreCase(CustomernamesecondValue)) {
	                if (chk.isSelected()) {
	                    secondFound = true;
	                    LoggerUtil.pass("Customer retained → " + CustomernamesecondValue);
	                }
	            }
	        }

	        if (firstFound && secondFound) {
	            LoggerUtil.pass("Both customers retained after Edit");
	        } else {
	            LoggerUtil.fail("Customer retention failed after Edit");
	        }

	        LoggerUtil.info("===== CUSTOMER UPDATE VERIFICATION COMPLETED SUCCESSFULLY =====");

	    } catch (Exception e) {
	        LoggerUtil.error("Exception during CUSTOMER Update verification → " + e.getMessage());
	        e.printStackTrace();
	    }
	}

	public static final By PopuptextForValidateExportButton = By.xpath("//div[@id='iddpopupexp']//h5");

	public void ClickingExportButtonAndItShouldShowWithinSecond() {

		try {
			LoggerUtil.info("===== ⏱ Step: Verifying Export Button Popup Appears Within 1 Second =====");

			List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);

			long startTime = System.currentTimeMillis(); // Start time in ms
			ClickingButtonProcessMasterByName(buttons, "Export");

			// Wait for popup text to appear
			String actualPopupText = waitForExpectedElement(PopuptextForValidateExportButton).getText();
			long endTime = System.currentTimeMillis(); // End time in ms

			// Calculate duration in seconds
			double actualTimeTaken = (endTime - startTime) / 1000.0;

			LoggerUtil.info(" Popup appeared in " + actualTimeTaken + " second(s)");
			LoggerUtil.info(" Popup Text → " + actualPopupText);

			if (actualTimeTaken <= 1.0) {
				LoggerUtil.pass(" Export popup displayed within 1 second as expected.");
			} else if (actualTimeTaken <= 2.0) {
				LoggerUtil.warn(" Export popup took " + actualTimeTaken + " seconds — slightly slower than expected.");
			} else {
				LoggerUtil.fail(" Export popup appeared too late → " + actualTimeTaken + " seconds.");
			}

			LoggerUtil.info("=====  Export Button Response Time Verification Completed ");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while verifying Export Button popup time: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By DynamicTextForRadioButtonExport = By.xpath("//div[@id='iddpopupexp']//label");
	public static final By clickingSupplierDropdownForExportingExcelFile = By
			.xpath("//select[@id='suppdropdown']/following-sibling::div/button");
	public static final By EnterValueSearchBoxSupplierDrodownForExportingExcelFileProcessMaster = By
			.xpath("//select[@id='suppdropdown']/following-sibling::div/div//input[@type='search']");

	public static final By clickingExportButtonDownloadProcessMaster = By.xpath("//button[@id='exportButton']");

	public HashMap<String, String> VerifyExportOrDownloadExcelFileProcessMaster(String EnetrSupplierName)
			throws InterruptedException {

		HashMap<String, String> storeSuppliername = new HashMap<String, String>();

		List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);

		ClickingButtonProcessMasterByName(buttons, "Export");

		List<WebElement> names = driver.findElements(DynamicTextForRadioButtonExport);

		for (WebElement text : names) {

			String name = text.getText().trim();

			if (name.contains("New process addition")) {

				WebElement RadiobtnnewporcessAdditionforExportExclefile = text
						.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
				RadiobtnnewporcessAdditionforExportExclefile.click();
				break;

			}

		}

		Thread.sleep(8000);
		clickOnElement(clickingSupplierDropdownForExportingExcelFile);

		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxSupplierDrodownForExportingExcelFileProcessMaster),
				EnetrSupplierName);

		for (WebElement suppwebelement : names) {

			String supptext = suppwebelement.getText().trim();

			if (supptext.equals(EnetrSupplierName)) {

				WebElement suppcheckbox = suppwebelement
						.findElement(By.xpath("./preceding-sibling::input[@type='checkbox']"));

				suppcheckbox.click();
				break;
			}
		}

		Thread.sleep(7000);
		clickOnElement(clickingExportButtonDownloadProcessMaster);

		storeSuppliername.put("Supplier name", EnetrSupplierName);
         driver.navigate().refresh();
		
		return storeSuppliername;

	}

	public HashMap<String, String> WriteExcelFileForSupplierProcessMaster() throws InterruptedException {

		HashMap<String, String> storeExcelinfoProcessMaster = new HashMap<>();

		LoggerUtil.info("===== 🧩 Step: Writing Data into Latest Supplier Process Master Excel File =====");

		// Wait for file download to complete
		Thread.sleep(15000);

		File latestFile = getLatestFileProcessMasterForSupplier();

		// Recheck once more if file not found after wait
		if (latestFile == null || !latestFile.exists()) {
			LoggerUtil.fail("❌ No 'Process Master' Excel file found after waiting. Aborting write operation.");
			return storeExcelinfoProcessMaster;
		}

		String filePath = latestFile.getAbsolutePath();
		LoggerUtil.info("📁 Found latest Process Master file: " + latestFile.getName());
		LoggerUtil.info("🗓 Last Modified: " + new Date(latestFile.lastModified()));

		try {
			// Initialize Faker values
			Faker faker = new Faker();
			String processName = faker.name().firstName() + faker.letterify("??????");
			String unitDropdown = "Hourly";
			String rmInput = "Extrusion Rubber & Plastic Hoses";
			String processRate = faker.number().digits(2);
			String suppLanded = faker.number().digits(2);

			LoggerUtil.info("🧠 Generated Random Test Data → " + "Process Name: " + processName + ", UOM: "
					+ unitDropdown + ", RM: " + rmInput + ", Rate: " + processRate + ", SuppDelta: " + suppLanded);

			// Write values to Excel using ExcelFiller
			ExcelFiller.setCellValue(filePath, 0, 2, 1, ExcelFiller.ValueType.STRING, Arrays.asList(processName));
			ExcelFiller.setCellValue(filePath, 0, 3, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(unitDropdown));
			ExcelFiller.setCellValue(filePath, 0, 9, 1, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(rmInput));
			ExcelFiller.setCellValue(filePath, 0, 17, 1, ExcelFiller.ValueType.STRING, Arrays.asList(processRate));
			ExcelFiller.setCellValue(filePath, 0, 18, 1, ExcelFiller.ValueType.STRING, Arrays.asList(suppLanded));

			LoggerUtil.pass("✅ Excel data successfully written in → " + filePath);

			// Store values for validation reference
			storeExcelinfoProcessMaster.put("Process Name", processName);
			storeExcelinfoProcessMaster.put("Unit", unitDropdown);
			storeExcelinfoProcessMaster.put("RM Input", rmInput);
			storeExcelinfoProcessMaster.put("Process Rate", processRate);
			storeExcelinfoProcessMaster.put("Supplier Landed", suppLanded);
			storeExcelinfoProcessMaster.put("Excel File Path ", filePath);
			LoggerUtil.info("🧾 Stored written values for further verification: " + storeExcelinfoProcessMaster);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while writing data into Process Master Excel: " + e.getMessage());
			e.printStackTrace();
		}

		LoggerUtil.info("===== ✅ Completed Excel Write Operation for Supplier Process Master =====");
		return storeExcelinfoProcessMaster;
	}

	public void VeifySaveAndImportExcelFile(HashMap<String, String> storeExcelinfoProcessMaster)
			throws IOException, AWTException, InterruptedException {

		String ActulaExcelFilePath = storeExcelinfoProcessMaster.get("Excel File Path ");

		ExcelUtil.openSaveCloseExcelFile(ActulaExcelFilePath);

		List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);

		ClickingButtonProcessMasterByName(buttons, "Import");

		List<WebElement> names = driver.findElements(DynamicTextForRadioButtonExport);

		for (WebElement text : names) {

			String name = text.getText().trim();

			if (name.contains("Import New Data")) {

				WebElement RadiobtnnewporcessAdditionforExportExclefile = text
						.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
				RadiobtnnewporcessAdditionforExportExclefile.click();
				break;

			}

		}

		WebElement fileInput = driver.findElement(By.id("fileUploadnewdata"));

		// Make it visible via JS
		((JavascriptExecutor) driver).executeScript("arguments[0].style.display = 'block';", fileInput);

		System.out.println("Uploading file: " + ActulaExcelFilePath); // 🧾 for debug

		fileInput.sendKeys(ActulaExcelFilePath); // ✅ correctly sending full path

	}

	public void VerifyExcelImportedFileSaveOrNotInTable(HashMap<String, String> storeExcelinfoProcessMaster)
			throws InterruptedException {

		Thread.sleep(2000);
		List<WebElement> buttons = driver.findElements(clickingButtonsByNameProcessMaster);
		ClickingButtonProcessMasterByName(buttons, "View");
		Thread.sleep(2000);
		String processName = storeExcelinfoProcessMaster.get("Process Name");

		// Step 8: Search Saved Record
		LoggerUtil.info("🔹 Step 8: Searching saved record by process name...");
		clearAndEnterText(waitForExpectedElement(EntervlueSearchboxProcessMasterPage), processName);
		// wait.until(ExpectedConditions.visibilityOfElementLocated(EntervlueSearchboxProcessMasterPage));
		Thread.sleep(5000);

		// Step 9: Read Table Data
		LoggerUtil.info("🔹 Step 9: Reading table data for verification...");
		WebElement Row = driver.findElement(FetchingHeaderRow);
		List<WebElement> Coloumns = Row.findElements(By.tagName("th"));
		HashMap<String, Integer> HeaderRowinfo = new HashMap<>();
		// wait.until(ExpectedConditions.visibilityOfElementLocated(FetchingHeaderRow));

		for (WebElement Coloumn : Coloumns) {
			HeaderRowinfo.put(Coloumn.getText().trim(), Coloumns.indexOf(Coloumn));
		}
		LoggerUtil.info("📘 Captured Header Info: " + HeaderRowinfo);

		// ✅ Step 9.1: Verify visible and non-empty row count (don’t stop execution)
		try {
			WebElement table = waitForExpectedElement(By.id("unitTable1"));
			List<WebElement> allRows = table.findElements(By.xpath(".//tbody/tr"));
			int visibleCount = 0;

			for (WebElement row : allRows) {
				if (row.isDisplayed()) {
					String rowText = row.getText().trim();
					if (!rowText.isEmpty())
						visibleCount++;
				}
			}

			if (visibleCount == 1) {
				LoggerUtil.pass("✅ Only one visible record found after searching → Row count: " + visibleCount);
			} else if (visibleCount > 1) {
				LoggerUtil.fail(
						"❌ Multiple (" + visibleCount + ") visible records found after searching for process name: "
								+ processName + " — continuing execution.");
			} else {
				LoggerUtil.fail(
						"❌ No visible records found in Process Master table after search — continuing execution.");
			}

		} catch (Exception e) {
			LoggerUtil.error("⚠ Error verifying Process Master row count: " + e.getMessage());
		}

		// Step 10: Fetch data from the table for validation
		WebElement TableRow = driver.findElement(FethchingTableRow);
		List<WebElement> TableData = TableRow.findElements(By.tagName("td"));

		String processRate = storeExcelinfoProcessMaster.get("Process Rate");
		String unit = storeExcelinfoProcessMaster.get("Unit");

		String processNameViewTable = TableData.get(HeaderRowinfo.get("Process Name")).getText().trim();
		String processRateViewTable = TableData.get(HeaderRowinfo.get("Process Rate")).getText().trim();
		String unitViewTable = TableData.get(HeaderRowinfo.get("Unit")).getText().trim();

		LoggerUtil.info("🧾 Comparing Excel vs View Table Data → " + "Process Name: [" + processName + " | "
				+ processNameViewTable + "], " + "Rate: [" + processRate + " | " + processRateViewTable + "], "
				+ "Unit: [" + unit + " | " + unitViewTable + "]");

		// ---- BigDecimal Comparison for Rate ----
		boolean isRateEqual = false;
		try {
			BigDecimal excelRate = new BigDecimal(processRate.trim());
			BigDecimal viewRate = new BigDecimal(processRateViewTable.trim());
			isRateEqual = excelRate.compareTo(viewRate) == 0;
		} catch (NumberFormatException e) {
			LoggerUtil.warn("⚠ Unable to convert Process Rate to numeric for comparison: " + e.getMessage());
		}

		// ---- Compare all three fields ----
		if (processName.equalsIgnoreCase(processNameViewTable) && isRateEqual && unit.equalsIgnoreCase(unitViewTable)) {
			LoggerUtil.pass("✅ Table data matches Excel data (BigDecimal check passed) — proceeding to click Edit.");

			LoggerUtil.info("🔹 Step 11: Clicking Edit button...");
			if (HeaderRowinfo.containsKey("Action")) {
				int actionIndex = HeaderRowinfo.get("Action");
				WebElement actionColumn = TableData.get(actionIndex);
				WebElement editButton = actionColumn.findElement(By.cssSelector("i.fas.fa-edit"));

				editButton.click();
				LoggerUtil.pass("✅ Clicked Edit button successfully.");
			} else {
				LoggerUtil.warn("⚠ 'Action' column not found — cannot click Edit.");
			}

		} else {
			LoggerUtil.fail("❌ Table data does not match Excel data — Edit action skipped. " + "(Expected: "
					+ processName + " / " + processRate + " / " + unit + ", Found: " + processNameViewTable + " / "
					+ processRateViewTable + " / " + unitViewTable + ")");
		}
	}

	public static final By supplierTextNameProcessMaster = By.xpath("//table[@id='rmSupplier']/descendant::label");
	public static final By FetchingValueFromSuppdeltaDropdown = By
			.xpath("//select[@id='SupplierSpecificDelta']/following-sibling::div//span");

	public void VerifyUiDataAndExcelData(HashMap<String, String> storeExcelinfoProcessMaster,
			HashMap<String, String> storeSuppliername) {

		LoggerUtil.info("===== 🧩 Step: Verifying UI Data Against Excel Data for Supplier Process Master =====");

		try {
// 🧾 Extract values from Excel HashMap
			String processNameExcel = storeExcelinfoProcessMaster.get("Process Name");
			String processRateExcel = storeExcelinfoProcessMaster.get("Process Rate");
			String unitExcel = storeExcelinfoProcessMaster.get("Unit");
			String rmInputExcel = storeExcelinfoProcessMaster.get("RM Input");
			String suppLandedPriceExcel = storeExcelinfoProcessMaster.get("Supplier Landed");
			String supplierNamefromDowladingExcelDropdown = storeSuppliername.get("Supplier name");

			LoggerUtil.info("📘 Excel Data → " + storeExcelinfoProcessMaster);

// 🧠 Read values from UI
			String processNameUI = waitForExpectedElement(ProcessMasterPage.EnterProcessNameValue).getAttribute("value")
					.trim();
			String processRateUI = waitForExpectedElement(ProcessMasterPage.EnterProcessRate).getAttribute("value")
					.trim();
			String unitUI = new Select(waitForExpectedElement(clickingUomDropdownProcessMaster))
					.getFirstSelectedOption().getText().trim();

// ---- Compare Process Name ----
			if (processNameExcel.equalsIgnoreCase(processNameUI)) {
				LoggerUtil.pass("✅ Process Name matches → " + processNameUI);
			} else {
				LoggerUtil
						.fail("❌ Process Name mismatch → Expected: " + processNameExcel + " | Found: " + processNameUI);
			}

// ---- Compare Process Rate (BigDecimal-safe) ----
			try {
				BigDecimal excelRate = new BigDecimal(processRateExcel.trim());
				BigDecimal uiRate = new BigDecimal(processRateUI.trim());
				if (excelRate.compareTo(uiRate) == 0) {
					LoggerUtil.pass("✅ Process Rate matches numerically → " + uiRate);
				} else {
					LoggerUtil.fail("❌ Process Rate mismatch → Expected: " + excelRate + " | Found: " + uiRate);
				}
			} catch (NumberFormatException e) {
				LoggerUtil.error("⚠ Unable to convert Process Rate for numeric comparison: " + e.getMessage());
			}

// ---- Compare Unit ----
			if (unitExcel.equalsIgnoreCase(unitUI)) {
				LoggerUtil.pass("✅ Unit matches → " + unitUI);
			} else {
				LoggerUtil.fail("❌ Unit mismatch → Expected: " + unitExcel + " | Found: " + unitUI);
			}

// ---- Verify RM Category Checkbox ----
			LoggerUtil.info("🔹 Step: Verifying RM Category checkbox selection dynamically...");
			boolean rmFound = false;
			for (WebElement rm : driver.findElements(listValueRmInputCategoryProcessMaster)) {
				String actualName = rm.getText().trim();
				if (actualName.equalsIgnoreCase(rmInputExcel)) {
					rmFound = true;
					WebElement rmCheckbox = rm.findElement(By.tagName("input"));
					if (rmCheckbox.isSelected()) {
						LoggerUtil.pass("✅ RM Input '" + rmInputExcel + "' checkbox is correctly selected.");
					} else {
						LoggerUtil.fail("❌ RM Input '" + rmInputExcel + "' checkbox is NOT selected.");
					}
					break;
				}
			}
			if (!rmFound) {
				LoggerUtil.fail("❌ RM Input '" + rmInputExcel + "' not found in the RM category list.");
			}

			List<WebElement> SupplierNames = driver.findElements(supplierTextNameProcessMaster);

			for (WebElement supptext : SupplierNames) {

				String suppliers = supptext.getText().trim();

				if (suppliers.equals(supplierNamefromDowladingExcelDropdown)) {

					WebElement checkboxsupplier = supptext.findElement(By.tagName("input"));

					if (checkboxsupplier.isSelected()) {

						LoggerUtil.pass("This is Selected");
					}

				}

			}

			String actualsuppdeltadropname = waitForExpectedElement(FetchingValueFromSuppdeltaDropdown).getText();

			if (actualsuppdeltadropname.equals(supplierNamefromDowladingExcelDropdown)) {

				LoggerUtil.pass("This is pass");
			}

			supplierNamefromDowladingExcelDropdown = supplierNamefromDowladingExcelDropdown.trim()
					.replaceAll("[-\\s]+$", "");

			LoggerUtil.info("📘 Expected from Excel → Supplier: " + supplierNamefromDowladingExcelDropdown
					+ ", Landed Price: " + suppLandedPriceExcel);

			// 🔹 Step 2: Locate the table
			WebElement deltaTableBody = waitForExpectedElement(By.id("DeltaTableBody"));
			List<WebElement> rows = deltaTableBody.findElements(By.tagName("tr"));
			boolean matchFound = false;

			for (WebElement row : rows) {
				try {
					// Supplier name
					WebElement supplierNameInput = row
							.findElement(By.cssSelector("td:nth-child(1) input.deltaSupplierName"));
					String supplierNameUI = supplierNameInput.getAttribute("value").trim();

					// Landed price
					WebElement landedInput = row.findElement(By.cssSelector("td:nth-child(3) input.LCdeltaRMApr"));
					String landedPriceUI = landedInput.getAttribute("value").trim();

					LoggerUtil.info(
							"🔍 Found Row → Supplier: [" + supplierNameUI + "], Landed Price: [" + landedPriceUI + "]");

					// Normalize for matching (ignore trailing '-' and spaces)
					String cleanedSupplierUI = supplierNameUI.replaceAll("[-\\s]+$", "");

					if (supplierNamefromDowladingExcelDropdown.equalsIgnoreCase(cleanedSupplierUI)) {
						LoggerUtil.pass("✅ Supplier Name Matched → " + cleanedSupplierUI);

						// Compare Landed numerically
						try {
							BigDecimal excelLanded = new BigDecimal(suppLandedPriceExcel.trim());
							BigDecimal uiLanded = new BigDecimal(landedPriceUI.trim());

							if (excelLanded.compareTo(uiLanded) == 0) {
								LoggerUtil.pass("✅ Landed Price Matched Numerically → " + uiLanded);
							} else {
								LoggerUtil.fail(
										"❌ Landed Price Mismatch → Expected: " + excelLanded + " | Found: " + uiLanded);
							}
						} catch (NumberFormatException e) {
							LoggerUtil.error("⚠ Error converting Landed Price to numeric: " + e.getMessage());
						}

						matchFound = true;
						break;
					}

				} catch (Exception innerEx) {
					LoggerUtil.error("⚠ Error while reading a row in Delta Table: " + innerEx.getMessage());
				}
			}

			if (!matchFound) {
				LoggerUtil.fail("❌ Supplier Name '" + supplierNamefromDowladingExcelDropdown
						+ "' not found in Delta Table after normalization.");
			} else {
				LoggerUtil.info("===== ✅ Delta Table (Landed Price) Verification Completed Successfully =====");
			}

			// Clean name (remove trailing hyphen/space)
			supplierNamefromDowladingExcelDropdown = supplierNamefromDowladingExcelDropdown.trim()
					.replaceAll("[-\\s]+$", "");

			LoggerUtil.info("📘 Expected from Excel → Supplier: " + supplierNamefromDowladingExcelDropdown
					+ ", Process Rate: " + processRateExcel + ", Landed Price: " + suppLandedPriceExcel);

			for (WebElement row : rows) {
				try {
					// Supplier Name
					WebElement supplierNameInput = row
							.findElement(By.cssSelector("td:nth-child(1) input.deltaSupplierName"));
					String supplierNameUI = supplierNameInput.getAttribute("value").trim();

					// Delta (2nd column)
					WebElement deltaInput = row.findElement(By.cssSelector("td:nth-child(2) input.deltaRMApr"));
					String deltaValueUI = deltaInput.getAttribute("value").trim();

					// Landed Price (3rd column)
					WebElement landedInput = row.findElement(By.cssSelector("td:nth-child(3) input.LCdeltaRMApr"));
					String landedPriceUI = landedInput.getAttribute("value").trim();

					LoggerUtil.info("🔍 Found Row → Supplier: [" + supplierNameUI + "], Delta: [" + deltaValueUI
							+ "], Landed: [" + landedPriceUI + "]");

					// Clean supplier for comparison
					String cleanedSupplierUI = supplierNameUI.replaceAll("[-\\s]+$", "");

					if (supplierNamefromDowladingExcelDropdown.equalsIgnoreCase(cleanedSupplierUI)) {
						matchFound = true;
						LoggerUtil.pass("✅ Supplier Name Matched → " + cleanedSupplierUI);

						try {
							// Convert to BigDecimal for numeric comparison
							BigDecimal processRate = new BigDecimal(processRateExcel.trim());
							BigDecimal landedPrice = new BigDecimal(landedPriceUI.trim());
							BigDecimal deltaUI = new BigDecimal(deltaValueUI.trim());

							// Calculate expected delta = Landed - Process Rate
							BigDecimal expectedDelta = landedPrice.subtract(processRate).setScale(3,
									RoundingMode.HALF_UP);

							LoggerUtil.info("🧮 Calculated Expected Delta = " + landedPrice + " - " + processRate
									+ " = " + expectedDelta);

							// Compare expected vs actual UI Delta
							if (expectedDelta.compareTo(deltaUI) == 0) {
								LoggerUtil.pass("✅ Delta Calculation Correct → Expected: " + expectedDelta + " | UI: "
										+ deltaUI);
							} else {
								LoggerUtil.fail("❌ Delta Calculation Mismatch → Expected: " + expectedDelta
										+ " | Found: " + deltaUI);
							}

						} catch (Exception numEx) {
							LoggerUtil.error("⚠ Error converting numeric values for comparison: " + numEx.getMessage());
						}

						break; // Stop after matched supplier
					}

				} catch (Exception innerEx) {
					LoggerUtil.error("⚠ Error reading Delta Table row: " + innerEx.getMessage());
				}
			}

			if (!matchFound) {
				LoggerUtil.fail("❌ Supplier '" + supplierNamefromDowladingExcelDropdown
						+ "' not found in Delta Table for Delta verification.");
			} else {
				LoggerUtil.info("===== ✅ Delta Table (Delta Value) Verification Completed Successfully =====");
			}
			LoggerUtil.info("===== ✅ UI vs Excel Data Verification Completed Successfully =====");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception occurred during UI vs Excel data verification: " + e.getMessage());
			e.printStackTrace();
		}
	}

///////////////////////////////////////////////////PartMaster ////////////////////////////////////////////////////// 	

	public static final By FetchingHeaderPartMaster = By
			.xpath("//div[@class='row justify-content-center']/descendant::h5[contains(text(),'')]");

	public void VerifyFetchingHeaderAndPageLoadTime() {
		LoggerUtil.info("===== 🧩 Step: Verifying Page Header and Load Time for Part Master =====");

		try {
			// ⏱️ Step 1: Start load timer
			long startTime = System.currentTimeMillis();
			LoggerUtil.info("⏳ Waiting for Part Master page to load...");

			// Step 2: Wait for header element to appear
			WebElement headerElement = waitForExpectedElement(FetchingHeaderPartMaster);
			long endTime = System.currentTimeMillis();

			// Step 3: Measure page load duration
			long loadDuration = endTime - startTime;
			double loadInSeconds = loadDuration / 1000.0;

			// Step 4: Verify Header Text
			String actualHeaderName = headerElement.getText().trim();
			String expectedHeaderName = "Part Master";

			LoggerUtil.info(" Expected Header → " + expectedHeaderName);
			LoggerUtil.info(" Actual Header → " + actualHeaderName);

			if (actualHeaderName.equalsIgnoreCase(expectedHeaderName)) {
				LoggerUtil.pass("✅ Header verified successfully → " + actualHeaderName);
			} else {
				LoggerUtil
						.fail("❌ Header mismatch → Expected: " + expectedHeaderName + " | Found: " + actualHeaderName);
			}

			// Step 5: Log page load performance
			if (loadInSeconds <= 5.0) {
				LoggerUtil.pass(" Page loaded successfully within " + loadInSeconds + " sec.");
			} else if (loadInSeconds <= 10.0) {
				LoggerUtil
						.warn(" Page loaded slower than expected (" + loadInSeconds + " sec). Consider optimization.");
			} else {
				LoggerUtil.fail(" Page load time too high → " + loadInSeconds + " sec.");
			}

			LoggerUtil.info("===== ✅ Header Verification & Load Time Check Completed Successfully =====");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during header verification or load time check: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By EnterValueInSearchBoxPartMaster = By
			.xpath("//span[@class='select2-search select2-search--dropdown']/input");
	public static final By listUomDropdownPartMaster = By.xpath("//ul[@id='select2-PartUOM-results']/li");
	public static final By clickingUomDropdown = By
			.xpath("//select[@id='PartUOM']/following-sibling::span/descendant::span[@id='select2-PartUOM-container']");
	public static final By clickingCompanyNameDropdown = By
			.xpath("//select[@id='PlantSelection']/following-sibling::div/button");

	public static final By FetchingCompanyNames = By
			.xpath("//select[@id='PlantSelection']/following-sibling::div//div/button/descendant::label");

	public static final By FetchingNamesFromPartMaster = By
			.xpath("//div[@class='row align-items-center mb-1']/div/label[contains(text(),'')]");

	public static final By clickingSupplierDropdown = By
			.xpath("//select[@id='SupplierSelection']/following-sibling::div/button");

	public static final By FetchingSupplierName = By
			.xpath("//select[@id='SupplierSelection']/following-sibling::div/div/button/span/label");

	public static final By EnterSearchSupplierNameSupplierDropdown = By
			.xpath("//*[@id='SupplierSelection']/following-sibling::div/descendant::input[@type='search']");

	public static final By ClickingProductCategoryDropdown = By
			.xpath("//select[@id='ProductModel']/following-sibling::div/button");

	public static final By ProductCategoryDropdownName = By
			.xpath("//select[@id='ProductModel']/following-sibling::div/div/button/descendant::label");

	public static final By EnterSearchBoxProductCategoryName = By
			.xpath("//select[@id='ProductModel']/following-sibling::div/div/descendant::input[@type='search']");

	public static final By clickingProductModelNameDropdown = By
			.xpath("//select[@id='SubProductModel']/following-sibling::div/button");

	public static final By EnterValueSearchBoxForProductModel = By
			.xpath("//select[@id='SubProductModel']/following-sibling::div/div/descendant::input[@type='search']");

	public static final By ProductModelNameTextFromDropdownList = By
			.xpath("//select[@id='SubProductModel']/following-sibling::div/div/button/span/label");

	public static final By clickingSpecialProductCategory = By
			.xpath("//select[@id='SpecialProductCategory']/following-sibling::div/button");

	public static final By EnterSearchValueProductCategory = By
			.xpath("//select[@id='SpecialProductCategory']/following-sibling::div/descendant::input[@type='search']");

	public static final By specialProductCategoryListValuesDropdown = By
			.xpath("//select[@id='SpecialProductCategory']/following-sibling::div/descendant::label");

	public static final By clickingButtonsPartMaster = By.xpath(
			"//form[@id='PartMaster']/descendant::div[contains(@class,'footer_sticky_button')]/button[contains(text(),'')]");

	public static final By toastMessage = By.xpath("//div[@class='toast-message']");

	public void EnterValueInSupplierSideAndSave(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredsupplierNameFromText, String RequiredProducCategoryName, String RequiredProducModelName,
			String RequiredSpecialProductCategory) throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			// wait.until(ExpectedConditions.elementToBeClickable(PartMasterPage.clickOnPartUOM));
			LoggerUtil.info("Clicked on UOM dropdown.");

			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection
			// ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Texy =====" + RequiredRadionButtonName);
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}

			// ========================== Supplier Selection ==========================
			LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
			clickOnElement(clickingSupplierDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
					RequiredsupplierNameFromText);

			List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
			for (WebElement Supplier : SupplierNameList) {
				String SupplierText = Supplier.getText().trim();
				if (SupplierText.contains(RequiredsupplierNameFromText)) {
					Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Supplier → " + SupplierText);
					break;
				}
			}

			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);

			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			// ========================== Save Button Click ==========================
			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			// ========================== Toast Message Verification
			// ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast Message =====");
			VerifyToastMessage("Part Master SucessFully Save!");
			LoggerUtil.pass("Toast message verification completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public void EnterValueInCustomerSideAndSave(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredCustomerNameFromText, String RequiredProducCategoryName, String RequiredProducModelName,
			String RequiredSpecialProductCategory) throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			// wait.until(ExpectedConditions.elementToBeClickable(PartMasterPage.clickOnPartUOM));
			LoggerUtil.info("Clicked on UOM dropdown.");

			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection
			// ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Texy =====" + RequiredRadionButtonName);
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}

			// ========================== Customer Selection
			// ===================================================//

			clickOnElement(clickingCustomerDropdown);

			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);

			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);

			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}
			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);

			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			// ========================== Save Button Click ==========================
			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			// ========================== Toast Message Verification
			// ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast Message =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast message verification completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public void EnterValueInSalesSideAndSave(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredCustomerNameFromText,

			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory)
			throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			Thread.sleep(2000);
			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			// wait.until(ExpectedConditions.elementToBeClickable(PartMasterPage.clickOnPartUOM));
			LoggerUtil.info("Clicked on UOM dropdown.");

			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);
			Thread.sleep(2000);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			Thread.sleep(2000);
			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			Thread.sleep(2000);
			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Name =====");
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}

			// ========================================= Customer Selection
			// ========================================================//

			Thread.sleep(2000);
			clickOnElement(clickingCustomerDropdown);

			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);

			Thread.sleep(2000);
			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);

			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			Thread.sleep(2000);
			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			Thread.sleep(3000);
			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
			Thread.sleep(2000);
			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			Thread.sleep(2000);
			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			// ========================== Save Button Click ==========================
			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			// ========================== Toast Message Verification
			// ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast Message =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast message verification completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By clickingCustomerDropdown = By
			.xpath("//select[@id='CustomerSelection']/following-sibling::div/button");
	public static final By EnterSearchboxCustomerName = By
			.xpath("//select[@id='CustomerSelection']/following-sibling::div/descendant::input[@type='search']");
	public static final By CustomerListDropdown = By
			.xpath("//select[@id='CustomerSelection']/following-sibling::div/div/button/span/label");

	public void EnterValueInBothTypeSideAndSave(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredsupplierNameFromText, String RequiredCustomerNameFromText,

			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory)
			throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			Thread.sleep(2000);
			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			// wait.until(ExpectedConditions.elementToBeClickable(PartMasterPage.clickOnPartUOM));
			LoggerUtil.info("Clicked on UOM dropdown.");

			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);
			Thread.sleep(2000);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			Thread.sleep(2000);
			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			Thread.sleep(2000);
			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Name =====");
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected  Radio Button → " + pagenametext);
					break;
				}
			}
			Thread.sleep(2000);

			// Step 5: Select Supplier
			LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
			clickOnElement(clickingSupplierDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
					RequiredsupplierNameFromText);
			List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
			for (WebElement Supplier : SupplierNameList) {
				String SupplierText = Supplier.getText().trim();
				if (SupplierText.equalsIgnoreCase(RequiredsupplierNameFromText)) {
					Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Supplier → " + SupplierText);
					break;
				}
			}
			Thread.sleep(2000);
			// Step 6: Select Customer
			LoggerUtil.info("===== STEP 6: Selecting Customer Name =====");
			clickOnElement(clickingCustomerDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);
			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);
			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.equalsIgnoreCase(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			Thread.sleep(4000);
			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			Thread.sleep(2000);
			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
			Thread.sleep(2000);
			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			Thread.sleep(2000);
			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}
			Thread.sleep(2000);

			// ========================== Save Button Click ==========================
			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			// ========================== Toast Message Verification
			// ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast Message =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast message verification completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public void EnterValueInBothTypeSideAndSaveForCopyCosting(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredsupplierNameFromText, String RequiredCustomerNameFromText, String RequiredProducCategoryName,
			String RequiredProducModelName, String RequiredSpecialProductCategory) throws InterruptedException {

		try {
			LoggerUtil.info("====================================================");
			LoggerUtil.info("🧩 STEP 1: Creating SECOND Part Entry for COPY COSTING Validation");
			LoggerUtil.info("----------------------------------------------------");
			LoggerUtil.info("This part entry is being created specifically to perform Copy Costing tests.");
			LoggerUtil.info(
					"The costing of the first part will be replicated and validated against this newly created record.");
			LoggerUtil.info("====================================================");

			// Step 1: Enter basic details
			LoggerUtil.info("===== STEP 1: Enter Part Details (Copy Costing Part) =====");
			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number (Copy Part) → " + EnterPartNumber);

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description (Copy Part) → " + EnterPartDescription);

			// Step 2: Select UOM
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			// wait.until(ExpectedConditions.elementToBeClickable(PartMasterPage.clickOnPartUOM));
			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);
			boolean matchFound = false;
			for (WebElement ListValue : ListValues) {
				String ActualValueText = ListValue.getText().trim();
				if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
					ListValue.click();
					LoggerUtil.pass("Selected UOM → " + ActualValueText);
					matchFound = true;
					break;
				}
			}
			if (!matchFound)
				LoggerUtil.warn("No exact UOM match found for → " + EnterPartUomName);

			// Step 3: Select Company Name
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);
			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// Step 4: Select Radio Button (Procurement / Both / Sales)
			LoggerUtil.info("===== STEP 4: Selecting Radio Button By Name =====");
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}

			// Step 5: Select Supplier
			LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
			clickOnElement(clickingSupplierDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
					RequiredsupplierNameFromText);
			List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
			for (WebElement Supplier : SupplierNameList) {
				String SupplierText = Supplier.getText().trim();
				if (SupplierText.contains(RequiredsupplierNameFromText)) {
					Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Supplier → " + SupplierText);
					break;
				}
			}

			// Step 6: Select Customer
			LoggerUtil.info("===== STEP 6: Selecting Customer Name =====");
			clickOnElement(clickingCustomerDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);
			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);
			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			// Step 7: Select Product Category
			LoggerUtil.info("===== STEP 7: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);
			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// Step 8: Select Product Model (FAIL-PROOF using locator)
			LoggerUtil.info("===== STEP 8: Selecting Product Model =====");

			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));

			// 8.1 Wait dropdown clickable
			wait.until(ExpectedConditions.elementToBeClickable(clickingProductModelNameDropdown));

			// 8.2 Open dropdown (JS fallback)
			try {
				driver.findElement(clickingProductModelNameDropdown).click();
			} catch (Exception e) {
				JavascriptExecutor js = (JavascriptExecutor) driver;
				js.executeScript("arguments[0].click();", driver.findElement(clickingProductModelNameDropdown));
			}
			LoggerUtil.info("Product Model dropdown clicked.");

			// 8.3 WAIT for search input EXISTENCE (using LOCATOR VARIABLE)
			WebElement searchBox = wait
					.until(driver -> driver.findElements(EnterValueSearchBoxForProductModel).size() > 0
							? driver.findElement(EnterValueSearchBoxForProductModel)
							: null);

			// 8.4 Enter Product Model
			searchBox.clear();
			searchBox.sendKeys(RequiredProducModelName);
			LoggerUtil.info("Entered Product Model search text → " + RequiredProducModelName);

			// 8.5 Select Product Model from list
			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);

			boolean modelFound = false;
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equalsIgnoreCase(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					modelFound = true;
					break;
				}
			}

			if (!modelFound) {
				LoggerUtil.fail("❌ Product Model NOT found in dropdown → " + RequiredProducModelName);
				return;
			}

			// Step 9: Select Special Product Category
			LoggerUtil.info("===== STEP 9: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);
			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			// Step 10: Click Save Button
			LoggerUtil.info("===== STEP 10: Clicking Save Button (Copy Costing Part) =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully for Copy Costing Part.");

			// Step 11: Validate Toast Message
			LoggerUtil.info("===== STEP 11: Verifying Toast Message =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast message verification completed successfully for Copy Costing Part.");

			LoggerUtil.info("✅ Secondary Part creation completed successfully for Copy Costing comparison.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInBothTypeSideAndSaveForCopyCosting: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By ClickingFilterButtonPartMaster = By
			.xpath("//div[@id='divView']/descendant::i[starts-with(@class,'fas fa-filter filter-icon')]");

	public static final By ListFilterNamesPartMaster = By.xpath("//div[@id='chkPartMaster']/label");

	public static final By EnterSearchValuePartMaster = By.xpath("//input[@id='searchBoxPartMaster']");

	public static final By clickingSearchButton = By.xpath("//button[@id='btnSearchPart']");

	private String safe(String s) {
		return (s == null) ? "" : s.trim();
	}

	private String norm(String s) {
		if (s == null)
			return "";
		return s.replaceAll("[^A-Za-z0-9]", "").toLowerCase();
	}

	private Map<String, String> headerAliases() {
		Map<String, String> map = new HashMap<>();
		map.put(norm("Part Number"), norm("Part No."));
		map.put(norm("Part Uom"), norm("Part UOM"));
		map.put(norm("Product Model Name & No."), norm("Product Model Name and No."));
		map.put(norm("Product Category Name"), norm("Product Category"));
		map.put(norm("Supplier Name"), norm("Supplier Detail 1"));
		map.put(norm("Customer Name"), norm("Customer"));
		return map;
	}

	private Map<String, String> normalizeHeaderKeys(LinkedHashMap<String, String> firstRowMap) {
		Map<String, String> out = new HashMap<>();
		if (firstRowMap == null)
			return out;
		for (Map.Entry<String, String> e : firstRowMap.entrySet()) {
			out.put(norm(e.getKey()), safe(e.getValue()));
		}
		return out;
	}

	private Map<String, String> normalizeExpectedKeys(Map<String, String> expectedMap) {
		Map<String, String> out = new LinkedHashMap<>();
		if (expectedMap == null)
			return out;

		Map<String, String> aliases = headerAliases();
		for (Map.Entry<String, String> e : expectedMap.entrySet()) {
			String k = norm(e.getKey());
			String v = safe(e.getValue());
			String alias = aliases.getOrDefault(k, k);
			out.put(alias, v);
		}
		return out;
	}

	// ======================= Your method (execution-safe) =======================

	public void VerifyViewAndSearchFunctionality(String RequiredFilterName, String EnetrSearch)
			throws InterruptedException {

		List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(Buttons, "View");

		Thread.sleep(3200);
		// ===== UPDATED FILTER BLOCK (only this part changed) =====
		clickOnElement(ClickingFilterButtonPartMaster);

		Thread.sleep(3000);
		// Wait using locator (reliable), then fetch list
		wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(ListFilterNamesPartMaster));
		List<WebElement> FilterNames = driver.findElements(ListFilterNamesPartMaster);

		boolean filterFound = false;
		for (WebElement filters : FilterNames) {
			String Name = filters.getText().trim();
			if (Name.equalsIgnoreCase(RequiredFilterName)) {
				WebElement checkbox = filters.findElement(By.tagName("input"));
				checkbox.click();
				LoggerUtil.pass("Filter option FOUND & selected → " + Name);
				filterFound = true;
				break;
			}
		}
		if (!filterFound) {
			LoggerUtil.error("Filter option NOT FOUND → '" + RequiredFilterName + "'. Proceeding without it.");
		}
		// ===== END UPDATED FILTER BLOCK =====
		Thread.sleep(2000);
		clearAndEnterText(waitForExpectedElement(EnterSearchValuePartMaster), EnetrSearch);
		Thread.sleep(2000);
		clickOnElement(clickingSearchButton);
		Thread.sleep(7000);

		getAllHeaderNames();
		verifyFirstRowValueByHeader(RequiredFilterName, EnetrSearch);
	}

	// ======================= Helpers (updated) =======================

	// ======================= Helpers (execution-safe) =======================

	public List<String> getAllHeaderNamesOrdered() {
		List<String> headers = new ArrayList<>();
		try {
			new WebDriverWait(driver, Duration.ofSeconds(10)).until(
					ExpectedConditions.visibilityOfElementLocated(By.xpath("//table[@id='modelTable']//thead//tr")));

			List<WebElement> ths = driver.findElements(By.xpath("//table[@id='modelTable']//thead//th"));
			int i = 1;
			for (WebElement th : ths) {
				String t;
				try {
					Object inner = ((JavascriptExecutor) driver)
							.executeScript("return (arguments[0].innerText || '').toString();", th);
					t = (inner == null) ? "" : inner.toString();
				} catch (Exception ignore) {
					t = th.getText();
				}
				t = t.replace('\u00A0', ' ').replaceAll("\\s+", " ").trim();
				if (t.isEmpty())
					t = "Column#" + i;
				headers.add(t);
				i++;
			}
			LoggerUtil.info("Headers found (" + headers.size() + "): " + headers);
		} catch (Exception e) {
			LoggerUtil.error("Failed to read headers: " + e.getMessage());
		}
		return headers;
	}

	// First row ko header->value map (no hard stop anywhere)
	public LinkedHashMap<String, String> getHeaderToFirstRowMap() {
		LinkedHashMap<String, String> map = new LinkedHashMap<>();
		try {
			new WebDriverWait(driver, Duration.ofSeconds(10))
					.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//table[@id='modelTable']//tbody")));

			List<WebElement> rows = driver.findElements(By.xpath("//table[@id='modelTable']//tbody/tr"));
			int rowCount = (rows == null) ? 0 : rows.size();
			if (rowCount <= 0) {
				LoggerUtil.error("No rows present — cannot read first row.");
				return map;
			}

			List<WebElement> ths = driver.findElements(By.xpath("//table[@id='modelTable']//thead//th"));
			List<String> headers = new ArrayList<>();
			int idx = 1;
			for (WebElement th : ths) {
				String h = th.getText().replace('\u00A0', ' ').replaceAll("\\s+", " ").trim();
				if (h.isEmpty())
					h = "Column#" + idx;
				headers.add(h);
				idx++;
			}

			WebElement firstRow = rows.get(0);
			List<WebElement> cells = firstRow.findElements(By.cssSelector("td"));

			int colCount = Math.min(headers.size(), cells.size());
			if (headers.size() != cells.size()) {
				LoggerUtil.warn("Header count (" + headers.size() + ") != first-row cell count (" + cells.size()
						+ "). Mapping up to " + colCount + ".");
			}

			for (int i = 0; i < colCount; i++) {
				String header = headers.get(i);
				String value = cells.get(i).getText().replace('\u00A0', ' ') // <- FIXED
						.replaceAll("\\s+", " ").trim();
				map.put(header, value);
			}
			LoggerUtil.info("Header → First row values: " + map);
		} catch (Exception e) {
			LoggerUtil.error("getHeaderToFirstRowMap error: " + e.getMessage());
		}
		return map;
	}

	// ========== Normalization + Safety Helpers ==========

	// ======================= Your method (execution-safe) =======================

	public void VerifyViewAndSearchFunctionalityForWhoelRowData(String EnetrSearch, Map<String, String> expectedMap)
			throws InterruptedException {
		try {
			// STEP-0: Open View
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "View");

			Thread.sleep(2000);
			// STEP-1: Search (without filter)
			clearAndEnterText(waitForExpectedElement(EnterSearchValuePartMaster), EnetrSearch);
			Thread.sleep(2000);
			clickOnElement(clickingSearchButton);

			// (If loader locator available, prefer explicit wait-until-hidden)
			Thread.sleep(4000);

			// STEP-2: Table present + rows > 0
			try {
				wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//table[@id='modelTable']//tbody")));
			} catch (Exception e) {
				LoggerUtil.error("Table body not visible after search. " + e.getMessage());
				return; // safe exit
			}
			List<WebElement> rows = driver.findElements(By.xpath("//table[@id='modelTable']//tbody/tr"));
			int rowCount = (rows == null) ? 0 : rows.size();
			if (rowCount <= 0) {
				LoggerUtil.error("Row count is 0 after search — expected at least 1 row.");
				return; // safe exit
			} else {
				LoggerUtil.pass("Rows present after search: " + rowCount);
			}

			List<WebElement> ths = driver.findElements(By.xpath("//table[@id='modelTable']//thead//th"));
			List<String> headers = new ArrayList<>();
			int hIdx = 1;
			for (WebElement th : ths) {
				String h = th.getText();
				if (h == null)
					h = "";

				h = h.replace('\u00A0', ' ').replaceAll("\\s+", " ").trim();
				if (h.isEmpty())
					h = "Column#" + hIdx;
				headers.add(h);
				hIdx++;
			}
			LoggerUtil.info("Headers found (" + headers.size() + "): " + headers);

			WebElement firstRow = rows.get(0);
			List<WebElement> cells = firstRow.findElements(By.cssSelector("td"));
			LoggerUtil.info("First row cells (plain): total=" + cells.size());

			LinkedHashMap<String, String> firstRowMap = new LinkedHashMap<>();
			int colCount = Math.min(headers.size(), cells.size());
			if (headers.size() != cells.size()) {
				LoggerUtil.warn("Header count (" + headers.size() + ") != first-row cell count (" + cells.size()
						+ "). Mapping up to " + colCount + ".");
			}
			for (int i = 0; i < colCount; i++) {
				try {
					String header = headers.get(i);
					String value = cells.get(i).getText();
					if (value == null)
						value = "";
					// ✔ FIX: use String-String (or char-char) consistently
					value = value.replace("\u00A0", " ").replaceAll("\\s+", " ").trim();
					firstRowMap.put(header, value);
				} catch (Exception ex) {
					LoggerUtil.warn("Skipping col #" + (i + 1) + " due to error: " + ex.getMessage());
				}
			}
			if (firstRowMap.isEmpty()) {
				LoggerUtil.error("Could not read first row data — map is empty.");
				return;
			}
			LoggerUtil.info("First row (Header → Value): " + firstRowMap);

			// OPTIONAL: Ensure the search term appears in FIRST ROW somewhere
			if (EnetrSearch != null && !EnetrSearch.trim().isEmpty()) {
				boolean foundInFirstRow = false;
				for (String v : firstRowMap.values()) {
					if (v != null && v.toLowerCase().contains(EnetrSearch.toLowerCase().trim())) {
						foundInFirstRow = true;
						break;
					}
				}
				if (foundInFirstRow) {
					LoggerUtil.pass("Search term found in FIRST ROW: '" + EnetrSearch + "'");
				} else {
					LoggerUtil.error("Search term NOT found in FIRST ROW: '" + EnetrSearch + "'");
				}
			}

			// STEP-4: expected HashMap vs firstRowMap compare (no hard stop)
			if (expectedMap == null || expectedMap.isEmpty()) {
				LoggerUtil.warn("Expected map is null/empty — skipping key/value comparison.");
				LoggerUtil.info("✅ Row validation completed (no hard stop).");
				return;
			}

			// ---- normalization helpers inline ----
			Function<String, String> safe = s -> (s == null) ? "" : s.trim();
			Function<String, String> norm = s -> (s == null) ? "" : s.replaceAll("[^A-Za-z0-9]", "").toLowerCase();
			Map<String, String> alias = new HashMap<>();
			alias.put(norm.apply("Part Number"), norm.apply("Part No."));
			alias.put(norm.apply("Part Uom"), norm.apply("Part UOM"));
			alias.put(norm.apply("Product Model Name & No."), norm.apply("Product Model Name and No."));
			alias.put(norm.apply("Product Category Name"), norm.apply("Product Category"));
			alias.put(norm.apply("Supplier Name"), norm.apply("Supplier Detail 1"));
			alias.put(norm.apply("Customer Name"), norm.apply("Customer"));

			// normalize firstRow headers
			Map<String, String> normalizedFirstRow = new HashMap<>();
			for (Map.Entry<String, String> e : firstRowMap.entrySet()) {
				normalizedFirstRow.put(norm.apply(e.getKey()), safe.apply(e.getValue()));
			}

			// normalize expected keys (apply alias)
			Map<String, String> normalizedExpected = new LinkedHashMap<>();
			for (Map.Entry<String, String> e : expectedMap.entrySet()) {
				String k = norm.apply(e.getKey());
				String v = safe.apply(e.getValue());
				String aliased = alias.getOrDefault(k, k);
				normalizedExpected.put(aliased, v);
			}

			// compare
			LoggerUtil.info("Validating expected key/value pairs against first row...");
			for (Map.Entry<String, String> exp : normalizedExpected.entrySet()) {
				try {
					String normKey = exp.getKey();
					String expectedVal = safe.apply(exp.getValue());

					if (!normalizedFirstRow.containsKey(normKey)) {
						LoggerUtil.error("Header not found in table for expected key → '" + exp.getKey() + "'");
						continue;
					}

					String actualVal = safe.apply(normalizedFirstRow.get(normKey));
					if (actualVal.equalsIgnoreCase(expectedVal)) {
						LoggerUtil.pass("MATCH → [" + exp.getKey() + "]  Expected: '" + expectedVal + "'  |  Actual: '"
								+ actualVal + "'");
					} else {
						LoggerUtil.error("MISMATCH → [" + exp.getKey() + "]  Expected: '" + expectedVal
								+ "'  |  Actual: '" + actualVal + "'");
					}
				} catch (Exception inner) {
					LoggerUtil.warn("Compare step error for key '" + exp.getKey() + "': " + inner.getMessage());
				}
			}

			LoggerUtil.info("✅ Row validation completed (no hard stop).");

		} catch (Throwable t) { // catch-all to ensure absolutely no stop
			LoggerUtil.error("Exception in VerifyViewAndSearchFunctionalityForWhoelRowData: " + t.getMessage());
		}
	}

	// Get all header names as displayed
	public List<String> getAllHeaderNames() {
		List<String> headersText = new ArrayList<>();
		List<WebElement> headers = driver.findElements(By.xpath("//table[@id='modelTable']//thead//th"));
		for (WebElement th : headers) {
			String txt = th.getText().trim();
			if (!txt.isEmpty())
				headersText.add(txt);
		}
		LoggerUtil.info("Headers found (" + headersText.size() + "): " + headersText);
		return headersText;
	}

	// Get 1-based column index by header text (exact match using normalize-space)
	public int getColumnIndexByHeader(String headerName) {
		String headerXpath = "//table[@id='modelTable']//thead//th[normalize-space(.)='" + headerName + "']";
		List<WebElement> found = driver.findElements(By.xpath(headerXpath));
		if (found.isEmpty()) {
			LoggerUtil.fail("Header not found: " + headerName);
			return -1;
		}
		WebElement target = found.get(0);
		int index = target.findElements(By.xpath("preceding-sibling::th")).size() + 1; // 1-based
		LoggerUtil.info("Column '" + headerName + "' found at index: " + index);
		return index;
	}

	// Return first-row text under a given column name (handles links/icons
	// gracefully)
	public String getFirstRowCellTextByHeader(String headerName) {
		int colIndex = getColumnIndexByHeader(headerName);
		if (colIndex <= 0)
			return "";

		List<WebElement> rows = driver.findElements(By.xpath("//table[@id='modelTable']//tbody/tr"));
		if (rows == null || rows.isEmpty()) {
			LoggerUtil.fail("No rows present in table 'modelTable'.");
			return "";
		}

		WebElement cell = driver.findElement(By.xpath("//table[@id='modelTable']//tbody/tr[1]/td[" + colIndex + "]"));

		// Prefer visible link text if present, else cell text
		List<WebElement> links = cell.findElements(By.xpath(".//a"));
		String value;
		if (!links.isEmpty()) {
			value = links.get(0).getText().trim();
		} else {
			value = cell.getText().trim();
		}

		LoggerUtil.info("First-row value under '" + headerName + "' → '" + value + "'");
		return value;
	}

	// Verify: table has rows > 0, header exists, and first-row value matches
	// expected
	public void verifyFirstRowValueByHeader(String headerName, String expectedValue) {

	    try {
	        // --- Step 1: Read headers fresh ---
	        List<WebElement> headers = driver.findElements(
	                By.xpath("//table[@id='modelTable']//thead//th"));

	        int targetIndex = -1;
	        for (int i = 0; i < headers.size(); i++) {
	            String headerText = headers.get(i)
	                    .getText()
	                    .replace('\u00A0', ' ')
	                    .replaceAll("\\s+", " ")
	                    .trim();

	            if (headerText.equalsIgnoreCase(headerName)) {
	                targetIndex = i;
	                LoggerUtil.info("Column '" + headerName + "' found at index: " + targetIndex);
	                break;
	            }
	        }

	        if (targetIndex == -1) {
	            LoggerUtil.fail("Header not found → " + headerName);
	            return;
	        }

	        // --- Step 2: Wait for table body to stabilize ---
	        new WebDriverWait(driver, Duration.ofSeconds(10))
	                .until(ExpectedConditions.presenceOfElementLocated(
	                        By.xpath("//table[@id='modelTable']//tbody/tr")));

	        // --- Step 3: Fetch cell dynamically (NO cached elements) ---
	        By cellLocator = By.xpath(
	                "//table[@id='modelTable']//tbody/tr[1]/td[" + (targetIndex + 1) + "]");

	        WebElement cell = driver.findElement(cellLocator);

	        // --- Step 4: Read text safely (handles <a>, <span>, plain text) ---
	        String actualValue;
	        try {
	            actualValue = cell.getText();
	        } catch (StaleElementReferenceException e) {
	            // one retry only
	            cell = driver.findElement(cellLocator);
	            actualValue = cell.getText();
	        }

	        actualValue = actualValue
	                .replace('\u00A0', ' ')
	                .replaceAll("\\s+", " ")
	                .trim();

	        // --- Step 5: Validation ---
	        if (actualValue.equalsIgnoreCase(expectedValue)) {
	            LoggerUtil.pass("Verified first row value for '" + headerName
	                    + "' → " + actualValue);
	        } else {
	            LoggerUtil.fail("Mismatch for '" + headerName
	                    + "' → Expected: " + expectedValue
	                    + " | Found: " + actualValue);
	        }

	    } catch (Exception e) {
	        LoggerUtil.fail("Exception in verifyFirstRowValueByHeader('"
	                + headerName + "'): " + e.getMessage());
	    }
	}


	/**
	 * Utility: Check if a string is numeric
	 */
	private boolean isNumeric(String value) {
		if (value == null || value.isEmpty())
			return false;
		return value.matches("-?\\d+(\\.\\d+)?");
	}

	public void VerifyToastMessage(String expectedToast) {
		try {
			// Wait and check if toast is visible
			WebElement toastElement = waitForExpectedElement(toastMessage);

			if (toastElement != null && toastElement.isDisplayed()) {
				String actualToast = toastElement.getText().trim();
				LoggerUtil.info("Toast message appeared: " + actualToast);

				// Validate expected message
				if (actualToast.equalsIgnoreCase(expectedToast)) {
					LoggerUtil.info("✅ Toast message validated successfully. Expected: " + expectedToast);
				} else {
					LoggerUtil.error(
							"❌ Toast message mismatch! Expected: " + expectedToast + ", but found: " + actualToast);
				}
			} else {
				LoggerUtil.error("❌ Toast message element not displayed on UI.");
			}
		} catch (Exception e) {
			LoggerUtil.error("⚠️ Exception while verifying toast message: " + e.getMessage());
		}
	}

	public void ClickingButtonPartMasters(List<WebElement> ele, String Names) {
		try {
			LoggerUtil.info("===== STEP: Clicking Button in Part Master → " + Names + " =====");

			if (ele != null && !ele.isEmpty()) {
				boolean buttonFound = false;

				for (WebElement ButtonName : ele) {
					String ButtonText = ButtonName.getText().trim();

					if (ButtonText.equalsIgnoreCase(Names)) {
						ButtonName.click();
						LoggerUtil.pass("✅ Successfully clicked button → " + ButtonText);
						buttonFound = true;
						break;
					}
				}

				if (!buttonFound) {
					LoggerUtil.fail("❌ Button with name '" + Names + "' not found among available buttons.");
				}
			} else {
				LoggerUtil.fail("❌ No buttons found — element list is null or empty.");
			}
		} catch (Exception e) {
			LoggerUtil.error("⚠️ Exception while clicking Part Master button '" + Names + "': " + e.getMessage());
			e.printStackTrace();
		}
	}

	/////////////////////////////////////////// update part
	/////////////////////////////////////////// Master////////////////////////////////////////////////

	public void VerifyViewAndSearchFunctionality(String enterSearch) {
		try {
			LoggerUtil.info("===== Starting VerifyViewAndSearchFunctionality =====");
			LoggerUtil.info("Search Input Provided: " + enterSearch);

			// Step 1: Click on View button
			List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
			LoggerUtil.info("Total buttons found: " + buttons.size());
			ClickingButtonPartMasters(buttons, "View");
			LoggerUtil.pass("Successfully clicked on 'View' button.");
			Thread.sleep(2000);
			// Step 2: Enter search value
			WebElement searchInput = waitForExpectedElement(EnterSearchValuePartMaster);
			clearAndEnterText(searchInput, enterSearch);
			LoggerUtil.info("Entered search value: " + enterSearch);
			Thread.sleep(2000);
			// Step 3: Click on Search button
			clickOnElement(clickingSearchButton);
			LoggerUtil.pass("Clicked on 'Search' button successfully.");

			// Step 4: Wait for results to load
			Thread.sleep(5000); // explicit short wait for data to appear
			LoggerUtil.info("Waiting for table results to load...");

			// Step 5: Validate if search results are displayed
			List<WebElement> tableRows = driver.findElements(TableBody);
			if (tableRows != null && !tableRows.isEmpty()) {
				LoggerUtil.pass("Search successful. Records found: " + tableRows.size());
			} else {
				LoggerUtil.fail("No records found for search value: " + enterSearch);

			}

			LoggerUtil.pass("VerifyViewAndSearchFunctionality completed successfully.");
			LoggerUtil.info("===== End of VerifyViewAndSearchFunctionality =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception occurred during VerifyViewAndSearchFunctionality: " + e.getMessage());

		}
	}

	public static final By TableHeaderRow = By.xpath("//table[@id='modelTable']/thead/tr");
	public static final By TableBody = By.xpath("//table[@id='modelTable']/tbody/tr");

	public void ValidateDataFromTable(HashMap<String, String> storePartMasterInfo) {
		try {
			LoggerUtil.info("===== Starting Table Data Validation =====");

			String partNumberUi = storePartMasterInfo.get("Part Number");
			String companyNameUi = storePartMasterInfo.get("Company Name");
			String partDescriptionUi = storePartMasterInfo.get("Part Description");
			String partUomUi = storePartMasterInfo.get("Part Uom");

			// Step 1: Read all table headers
			HashMap<String, Integer> headerMap = new HashMap<>();
			WebElement headerRow = driver.findElement(TableHeaderRow);
			List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));

			for (int i = 0; i < headerColumns.size(); i++) {
				headerMap.put(headerColumns.get(i).getText().trim(), i);
			}
			LoggerUtil.info("Header Names with Index: " + headerMap);

			// Step 2: Read all table rows
			List<WebElement> tableRows = driver.findElements(TableBody);

			if (tableRows == null || tableRows.isEmpty()) {
				LoggerUtil.fail("No rows found in the table for validation.");
				return;
			}

			WebElement firstRow = tableRows.get(0);
			List<WebElement> rowData = firstRow.findElements(By.tagName("td"));

			HashMap<String, String> rowDataMap = new HashMap<>();
			for (Map.Entry<String, Integer> entry : headerMap.entrySet()) {
				int index = entry.getValue();
				if (index < rowData.size()) {
					String cellValue = rowData.get(index).getText().trim();
					rowDataMap.put(entry.getKey(), cellValue);
				}
			}

			LoggerUtil.info("First Row Data Mapped: " + rowDataMap);

			// Step 3: Field Validations with Report Logging
			compareAndLog("Part No.", partNumberUi, rowDataMap.get("Part No."));
			compareAndLog("Company Name", companyNameUi, rowDataMap.get("Company Name"));
			compareAndLog("Part Description", partDescriptionUi, rowDataMap.get("Part Description"));
			compareAndLog("Part UOM", partUomUi, rowDataMap.get("Part UOM"));

			// Step 4: Action Column Handling (Edit Icon Click)
			if (headerMap.containsKey("Action")) {
				int actionIndex = headerMap.get("Action");
				WebElement actionCell = rowData.get(actionIndex);
				List<WebElement> icons = actionCell.findElements(By.tagName("i"));

				for (WebElement icon : icons) {
					String iconClass = icon.getAttribute("class");
					if (iconClass.equalsIgnoreCase("fas fa-edit")) {
						LoggerUtil.info("Clicking Edit icon for first record...");
						icon.click();
						LoggerUtil.pass("Edit icon clicked successfully.");
						break;
					}
				}
			}

			LoggerUtil.pass("Table data validation completed successfully.");
			LoggerUtil.info("===== End of Table Validation =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception during table validation: " + e.getMessage());

		}
	}

	public void ValidateDataFromTableForUpdated(HashMap<String, String> storePartMasterInfo,
			HashMap<String, String> storeUpdatedDataInfo) {
		try {
			LoggerUtil.info("===== Starting Table Data Validation for Updated Record =====");

// Step 1: Fetch expected values from both HashMaps
			String updatedPartNumberUi = storeUpdatedDataInfo.get("Updated-PartNumber");
			String updatedPartDescriptionUi = storeUpdatedDataInfo.get("Updated-PartDescription");

			String companyNameUi = storePartMasterInfo.get("Company Name");
			String partUomUi = storePartMasterInfo.get("Part Uom");
			String customerNameUi = storePartMasterInfo.get("Customer Name");
			String supplierNameUi = storePartMasterInfo.get("Supplier Name");
			String productCategoryNameUi = storePartMasterInfo.get("Product Category Name");
			String productModelUi = storePartMasterInfo.get("Product Model Name & No.");
			String specialProductCategoryUi = storePartMasterInfo.get("Special Product Category");

// Step 2: Read all table headers
			HashMap<String, Integer> headerMap = new HashMap<>();
			WebElement headerRow = driver.findElement(TableHeaderRow);
			List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));

			for (int i = 0; i < headerColumns.size(); i++) {
				headerMap.put(headerColumns.get(i).getText().trim(), i);
			}
			LoggerUtil.info("Header Names with Index: " + headerMap);

// Step 3: Read first row data
			List<WebElement> tableRows = driver.findElements(TableBody);
			if (tableRows == null || tableRows.isEmpty()) {
				LoggerUtil.fail("No rows found in the table for validation.");
				return;
			}

			WebElement firstRow = tableRows.get(0);
			List<WebElement> rowData = firstRow.findElements(By.tagName("td"));

			HashMap<String, String> rowDataMap = new HashMap<>();
			for (Map.Entry<String, Integer> entry : headerMap.entrySet()) {
				int index = entry.getValue();
				if (index < rowData.size()) {
					String cellValue = rowData.get(index).getText().trim();
					rowDataMap.put(entry.getKey(), cellValue);
				}
			}
			LoggerUtil.info("First Row Data Mapped with Header: " + rowDataMap);

// Step 4: Compare all fields using helper
			compareAndLog("Part No.", updatedPartNumberUi, rowDataMap.get("Part No."));
			compareAndLog("Company Name", companyNameUi, rowDataMap.get("Company Name"));
			compareAndLog("Part Description", updatedPartDescriptionUi, rowDataMap.get("Part Description"));
			compareAndLog("Part UOM", partUomUi, rowDataMap.get("Part UOM"));
			compareAndLog("Customer Name", customerNameUi, rowDataMap.get("Customer"));
			compareAndLog("Supplier Name", supplierNameUi, rowDataMap.get("Supplier Detail 1"));
			compareAndLog("Product Category Name", productCategoryNameUi, rowDataMap.get("Product Category"));
			compareAndLog("Product Model Name & No.", productModelUi, rowDataMap.get("Product Model Name and No."));
			compareAndLog("Special Product Category", specialProductCategoryUi,
					rowDataMap.get("Special Product Category"));

// Step 5: Action Column Handling (Edit Button)
			if (headerMap.containsKey("Action")) {
				int actionIndex = headerMap.get("Action");
				WebElement actionCell = rowData.get(actionIndex);
				List<WebElement> icons = actionCell.findElements(By.tagName("i"));

				for (WebElement icon : icons) {
					String iconClass = icon.getAttribute("class");
					if (iconClass.equalsIgnoreCase("fas fa-edit")) {
						LoggerUtil.info("Clicking Edit icon for the first record...");
						icon.click();
						LoggerUtil.pass("Edit icon clicked successfully.");
						break;
					}
				}
			}

			LoggerUtil.pass("Table data validation for updated record completed successfully.");
			LoggerUtil.info("===== End of Table Validation for Updated Record =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception during table validation: " + e.getMessage());

		}
	}

	public void ValidateDataFromTableForSaveAsNew(HashMap<String, String> storePartMasterInfo,
			HashMap<String, String> storeUpdatedDataInfo) {
		try {
			LoggerUtil.info("===== Starting Table Data Validation for Updated Record =====");

// Step 1: Fetch expected values from both HashMaps
			String updatedPartNumberUi = storeUpdatedDataInfo.get("SaveAsNew-PartNumber");
			String updatedPartDescriptionUi = storeUpdatedDataInfo.get("SaveAsNew-PartDescription");

			String companyNameUi = storePartMasterInfo.get("Company Name");
			String partUomUi = storePartMasterInfo.get("Part Uom");
			String customerNameUi = storePartMasterInfo.get("Customer Name");
			String supplierNameUi = storePartMasterInfo.get("Supplier Name");
			String productCategoryNameUi = storePartMasterInfo.get("Product Category Name");
			String productModelUi = storePartMasterInfo.get("Product Model Name & No.");
			String specialProductCategoryUi = storePartMasterInfo.get("Special Product Category");

// Step 2: Read all table headers
			HashMap<String, Integer> headerMap = new HashMap<>();
			WebElement headerRow = driver.findElement(TableHeaderRow);
			List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));

			for (int i = 0; i < headerColumns.size(); i++) {
				headerMap.put(headerColumns.get(i).getText().trim(), i);
			}
			LoggerUtil.info("Header Names with Index: " + headerMap);

// Step 3: Read first row data
			List<WebElement> tableRows = driver.findElements(TableBody);
			if (tableRows == null || tableRows.isEmpty()) {
				LoggerUtil.fail("No rows found in the table for validation.");
				return;
			}

			WebElement firstRow = tableRows.get(0);
			List<WebElement> rowData = firstRow.findElements(By.tagName("td"));

			HashMap<String, String> rowDataMap = new HashMap<>();
			for (Map.Entry<String, Integer> entry : headerMap.entrySet()) {
				int index = entry.getValue();
				if (index < rowData.size()) {
					String cellValue = rowData.get(index).getText().trim();
					rowDataMap.put(entry.getKey(), cellValue);
				}
			}
			LoggerUtil.info("First Row Data Mapped with Header: " + rowDataMap);

// Step 4: Compare all fields using helper
			compareAndLog("Part No.", updatedPartNumberUi, rowDataMap.get("Part No."));
			compareAndLog("Company Name", companyNameUi, rowDataMap.get("Company Name"));
			compareAndLog("Part Description", updatedPartDescriptionUi, rowDataMap.get("Part Description"));
			compareAndLog("Part UOM", partUomUi, rowDataMap.get("Part UOM"));
			compareAndLog("Customer Name", customerNameUi, rowDataMap.get("Customer"));
			compareAndLog("Supplier Name", supplierNameUi, rowDataMap.get("Supplier Detail 1"));
			compareAndLog("Product Category Name", productCategoryNameUi, rowDataMap.get("Product Category"));
			compareAndLog("Product Model Name & No.", productModelUi, rowDataMap.get("Product Model Name and No."));
			compareAndLog("Special Product Category", specialProductCategoryUi,
					rowDataMap.get("Special Product Category"));

// Step 5: Action Column Handling (Edit Button)
			if (headerMap.containsKey("Action")) {
				int actionIndex = headerMap.get("Action");
				WebElement actionCell = rowData.get(actionIndex);
				List<WebElement> icons = actionCell.findElements(By.tagName("i"));

				for (WebElement icon : icons) {
					String iconClass = icon.getAttribute("class");
					if (iconClass.equalsIgnoreCase("fas fa-edit")) {
						LoggerUtil.info("Clicking Edit icon for the first record...");
						icon.click();
						LoggerUtil.pass("Edit icon clicked successfully.");
						break;
					}
				}
			}

			LoggerUtil.pass("Table data validation for updated record completed successfully.");
			LoggerUtil.info("===== End of Table Validation for Updated Record =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception during table validation: " + e.getMessage());

		}
	}

	/**
	 * Helper to compare expected vs actual with Extent Report logging.
	 */
	private void compareAndLog(String field, String expected, String actual) {
		if (expected == null && actual == null) {
			LoggerUtil.info(field + ": Both values are null (skipped).");
			return;
		}

		if (expected != null && expected.equals(actual)) {
			LoggerUtil.pass(field + " matched correctly. [UI: " + expected + " | Table: " + actual + "]");
		} else {
			LoggerUtil.fail(field + " mismatch! [Expected: " + expected + " | Actual: " + actual + "]");

		}
	}

	public void EnterNewPartDescriptionAndReplacepriviousData(String enterPartNumber, String enterPartDescription)
			throws InterruptedException {

		LoggerUtil.info("===== Starting EnterNewPartDescriptionAndReplacepriviousData =====");

		// Step 1: Clear and Enter Part Number
		WebElement partNumberField = waitForExpectedElement(PartMasterPage.enterOnPartNumber);
		Thread.sleep(500);
		partNumberField.click();
		Thread.sleep(500);
		partNumberField.sendKeys(Keys.CONTROL + "a");
		Thread.sleep(500);
		partNumberField.sendKeys(Keys.DELETE);
		Thread.sleep(500); // small buffer
		partNumberField.sendKeys(enterPartNumber);
		LoggerUtil.pass("Entered Part Number → " + enterPartNumber);

		// Step 2: Clear and Enter Part Description
		WebElement partDescriptionField = waitForExpectedElement(PartMasterPage.enterOnPartDescription);
		Thread.sleep(500);
		partDescriptionField.click();
		Thread.sleep(500);
		partDescriptionField.sendKeys(Keys.CONTROL + "a");
		Thread.sleep(500);
		partDescriptionField.sendKeys(Keys.DELETE);
		Thread.sleep(500);
		partDescriptionField.sendKeys(enterPartDescription);
		LoggerUtil.pass("Entered Part Description → " + enterPartDescription);

		// Step 3: Click on Update button
		Thread.sleep(2000);
		List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(buttons, "Update");
		LoggerUtil.info("Clicked on 'Update' button.");

		// Step 4: Verify success toast message
		VerifyToastMessage("Part Master details Updated successfully.");
		LoggerUtil.pass("Toast message verified successfully: Part Master details Updated successfully.");

		LoggerUtil.info("===== End of EnterNewPartDescriptionAndReplacepriviousData =====");

	}

	public void EnterNewPartDescriptionAndReplacepriviousDataForSaveAsNew(String enterPartNumber,
			String enterPartDescription) throws InterruptedException {

		try {
			LoggerUtil.info("===== Starting EnterNewPartDescriptionAndReplacepriviousDataForSaveAsNew =====");
			LoggerUtil.info(
					"Input Values → Part Number: " + enterPartNumber + ", Part Description: " + enterPartDescription);

			// Step 1: Clear and Enter Part Number
			WebElement partNumberField = waitForExpectedElement(PartMasterPage.enterOnPartNumber);
			partNumberField.click();
			Thread.sleep(500);
			partNumberField.sendKeys(Keys.CONTROL + "a");
			Thread.sleep(500);
			partNumberField.sendKeys(Keys.DELETE);
			Thread.sleep(500);
			partNumberField.sendKeys(enterPartNumber);
			LoggerUtil.pass("Entered new Part Number → " + enterPartNumber);

			// Step 2: Clear and Enter Part Description
			WebElement partDescriptionField = waitForExpectedElement(PartMasterPage.enterOnPartDescription);
			partDescriptionField.click();
			Thread.sleep(500);
			partDescriptionField.sendKeys(Keys.CONTROL + "a");
			Thread.sleep(500);
			partDescriptionField.sendKeys(Keys.DELETE);
			Thread.sleep(500);
			partDescriptionField.sendKeys(enterPartDescription);
			LoggerUtil.pass("Entered new Part Description → " + enterPartDescription);

			// Step 3: Click on "Save As New" button
			Thread.sleep(2000);
			List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(buttons, "Save As New");
			LoggerUtil.info("Clicked on 'Save As New' button successfully.");

			// Step 4: Verify toast message for successful save
			VerifyToastMessage("Part Master details Saved successfully.");
			LoggerUtil.pass("Toast message verified successfully: Part Master details Saved successfully.");

			LoggerUtil.pass("Record saved successfully as new entry.");
			LoggerUtil.info("===== End of EnterNewPartDescriptionAndReplacepriviousDataForSaveAsNew =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception occurred in EnterNewPartDescriptionAndReplacepriviousDataForSaveAsNew: "
					+ e.getMessage());

		}
	}

	public void VerifyViewAndColoumnNameAndColoumnValues(String RequiredHeaderName, String ExpectedValue)
			throws InterruptedException {

		try {
			LoggerUtil.info("===== Starting VerifyViewAndColoumnNameAndColoumnValues =====");
			LoggerUtil.info("Header Name: " + RequiredHeaderName + " | Expected Value: " + ExpectedValue);

			// Step 1: Wait for table to load
			Thread.sleep(4000);
			getAllHeaderNames();

			// Step 2: Get column index for the given header
			int colIndex = getColumnIndexByHeader(RequiredHeaderName);
			if (colIndex < 0) {
				LoggerUtil.fail("Column Header NOT FOUND → '" + RequiredHeaderName + "'.");
				return;
			}

			// Step 3: Fetch all rows
			List<WebElement> rows = driver.findElements(By.xpath("//table[@id='modelTable']//tbody/tr"));
			if (rows == null || rows.isEmpty()) {
				LoggerUtil.fail("No data rows found in the table.");
				return;
			}

			boolean recordFound = false;

			// Step 4: Loop rows to find the matching value
			for (WebElement row : rows) {
				List<WebElement> cells = row.findElements(By.tagName("td"));
				if (cells.size() <= colIndex)
					continue;

				String actualValue = cells.get(colIndex).getText().trim();
				if (actualValue.equalsIgnoreCase(ExpectedValue.trim())) {
					recordFound = true;
					LoggerUtil.pass("Matched value in column '" + RequiredHeaderName + "' → " + actualValue);

					// Step 5: Locate Delete icon in Action column and click
					WebElement actionCell = cells.get(0);
					WebElement deleteIcon = actionCell.findElement(By.xpath(".//i[contains(@class,'fas fa-trash-o')]"));

					if (deleteIcon != null && deleteIcon.isDisplayed()) {
						deleteIcon.click();
						LoggerUtil.pass("Clicked on Delete icon for record having " + RequiredHeaderName + " = "
								+ ExpectedValue);
						driver.switchTo().alert().accept();

						LoggerUtil.info("=====  Verifying Toast Message =====");
						VerifyToastMessage("This Part is being used in costings and can’t be deleted.!");
						LoggerUtil.pass("Toast message verification completed successfully.");

					} else {
						LoggerUtil.fail("Delete icon not found in Action column for matched record.");
					}

					break; // Stop after first match
				}
			}

			if (!recordFound) {
				LoggerUtil.fail("No row matched with '" + RequiredHeaderName + "' = '" + ExpectedValue + "'.");
			}

			LoggerUtil.info("===== End of VerifyViewAndColoumnNameAndColoumnValues =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception in VerifyViewAndColoumnNameAndColoumnValues: " + e.getMessage());
		}
	}

	public static final By verifyViewPageUi = By.xpath("//table[@id='modelTable']");

	public void DeleteDataFromTableWihoutCostingData(HashMap<String, String> storePartMasterInfo) {
		try {
			LoggerUtil.info("===== Starting DeleteDataFromTableWihoutCostingData =====");

			String partNumberUi = storePartMasterInfo.get("Part Number");
			String companyNameUi = storePartMasterInfo.get("Company Name");
			String partDescriptionUi = storePartMasterInfo.get("Part Description");
			String partUomUi = storePartMasterInfo.get("Part Uom");

			// Step 1: Read all table headers
			HashMap<String, Integer> headerMap = new HashMap<>();
			WebElement headerRow = driver.findElement(TableHeaderRow);
			List<WebElement> headerColumns = headerRow.findElements(By.tagName("th"));
			for (int i = 0; i < headerColumns.size(); i++) {
				headerMap.put(headerColumns.get(i).getText().trim(), i);
			}
			LoggerUtil.info("Header Names with Index: " + headerMap);

			// Step 2: Read all table rows
			List<WebElement> tableRows = driver.findElements(TableBody);
			if (tableRows == null || tableRows.isEmpty()) {
				LoggerUtil.fail("No rows found in the table for validation.");
				return;
			}

			WebElement firstRow = tableRows.get(0);
			List<WebElement> rowData = firstRow.findElements(By.tagName("td"));

			HashMap<String, String> rowDataMap = new HashMap<>();
			for (Map.Entry<String, Integer> entry : headerMap.entrySet()) {
				int index = entry.getValue();
				if (index < rowData.size()) {
					String cellValue = rowData.get(index).getText().trim();
					rowDataMap.put(entry.getKey(), cellValue);
				}
			}

			LoggerUtil.info("First Row Data Mapped: " + rowDataMap);

			// Step 3: Field Validations
			compareAndLog("Part No.", partNumberUi, rowDataMap.get("Part No."));
			compareAndLog("Company Name", companyNameUi, rowDataMap.get("Company Name"));
			compareAndLog("Part Description", partDescriptionUi, rowDataMap.get("Part Description"));
			compareAndLog("Part UOM", partUomUi, rowDataMap.get("Part UOM"));

			// Step 4: Action Column Handling (Delete Icon Click)
			if (headerMap.containsKey("Action")) {
				int actionIndex = headerMap.get("Action");
				WebElement actionCell = rowData.get(actionIndex);
				List<WebElement> icons = actionCell.findElements(By.tagName("i"));

				for (WebElement icon : icons) {
					String iconClass = icon.getAttribute("class");
					if (iconClass.equalsIgnoreCase("fas fa-trash-o")) {
						LoggerUtil.info("Clicking Delete icon for first record...");

						try {
							((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", icon);
							Thread.sleep(300);
							icon.click();
							LoggerUtil.pass("Delete icon clicked successfully.");

							// Step 5: Handle Delete Confirmation Popup
							try {
								driver.switchTo().alert().accept();
								LoggerUtil.info("Alert popup accepted successfully.");
								LoggerUtil.info("===== Verifying Toast Message =====");
								

								Thread.sleep(4000);

								// Step 6: Verify if View Page reloaded correctly
								try {
									WebElement viewPageElement = driver.findElement(verifyViewPageUi);
									if (viewPageElement.isDisplayed()) {
										LoggerUtil.info(
												"After clicking OK on delete popup, view page did not return to front.");
									} else {
										LoggerUtil.info("View Page element not visible after delete popup.");
									}
								} catch (Exception e) {
									LoggerUtil.info("View Page element not found or not visible after delete popup.");
									LoggerUtil.error(
											"After Clicking  Delete And Accept Delete Popup  Page Automatically Move From  View Page To Front Page ");
								}

							} catch (NoAlertPresentException e) {
								LoggerUtil.info("No alert popup displayed during delete action.");
							}

							// Step 7: Verify Toast Message

						} catch (Exception ex) {
							LoggerUtil.fail(
									"Unable to perform delete action or verify toast message: " + ex.getMessage());
						}
						break;
					}
				}
			}

			LoggerUtil.pass("DeleteDataFromTableWihoutCostingData executed successfully.");
			LoggerUtil.info("===== End of DeleteDataFromTableWihoutCostingData =====");

		} catch (Exception e) {
			LoggerUtil.fail("Exception during DeleteDataFromTableWihoutCostingData: " + e.getMessage());
		}
	}

	public static final By ClickingExportForDownload = By.xpath("//button[@id='oldCostingExportss']");

	public void VerifyExportExcelFileForPartMaster(String RequiredName) {

		// ========================== Company Name Selection ==========================
		LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
		clickOnElement(clickingCompanyNameDropdown);
		List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

		for (WebElement Companies : ListCompanyName) {
			String CompanyNameText = Companies.getText().trim();
			if (CompanyNameText.equals(RequiredName)) {
				Companies.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
				break;
			}
		}

		List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(buttons, "Export / Import");

		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("arguments[0].click();", waitForExpectedElement(ClickingExportForDownload));

		wait.until(ExpectedConditions.elementToBeClickable(ClickingExportForDownload));
		VerifyToastMessage("Name contains invalid characters or is not valid.17012025");

	}

	public static final By RadioNameListExportModal = By
			.xpath("//div[@id='partMasterOldCostingmodal']/descendant::label[contains(text(),'')]");

	public static final By ClickingCheckboxByNameOldCosting = By
			.xpath("//*[@class='modal-body']/descendant::label[contains(text(),'')]");

	public static final By enterNumberTotalNumberOfParts = By.xpath("//input[@id='excelCount']");

	public static final By clickingYearDropdownPartMaster = By
			.xpath("//select[@id='yearoldexp']/following-sibling::div/button");

	public static final By clickingDropdownYearNameList = By
			.xpath("//select[@id='yearoldexp']/following-sibling::div/descendant::label");

	public static final By clickingCommodityDropdownPartMaster = By
			.xpath("//select[@id='cmdgrpoldexp']/following-sibling::div/button");

	public static final By EnterCommodityGroupNameSearchBox = By
			.xpath("//select[@id='cmdgrpoldexp']/following-sibling::div/descendant::input[@type='search']");

	public static final By CommodityGroupNameList = By
			.xpath("//select[@id='cmdgrpoldexp']/following-sibling::div/descendant::label");

	public static final By ClickingCheckboxCommodityGroupCheckbox = By
			.xpath("./preceding-sibling::input[@type='checkbox']");

	public static final By ClickingGroupClassificationDropdownBoxPartMaster = By
			.xpath("//button[contains(@class,'multiselect dropdown-toggle')]");

	public static void clickGroupClassificationDropdownForPartMaster() {
		By dropdownButton = By
				.xpath("//select[@id='grpclassoldexp']/following-sibling::div//button[contains(@class,'multiselect')]");
		By dropdownMenu = By.xpath(
				"//select[@id='grpclassoldexp']/following-sibling::div//div[contains(@class,'multiselect-container')]");

		SoftAssert soft = new SoftAssert();

		try {
			LoggerUtil.info("🔍 Validating and clicking Group Classification dropdown...");

			WebElement button = waitForExpectedElement(dropdownButton);

			// 1️⃣ Visibility and enablement check
			if (!button.isDisplayed()) {
				LoggerUtil.fail("❌ Dropdown button not visible on screen.");
				soft.fail("Dropdown button not visible.");
			} else {
				LoggerUtil.pass("✅ Dropdown button is visible.");
			}

			if (!button.isEnabled()) {
				LoggerUtil.fail("❌ Dropdown button is disabled.");
				soft.fail("Dropdown button is disabled.");
			} else {
				LoggerUtil.pass("✅ Dropdown button is enabled.");
			}

			// 2️⃣ Scroll into view
			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});", button);
			new Actions(driver).moveToElement(button).pause(Duration.ofMillis(300)).perform();

			// 3️⃣ Wait until clickable
			try {
				new WebDriverWait(driver, Duration.ofSeconds(8)).until(ExpectedConditions.elementToBeClickable(button));
				LoggerUtil.pass("✅ Dropdown button is clickable.");
			} catch (Exception e) {
				LoggerUtil.mismatch("⚠️ Dropdown not clickable immediately → " + e.getMessage());
				soft.fail("Dropdown not clickable immediately.");
			}

			// 4️⃣ Click (normal → JS fallback)
			try {
				button.click();
				LoggerUtil.pass("🖱️ Clicked Group Classification dropdown (normal click).");
			} catch (Exception e) {
				
				((JavascriptExecutor) driver).executeScript("arguments[0].click();", button);
				LoggerUtil.pass("✅ Clicked dropdown via JS fallback.");
			}

			// 5️⃣ Verify dropdown actually expanded
			boolean expanded = false;
			for (int i = 0; i < 10; i++) {
				if ("true".equalsIgnoreCase(button.getAttribute("aria-expanded"))) {
					expanded = true;
					break;
				}
				List<WebElement> menuList = driver.findElements(dropdownMenu);
				if (!menuList.isEmpty() && menuList.get(0).isDisplayed()) {
					expanded = true;
					break;
				}
				Thread.sleep(300);
			}

			if (expanded) {
				LoggerUtil.pass("✅ Dropdown expanded successfully. Options are visible.");
			} else {
				LoggerUtil.fail("❌ Dropdown did not expand after clicking.");
				soft.fail("Dropdown did not expand after clicking.");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while clicking Group Classification dropdown → " + e.getMessage());
			soft.fail("Exception: " + e.getMessage());
		}

		soft.assertAll();
	}

	public static void clickCommodityGroupDropdownForPartMaster() {

	    By dropdownButton = By
	            .xpath("//select[@id='cmdgrpoldexp']/following-sibling::div//button[contains(@class,'multiselect')]");
	    By dropdownMenu = By.xpath(
	            "//select[@id='cmdgrpoldexp']/following-sibling::div//div[contains(@class,'multiselect-container')]");

	    SoftAssert soft = new SoftAssert();

	    try {
	        LoggerUtil.info("🔍 Validating and clicking Commodity Group dropdown...");

	        WebElement button = waitForExpectedElement(dropdownButton);

	        if (!button.isDisplayed()) {
	            LoggerUtil.fail("❌ Commodity Group dropdown button not visible on screen.");
	            soft.fail("Dropdown button not visible.");
	        } else {
	            LoggerUtil.pass("✅ Dropdown button is visible.");
	        }

	        if (!button.isEnabled()) {
	            LoggerUtil.fail("❌ Commodity Group dropdown button is disabled.");
	            soft.fail("Dropdown button is disabled.");
	        } else {
	            LoggerUtil.pass("✅ Dropdown button is enabled.");
	        }

	        ((JavascriptExecutor) driver)
	                .executeScript("arguments[0].scrollIntoView({block:'center'});", button);
	        new Actions(driver).moveToElement(button).pause(Duration.ofMillis(300)).perform();

	        try {
	            new WebDriverWait(driver, Duration.ofSeconds(8))
	                    .until(ExpectedConditions.elementToBeClickable(button));
	            LoggerUtil.pass("✅ Commodity Group dropdown button is clickable.");
	        } catch (Exception e) {
	            LoggerUtil.info("Commodity Group dropdown not clickable immediately → " + e.getMessage());
	            soft.fail("Dropdown not clickable immediately.");
	        }

	        try {
	            button.click();
	            LoggerUtil.pass("🖱️ Clicked Commodity Group dropdown (normal click).");
	        } catch (Exception e) {

	            // 🔽 🔽 🔽 THIS IS THE ONLY LINE CHANGED 🔽 🔽 🔽
	            LoggerUtil.info("Normal click failed, switching to JavaScript click.");

	            ((JavascriptExecutor) driver).executeScript("arguments[0].click();", button);
	            LoggerUtil.pass("✅ Clicked dropdown via JS fallback.");
	        }

	        boolean expanded = false;
	        for (int i = 0; i < 10; i++) {
	            if ("true".equalsIgnoreCase(button.getAttribute("aria-expanded"))) {
	                expanded = true;
	                break;
	            }
	            List<WebElement> menuList = driver.findElements(dropdownMenu);
	            if (!menuList.isEmpty() && menuList.get(0).isDisplayed()) {
	                expanded = true;
	                break;
	            }
	            Thread.sleep(300);
	        }

	        if (expanded) {
	            LoggerUtil.pass("✅ Commodity Group dropdown expanded successfully. Options are visible.");
	        } else {
	            LoggerUtil.fail("❌ Commodity Group dropdown did not expand after clicking.");
	            soft.fail("Dropdown did not expand after clicking.");
	        }

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Error while clicking Commodity Group dropdown → " + e.getMessage());
	        soft.fail("Exception: " + e.getMessage());
	    }

	    soft.assertAll();
	}


	public static final By dropdownlistValueForGroupClassificaitonPartMaster = By.xpath(
			"//select[@id='grpclassoldexp']/following-sibling::div/descendant::div/button[contains(@class,'multiselect-option dropdown-item')]");
	public static final By EnterValueSearchBoxGroupClassificatioPartMaster = By
			.xpath("//select[@id='grpclassoldexp']/following-sibling::div/descendant::input[@type='search']");
	public static final By ClickingSecondExportButtonForDownloadPartMaster = By
			.xpath("//button[@id='oldCostingExportss']");

	public HashMap<String, String> VerifyExportAndDownloadExcelFileForOldCosting(String RequiredCompanyName,
			String RequiredRadionButtonName, String RequiredsupplierNameFromText, String RequiredCustomerNameFromText,
			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory,
			String enterTotalNumberofparts, String EnterYear, String enterCommGroupName,
			String enterGroupclassificationValue) throws InterruptedException {

		// ✅ Initialize HashMap to store all values
		HashMap<String, String> exportDataMap = new HashMap<>();

		LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
		clickOnElement(clickingCompanyNameDropdown);
		List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

		for (WebElement Companies : ListCompanyName) {
			String CompanyNameText = Companies.getText().trim();
			if (CompanyNameText.equals(RequiredCompanyName)) {
				Companies.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
				exportDataMap.put("CompanyName", CompanyNameText);
				break;
			}
		}

		// ========================== Radio Button Selection ==========================
		LoggerUtil.info("===== STEP 4: Selecting Radio Button By Name =====");
		List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
		for (WebElement Pagename : PageHeadersName) {
			String pagenametext = Pagename.getText().trim();
			if (pagenametext.contains(RequiredRadionButtonName)) {
				Pagename.findElement(By.tagName("input")).click();
				LoggerUtil.pass("Selected Radio Button → " + pagenametext);
				exportDataMap.put("RadioButtonName", pagenametext);
				break;
			}
		}

		// ========================== Supplier Selection ==========================
		LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
		clickOnElement(clickingSupplierDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
				RequiredsupplierNameFromText);

		List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
		for (WebElement Supplier : SupplierNameList) {
			String SupplierText = Supplier.getText().trim();
			if (SupplierText.contains(RequiredsupplierNameFromText)) {
				Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Supplier → " + SupplierText);
				exportDataMap.put("SupplierName", SupplierText);
				break;
			}
		}

		// ========================== Customer Selection ==========================
		clickOnElement(clickingCustomerDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);
		List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);
		for (WebElement Customer : CustomerNameList) {
			String CustomerText = Customer.getText().trim();
			if (CustomerText.contains(RequiredCustomerNameFromText)) {
				Customer.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Customer → " + CustomerText);
				exportDataMap.put("CustomerName", CustomerText);
				break;
			}
		}

		// ========================== Product Category Selection
		// ==========================
		LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
		clickOnElement(ClickingProductCategoryDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);
		List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
		for (WebElement ProductCat : ProductCategories) {
			String TextproductCategory = ProductCat.getText().trim();
			if (TextproductCategory.contains(RequiredProducCategoryName)) {
				ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
				exportDataMap.put("ProductCategory", TextproductCategory);
				break;
			}
		}

		// ========================== Product Model Selection ==========================
		LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
		clickOnElement(clickingProductModelNameDropdown);
		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
		List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
		for (WebElement productname : Productmodalnames) {
			String Producttextname = productname.getText().trim();
			if (Producttextname.equals(RequiredProducModelName)) {
				productname.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Product Model → " + Producttextname);
				exportDataMap.put("ProductModel", Producttextname);
				break;
			}
		}

		// ========================== Special Product Category
		// ==========================
		LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
		clickOnElement(clickingSpecialProductCategory);
		clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);
		List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
		for (WebElement ProductCategory : productCategoryNames) {
			String productCategoryText = ProductCategory.getText().trim();
			if (productCategoryText.equals(RequiredSpecialProductCategory)) {
				ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
				exportDataMap.put("SpecialProductCategory", productCategoryText);
				break;
			}
		}

		// ========================== Export Steps ==========================
		List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(buttons, "Export / Import");
		Thread.sleep(2000);

		List<WebElement> RadiobuttonsName = driver.findElements(RadioNameListExportModal);
		for (WebElement Radio : RadiobuttonsName) {
			String radiobtn = Radio.getText().trim();
			if (radiobtn.equals("Old Costing")) {
				WebElement oldcasting = Radio
						.findElement(By.xpath("./preceding-sibling::input[contains(@type,'radio')]"));
				oldcasting.click();
				exportDataMap.put("ExportType", "Old Costing");
				break;
			}
		}

		List<WebElement> CheckboxbuttonsName = driver.findElements(ClickingCheckboxByNameOldCosting);
		for (WebElement checkboxes : CheckboxbuttonsName) {
			String Checkboxname = checkboxes.getText().trim();
			if (Checkboxname.equals("Yearly")) {
				WebElement yearlycheckbox = checkboxes
						.findElement(By.xpath("./preceding-sibling::input[contains(@type,'checkbox')]"));
				yearlycheckbox.click();
				exportDataMap.put("CostingType", "Yearly");
				break;
			}
		}

		clearAndEnterText(waitForExpectedElement(enterNumberTotalNumberOfParts), enterTotalNumberofparts);
		exportDataMap.put("TotalParts", enterTotalNumberofparts);

		clickOnElement(clickingYearDropdownPartMaster);
		List<WebElement> yearNamesList = driver.findElements(clickingDropdownYearNameList);
		for (WebElement yearname : yearNamesList) {
			String yeartext = yearname.getText().trim();
			if (yeartext.contains(EnterYear)) {
				WebElement datecheckbox = yearname
						.findElement(By.xpath("./preceding-sibling::input[@type='checkbox']"));
				datecheckbox.click();
				exportDataMap.put("SelectedYear", yeartext);
				break;
			}
		}

		clickCommodityGroupDropdownForPartMaster();
		clearAndEnterText(waitForExpectedElement(EnterCommodityGroupNameSearchBox), enterCommGroupName);
		List<WebElement> Commgroupname = driver.findElements(CommodityGroupNameList);
		for (WebElement Comgroup : Commgroupname) {
			String CommgrpName = Comgroup.getText().trim();
			if (CommgrpName.equals(enterCommGroupName)) {
				WebElement comgrpcheckbox = Comgroup.findElement(ClickingCheckboxCommodityGroupCheckbox);
				comgrpcheckbox.click();
				exportDataMap.put("CommodityGroup", CommgrpName);
				break;
			}
		}

		clickGroupClassificationDropdownForPartMaster();
		Thread.sleep(500);

		// Enter text in search box
		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxGroupClassificatioPartMaster),
				enterGroupclassificationValue);

		// Fetch all visible dropdown buttons (including Select All)
		List<WebElement> groupItems = driver.findElements(
				By.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//button"));

		for (WebElement item : groupItems) {

			String title = item.getAttribute("title").trim();

			if (title.equalsIgnoreCase(enterGroupclassificationValue)) {

				WebElement checkbox = item.findElement(By.xpath(".//input[@type='checkbox']"));

				if (!checkbox.isSelected()) {
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", checkbox);
				}

				exportDataMap.put("GroupClassification", title);

				LoggerUtil.info("Selected Group Classification: " + title);

				break;
			}
		}

		Thread.sleep(6000);
		clickOnElement(ClickingSecondExportButtonForDownloadPartMaster);
		LoggerUtil.pass("Clicked on Export button successfully.");
		Thread.sleep(15000);
		getLatestOldCostingFile();
		

		LoggerUtil.pass("✅ Old Costing Excel exported and downloaded successfully.");
		LoggerUtil.info("Export Data Map: " + exportDataMap);

		return exportDataMap;
	}

	public HashMap<String, String> VerifyFillExcelFilepartMasterOldCasting(String CommodityGroupValue,
			String GroupClassificationValue, String grade, String year) {

		HashMap<String, String> StoreOldCostingInfo = new HashMap<>();

		File latestFile = getLatestOldCostingFile();
		if (latestFile == null) {
			LoggerUtil.error("❌ No Old Costing file found.");
			return StoreOldCostingInfo;
		}

		String filePath = latestFile.getAbsolutePath();
		LoggerUtil.info("📄 Latest Old Costing file detected: " + filePath);

		try {
			// ========== Generate Random Test Data ==========
			String BOML1 = "1";
			String QtyAssy = "1";
			String PartNo = faker.number().digits(2);
			String PartDescription = faker.name().firstName() + PartNo;
			String PartUom = DataProp.getProperty("PartUomPartMaster");

			String CostingModule = "Standard Shapes";
			String ManufacturingCategory = "Stamping";

			String RmInputCategory = "Sheet";
			String RmType = "Yearly";

			String CommodityGroup = CommodityGroupValue;
			String Classification = GroupClassificationValue;
			String SpecificGrade = grade;
			String Year = year;
			String SelectedMonthQHY = "Jan";

			String ProcurnmentType = "Part";
			String PackagingCost = faker.number().digits(2);
			String FreightCost = faker.number().digits(2);
			String ProcessCost = faker.number().digits(2);
			String OhpOthers = faker.number().digits(2);

			String NetWeight = faker.number().digits(2);
			String GrossWeight = NetWeight + faker.number().digits(2);

			int targetRow = 2; // row where we’re writing
			int headerRow = 1; // row above

			// ========== Column-Wise Fill and Capture ==========
			int[] columns = { 0, 8, 9, 10, 12, 13, 24, 25, 27, 29, 30, 32, 33, 34, 35, 36, 37, 56, 57, 58, 59 };
			String[] values = { BOML1, QtyAssy, PartNo, PartDescription, ProcurnmentType, PartUom, CostingModule,
					ManufacturingCategory, RmInputCategory, GrossWeight, NetWeight, RmType, CommodityGroup,
					Classification, SpecificGrade, Year, SelectedMonthQHY, ProcessCost, OhpOthers, FreightCost,
					PackagingCost };

			for (int i = 0; i < columns.length; i++) {
				int col = columns[i];
				String value = values[i];

				// get column name (header) from one row above (row index 1)
				String headerName = ExcelUtil.getCellValue(filePath, 0, headerRow, col);
				ExcelFiller.setCellValue(filePath, 0, targetRow, col, ExcelFiller.ValueType.STRING,
						Arrays.asList(value));

				StoreOldCostingInfo.put(headerName, value);
				LoggerUtil.info(String.format("📘 %-30s → %s", headerName, value));
			}

			// Extra metadata for tracking
			StoreOldCostingInfo.put("Excel_File_Path", filePath);
			StoreOldCostingInfo.put("Downloaded_File_Name", latestFile.getName());

			LoggerUtil.pass("✅ Successfully filled Excel file and captured ColumnName → Value mapping.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while filling Excel file → " + e.getMessage());
		}

		LoggerUtil.info("🧾 Final Old Costing Data Map: " + StoreOldCostingInfo);
		return StoreOldCostingInfo;
	}

	public static final By ImportButton = By.xpath("//button[@id='ImportOldCosting']");

	public void ImportExcelSheet() throws InterruptedException, TimeoutException {

		SoftAssert soft = new SoftAssert();
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(20));

		try {
			LoggerUtil.info("===== STEP 1️⃣ : Opening Export / Import Modal =====");
			List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(buttons, "Export / Import");
			Thread.sleep(2000);

			// ✅ STEP 2: Find the latest Excel file
			File downloadDir = new File("E:\\ICE-PROJECT\\CostMasters-ICE-V5.0\\downloads");
			File latestFile = Arrays
					.stream(Objects.requireNonNull(downloadDir.listFiles((dir, name) -> name.endsWith(".xlsx"))))
					.max(Comparator.comparingLong(File::lastModified)).orElse(null);

			if (latestFile == null) {
				LoggerUtil.fail("❌ No Excel file found in download folder.");
				return;
			}

			String fullPath = latestFile.getAbsolutePath();
			LoggerUtil.info("📄 Using Excel File for Import → " + fullPath);

			// ✅ STEP 3: Click Import button (this opens file chooser naturally)
			WebElement importBtn = wait.until(ExpectedConditions.elementToBeClickable(By.id("ImportOldCosting")));
			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", importBtn);
			((JavascriptExecutor) driver).executeScript("arguments[0].click();", importBtn);
			LoggerUtil.info("🖱️ Clicked on 'Import Old Costing' button — file chooser opened.");

			// ✅ STEP 4: Wait a few seconds for dialog, then handle it
			Thread.sleep(2000);
			StringSelection selection = new StringSelection(fullPath);
			Toolkit.getDefaultToolkit().getSystemClipboard().setContents(selection, null);

			Robot robot = new Robot();
			robot.delay(2000);

			// Paste path
			robot.keyPress(KeyEvent.VK_CONTROL);
			robot.keyPress(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_CONTROL);
			LoggerUtil.info("📋 Pasted file path into File Chooser: " + fullPath);

			robot.delay(500);
			robot.keyPress(KeyEvent.VK_ENTER);
			robot.keyRelease(KeyEvent.VK_ENTER);
			LoggerUtil.info("✅ Confirmed file selection by pressing Enter.");

			// ✅ STEP 5: Wait and then auto-close any lingering dialog (failsafe)
			Thread.sleep(5000);
			try {
				Robot escRobot = new Robot();
				escRobot.keyPress(KeyEvent.VK_ESCAPE);
				escRobot.keyRelease(KeyEvent.VK_ESCAPE);
				LoggerUtil.info("🧹 Closed File Chooser automatically after 5 seconds.");
			} catch (Exception escEx) {
				LoggerUtil.warn("⚠️ ESC key fallback failed, but continuing normally.");
			}

			// ✅ STEP 6: Wait for backend toast
			LoggerUtil.info("⌛ Waiting for toast message after import...");
			WebElement toast = wait.until(ExpectedConditions.visibilityOfElementLocated(toastMessage));

			String toastText = toast.getText().trim();
			LoggerUtil.info("📢 Toast → " + toastText);

			if (toastText.toLowerCase().contains("success")) {
				LoggerUtil.pass("✅ Import completed successfully for file: " + latestFile.getName());
			} else if (toastText.toLowerCase().contains("invalid import id")) {
				LoggerUtil.warn("⚠️ Import failed → Invalid Import ID.");
			} else if (toastText.toLowerCase().contains("error converting")) {
				LoggerUtil.error("❌ Import failed → SQL data type mismatch in Excel.");
			} else {
				LoggerUtil.info("ℹ️ Unexpected toast text → " + toastText);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Old Costing Excel import → " + e.getMessage());
			e.printStackTrace();
			soft.fail("Exception in ImportExcelSheet → " + e.getMessage());
		}

		LoggerUtil.info("===== END OF ImportExcelSheet Execution =====");
		soft.assertAll();
	}

	public static final By clickingSearchButtonToValidatePartDescription = By.xpath("//button[@id='btnSearch']");
	public static final By EnterSearchValueForPartNumberAndDescriptionAfterImportData = By
			.xpath("//div[@class='modal-body']/descendant::input[@id='searchBox']");
	public static final By ClickingSearchButtonPartMasterVerifingPartDescription = By
			.xpath("//div[@class='header-content-right']/descendant::a[@onclick='openSearch()']");

	public void VerifyDataHasBeenUpdatedOrNot(HashMap<String, String> StoreOldCostingInfo) throws InterruptedException {

		if (StoreOldCostingInfo == null || StoreOldCostingInfo.isEmpty()) {
			LoggerUtil.error("❌ StoreOldCostingInfo is null or empty — cannot verify data.");
			Assert.fail("StoreOldCostingInfo is null or empty.");
			return;
		}

		String ExpectedPartDescription = StoreOldCostingInfo.getOrDefault("Part_Description",
				StoreOldCostingInfo.get("Part Description"));
		String ExpectedPartNumber = StoreOldCostingInfo.getOrDefault("Part_Number",
				StoreOldCostingInfo.get("Part No.*"));

		String ExpectedCompanyName = DataProp.getProperty("CompanyNamePartMaster");
		String ExpectedSupplierName = DataProp.getProperty("SupplierNamePartMaster");

		if (ExpectedPartDescription == null || ExpectedPartNumber == null) {
			LoggerUtil.error(
					"❌ Missing critical expected values (Part_Description or Part_Number) in StoreOldCostingInfo.");
			LoggerUtil.info("🧾 Current Map: " + StoreOldCostingInfo);
			Assert.fail("Part_Description or Part_Number key not found in StoreOldCostingInfo.");
			return;
		}

		clickOnElement(ClickingSearchButtonPartMasterVerifingPartDescription);
		LoggerUtil.info("ClickingSearchButton");

		clearAndEnterText(waitForExpectedElement(EnterSearchValueForPartNumberAndDescriptionAfterImportData),
				ExpectedPartDescription);
		Thread.sleep(2000);
		clickOnElement(clickingSearchButtonToValidatePartDescription);

		String partNo = getValueByHeader("Part No.");
		String partDesc = getValueByHeader("Part Description");
		String companies = getValueByHeader("Companies");
		String suppliers = getValueByHeader("Suppliers");

		if (ExpectedPartDescription.equals(partDesc)) {
			LoggerUtil.pass("✅ Part Description matched: " + partDesc);
		} else {
			LoggerUtil.error(
					"❌ Part Description mismatch. Expected: " + ExpectedPartDescription + ", Actual: " + partDesc);
		}

		if (ExpectedPartNumber.equals(partNo)) {
			LoggerUtil.pass("✅ Part Number matched: " + partNo);
		} else {
			LoggerUtil.error("❌ Part Number mismatch. Expected: " + ExpectedPartNumber + ", Actual: " + partNo);
		}

		if (ExpectedCompanyName.equals(companies)) {
			LoggerUtil.pass("✅ Company Name matched: " + companies);
		} else {
			LoggerUtil.error("❌ Company Name mismatch. Expected: " + ExpectedCompanyName + ", Actual: " + companies);
		}

		if (ExpectedSupplierName.equals(suppliers)) {
			LoggerUtil.pass("✅ Supplier Name matched: " + suppliers);
		} else {
			LoggerUtil.error("❌ Supplier Name mismatch. Expected: " + ExpectedSupplierName + ", Actual: " + suppliers);
		}

		Thread.sleep(8000);
		clickCellLinkByHeader("Suppliers");
	}

	public static final By FetchingDataPartDescriptionTextUiFirstTabPartMaster = By
			.xpath("//div[@class='row mb-1 align-items-center']/descendant::input[@id='Partdesc']");
	public static final By FetchingDataPartNumberTextUiFirstTabPartMaster = By
			.xpath("//div[@class='row mb-1 align-items-center']/descendant::input[@id='PartNo']");
	public static final By fetchingSupplierNameTextFirstTabPartMaster = By
			.xpath("//div[@id='supDivP']/descendant::input[@id='SupplierName']");
	public static final By fetchingCommodityGroupFirstTabPartMaster = By.xpath(
			"//span[@class='select2 select2-container select2-container--default']/descendant::span[@id='select2-commodityDrop-container']");

	public HashMap<String, String> VerifyFetchDataInPartAttribute() {
		HashMap<String, String> partAttributeData = new HashMap<>();
		try {
			String partDescription = waitForExpectedElement(FetchingDataPartDescriptionTextUiFirstTabPartMaster)
					.getAttribute("value");
			String partNumber = waitForExpectedElement(FetchingDataPartNumberTextUiFirstTabPartMaster)
					.getAttribute("value");
			String supplierName = waitForExpectedElement(fetchingSupplierNameTextFirstTabPartMaster)
					.getAttribute("value");
			String commodityGroup = waitForExpectedElement(fetchingCommodityGroupFirstTabPartMaster).getText();

			partAttributeData.put("Part Description", partDescription);
			partAttributeData.put("Part Number", partNumber);
			partAttributeData.put("Supplier Name", supplierName);
			partAttributeData.put("Commodity Group", commodityGroup);

			LoggerUtil.info("Fetched Part Attribute Data:");
			for (Map.Entry<String, String> entry : partAttributeData.entrySet()) {
				LoggerUtil.info(entry.getKey() + " → " + entry.getValue());
			}

		} catch (Exception e) {
			LoggerUtil.error("Error fetching part attribute data: " + e.getMessage());
		}

		return partAttributeData;
	}

////////////////////////////////////////////////////////////SecondTabOldCostingData////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	/**
	 * Clicks a tab inside the Part Master > Costing module based on its visible
	 * name. Works for: Part Attributes, Part Price Calculations, BOP, Tooling Cost,
	 * Assembly Cost, Packaging and Transportation.
	 */
	/**
	 * Clicks a tab inside the Part Master > Costing module based on visible name.
	 * Handles hidden/covered elements using scroll and JS fallback.
	 */
	public void clickTabByNameInCostingModule(String tabName) {
		try {
			By dynamicTab = By.xpath("//ul[@class='nav nav-pills']//a[normalize-space(text())='" + tabName + "']");
			WebElement tabElement = waitForExpectedElement(dynamicTab);

			// Scroll tab into view
			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block: 'center'});", tabElement);
			Thread.sleep(500); // slight delay to stabilize scroll position

			try {
				// Normal click attempt
				tabElement.click();
				LoggerUtil.info("✅ Clicked normally on tab: " + tabName);
			} catch (ElementClickInterceptedException e) {
				// Fallback: JS click if obstructed
				((JavascriptExecutor) driver).executeScript("arguments[0].click();", tabElement);
				LoggerUtil.info("⚙️ Element was intercepted — clicked via JavaScript: " + tabName);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Failed to click on tab '" + tabName + "': " + e.getMessage());
			Assert.fail("Tab not found or not clickable: " + tabName);
		}
	}

	/**
	 * Verifies whether the radio button with the given label text is selected.
	 * Works even when input and label are wrapped together.
	 */
	public boolean isRadioButtonSelectedByLabel(String labelText) {
		try {
			// Find label that contains the text
			String radioXpath = "//label[contains(normalize-space(.),'" + labelText + "')]//input[@type='radio']";
			WebElement radioButton = waitForExpectedElement(By.xpath(radioXpath));

			boolean isSelected = radioButton.isSelected();

			if (isSelected) {
				LoggerUtil.info("✅ Radio Button '" + labelText + "' is SELECTED.");
			} else {
				LoggerUtil.warn("⚠️ Radio Button '" + labelText + "' is NOT selected.");
			}

			return isSelected;

		} catch (Exception e) {
			LoggerUtil.error("❌ Failed to verify radio button '" + labelText + "': " + e.getMessage());
			return false;
		}
	}

	public void verifyAssemblyCostData(HashMap<String, String> StoreOldCostingInfo) {
		{
			try {
				LoggerUtil.info(
						"🔍 Starting Assembly Cost data verification (Asterisk-Insensitive Value-Based Matching)...");

				// Step 1️⃣: Click and open "Assembly Cost" tab
				clickTabByNameInCostingModule("Assembly Cost");

				// Step 2️⃣: Extract UI table data
				By assemblyTable = By.id("tb_P1");
				LinkedHashMap<String, String> uiTableData = getHeaderValueMapFromTable(assemblyTable);

				if (uiTableData == null || uiTableData.isEmpty()) {
					LoggerUtil.error("❌ Assembly Cost table data is empty or could not be fetched.");
					return;
				}

				// Step 3️⃣: Define Excel → UI mapping
				Map<String, String> columnMapping = new LinkedHashMap<>();
				columnMapping.put("Part Description", "Part Description");
				columnMapping.put("Part No", "Part No.");
				columnMapping.put("Procurement Type", "Procurement Type");
				columnMapping.put("Commodity Group", "Commodity Group");
				columnMapping.put("Specific Grade", "RM Grade");
				columnMapping.put("Process Cost", "Process Cost/PC");
				columnMapping.put("Freight Cost", "Freight/Kg");
				columnMapping.put("Packing Cost", "Packing");
				columnMapping.put("OHP -others", "Other/ICC");

				// Step 4️⃣: Compare values using mapping
				int passCount = 0;
				int failCount = 0;

				for (Map.Entry<String, String> mapEntry : columnMapping.entrySet()) {
					String excelKey = mapEntry.getKey().replace("*", "").trim();
					String uiKey = mapEntry.getValue().replace("*", "").trim();

					// Get corresponding values
					String excelValue = getValueIgnoringAsterisk(StoreOldCostingInfo, excelKey);
					String uiValue = getValueIgnoringAsterisk(uiTableData, uiKey);

					// Comparison logic
					if (isValuesEqual(excelValue, uiValue)) {
						LoggerUtil.pass("✅ " + excelKey + " → Matched | Excel: " + excelValue + " | UI: " + uiValue);
						passCount++;
					} else {
						LoggerUtil.error("❌ " + excelKey + " → Mismatch | Excel: " + excelValue + " | UI: " + uiValue);
						failCount++;
					}
				}

				// Step 5️⃣: Summary
				LoggerUtil.info("📋 Comparison Summary → Matched: " + passCount + " | Mismatched: " + failCount);
				if (failCount == 0) {
					LoggerUtil.pass("🎯 All fields matched successfully between Excel and UI (Asterisk ignored).");
				} else {
					LoggerUtil.error("⚠️ Some mismatches found. Review the above details.");
				}

			} catch (Exception e) {
				LoggerUtil.error("💥 Error verifying Assembly Cost data: " + e.getMessage());
			}
		}

	}

	private boolean isValuesEqual(String val1, String val2) {
		try {
			// Handle numeric comparison (e.g., 21 vs 21.0000)
			double num1 = Double.parseDouble(val1.replaceAll("[^0-9.\\-]", ""));
			double num2 = Double.parseDouble(val2.replaceAll("[^0-9.\\-]", ""));
			return Math.abs(num1 - num2) < 0.0001;
		} catch (NumberFormatException e) {
			// Fallback to simple case-insensitive string match
			return val1.equalsIgnoreCase(val2);
		}
	}

	private String getValueIgnoringAsterisk(Map<String, String> map, String key) {
		if (map == null || map.isEmpty())
			return "";

		String cleanKey = normalizeKey(key);

		return map.entrySet().stream().filter(e -> normalizeKey(e.getKey()).equalsIgnoreCase(cleanKey))
				.map(Map.Entry::getValue).findFirst().orElse("").trim();
	}

	private String normalizeKey(String key) {
		if (key == null)
			return "";
		return key.replace("*", "").replace(".", "").replace("(", "").replace(")", "").trim().toLowerCase();
	}

	/**
	 * Fetches all header names and their corresponding values from the given table.
	 * Works for dynamic column positions and returns data in Header → Value order.
	 */
	public LinkedHashMap<String, String> getHeaderValueMapFromTable(By tableLocator) {
		LinkedHashMap<String, String> tableData = new LinkedHashMap<>();

		try {
			WebElement table = waitForExpectedElement(tableLocator);

			// Fetch all headers
			List<WebElement> headers = table.findElements(By.xpath(".//thead/tr/th"));
			// Fetch first data row (you can modify if you need multiple)
			List<WebElement> firstRowCells = table.findElements(By.xpath(".//tbody/tr[1]/td"));

			int totalColumns = Math.min(headers.size(), firstRowCells.size());

			for (int i = 1; i <= totalColumns; i++) {
				String headerXpath = ".//thead/tr/th[" + i + "]";
				String cellXpath = ".//tbody/tr[1]/td[" + i + "]";

				String header = "";
				String value = "";

				try {
					header = table.findElement(By.xpath(headerXpath)).getText().trim();
				} catch (Exception ignore) {
				}

				try {
					value = table.findElement(By.xpath(cellXpath)).getText().trim();
				} catch (Exception ignore) {
				}

				if (!header.isEmpty()) {
					tableData.put(header, value);
					LoggerUtil.info(header + " → " + value);
				}
			}

			LoggerUtil.info(" Successfully fetched table data. Total columns: " + tableData.size());

		} catch (Exception e) {
			LoggerUtil.error(" Failed to read table header-value data: " + e.getMessage());
		}

		return tableData;
	}

	public void verifyExcelVsUITable(HashMap<String, String> excelMap, HashMap<String, String> uiMap) {
		try {
			LoggerUtil.info("🔍 Starting comparison between Excel data and UI table data...");

			int passCount = 0;
			int failCount = 0;

			for (Map.Entry<String, String> excelEntry : excelMap.entrySet()) {
				String header = excelEntry.getKey().trim();
				String excelValue = excelEntry.getValue() == null ? "" : excelEntry.getValue().trim();

				// Find matching key in UI map (case-insensitive)
				Optional<Map.Entry<String, String>> matchingEntry = uiMap.entrySet().stream()
						.filter(e -> e.getKey().equalsIgnoreCase(header)).findFirst();

				if (matchingEntry.isPresent()) {
					String uiValue = matchingEntry.get().getValue() == null ? ""
							: matchingEntry.get().getValue().trim();

					if (excelValue.equalsIgnoreCase(uiValue)) {
						LoggerUtil.pass(" " + header + " → Matched | Excel: " + excelValue + " | UI: " + uiValue);
						passCount++;
					} else {
						LoggerUtil.error(" " + header + " → Mismatch | Excel: " + excelValue + " | UI: " + uiValue);
						failCount++;
					}
				} else {
					LoggerUtil.warn(" No matching UI column found for Excel header: " + header);
					failCount++;
				}
			}

			LoggerUtil.info(" Comparison Summary → Matched: " + passCount + " | Mismatched/Missing: " + failCount);
			if (failCount == 0) {
				LoggerUtil.pass(" All matched successfully between Excel and UI table.");
			} else {
				LoggerUtil.error(" Some mismatches found. Please review logs above.");
			}

		} catch (Exception e) {
			LoggerUtil.error(" Error during Excel vs UI comparison: " + e.getMessage());
		}
	}

	/**
	 * Click the first <a> inside the cell of the first data row for the given
	 * header.
	 */
	public boolean clickCellLinkByHeader(String headerName) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null) {
			LoggerUtil.error("Header not found: " + headerName);
			return false;
		}

		WebElement firstRow = waitForExpectedElement(By.xpath("//table[@id='" + TABLE_ID + "']//tbody/tr[1]"));
		if (firstRow == null)
			return false;

		WebElement cell = firstRow.findElement(By.xpath("./td[" + colIdx + "]"));
		return clickFirstAnchor(cell, headerName, null);
	}

	/**
	 * Click the first <a> inside the cell of the row that matches the given Part
	 * No. for the given header.
	 */
	public boolean clickCellLinkByHeader(String headerName, String partNo) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null) {
			LoggerUtil.error("Header not found: " + headerName);
			return false;
		}

		WebElement row = waitForExpectedElement(
				By.xpath("//table[@id='" + TABLE_ID + "']//tbody/tr[td[normalize-space(text())='" + partNo + "']]"));
		if (row == null)
			return false;

		WebElement cell = row.findElement(By.xpath("./td[" + colIdx + "]"));
		return clickFirstAnchor(cell, headerName, null);
	}

	/**
	 * Click the <a> within the given header column whose visible text matches
	 * linkText (first data row).
	 */
	public boolean clickLinkByHeaderAndText(String headerName, String linkText) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null) {
			LoggerUtil.error("Header not found: " + headerName);
			return false;
		}

		WebElement firstRow = waitForExpectedElement(By.xpath("//table[@id='" + TABLE_ID + "']//tbody/tr[1]"));
		if (firstRow == null)
			return false;

		WebElement cell = firstRow.findElement(By.xpath("./td[" + colIdx + "]"));
		return clickFirstAnchor(cell, headerName, linkText);
	}

	/**
	 * Click the <a> within the given header column whose visible text matches
	 * linkText (specific Part No. row).
	 */
	public boolean clickLinkByHeaderAndText(String headerName, String partNo, String linkText) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null) {
			LoggerUtil.error("Header not found: " + headerName);
			return false;
		}

		WebElement row = findRowByPartNo(partNo);
		if (row == null)
			return false;

		WebElement cell = row.findElement(By.xpath("./td[" + colIdx + "]"));
		return clickFirstAnchor(cell, headerName, linkText);
	}

	private WebElement findRowByPartNo(String partNo) {
		String xp = "//table[@id='commodtiyTable']//tbody/tr[td[normalize-space(.)='" + partNo + "']]";
		try {
			WebDriverWait w = new WebDriverWait(driver, java.time.Duration.ofSeconds(15));
			return w.until(ExpectedConditions.presenceOfElementLocated(By.xpath(xp)));
		} catch (Exception e) {
			LoggerUtil.error("findRowByPartNo failed for: " + partNo + " | " + e.getMessage());
			return null;
		}
	}

	/* Internal: click anchor inside a cell; if linkText is provided, match it. */
	private boolean clickFirstAnchor(WebElement cell, String headerName, String linkText) {
		try {
			List<WebElement> anchors = (linkText == null || linkText.isEmpty())
					? cell.findElements(By.xpath(".//a[normalize-space(.)!='']"))
					: cell.findElements(By.xpath(".//a[normalize-space(.)='" + linkText + "']"));

			if (anchors.isEmpty()) {
				LoggerUtil.error("No matching link found in column: " + headerName
						+ (linkText != null ? " for text: " + linkText : ""));
				return false;
			}

			WebElement target = anchors.get(0);
			try {
				target.click();
			} catch (Exception e) {
				((JavascriptExecutor) driver).executeScript("arguments[0].click();", target);
			}
			LoggerUtil.info("Clicked link in column: " + headerName + " | Text: " + target.getText());
			return true;
		} catch (Exception ex) {
			LoggerUtil.error("Failed to click in column: " + headerName + " | " + ex.getMessage());
			return false;
		}
	}

	// keep at top of your class
	private static final String TABLE_ID = "commodtiyTable";
	private Map<String, Integer> headerIndexCache; // optional cache

	/**
	 * Reads all header texts and returns a map: headerText -> 1-based column index
	 */
	public Map<String, Integer> readAllHeaders() {
		waitForExpectedElement(By.id(TABLE_ID));
		List<WebElement> headers = driver.findElements(By.xpath("//table[@id='" + TABLE_ID + "']//thead//th"));

		Map<String, Integer> headerIndexMap = new LinkedHashMap<>();
		for (int i = 0; i < headers.size(); i++) {
			String header = headers.get(i).getText().trim().replaceAll("\\s+", " ");
			if (!header.isEmpty()) {
				headerIndexMap.put(header, i + 1); // XPath is 1-based
			}
		}
		headerIndexCache = headerIndexMap;
		return headerIndexMap;
	}

	/** header name -> value from the first data row. Returns "" if not found. */
	public String getValueByHeader(String headerName) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null)
			return "";

		WebElement firstDataRow = waitForExpectedElement(By.xpath("//table[@id='" + TABLE_ID + "']//tbody/tr[1]"));
		if (firstDataRow == null)
			return "";

		WebElement cell = firstDataRow.findElement(By.xpath("./td[" + colIdx + "]"));
		return safeCellText(cell);
	}

	/**
	 * header name + specific Part No. -> value from that row/column. Returns "" if
	 * not found.
	 */
	public String getValueByHeader(String headerName, String partNo) {
		Integer colIdx = resolveColumnIndex(headerName);
		if (colIdx == null)
			return "";

		WebElement row = waitForExpectedElement(
				By.xpath("//table[@id='" + TABLE_ID + "']//tbody/tr[td[normalize-space(text())='" + partNo + "']]"));
		if (row == null)
			return "";

		WebElement cell = row.findElement(By.xpath("./td[" + colIdx + "]"));
		return safeCellText(cell);
	}

	/* ---------- Helpers (keep inside same class) ---------- */

	private Integer resolveColumnIndex(String headerName) {
		if (headerIndexCache == null || headerIndexCache.isEmpty()) {
			readAllHeaders();
		}
		String key = headerName.trim().replaceAll("\\s+", " ");
		for (Map.Entry<String, Integer> e : headerIndexCache.entrySet()) {
			if (e.getKey().equalsIgnoreCase(key)) {
				return e.getValue();
			}
		}
		LoggerUtil.error("Header not found: " + headerName);
		return null;
	}

	/** Robust text extractor; works for nested <a>/<span> too */
	private String safeCellText(WebElement cell) {
		try {
			String inner = cell.getAttribute("innerText");
			if (inner != null)
				return inner.trim().replaceAll("\\s+", " ");
		} catch (Exception ignored) {
		}
		try {
			return cell.getText().trim().replaceAll("\\s+", " ");
		} catch (Exception ex) {
			LoggerUtil.error("Failed to read cell text: " + ex.getMessage());
			return "";
		}
	}

	public void EnterValueInBothTypeSideAndVerifyResetButton(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredsupplierNameFromText, String RequiredCustomerNameFromText,

			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory)
			throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);
			Thread.sleep(2000);
			LoggerUtil.info("Clicked on UOM dropdown.");

			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			Thread.sleep(2000);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Name =====");
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}

			// ========================== Supplier Selection ==========================
			LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
			clickOnElement(clickingSupplierDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
					RequiredsupplierNameFromText);

			List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
			for (WebElement Supplier : SupplierNameList) {
				String SupplierText = Supplier.getText().trim();
				if (SupplierText.contains(RequiredsupplierNameFromText)) {
					Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Supplier → " + SupplierText);
					break;
				}
			}

			// ========================================= Customer Selection
			// ========================================================//

			clickOnElement(clickingCustomerDropdown);

			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);

			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);

			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);

			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			String partnumberValue = waitForExpectedElement(PartMasterPage.enterOnPartNumber).getAttribute("value");
			System.out.println(partnumberValue);

			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Reset");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			Thread.sleep(6000);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public void VerifyResetButtonFunctionality() {
		try {
			LoggerUtil.info("===== STEP 10: Verifying Reset Button Functionality =====");

			Thread.sleep(16000);
			boolean allCleared = true; // Flag to track overall status

			// ✅ 1️⃣ Verify Part Number
			WebElement partNumber = waitForExpectedElement(PartMasterPage.enterOnPartNumber);
			String partNumberValue = partNumber.getAttribute("value").trim();
			if (partNumberValue.isEmpty()) {
				LoggerUtil.pass("✅ Part Number field cleared successfully.");
			} else {
				LoggerUtil.mismatch("❌ Part Number field not cleared. Current value: " + partNumberValue);
				allCleared = false;
			}

			// ✅ 2️⃣ Verify Part Description
			WebElement partDescription = waitForExpectedElement(PartMasterPage.enterOnPartDescription);
			String partDescValue = partDescription.getAttribute("value").trim();
			if (partDescValue.isEmpty()) {
				LoggerUtil.pass("✅ Part Description field cleared successfully.");
			} else {
				LoggerUtil.mismatch("❌ Part Description field not cleared. Current value: " + partDescValue);
				allCleared = false;
			}

			// ✅ 3️⃣ Verify UOM dropdown (we clicked clickingUomDropdown to open it)
			WebElement uomDropdown = waitForExpectedElement(clickingUomDropdown);
			String uomText = uomDropdown.getText().trim();
			if (uomText.isEmpty() || uomText.equalsIgnoreCase("Select") || uomText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ UOM dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ UOM dropdown not reset. Current selection: " + uomText);
				allCleared = false;
			}

			// ✅ 4️⃣ Verify Company Name dropdown (we clicked clickingCompanyNameDropdown to
			// open it)
			WebElement companyDropdown = waitForExpectedElement(clickingCompanyNameDropdown);
			String companyText = companyDropdown.getText().trim();
			if (companyText.isEmpty() || companyText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Company Name dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ Company Name dropdown not reset. Current selection: " + companyText);
				allCleared = false;
			}

			// ✅ 5️⃣ Verify Supplier dropdown
			WebElement supplierDropdown = waitForExpectedElement(clickingSupplierDropdown);
			String supplierText = supplierDropdown.getText().trim();
			if (supplierText.isEmpty() || supplierText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Supplier dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ Supplier dropdown not reset. Current selection: " + supplierText);
				allCleared = false;
			}

			// ✅ 6️⃣ Verify Customer dropdown
			WebElement customerDropdown = waitForExpectedElement(clickingCustomerDropdown);
			String customerText = customerDropdown.getText().trim();
			if (customerText.isEmpty() || customerText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Customer dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ Customer dropdown not reset. Current selection: " + customerText);
				allCleared = false;
			}

			// ✅ 7️⃣ Verify Product Category dropdown
			WebElement productCategoryDropdown = waitForExpectedElement(ClickingProductCategoryDropdown);
			String productCategoryText = productCategoryDropdown.getText().trim();
			if (productCategoryText.isEmpty() || productCategoryText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Product Category dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ Product Category dropdown not reset. Current selection: " + productCategoryText);
				allCleared = false;
			}

			// ✅ 8️⃣ Verify Product Model dropdown
			WebElement productModelDropdown = waitForExpectedElement(clickingProductModelNameDropdown);
			String productModelText = productModelDropdown.getText().trim();
			if (productModelText.isEmpty() || productModelText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Product Model dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch("❌ Product Model dropdown not reset. Current selection: " + productModelText);
				allCleared = false;
			}

			// ✅ 9️⃣ Verify Special Product Category dropdown
			WebElement specialProductDropdown = waitForExpectedElement(clickingSpecialProductCategory);
			String specialProductText = specialProductDropdown.getText().trim();
			if (specialProductText.isEmpty() || specialProductText.equalsIgnoreCase("None selected")) {
				LoggerUtil.pass("✅ Special Product Category dropdown reset successfully.");
			} else {
				LoggerUtil.mismatch(
						"❌ Special Product Category dropdown not reset. Current selection: " + specialProductText);
				allCleared = false;
			}

			// ✅ Final Step: Summary Result
			if (allCleared) {
				LoggerUtil.pass(
						"🎯 All text fields and dropdowns cleared successfully. Reset Button Functionality verified.");
			} else {
				LoggerUtil.fail("❌ One or more fields/dropdowns were not cleared properly after Reset.");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Reset Button verification → " + e.getMessage());
			Assert.fail("Error verifying Reset functionality: " + e.getMessage());
		}

	}

	public static HashMap<String, String> savedataDetailsTillYear(String searchcommoditydropvalue,
			String searchcommodityclassification, String selectcommoditygradevalue, String enteryear)
			throws InterruptedException {

		// ✅ Create HashMap to store all selected values
		HashMap<String, String> selectedData = new HashMap<>();

		try {
			LoggerUtil.info("STEP 1: Open 'Commodity Group' dropdown.");
			Thread.sleep(5000);
			clickOnElement(ClickingcommoditydropdownBtnThirdTab);

			LoggerUtil.info("STEP 2: Enter Commodity Group → " + searchcommoditydropvalue);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchInputforcommodityDetailsTab),
					searchcommoditydropvalue);

			List<WebElement> comlist = driver.findElements(CommodityDetailsPage.commoditydropdownlist);
			boolean comFound = false;
			for (WebElement comgrpvalue : comlist) {
				if (comgrpvalue.getText().trim().equalsIgnoreCase(searchcommoditydropvalue)) {
					comgrpvalue.click();
					comFound = true;
					LoggerUtil.pass("Commodity Group '" + searchcommoditydropvalue + "' selected successfully.");
					selectedData.put("CommodityGroup", searchcommoditydropvalue);
					break;
				}
			}
			if (!comFound) {
				LoggerUtil.fail("Commodity Group '" + searchcommoditydropvalue + "' not found.");
			}
		} catch (Exception e) {
			LoggerUtil.error("Commodity Group selection failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 3: Open 'Group Classification' dropdown.");
			Thread.sleep(5000);
			clickOnElement(ClickingGroupclassificationBtnThirdTabDropdown);
			Thread.sleep(3000);

			List<WebElement> grpclasslist = driver.findElements(CommodityDetailsPage.groupclassificationlist);
			boolean grpFound = false;
			for (WebElement grpclasslistval : grpclasslist) {
				if (grpclasslistval.getText().trim().equalsIgnoreCase(searchcommodityclassification)) {
					grpclasslistval.click();
					grpFound = true;
					LoggerUtil.pass(
							"Group Classification '" + searchcommodityclassification + "' selected successfully.");
					selectedData.put("GroupClassification", searchcommodityclassification);
					break;
				}
			}
			if (!grpFound) {
				LoggerUtil.fail("Group Classification '" + searchcommodityclassification + "' not found.");
			}
		} catch (Exception e) {
			LoggerUtil.error("Group Classification selection failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 4: Open 'Specific Grade' dropdown.");
			Thread.sleep(5000);
			clickOnElement(ClickingspecificgradeBtndropdownForThirdTab);

			List<WebElement> comgradelist = driver.findElements(CommodityDetailsPage.specificgradelist);
			boolean gradeFound = false;
			for (WebElement comgradelistval : comgradelist) {
				if (comgradelistval.getText().trim().equalsIgnoreCase(selectcommoditygradevalue)) {
					comgradelistval.click();
					gradeFound = true;
					LoggerUtil.pass("Specific Grade '" + selectcommoditygradevalue + "' selected successfully.");
					selectedData.put("SpecificGrade", selectcommoditygradevalue);
					break;
				}
			}
			if (!gradeFound) {
				LoggerUtil.fail("Specific Grade '" + selectcommoditygradevalue + "' not found.");
			}
		} catch (Exception e) {
			LoggerUtil.error("Specific Grade selection failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 5: Select UOM = 'Mtr'");
			clickOnElement(CommodityDetailsPage.Uomdropdown);
			Thread.sleep(3000);

			WebElement searchuom = waitForExpectedElement(CommodityDetailsPage.searchinputforuom);
			clearAndEnterText(searchuom, "Mtr");
			searchuom.sendKeys(Keys.ENTER);
			Thread.sleep(500);
			LoggerUtil.pass("UOM 'Mtr' selected successfully.");
			selectedData.put("UOM", "Mtr");
		} catch (Exception e) {
			LoggerUtil.error("UOM selection failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 6: Select Shape = 'Sheet'");
			clickOnElement(ClickingShapedropdownForthirdTab);
			Thread.sleep(300);

			WebElement shapesearch = waitForExpectedElement(CommodityDetailsPage.searchinputforshape);
			clearAndEnterText(shapesearch, "Sheet");
			shapesearch.sendKeys(Keys.ENTER);
			Thread.sleep(5000);
			LoggerUtil.pass("Shape 'Sheet' selected successfully.");
			selectedData.put("Shape", "Sheet");
		} catch (Exception e) {
			LoggerUtil.error("Shape selection failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 7: Scroll window by 130px.");
			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("window.scrollBy(0, 130);");
			Thread.sleep(2000);
			LoggerUtil.pass("Scroll successful.");
		} catch (Exception e) {
			LoggerUtil.error("Scroll failed → " + e.getMessage());
		}

		try {
			LoggerUtil.info("STEP 8: Select Year → " + enteryear);
			clickOnElement(CommodityDetailsPage.selectyeardrop);
			Thread.sleep(500);

			WebElement yearsearch = waitForExpectedElement(CommodityDetailsPage.searchinputyear);
			clearAndEnterText(yearsearch, enteryear);
			yearsearch.sendKeys(Keys.ENTER);
			Thread.sleep(3000);
			LoggerUtil.pass("Year '" + enteryear + "' selected successfully.");
			selectedData.put("Year", enteryear);
		} catch (Exception e) {
			LoggerUtil.error("Year selection failed → " + e.getMessage());
		}

		// ✅ Return all stored selections
		LoggerUtil.info("All selected dropdown values stored in HashMap: " + selectedData);
		return selectedData;
	}

	public static HashMap<String, String> enetrRmAndScrapValuesForPartMasterValidation(String enteraprilrm,
			String enteraprilscrap, String entermayrm, String entermayscrap, String enterjunerm, String enterjunescrap,
			String enterjulyrm, String enterjulyscrap, String enteraugustrm, String enteraugscrap, String enterseptemrm,
			String entersepscrap, String enetroctrm, String enteroctscrap, String enternovrm, String enternovscrap,
			String enterdecrm, String enterdecscrap, String enetrjanram, String enterjanscrap, String enterfebrm,
			String enterfebscrap, String entermarchrm, String entermarchscrap, String entersearchvalue)
			throws InterruptedException {

		SoftAssert soft = new SoftAssert();
		HashMap<String, String> rmScrapMap = new HashMap<>();

		LoggerUtil.info("===== Filling RM & Scrap values for each month with 3-decimal precision =====");

		try {
			// ---------------- APRIL ----------------
			LoggerUtil.info("April RM: " + enteraprilrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "RM")),
					enteraprilrm);
			LoggerUtil.info("April Scrap: " + enteraprilscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Apr", "Scrap")),
					enteraprilscrap);
			rmScrapMap.put("Apr_RM", enteraprilrm);
			rmScrapMap.put("Apr_Scrap", enteraprilscrap);

			// ---------------- MAY ----------------
			LoggerUtil.info("May RM: " + entermayrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("May", "RM")),
					entermayrm);
			LoggerUtil.info("May Scrap: " + entermayscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("May", "Scrap")),
					entermayscrap);
			rmScrapMap.put("May_RM", entermayrm);
			rmScrapMap.put("May_Scrap", entermayscrap);

			// ---------------- JUNE ----------------
			LoggerUtil.info("June RM: " + enterjunerm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jun", "RM")),
					enterjunerm);
			LoggerUtil.info("June Scrap: " + enterjunescrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jun", "Scrap")),
					enterjunescrap);
			rmScrapMap.put("Jun_RM", enterjunerm);
			rmScrapMap.put("Jun_Scrap", enterjunescrap);

			// ---------------- JULY ----------------
			LoggerUtil.info("July RM: " + enterjulyrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jul", "RM")),
					enterjulyrm);
			LoggerUtil.info("July Scrap: " + enterjulyscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jul", "Scrap")),
					enterjulyscrap);
			rmScrapMap.put("Jul_RM", enterjulyrm);
			rmScrapMap.put("Jul_Scrap", enterjulyscrap);

			// ---------------- AUGUST ----------------
			LoggerUtil.info("August RM: " + enteraugustrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Aug", "RM")),
					enteraugustrm);
			LoggerUtil.info("August Scrap: " + enteraugscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Aug", "Scrap")),
					enteraugscrap);
			rmScrapMap.put("Aug_RM", enteraugustrm);
			rmScrapMap.put("Aug_Scrap", enteraugscrap);

			// ---------------- SEPTEMBER ----------------
			LoggerUtil.info("September RM: " + enterseptemrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Sep", "RM")),
					enterseptemrm);
			LoggerUtil.info("September Scrap: " + entersepscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Sep", "Scrap")),
					entersepscrap);
			rmScrapMap.put("Sep_RM", enterseptemrm);
			rmScrapMap.put("Sep_Scrap", entersepscrap);

			// ---------------- OCTOBER ----------------
			LoggerUtil.info("October RM: " + enetroctrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Oct", "RM")),
					enetroctrm);
			LoggerUtil.info("October Scrap: " + enteroctscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Oct", "Scrap")),
					enteroctscrap);
			rmScrapMap.put("Oct_RM", enetroctrm);
			rmScrapMap.put("Oct_Scrap", enteroctscrap);

			// ---------------- NOVEMBER ----------------
			LoggerUtil.info("November RM: " + enternovrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Nov", "RM")),
					enternovrm);
			LoggerUtil.info("November Scrap: " + enternovscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Nov", "Scrap")),
					enternovscrap);
			rmScrapMap.put("Nov_RM", enternovrm);
			rmScrapMap.put("Nov_Scrap", enternovscrap);

			// ---------------- DECEMBER ----------------
			LoggerUtil.info("December RM: " + enterdecrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Dec", "RM")),
					enterdecrm);
			LoggerUtil.info("December Scrap: " + enterdecscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Dec", "Scrap")),
					enterdecscrap);
			rmScrapMap.put("Dec_RM", enterdecrm);
			rmScrapMap.put("Dec_Scrap", enterdecscrap);

			// ---------------- JANUARY ----------------
			LoggerUtil.info("January RM: " + enetrjanram);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jan", "RM")),
					enetrjanram);
			LoggerUtil.info("January Scrap: " + enterjanscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Jan", "Scrap")),
					enterjanscrap);
			rmScrapMap.put("Jan_RM", enetrjanram);
			rmScrapMap.put("Jan_Scrap", enterjanscrap);

			// ---------------- FEBRUARY ----------------
			LoggerUtil.info("February RM: " + enterfebrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Feb", "RM")),
					enterfebrm);
			LoggerUtil.info("February Scrap: " + enterfebscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Feb", "Scrap")),
					enterfebscrap);
			rmScrapMap.put("Feb_RM", enterfebrm);
			rmScrapMap.put("Feb_Scrap", enterfebscrap);

			// ---------------- MARCH ----------------
			LoggerUtil.info("March RM: " + entermarchrm);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Mar", "RM")),
					entermarchrm);
			LoggerUtil.info("March Scrap: " + entermarchscrap);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.getDynamicRMOrScrapLocator("Mar", "Scrap")),
					entermarchscrap);
			rmScrapMap.put("Mar_RM", entermarchrm);
			rmScrapMap.put("Mar_Scrap", entermarchscrap);

			// ✅ Business Segment Selection
			clickOnElement(CommodityDetailsPage.businessSegbox);
			clearAndEnterText(waitForExpectedElement(CommodityDetailsPage.searchbarbusinessSeg), "rishi");
			Thread.sleep(3000);
			clickOnElement(CommodityDetailsPage.selectallcheckboxInbusinsessSeg);
			Thread.sleep(8000);
			clickOnElement(CommodityDetailsPage.customercheckbox);
			Thread.sleep(3000);

			// ✅ Save Button Click
			clickOnElement(CommodityDetailsPage.ClickingSaveBtnForThirdTab);
			LoggerUtil.info("Clicked Save button for third tab.");
			Thread.sleep(4000);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error in RM & Scrap entry or save process → " + e.getMessage());
			e.printStackTrace();
			soft.fail("Failed during RM/Scrap entry process");
		}

		// ✅ Log all stored values
		LoggerUtil.info("✅ Stored RM & Scrap values in HashMap → " + rmScrapMap);

		soft.assertAll();
		return rmScrapMap;
	}

	public static final By EnterValueforExcelContRow = By
			.xpath("//div[@class='detailcosting']/descendant::input[@id='excelCount2']");

	public HashMap<String, String> VerifyExportAndDownloadExcelFileForDetailsCosting(String RequiredCompanyName,
			String RequiredRadionButtonName, String RequiredsupplierNameFromText, String RequiredCustomerNameFromText,
			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory,
			String enterTotalNumberofparts, String EnterYear, String enterCommGroupName,
			String enterGroupclassificationValuem, String ExpectedToastMessage) throws InterruptedException {

		// ✅ Initialize HashMap to store all values
		HashMap<String, String> exportDataMap = new HashMap<>();

		LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
		clickOnElement(clickingCompanyNameDropdown);
		List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

		for (WebElement Companies : ListCompanyName) {
			String CompanyNameText = Companies.getText().trim();
			if (CompanyNameText.equals(RequiredCompanyName)) {
				Companies.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
				exportDataMap.put("CompanyName", CompanyNameText);
				break;
			}
		}

		// ========================== Radio Button Selection ==========================
		LoggerUtil.info("===== STEP 4: Selecting Radio Button By Name =====");
		List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
		for (WebElement Pagename : PageHeadersName) {
			String pagenametext = Pagename.getText().trim();
			if (pagenametext.contains(RequiredRadionButtonName)) {
				Pagename.findElement(By.tagName("input")).click();
				LoggerUtil.pass("Selected Radio Button → " + pagenametext);
				exportDataMap.put("RadioButtonName", pagenametext);
				break;
			}
		}

		// ========================== Supplier Selection ==========================
		LoggerUtil.info("===== STEP 5: Selecting Supplier Name =====");
		clickOnElement(clickingSupplierDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchSupplierNameSupplierDropdown),
				RequiredsupplierNameFromText);

		List<WebElement> SupplierNameList = driver.findElements(FetchingSupplierName);
		for (WebElement Supplier : SupplierNameList) {
			String SupplierText = Supplier.getText().trim();
			if (SupplierText.contains(RequiredsupplierNameFromText)) {
				Supplier.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Supplier → " + SupplierText);
				exportDataMap.put("SupplierName", SupplierText);
				break;
			}
		}

		// ========================== Customer Selection ==========================
		clickOnElement(clickingCustomerDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);
		List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);
		for (WebElement Customer : CustomerNameList) {
			String CustomerText = Customer.getText().trim();
			if (CustomerText.contains(RequiredCustomerNameFromText)) {
				Customer.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Customer → " + CustomerText);
				exportDataMap.put("CustomerName", CustomerText);
				break;
			}
		}

		// ========================== Product Category Selection
		// ==========================
		LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
		clickOnElement(ClickingProductCategoryDropdown);
		clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);
		List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
		for (WebElement ProductCat : ProductCategories) {
			String TextproductCategory = ProductCat.getText().trim();
			if (TextproductCategory.contains(RequiredProducCategoryName)) {
				ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
				exportDataMap.put("ProductCategory", TextproductCategory);
				break;
			}
		}

		// ========================== Product Model Selection ==========================
		LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
		clickOnElement(clickingProductModelNameDropdown);
		clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
		List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
		for (WebElement productname : Productmodalnames) {
			String Producttextname = productname.getText().trim();
			if (Producttextname.equals(RequiredProducModelName)) {
				productname.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Product Model → " + Producttextname);
				exportDataMap.put("ProductModel", Producttextname);
				break;
			}
		}

		// ========================== Special Product Category
		// ==========================
		LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
		clickOnElement(clickingSpecialProductCategory);
		clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);
		List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
		for (WebElement ProductCategory : productCategoryNames) {
			String productCategoryText = ProductCategory.getText().trim();
			if (productCategoryText.equals(RequiredSpecialProductCategory)) {
				ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
				LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
				exportDataMap.put("SpecialProductCategory", productCategoryText);
				break;
			}
		}

		// ========================== Export Steps ==========================
		List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(buttons, "Export / Import");
		Thread.sleep(2000);

		List<WebElement> RadiobuttonsName = driver.findElements(RadioNameListExportModal);
		for (WebElement Radio : RadiobuttonsName) {
			String radiobtn = Radio.getText().trim();
			if (radiobtn.equals("Detail Costing")) {
				WebElement oldcasting = Radio
						.findElement(By.xpath("./preceding-sibling::input[contains(@type,'radio')]"));
				oldcasting.click();
				exportDataMap.put("ExportType", "Detail Costing");
				break;
			}
		}

		clearAndEnterText(waitForExpectedElement(EnterValueforExcelContRow), "1");

		Thread.sleep(2000);
		clickOnElement(ClickingSecondExportButtonForDownloadPartMaster);
		LoggerUtil.pass("Clicked on Export button successfully.");

		String ActualToastMessage = waitForExpectedElement(toastMessage).getText();
		Assert.assertTrue(ActualToastMessage.contains(ExpectedToastMessage));
		getLatestFilePartMasterForDetailCostingFile();
		Thread.sleep(15000);

		LoggerUtil.pass(" Details Costing Excel exported and downloaded successfully.");
		LoggerUtil.info("Export Data Map: " + exportDataMap);

		return exportDataMap;
	}

	public List<String> FetchDataFromExcelDtailsCosting() {
		List<String> lastRowData = new ArrayList<>();

		try {
			// ✅ STEP 1: Locate the latest Excel file from downloads
			File latestFile = getLatestFilePartMasterForDetailCostingFile();
			if (latestFile == null || !latestFile.exists()) {
				LoggerUtil.fail("❌ No Detail Costing Excel file found in download folder.");
				return lastRowData;
			}

			String filePath = latestFile.getAbsolutePath();
			LoggerUtil.info("📄 Reading last data row from file: " + filePath);

			// ✅ STEP 2: Open workbook and get sheet
			FileInputStream fis = new FileInputStream(filePath);
			Workbook workbook = WorkbookFactory.create(fis);
			Sheet sheet = workbook.getSheet("Commodity_Master");

			if (sheet == null) {
				LoggerUtil.fail("❌ Sheet 'Commodity_Master' not found in Excel.");
				workbook.close();
				fis.close();
				return lastRowData;
			}

			FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();

			// ✅ STEP 3: Find true last row (bottom-up scan for non-empty value in column B)
			int lastRowIndex = -1;
			for (int i = sheet.getLastRowNum(); i >= 0; i--) {
				Row row = sheet.getRow(i);
				if (row == null)
					continue;

				Cell keyCell = row.getCell(1); // Column B
				String keyValue = ExcelUtil.evaluateCellValue(keyCell, evaluator).trim();

				if (!keyValue.isEmpty()) {
					lastRowIndex = i;
					break;
				}
			}

			if (lastRowIndex == -1) {
				LoggerUtil.warn("⚠️ No valid data rows found in 'Commodity_Master'.");
				workbook.close();
				fis.close();
				return lastRowData;
			}

			LoggerUtil.pass("✅ True last data row index detected: " + lastRowIndex);

			// ✅ STEP 4: Read data from Columns B → BF (index 1 → 58)
			Row lastRow = sheet.getRow(lastRowIndex);
			int startCol = 1, endCol = 58;

			for (int col = startCol; col <= endCol; col++) {
				Cell cell = lastRow.getCell(col);
				String value = ExcelUtil.evaluateCellValue(cell, evaluator);
				lastRowData.add(value);
			}

			workbook.close();
			fis.close();

			// ✅ STEP 5: Log and return all values
			LoggerUtil.info("📊 Extracted Last Row Data (Columns B–BF): " + lastRowData);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while fetching last row data from 'Commodity_Master' → " + e.getMessage());
			e.printStackTrace();
		}

		return lastRowData;
	}

	public void clickLinkUnderHeader(String headerName, String matchText) {
		try {
			// 1️⃣ Find header column index
			List<WebElement> headerList = driver.findElements(By.xpath("//*[@id='commodtiyTable']//thead//th"));
			int headerIndex = -1;

			for (int i = 0; i < headerList.size(); i++) {
				String header = headerList.get(i).getText().trim();
				if (header.equalsIgnoreCase(headerName)) {
					headerIndex = i + 1;
					break;
				}
			}

			if (headerIndex == -1) {
				LoggerUtil.error("❌ Header not found: " + headerName);
				return;
			}

			// 2️⃣ Get table rows
			List<WebElement> rows = driver.findElements(By.xpath("//*[@id='commodtiyTable']//tbody/tr"));
			WebElement bestMatchRow = null;
			String bestRowText = "";

			// Normalize match text (e.g. lowercase)
			String normalizedTarget = matchText.toLowerCase().replaceAll("\\s+", "");

			// 3️⃣ Find the most suitable match
			for (WebElement row : rows) {
				String rowText = row.getText().trim();
				String normalizedRow = rowText.toLowerCase().replaceAll("\\s+", "");

				// --- Matching Rules ---
				boolean exact = normalizedRow.equals(normalizedTarget);
				boolean contains = normalizedRow.contains(normalizedTarget);
				boolean reversed = normalizedTarget.contains(normalizedRow);

				// Additional flexible match:
				// check if both "rishicustomer" and "-0004" appear anywhere in the same row
				boolean segmentMatch = normalizedTarget.contains("-")
						&& normalizedRow.contains(normalizedTarget.split("-")[0])
						&& normalizedRow.contains("-" + normalizedTarget.split("-")[1]);

				if (exact || contains || reversed || segmentMatch) {
					bestMatchRow = row;
					bestRowText = rowText;
					break;
				}
			}

			// 4️⃣ If still no match, click first available row instead of stopping
			if (bestMatchRow == null && !rows.isEmpty()) {
				bestMatchRow = rows.get(0);
				bestRowText = bestMatchRow.getText().trim();
				LoggerUtil.warn("⚠ No perfect match found for '" + matchText + "'. Defaulting to first row click.");
			}

			// 5️⃣ Click the link
			if (bestMatchRow != null) {
				if (!bestRowText.equalsIgnoreCase(matchText)) {
					LoggerUtil.warn(
							"LENIENT MATCH → Expected contains: '" + matchText + "' | Found: '" + bestRowText + "'");
				}

				WebElement link = bestMatchRow.findElement(By.xpath("./td[" + headerIndex + "]//a"));
				((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", link);
				((JavascriptExecutor) driver).executeScript("arguments[0].style.border='3px solid orange'", link);

				try {
					link.click();
					LoggerUtil.info("✅ Clicked link under header '" + headerName + "' for row text: " + bestRowText);
				} catch (Exception e) {
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", link);
					LoggerUtil.info("✅ Clicked link using JavaScript for row text: " + bestRowText);
				}
			} else {
				LoggerUtil.error("⚠ No rows available to click under header: " + headerName);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Error clicking link under header '" + headerName + "' → " + e.getMessage());
		}
	}

	public String getValueByLabelName(String labelName) {
		try {
			// XPath covers both label–input and table cell structures
			By locator = By.xpath("//*[normalize-space(text())='" + labelName + "']" + "/following::input[1]");

			WebElement inputElement = waitForExpectedElement(locator);
			String value = inputElement.getAttribute("value").trim();

			LoggerUtil.info("Fetched value for label '" + labelName + "' → " + value);
			return value;

		} catch (Exception e) {
			LoggerUtil.error("❌ Unable to get value for label '" + labelName + "' → " + e.getMessage());
			return "";
		}
	}

	public static final By ClickingSearchButtonFromUiPartMaster = By
			.xpath("//div[@class='header-element cs_part_search cs_indian_r']/a[@onclick='openSearch()']");
	public static final By clickingRadioButtonByName = By
			.xpath("//div[@id='modalSearch']/descendant::label[contains(text(),'')]");
	// select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']
	public static final By SelectingCommodityGroupDropdown = By.xpath(
			"//select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']");
	// select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']
	public static final By EnterCommodityGroupNameInSearchBoxfirstab = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");
	public static final By listCommodityGroupnames = By.xpath("//ul[@id='select2-commodityDrop-results']/li");

	public static final By ClickingSaveButtonPartMaster = By.id("tab1Save");

	public void VerifyPartNumberAreSavedOrNotWithCustomerSide(String EnterpartDescriptionNumber,
			String ExpectedPartnumberValue, String ExpectedPartdescriptionValue, String CommodityGroupName)
			throws InterruptedException {

		try {
			LoggerUtil.info(" Starting verification for Part: " + EnterpartDescriptionNumber);

			Thread.sleep(1500);
			clickOnElement(ClickingSearchButtonFromUiPartMaster);
			LoggerUtil.info("Clicked main Search button in Part Master.");

			Thread.sleep(1500);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueForPartNumberAndDescriptionAfterImportData),
					EnterpartDescriptionNumber);
			LoggerUtil.info("Entered search text: " + EnterpartDescriptionNumber);

			clickOnElement(ClickingSearchButtonPartMasterVerifingPartDescription);
			LoggerUtil.info("Clicked Part Master Search to validate description.");

			// Select 'Sales' radio button
			List<WebElement> RadioButtonNames = driver.findElements(clickingRadioButtonByName);
			boolean salesSelected = false;
			for (WebElement RadioBtnname : RadioButtonNames) {
				String RadioBtnNameText = RadioBtnname.getText().trim();
				if (RadioBtnNameText.equalsIgnoreCase("Sales")) {
					WebElement RadioBtn = RadioBtnname.findElement(By.xpath("./preceding-sibling::input"));
					RadioBtn.click();
					LoggerUtil.info("Selected 'Sales' radio button successfully.");
					salesSelected = true;
					Thread.sleep(1500);
					break;
				}
			}
			if (!salesSelected) {
				LoggerUtil.error(" 'Procurement' radio button not found. Proceeding with next step.");
			}

			// Click Search to open results
			clickOnElement(clickingSearchButtonToValidatePartDescription);
			LoggerUtil.info("Clicked Search to validate part description.");
			Thread.sleep(2500);

			// Click customer link even if mismatch occurs
			clickLinkUnderHeader("Customer", "rishicustomer-Tbilisi-0004");
			LoggerUtil.info("Clicked on Customer link: rishicustomer-Tbilisi-0004");

			// Fetch actual values from Customer-side screen
			String ActualPartnumberValue = getValueByLabelName("Part Number");
			String ActualPartdescriptionValue = getValueByLabelName("Part Description");

			// Validation 1: Part Number
			if (ActualPartnumberValue.equalsIgnoreCase(ExpectedPartnumberValue)) {
				LoggerUtil.pass(" Part Number matched → Expected: " + ExpectedPartnumberValue + " | Actual: "
						+ ActualPartnumberValue);
			} else {
				LoggerUtil.error(" MISMATCH → Part Number | Expected: " + ExpectedPartnumberValue + " | Actual: "
						+ ActualPartnumberValue);
			}

			// Validation 2: Part Description
			if (ActualPartdescriptionValue.equalsIgnoreCase(ExpectedPartdescriptionValue)) {
				LoggerUtil.pass(" Part Description matched → Expected: " + ExpectedPartdescriptionValue + " | Actual: "
						+ ActualPartdescriptionValue);
			} else {
				LoggerUtil.error(" MISMATCH → Part Description | Expected: " + ExpectedPartdescriptionValue
						+ " | Actual: " + ActualPartdescriptionValue);
			}

			LoggerUtil.info(" Verification process completed for part: " + EnterpartDescriptionNumber);

			clickOnElement(SelectingCommodityGroupDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterCommodityGroupNameInSearchBoxfirstab), CommodityGroupName);

			Thread.sleep(2000);

			List<WebElement> optionsComgrp = driver.findElements(listCommodityGroupnames);
			for (WebElement option : optionsComgrp) {

				String nametext = option.getText().trim();
				if (nametext.equals(CommodityGroupName)) {
					option.click();
					break;

				}

			}

			clickOnElement(ClickingSaveButtonPartMaster);
			String Actualtoastmsg = waitForExpectedElement(toastMessage).getText();
			System.out.println(Actualtoastmsg);

			if (Actualtoastmsg.equals("Part attribute details saved successfully.")) {

				LoggerUtil.pass("Toast Message Getting Correct ");
			} else {

				LoggerUtil.error("Incorrect Toast Message");
			}

			Thread.sleep(6000);

		} catch (Exception e) {
			LoggerUtil.error(" Error in VerifyPartNumberAreSavedOrNotWithCustomerSide → " + e.getMessage());
		}
	}

	public void uploadFileUsingJS() throws InterruptedException {

		WebElement UploadButtonForPartMaster = driver
				.findElement(By.xpath("//button[@class='btn btn-primary btn-sm pull-right']"));

		UploadButtonForPartMaster.click();

		UploadButtonForPartMaster.sendKeys("Detail Costing Sheet_16-10-2025_09-56-10 1 1.xlsx");

		LoggerUtil.info("Excel File Has Been Uploaded SucessFully..");

		Thread.sleep(588);

	}

	public static final By DropdownlistShapeOptions = By.xpath("//select[@id='ddlShapes']");
	public static final By RmInputCategoryDropdownn = By.xpath("//select[@id='rmInputDrop']");
	public static final By CommodityGroupDropdownStandardShapes = By.xpath("//select[@id='commodityGroupId_SS']");
	public static final By GroupClassificationDropdownStandardShapes = By.xpath("//select[@id='subGroupId_SS']");
	public static final By yearDropdownStandardShapes = By.xpath("//select[@id='Year']");
	public static final By PeriodDropdownStandardShapes = By.xpath("//select[@id='RmPeriod_SS']");
	public static final By SpecificGradeDropdownStandardShapes = By.xpath("//select[@id='RmGradeId_SS']");
	public static final By BlankGrossweightperkg = By.xpath("//input[@id='BlankGrossWt2_SS']");
	public static final By EnterNetWeight = By.xpath("//input[@id='partFinishWt_SS']");

	public static final By clickingRadioButtonDirectEntry = By.xpath("//input[@id='optionsRadioDirect_SS']");

	public static final By clickingRadioButtonDirectEntryRmSide = By
			.xpath("//div[@id='SystemDefault']/following-sibling::div/descendant::input[contains(text(),'')]");
	public static final By EnterPerstripvalue = By.xpath("//input[@id='perStrip']");

	public static final By FetchingRmInputCategoryDataFerrousCasting = By.xpath(
			"//select[@id='rmInputDrop']/following-sibling::span/descendant::span[@id='select2-rmInputDrop-container']");
	public static final By fetchingGroupClassificationDataFerrousCasting = By.xpath(
			"//select[@id='f_SubGroup']/following-sibling::span/descendant::span[@id='select2-f_SubGroup-container']");

	public static final By EnterLengethValueStandardShapes = By.xpath("//input[@id='FPB_Length_SS']");
	public static final By EnterWidthValuesStandardShapes = By.xpath("//input[@id='FPB_Width_SS']");

	public static final By ClickingRadioButtonDirectEntryRejectionWastage = By.id("optionsRadioDirect_SS");
	public static final By EnterValuePartFinishWaitKgperPcStandardShapes = By.xpath("//input[@id='partFinishWt_SS']");
	public static final By EnterScrapRealizationValueStandardShapes = By.xpath("//input[@id='scrapRealization2_SS']");

	public static final By ClickingOhpButtonStandardShapes = By.xpath(
			"//select[@id='forgingOhpStandarad']/following-sibling::span/descendant::span[@id='select2-forgingOhpStandarad-container']");
	public static final By EnterOhpValueStandardShapes = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");

	public static final By ohplistStandardShapes = By.xpath("//ul[@id='select2-forgingOhpStandarad-results']/li");
	public static final By EnterRejectionStandardShapes = By.id("RejectionText2S");
	public static final By EnterPackingValuestandardShapes = By.xpath("//input[@id='PackingText2S']");
	public static final By EnterInsuranceValueStandarShapes = By.xpath("//input[@id='InsuranceText2S']");
	public static final By EnterProfitValueStandarShapes = By.xpath("//input[@id='ProfitText2S']");
	public static final By EnterOverheadValueStandardShapes = By.xpath("//input[@id='OverheadText2S']");
	public static final By EnterIncoTermsValueStandarShapes = By.xpath("//input[@id='IncoTermS']");
	public static final By EnterIccValueStandardShapes = By.xpath("//input[@id='ICCText2S']");
	public static final By EnterFreightValueStandardShapes = By.xpath("//input[@id='FrightText2S']");
	public static final By EnterOtherFactor1StandardShapes = By.xpath("//input[@id='OtherFactor1C']");
	public static final By EnterOtherFactor2StandardShapes = By.xpath("//input[@id='OtherFactor2C']");
	public static final By EnterOtherFactor3StandardShapes = By.xpath("//input[@id='OtherFactor3C']");
	public static final By EnterRemarksValueStandardShapes = By.xpath("//input[@id='Remarks_S']");
	public static final By EnterToolcastValueStandardShapes = By.xpath("//input[@id='ToolCost_SS']");
	public static final By EnterAmortizationQtyStandardShapes = By.xpath("//input[@id='Quantity_SS']");
	public static final By ClickingSaveButtonstandardShapes = By.xpath("//button[@id='StandardShapeSave']");

	public static final By DirectEntryRadioButtonMarginStandardShapes = By.id("marginDirect");
	public static final By DirectEntryRadioButtonNumberOfPieciesStandardShapes = By.id("nopDirect");
	public static final By DirectEntryRadioButtonRejectionWastageStandardShapes = By.id("optionsRadioDirect_SS");

	public static final By EnterRejectionBlankWtStandarShapes = By.id("RejectionBlankWt_SS");
	public static final By EnterBlankGrossWtKgDirectStandardShapes = By.id("BlankGrossWt2_SS");
	public static final By FinishWtkgperpcStandardShapes = By.id("partFinishWt_SS");

	public static final By secondaryProcessHeader = By.xpath("//h3[contains(text(),'Secondary Process Cost')]");
	public static final By addProcessButton = By.id("forgingAddProcessStandard");
	public static final By OhpDropdown = By.xpath("//select[@id='forgingOhpStandarad']");

	public static final By fetchingohpvlaueforvalidation = By.xpath("//*[@id='select2-forgingOhpStandarad-container']");

	public void verifySecondaryProcessHeaderAndClickProcess() {
		try {

			WebElement element = waitForExpectedElement(By.id("NiPlatingAddProcessStandard"));

			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", element);

			LoggerUtil.info(" Scrolled to element with ID: NiPlatingAddProcessStandard");
			Thread.sleep(800);

			// Step 1: Verify Header
			WebElement header = waitForExpectedElement(secondaryProcessHeader);
			String headerText = header.getText().trim();
			LoggerUtil.info("Header found on screen: " + headerText);

			if (!headerText.equals("Secondary Process Cost")) {
				LoggerUtil.error(" Header text mismatch. Expected 'Secondary Process Cost' but found: " + headerText);
				return;
			}

			LoggerUtil.info(" Header text matched: 'Secondary Process Cost'.");

			// Step 2: Locate +Process Button
			WebElement button = waitForExpectedElement(addProcessButton);
			LoggerUtil.info("Found '+Process' button element in DOM.");

			// Step 3: Validate Button State
			boolean isDisplayed = button.isDisplayed();
			boolean isEnabled = button.isEnabled();

			if (!isDisplayed) {
				LoggerUtil.error(" '+Process' button is not displayed on the UI.");
				return;
			}
			if (!isEnabled) {
				LoggerUtil.error(" '+Process' button is disabled (not clickable).");
				return;
			}

			// Step 4: Verify Clickability (Selenium condition)
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
			try {
				wait.until(ExpectedConditions.elementToBeClickable(button));
				LoggerUtil.info(" '+Process' button is clickable.");
			} catch (Exception ex) {
				LoggerUtil.error(" '+Process' button not clickable yet — possible overlay or loader.");
			}

			// Step 5: Try Normal Click
			try {
				button.click();
				LoggerUtil.info("Clicked on '+Process' button using normal Selenium click.");
			} catch (Exception e1) {
				LoggerUtil.error(" Normal click failed. Trying JavaScript click...");

				// Step 6: Fallback JS Click
				JavascriptExecutor js1 = (JavascriptExecutor) driver;
				js1.executeScript("arguments[0].click();", button);
				LoggerUtil.info("Clicked on '+Process' button using JavaScript Executor.");
			}

			// Step 7: Verify Post-click Result (Popup or Table appears)
			Thread.sleep(1500);
			List<WebElement> processPopup = driver
					.findElements(By.xpath("//div[contains(@class,'modal')]//h4[contains(text(),'Process')]"));
			if (!processPopup.isEmpty()) {
				LoggerUtil.info(" Process selection popup opened successfully after clicking '+Process'.");
			} else {
				LoggerUtil.warn(
						" No popup detected after clicking '+Process'. Verify if function 'forgingAddProcessStandard' is bound properly.");
			}

		}

		catch (Exception e) {
			LoggerUtil
					.error("❌ Exception while verifying 'Secondary Process Cost' header or clicking '+Process' button: "
							+ e.getMessage());
		}

	}

	public static final By ClicingSaveButtonPriceCalculation = By.xpath("//button[@id='StandardShapeSave']");
	public static final By ClickingOhpDropdown = By.xpath(
			"//select[@id='forgingOhpStandarad']/following-sibling::span/descendant::span[@id='select2-forgingOhpStandarad-container']");
	public static final By clickingOHPScrapRecoveryCheckbox = By.xpath("//input[@id='ScrapRecovery']");
	public static final By EnteringRejectionPrice = By.xpath("//input[@id='RejectionText2S']");
	public static final By EnteringPackingValue = By.xpath("//input[@id='PackingText2S']");
	public static final By EnteringInsurancevalue = By.xpath("//input[@id='InsuranceText2S']");
	public static final By EnteringProfitValueInOhpFordetailsCosting = By.xpath("//input[@id='ProfitText2S']");
	public static final By EnteringRemarksInAnyBoxOhpDetailsCosting = By.xpath("//input[@id='Remarks_S']");
	public static final By EnteringAmortizationValueDetailsCosting = By.xpath("//input[@id='Quantity_SS']");
	public static final By EnteringToolmaintinanceCostDetailCosting = By
			.xpath("//input[@id='ToolmaintenanceonAmmortisation_SS']");

	public HashMap<String, String> selectOHPDropdownByIndex(int index, Map<Integer, String[]> factors)
			throws InterruptedException {

		HashMap<String, String> storeOHPData = new HashMap<>();

		try {
			// 🔵 STEP 1: Scroll to OHP Section
			LoggerUtil.info("STEP 1: Scrolling to OHP Section...");
			WebElement element = waitForExpectedElement(By.id("forgingOhpStandarad"));
			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", element);
			LoggerUtil.pass("Scrolled to OHP section (ID: forgingOhpStandarad)");
			Thread.sleep(800);

			// 🔵 STEP 2: Enable OHP Scrap Recovery
			LoggerUtil.info("STEP 2: Clicking Scrap Recovery checkbox");
			clickOnElement(clickingOHPScrapRecoveryCheckbox);
			storeOHPData.put("OHP Scrap Recovery Checkbox", "Clicked");
			LoggerUtil.pass("Scrap Recovery checkbox clicked");

			// 🔵 STEP 3: Enter OHP Base Fields
			LoggerUtil.info("STEP 3: Entering OHP Price input fields...");

			clearAndEnterText(waitForExpectedElement(EnteringRejectionPrice), "20");
			storeOHPData.put("Rejection Price", "20");
			LoggerUtil.pass("Entered Rejection Price = 20");

			clearAndEnterText(waitForExpectedElement(EnteringPackingValue), "3");
			storeOHPData.put("Packing Value", "3");
			LoggerUtil.pass("Entered Packing Value = 3");

			clearAndEnterText(waitForExpectedElement(EnteringInsurancevalue), "4");
			storeOHPData.put("Insurance Value", "4");
			LoggerUtil.pass("Entered Insurance Value = 4");

			clearAndEnterText(waitForExpectedElement(EnteringProfitValueInOhpFordetailsCosting), "13");
			storeOHPData.put("Profit Value", "13");
			LoggerUtil.pass("Entered Profit Value = 13");

			// 🔵 STEP 4: Open OHP Dropdown
			LoggerUtil.info("STEP 4: Opening OHP dropdown...");
			clickOnElement(ClickingOhpDropdown);
			Thread.sleep(1000);

			// 🔵 STEP 5: Detect Dropdown Type
			String ohpValue = DataProp.getProperty("OhpName").trim();
			LoggerUtil.info("STEP 5: Selecting OHP from dropdown. Expected: [" + ohpValue + "]");

			WebElement dropdownElement = waitForExpectedElement(OhpDropdown);
			String tagName = dropdownElement.getTagName().toLowerCase();
			LoggerUtil.info("Detected dropdown tag → " + tagName);

			String selectedOHPText = "";

			// 🔵 STEP 6: Select OHP Value
			LoggerUtil.info("STEP 6: Searching and selecting OHP option...");

			if (tagName.equals("select")) {

				LoggerUtil.info("Dropdown type: <select>");
				Select ohpDropdown = new Select(dropdownElement);
				List<WebElement> options = ohpDropdown.getOptions();

				boolean found = false;
				for (WebElement option : options) {
					String optionText = option.getText().trim();

					if (optionText.equalsIgnoreCase(ohpValue)) {
						ohpDropdown.selectByVisibleText(optionText);
						selectedOHPText = optionText;
						LoggerUtil.pass("Selected OHP value = " + selectedOHPText);
						found = true;
						break;
					}
				}

				if (!found) {
					LoggerUtil.error("OHP Value NOT FOUND in <select>: " + ohpValue);
				}

			} else {
				LoggerUtil.info("Dropdown type: Custom (Select2 / UL-LI)");

				List<WebElement> options = driver
						.findElements(By.xpath("//li[contains(@class,'select2-results__option') or self::li]"));

				boolean found = false;

				for (WebElement option : options) {
					String optionText = option.getText().trim();

					if (optionText.equalsIgnoreCase(ohpValue)) {
						((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", option);
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", option);
						selectedOHPText = optionText;
						LoggerUtil.pass("Selected OHP value = " + selectedOHPText + " (custom dropdown)");
						found = true;
						break;
					}
				}

				if (!found) {
					LoggerUtil.error("OHP Value NOT FOUND in custom dropdown: " + ohpValue);
				}
			}

			storeOHPData.put("Selected OHP", selectedOHPText);

			Thread.sleep(1500);

			// 🔵 STEP 7: Scroll to "Other Factor" section
			LoggerUtil.info("STEP 7: Scrolling to Other Factor section...");
			WebElement element1 = waitForExpectedElement(By.id("OtherFactor1C"));
			JavascriptExecutor js1 = (JavascriptExecutor) driver;
			js1.executeScript("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", element1);
			LoggerUtil.pass("Scrolled to Other Factor section.");
			Thread.sleep(800);

			// 🔵 STEP 8: Enter Other Factor Values
			LoggerUtil.info("STEP 8: Entering factor values...");

			if (factors != null && !factors.isEmpty()) {

				for (Map.Entry<Integer, String[]> entry : factors.entrySet()) {
					int factorNumber = entry.getKey();
					String factorName = entry.getValue()[0];
					String factorValue = entry.getValue()[1];

					enterOtherFactorValue(factorNumber, factorValue);

					storeOHPData.put("OtherFactor" + factorNumber + "_Name", factorName);
					storeOHPData.put("OtherFactor" + factorNumber + "_Value", factorValue);

					LoggerUtil.pass("Entered Factor [" + factorName + "] = " + factorValue);
				}

			} else {
				LoggerUtil.warn("No custom factors passed → entering default factor values");

				enterOtherFactorValue(1, "2.5");
				enterOtherFactorValue(2, "1.2");
				enterOtherFactorValue(3, "0.8");

				storeOHPData.put("OtherFactor1_Value", "2.5");
				storeOHPData.put("OtherFactor2_Value", "1.2");
				storeOHPData.put("OtherFactor3_Value", "0.8");

				LoggerUtil.pass("Default Other Factors entered successfully.");
			}

			// 🔵 STEP 9: Enter Remarks, Amortization & Tool Maintenance
			LoggerUtil.info("STEP 9: Entering Remarks and OHP Additional values...");

			clearAndEnterText(waitForExpectedElement(EnteringRemarksInAnyBoxOhpDetailsCosting), "435jnbsvvs");
			storeOHPData.put("Remarks", "435jnbsvvs");
			LoggerUtil.pass("Entered Remarks");

			clearAndEnterText(waitForExpectedElement(EnteringAmortizationValueDetailsCosting), "11");
			storeOHPData.put("Amortization Value", "11");
			LoggerUtil.pass("Entered Amortization Value = 11");

			clearAndEnterText(waitForExpectedElement(EnteringToolmaintinanceCostDetailCosting), "101");
			storeOHPData.put("Tool Maintenance Cost", "101");
			LoggerUtil.pass("Entered Tool Maintenance Cost = 101");

			// 🔵 STEP 10: Save OHP Data
			LoggerUtil.info("STEP 10: Clicking Save button...");
			clickOnElement(ClicingSaveButtonPriceCalculation);
			Thread.sleep(350);

			// 🔵 STEP 11: Verify Toast
			LoggerUtil.info("STEP 11: Validating toast message...");
			String ToastmsgPriceCalculation = waitForExpectedElement(toastMessage).getText().trim();

			storeOHPData.put("Toast Message", ToastmsgPriceCalculation);
			LoggerUtil.info("Toast displayed: " + ToastmsgPriceCalculation);

			if (ToastmsgPriceCalculation.equalsIgnoreCase("Standard Shape Costing saved successfully.")) {
				LoggerUtil.pass("Toast validated successfully!");
			} else {
				LoggerUtil.error("Unexpected toast message: " + ToastmsgPriceCalculation);
			}

			LoggerUtil.pass("OHP flow completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in selectOHPDropdownByIndex: " + e.getMessage());
		}

		return storeOHPData;
	}

	/**
	 * Enter value in the “Enter” box beside Other Factor 1–3
	 * 
	 * @param factorNumber 1, 2, or 3
	 * @param value        value to type (e.g., "2.5")
	 */
	public void enterOtherFactorValue(int factorNumber, String value) {
		try {
			// Build dynamic locator based on factor number
			By valueLocator = By.id("OtherFactor" + factorNumber + "C");

			WebElement valueField = waitForExpectedElement(valueLocator);

			// Clear and type the value
			clearAndEnterText(valueField, value);
			LoggerUtil.info("✅ Entered value '" + value + "' in Other Factor " + factorNumber);

			// Trigger on-input or recalculation
			valueField.sendKeys(Keys.TAB);
			Thread.sleep(500);

		} catch (Exception e) {
			LoggerUtil.error("❌ Unable to enter value for Other Factor " + factorNumber + ": " + e.getMessage());
		}
	}

	public void VerifyThreeBarFunctionality(String RminputCategoryValue, String partNumber)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Verify Three-Bar Functionality");
		LoggerUtil.info("==============================================");

		// ---------------------------------------------------------
		// STEP 1 → Navigate to Part Price Calculations tab
		// ---------------------------------------------------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
				break;
			}
		}

		// ---------------------------------------------------------
		// STEP 2 → Validate & Select RM Input Category
		// ---------------------------------------------------------
		Select dropdownRminput = new Select(waitForExpectedElement(RmInputCategoryDropdownn));

		boolean isOptionPresent = dropdownRminput.getOptions().stream()
				.anyMatch(opt -> opt.getText().trim().equalsIgnoreCase(RminputCategoryValue));

		if (isOptionPresent) {
			dropdownRminput.selectByVisibleText(RminputCategoryValue);
			LoggerUtil.pass("RM Input Category selected → " + RminputCategoryValue);
		} else {
			LoggerUtil.fail("RM Input Category NOT found → " + RminputCategoryValue);
			return;
		}

		Thread.sleep(3000);

		// ---------------------------------------------------------
		// STEP 3 → Open Three-Bar Menu
		// ---------------------------------------------------------
		clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
		LoggerUtil.pass("Clicked on Three-Bar menu");
		Thread.sleep(2000);

		List<WebElement> threeBarOptions = driver.findElements(SelectingOptionsThreeBars);

		if (threeBarOptions == null || threeBarOptions.isEmpty()) {
			LoggerUtil.fail("Three-bar options list is NULL or EMPTY");
			return;
		}

		LoggerUtil.info("Three-bar options loaded. Total options: " + threeBarOptions.size());

		// ---------------------------------------------------------
		// STEP 4 → Export Whole Report
		// ---------------------------------------------------------
		boolean exportClicked = false;

		for (WebElement option : threeBarOptions) {
			if (option.getText().trim().equalsIgnoreCase("Export Whole Report")) {
				option.click();
				LoggerUtil.pass("Clicked on 'Export Whole Report'");
				exportClicked = true;
				break;
			}
		}

		if (!exportClicked) {
			LoggerUtil.fail("'Export Whole Report' option NOT found in Three-Bar menu");
			return;
		}

		Thread.sleep(5000);

		getLatestCustomExcelFileForging();
		LoggerUtil.pass("Export Whole Report file downloaded successfully");

		// ---------------------------------------------------------
		// STEP 5 → Consolidated Assembly Export
		// ---------------------------------------------------------
		clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
		LoggerUtil.pass("Re-opened Three-Bar menu");
		Thread.sleep(2000);

		// Re-fetch list to avoid stale element issues
		threeBarOptions = driver.findElements(SelectingOptionsThreeBars);

		boolean consolidatedClicked = false;

		for (WebElement option : threeBarOptions) {
			if (option.getText().trim().equalsIgnoreCase("Consolidated Assembly")) {
				option.click();
				LoggerUtil.pass("Clicked on 'Consolidated Assembly'");
				consolidatedClicked = true;
				break;
			}
		}

		if (!consolidatedClicked) {
			LoggerUtil.fail("'Consolidated Assembly' option NOT found in Three-Bar menu");
			return;
		}

		Thread.sleep(1000);

		// ---------------------------------------------------------
		// STEP 6 → Toast Message Validation
		// ---------------------------------------------------------
		String actualMsg = waitForExpectedElement(FetchingToastmsgForDetailCosting).getText().trim();

		String expectedMsg = "Consolidated Assembly Exported SucessFully.";

		if (actualMsg.equals(expectedMsg)) {
			LoggerUtil.pass("Toast message validated successfully → " + actualMsg);
		} else {
			LoggerUtil.fail("Toast message mismatch → Expected: " + expectedMsg + " | Actual: " + actualMsg);
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Verify Three-Bar Functionality");
		LoggerUtil.info("==============================================");
	}

	public static final By ClickingSaveButtonBopTabCosting = By
			.xpath("//div[@id='bopbuttonsave']/button[normalize-space(.)='Save']");

	// Holds the latest captured header->value pairs from the BOP table (first row)
	private static Map<String, String> capturedBopData = new LinkedHashMap<>();
	private static String capturedBopSummaryData = "";

	public void forceMoveToBOP() {

		JavascriptExecutor js = (JavascriptExecutor) driver;

		try {
			LoggerUtil.info("switching to BOP tab");

			// =====================================================
			// STEP 1: Normal click attempt
			// =====================================================
			try {
				waitForExpectedElement(By.id("TabBopCosting")).click();
			} catch (Exception e) {
				js.executeScript("arguments[0].click();", waitForExpectedElement(By.id("TabBopCosting")));
			}

			Thread.sleep(500);

			// =====================================================
			// STEP 2: Bootstrap force (preferred)
			// =====================================================
			js.executeScript("if (window.jQuery) { $('#TabBopCosting').tab('show'); }");

			Thread.sleep(300);

			// =====================================================
			// STEP 3: HARD FORCE (DOM-level activation)
			// =====================================================
			js.executeScript("try {" + "  $('.nav.nav-pills a').removeClass('active show');"
					+ "  $('.tab-content .tab-pane').removeClass('active show in');"
					+ "  $('#TabBopCosting').addClass('active show');"
					+ "  $('#bopTabCosting').addClass('active show in');" + "} catch(e) {}");

			LoggerUtil.pass("switch to BOP tab executed");

		} catch (Exception e) {
			LoggerUtil.error("❌ Failed to force switch to BOP tab: " + e.getMessage());
			throw new RuntimeException(e);
		}
	}

	private void waitForBopCalculationToComplete() {

		WebDriverWait calcWait = new WebDriverWait(driver, Duration.ofSeconds(20));

		calcWait.until(driver -> {
			try {
				String val = getValueFromBopTableCell("Part Cost/Unit").replace(",", "").trim();
				return !val.isEmpty() && !val.equals("0") && !val.equals("0.000");
			} catch (Exception e) {
				return false;
			}
		});

		LoggerUtil.pass("✔ BOP calculation completed (Part Cost/Unit non-zero).");
	}

	public HashMap<String, String> clickAddBopAndVerifyTable() throws InterruptedException {

		HashMap<String, String> bopMap = new HashMap<>();

		try {
			// -----------------------------------------
			// STEP 1 → FORCE MOVE TO BOP TAB
			// -----------------------------------------
			By bopHeadingLocator = By.xpath("//h3[contains(text(),'Standard Bought out or Imported')]");
			forceMoveToBOP();

			// -----------------------------------------
			// STEP 2 → Verify Header
			// -----------------------------------------
			WebElement header = Base.waitForExpectedElement(bopHeadingLocator);

			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ 'Standard Bought Out or Imported' header NOT visible.");
				return bopMap;
			}
			LoggerUtil.pass("✔ Header located successfully.");

			// -----------------------------------------
			// STEP 3 → Click +BOP button (UNCHANGED)
			// -----------------------------------------
			By addBopBtn = By.id("btnAddToolingCost");

			try {
				WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));

				WebElement bopButton = wait.until(ExpectedConditions.presenceOfElementLocated(addBopBtn));

				((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});",
						bopButton);

				Thread.sleep(800);

				try {
					new Actions(driver).moveToElement(bopButton).pause(Duration.ofMillis(300)).click().perform();
				} catch (Exception ex) {
					LoggerUtil.warn("Action click failed, invoking JS function directly");
				}

				((JavascriptExecutor) driver).executeScript("addBopStandard();");

				LoggerUtil.pass("'+ BOP' action executed.");

			} catch (Exception e) {
				LoggerUtil.error("❌ Unable to execute '+ BOP' action.");
				return bopMap;
			}

			Thread.sleep(5000);

			// -----------------------------------------
			// STEP 4 → Verify BOP table visibility
			// -----------------------------------------
			WebElement table = Base.waitForExpectedElement(By.xpath("//table[@id='standaradTable']"));

			if (!table.isDisplayed()) {
				LoggerUtil.error("❌ BOP Standard Table not visible.");
				return bopMap;
			}
			LoggerUtil.pass("✔ BOP Table displayed.");

			// -----------------------------------------
			// STEP 5 → Fetch rows
			// -----------------------------------------
			List<WebElement> rows = driver.findElements(By.xpath("//tbody[@id='bopStandardBody']/tr"));

			if (rows.isEmpty()) {
				LoggerUtil.error("❌ No rows found inside BOP table.");
				return bopMap;
			}

			Thread.sleep(5000);

			// -----------------------------------------
			// -----------------------------------------
			// STEP 6 → Select Part No. (SAME CODE + THREAD FIX)
			// -----------------------------------------
			WebElement partNoSelect2 = Base
					.waitForExpectedElement(By.xpath("//select[@id='item_partnostandard_1']/following-sibling::span"));

			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});",
					partNoSelect2);

			Thread.sleep(600); // 🔧 UI settle

			WebElement clickableArea = partNoSelect2
					.findElement(By.xpath(".//span[contains(@class,'select2-selection--single')]"));

			Thread.sleep(800); // 🔧 before click
			new Actions(driver).moveToElement(clickableArea).click().perform();

			Thread.sleep(1000);

			List<WebElement> options = driver
					.findElements(By.xpath("//ul[@id='select2-item_partnostandard_1-results']/li"));

			Thread.sleep(1000);

			for (WebElement option : options) {
				String txt = option.getText().trim();

				if (txt.equals("M5 pressure rivet nut-28102024")) {

					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'nearest'});",
							option);

					Thread.sleep(300); // 🔧 scroll settle

					option.click();
					Thread.sleep(800);

					bopMap.put("PartNo", txt);
					LoggerUtil.pass("Selected Part No: " + txt);
					break;
				}
			}

			// 🔧 IMPORTANT: dropdown auto-close guard
			Thread.sleep(500);
			new Actions(driver).sendKeys(Keys.TAB).perform();
			Thread.sleep(500);

			// -----------------------------------------
			// STEP 7 → Enter Qty/Pc
			// -----------------------------------------
			String qtyValue = "2";
			enterValueInBopTableCell("Qty/Pc", qtyValue);
			bopMap.put("QtyPerPc", qtyValue);
			LoggerUtil.pass("Qty/Pc entered → " + qtyValue);

			Thread.sleep(1500);

			waitForBopCalculationToComplete();

			// -----------------------------------------
			// STEP 8 → Fetch Part Cost/Unit
			// -----------------------------------------
			String partCost = getValueFromBopTableCell("Part Cost/Unit");
			bopMap.put("PartCostPerUnit", partCost);
			LoggerUtil.pass("Auto fetched Part Cost/Unit → " + partCost);

			// -----------------------------------------
			// STEP 10 → Fetch Total Cost (UI)
			// -----------------------------------------
			String uiTotal = getValueFromBopTableCell("Total Cost");
			bopMap.put("TotalCost_UI", uiTotal);
			LoggerUtil.pass("Fetched Total Cost (UI) → " + uiTotal);

			// -----------------------------------------
			// STEP 11 → Extra Total Cost Cell
			// -----------------------------------------
			String extraTotal = waitForExpectedElement(TotalCostExtraCell).getAttribute("value").trim();
			bopMap.put("TotalCost_ExtraCell", extraTotal);
			LoggerUtil.pass("Fetched Total Cost (Extra Cell) → " + extraTotal);

			// -----------------------------------------
			// STEP 12 → Capture Header Values
			// -----------------------------------------
			capturedBopData = collectBopHeaderAndValuesMap();
			capturedBopSummaryData = toSummaryStringFromMap(capturedBopData);

			LoggerUtil.info("Captured BOP Header Values: " + capturedBopSummaryData);

			for (String col : capturedBopData.keySet()) {
				bopMap.put("Header_" + col, capturedBopData.get(col));
			}

			// -----------------------------------------
			// STEP 12.9 → EXIT EDIT MODE (UNCHANGED)
			// -----------------------------------------
			Actions actions = new Actions(driver);
			actions.sendKeys(Keys.TAB).perform();
			Thread.sleep(200);
			actions.sendKeys(Keys.ESCAPE).perform();
			Thread.sleep(200);

			((JavascriptExecutor) driver).executeScript("document.querySelector('h3').click();");

			Thread.sleep(500);

			// -----------------------------------------
			// STEP 12.95 → WAIT UNTIL SAVE ENABLED
			// -----------------------------------------
			WebDriverWait saveEnableWait = new WebDriverWait(driver, Duration.ofSeconds(30));
			saveEnableWait.until(d -> {
				WebElement saveBtn = d.findElement(By.id("bopSave"));
				String disabled = saveBtn.getAttribute("disabled");
				String classes = saveBtn.getAttribute("class");
				return (disabled == null || disabled.equals("false")) && !classes.contains("disabled");
			});

			LoggerUtil.pass("✔ Save button is enabled.");

			// -----------------------------------------
			// STEP 13 → SAVE BOP
			// -----------------------------------------
			WebElement saveBtn = Base.waitForExpectedElement(By.id("bopSave"));
			saveBtn.click();
			LoggerUtil.pass("✔ Save button clicked.");

			WebDriverWait toastWait = new WebDriverWait(driver, Duration.ofSeconds(5));
			WebElement toastEle = toastWait.until(ExpectedConditions.visibilityOfElementLocated(toastMessage));

			String toast = toastEle.getText().trim();
			bopMap.put("ToastMessage", toast);
			LoggerUtil.pass("Toast received → " + toast);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in clickAddBopAndVerifyTable → " + e.getMessage());
		}

		return bopMap;
	}

	public static final By FetchingBopHeaderInHouse = By
			.xpath("//div[@id='bopTabCosting']/descendant::h3[contains(text(),'In House')]");
	public static final By ClickingBopAddButtonForInhouse = By.xpath(
			"//div[@id='bopTabCosting']/descendant::button[@id='btnAddToolingCost' and @onclick='addBopInhouse()']");
	public static final By TableHeadersNamesBopInhouseTable = By.xpath("//table[@id='inhouseTable']/thead//th");
	public static final By SelectPartNumberDropdown = By.xpath("//select[@id='item_partnoinhouse_1']");
	public static final By EnterQuantityPerPcInCellBox = By.xpath(
			" //table[@id='inhouseTable']/tbody//input[contains(@class,'bopInhouseTb textaligmnentcs_r form-control qty')]");

	By partNoSelect = By.id("item_partnoinhouse_1");

	public HashMap<String, String> VerifyEnterValueInBopForInHouse(String EnterPartNumberDropdownValue,
			String EnterValueQuantityPerPc) {

		HashMap<String, String> bopMap = new HashMap<>();

		try {

			// ================================================================
			// STEP 1 → Verify Header
			// ================================================================
			String headerText = waitForExpectedElement(FetchingBopHeaderInHouse).getText().trim();

			if (!headerText.contains("In House")) {
				LoggerUtil.error("❌ In House BOP section NOT found.");
				return bopMap;
			}
			LoggerUtil.pass("✔ In House BOP section found.");

			// ================================================================
			// STEP 2 → Click +Add
			// ================================================================
			clickOnElement(ClickingBopAddButtonForInhouse);
			LoggerUtil.pass("✔ Clicked +Add");

			Thread.sleep(800);

			// ================================================================
			// STEP 3 → Capture Header Index
			// ================================================================
			List<WebElement> headernames = driver.findElements(TableHeadersNamesBopInhouseTable);
			Map<String, Integer> headerIndex = new LinkedHashMap<>();

			for (int i = 0; i < headernames.size(); i++) {
				headerIndex.put(headernames.get(i).getText().trim(), i);
			}

			LoggerUtil.info("Header Map: " + headerIndex);

			// ================================================================
			// STEP 4 → Get first row
			// ================================================================
			List<WebElement> rows = driver.findElements(By.xpath("//tbody[@id='bopInhouseBody']/tr"));
			if (rows.isEmpty()) {
				LoggerUtil.error("❌ No rows found in In-House BOP.");
				return bopMap;
			}

			WebElement row = rows.get(0);
			List<WebElement> cells = row.findElements(By.xpath("./th | ./td"));

			// ================================================================
			// STEP 5 → Select PART NO
			// ================================================================
			if (headerIndex.containsKey("Part No.")) {

				int idx = headerIndex.get("Part No.");
				WebElement partCell = cells.get(idx);

				try {
					WebElement select2Box = partCell.findElement(By.cssSelector(".select2-selection"));

					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});",
							select2Box);

					selectDropDownValue(partNoSelect, EnterPartNumberDropdownValue, "visibleText");

					LoggerUtil.pass("✔ Selected In-House Part No → " + EnterPartNumberDropdownValue);

					bopMap.put("Part No", EnterPartNumberDropdownValue);

				} catch (Exception e) {
					LoggerUtil.error("❌ Part No selection failed → " + e.getMessage());
				}
			}

			// ================================================================
			// STEP 6 → Wait for Qty auto-reset = 1
			// ================================================================
			int qtyIdx = headerIndex.get("Qty/Pc");
			WebElement qtyCell = cells.get(qtyIdx);
			WebElement qtyInput = qtyCell.findElement(By.tagName("input"));

			wait.until(ExpectedConditions.textToBePresentInElementValue(qtyInput, "1"));
			LoggerUtil.info("✔ Qty auto reset → 1");

			Thread.sleep(300);

			// ================================================================
			// STEP 7 → Enter QTY/Pc
			// ================================================================
			try {
				Actions act = new Actions(driver);
				act.moveToElement(qtyInput).click().pause(Duration.ofMillis(200)).keyDown(Keys.CONTROL).sendKeys("a")
						.keyUp(Keys.CONTROL).sendKeys(Keys.BACK_SPACE).pause(Duration.ofMillis(200))
						.sendKeys(EnterValueQuantityPerPc).perform();

				Thread.sleep(600);

			} catch (Exception e) {
				LoggerUtil.error("❌ Qty/Pc ENTRY failed → " + e.getMessage());
			}

			// ================================================================
			// STEP 8 → Trigger JS events
			// ================================================================
			try {
				((JavascriptExecutor) driver)
						.executeScript("arguments[0].dispatchEvent(new Event('input',{bubbles:true}));"
								+ "arguments[0].dispatchEvent(new Event('change',{bubbles:true}));"
								+ "arguments[0].dispatchEvent(new Event('keyup',{bubbles:true}));"
								+ "arguments[0].dispatchEvent(new Event('blur',{bubbles:true}));", qtyInput);

				Thread.sleep(600);

			} catch (Exception e) {
				LoggerUtil.error("❌ JS Event Dispatch failed → " + e.getMessage());
			}

			// ================================================================
			// STEP 9 → Trigger Internal Calculation
			// ================================================================
			try {
				((JavascriptExecutor) driver)
						.executeScript("if(typeof calculateInhouseBopRow === 'function'){ calculateInhouseBopRow(); }");

				Thread.sleep(500);

			} catch (Exception e) {
				LoggerUtil.error("❌ Internal JS calculation failed → " + e.getMessage());
			}

			// ================================================================
			// STEP 10 → Read Final Qty
			// ================================================================
			String finalQty = qtyInput.getAttribute("value").trim();
			LoggerUtil.pass("✔ Final Qty/Pc = " + finalQty);
			bopMap.put("Qty/Pc", finalQty);

			// ================================================================
			// STEP 11 → Auto-calculated columns
			// ================================================================
			String[] autoColumns = { "Bop Type", "Part Description", "UOM", "RM Grade", "RM Rate/kg", "Gross Wt",
					"Finish Wt", "RM Cost", "Process Cost", "Others", "Part Cost/Unit", "Sub Total", "BOP Handling%",
					"Total Cost" };

			for (String col : autoColumns) {

				if (!headerIndex.containsKey(col))
					continue;

				try {
					int idx = headerIndex.get(col);
					WebElement cell = cells.get(idx);

					String value;
					List<WebElement> inputs = cell.findElements(By.tagName("input"));

					if (!inputs.isEmpty()) {
						value = inputs.get(0).getAttribute("value").trim();
					} else {
						value = cell.getText().trim();
					}

					bopMap.put(col, value);
					LoggerUtil.pass(col + " = " + value);

				} catch (Exception e) {
					LoggerUtil.error("❌ Error reading column (" + col + ") → " + e.getMessage());
				}
			}

			// ================================================================
			// STEP 12 → Total Cost Check (LOG ONLY)
			// ================================================================
			try {
				double qty = Double.parseDouble(bopMap.get("Qty/Pc"));
				double partCost = Double.parseDouble(bopMap.get("Part Cost/Unit"));
				double expectedTotal = qty * partCost;

				double uiTotal = Double.parseDouble(bopMap.get("Total Cost"));

				if (Math.abs(uiTotal - expectedTotal) < 0.0001) {
					LoggerUtil.pass("✔ Total Cost verified → " + uiTotal);
				} else {
					LoggerUtil.error("❌ Total Cost mismatch → Expected: " + expectedTotal + " | Actual: " + uiTotal);
				}

			} catch (Exception e) {
				LoggerUtil.error("❌ Total Cost validation failed → " + e.getMessage());
			}

			// ================================================================
			// STEP 13 → SAVE ENTRY
			// ================================================================
			clickOnElement(ClickingSaveButtonBopTabCosting);
			LoggerUtil.pass("✔ Save button clicked for In-House BOP.");

			WebDriverWait toastWait = new WebDriverWait(driver, Duration.ofSeconds(5));
			WebElement toastEle = toastWait.until(ExpectedConditions.visibilityOfElementLocated(toastMessage));

			String toastMsg = toastEle.getText().trim();
			bopMap.put("ToastMessage", toastMsg);
			LoggerUtil.pass("Toast received → " + toastMsg);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in VerifyEnterValueInBopForInHouse → " + e.getMessage());
		}

		return bopMap;
	}

	private Map<String, String> getCapturedBopData() {
		if (capturedBopData == null || capturedBopData.isEmpty()) {
			LoggerUtil.warn("No BOP map captured yet. Ensure clickAddBopAndVerifyTable() was executed first.");
		}
		return capturedBopData;
	}

	private String getCapturedBopSummaryData() {
		if (capturedBopSummaryData == null || capturedBopSummaryData.trim().isEmpty()) {
			LoggerUtil.warn("No BOP data captured yet. Ensure clickAddBopAndVerifyTable() was executed first.");
		}
		return capturedBopSummaryData;
	}

	/**
	 * Collects all BOP table headers and their corresponding cell values (first row
	 * only) and returns a combined formatted string for validation or logging.
	 */
	/**
	 * Collects all BOP table headers (thead th) and the first-row cell <input>
	 * values into a LinkedHashMap to preserve the visible order. Also returns the
	 * map for direct use.
	 */
	public Map<String, String> collectBopHeaderAndValuesMap() {
		LinkedHashMap<String, String> map = new LinkedHashMap<>();
		try {
			List<WebElement> headers = driver
					.findElements(By.xpath("//table[@id='standaradTable']//thead//th/following-sibling::th"));
			if (headers == null || headers.isEmpty()) {
				LoggerUtil.error("No headers found in BOP table.");
				return map;
			}

			for (int i = 0; i < headers.size(); i++) {
				String headerName = headers.get(i).getText().trim();
				if (headerName.isEmpty()) {
					// Skip truly blank header cells (if any)
					continue;
				}
				// Reuse your existing cell fetch logic
				String value = getValueFromBopTableCell(headerName);
				map.put(headerName, value);
			}

			LoggerUtil.info("Captured " + map.size() + " header-value pairs from BOP table.");
			return map;

		} catch (Exception e) {
			LoggerUtil.error("Exception in collectBopHeaderAndValuesMap(): " + e.getMessage());
			return map;
		}
	}

	/**
	 * Utility to convert the captured map to your existing summary string format.
	 */
	private String toSummaryStringFromMap(Map<String, String> map) {
		StringBuilder sb = new StringBuilder();
		for (Map.Entry<String, String> e : map.entrySet()) {
			sb.append(e.getKey()).append(" = ").append(e.getValue() == null ? "" : e.getValue().trim()).append(", ");
		}
		String s = sb.toString();
		if (s.endsWith(", "))
			s = s.substring(0, s.length() - 2);
		return s;
	}

	public static final By TotalCostExtraCell = By.xpath("//input[@id='standTotBop']");

	private void enterValueInBopTableCell(String headerName, String value) {
		try {
			// Step 1️⃣: Locate all header cells
			List<WebElement> headers = driver.findElements(By.xpath("//table[@id='standaradTable']//thead//th"));
			int targetColIndex = -1;
			for (int i = 0; i < headers.size(); i++) {
				String headerText = headers.get(i).getText().trim();
				if (headerText.equalsIgnoreCase(headerName.trim())) {
					targetColIndex = i + 1; // XPath is 1-based index
					LoggerUtil.info("✅ Found header '" + headerName + "' at column index: " + targetColIndex);
					break;
				}
			}

			// Step 2️⃣: Validate if column was found
			if (targetColIndex == -1) {
				LoggerUtil.fail("❌ Header '" + headerName + "' not found in BOP table.");
				return;
			}

			// Step 3️⃣: Locate the input box inside the first row under that column
			String cellXpath = "//table[@id='standaradTable']//tbody[@id='bopStandardBody']/tr[1]/*[" + targetColIndex
					+ "]//input";
			WebElement cellInput = Base.waitForExpectedElement(By.xpath(cellXpath));

			// Step 4️⃣: Scroll and enter value (FIXED)
			((JavascriptExecutor) driver)
			        .executeScript("arguments[0].scrollIntoView({block:'center'});", cellInput);
			Thread.sleep(300);

			// 🔥 Force focus + click using JS
			((JavascriptExecutor) driver)
			        .executeScript("arguments[0].focus(); arguments[0].click();", cellInput);

			// 🔥 Clear & set value via JS (no interception)
			((JavascriptExecutor) driver)
			        .executeScript("arguments[0].value='';", cellInput);
			((JavascriptExecutor) driver)
			        .executeScript("arguments[0].value=arguments[1];", cellInput, value);

			// 🔥 Trigger change event (VERY IMPORTANT)
			((JavascriptExecutor) driver)
			        .executeScript("arguments[0].dispatchEvent(new Event('change'));", cellInput);

			LoggerUtil.pass("🟢 Entered value '" + value + "' in column '" + headerName + "' successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while entering value in '" + headerName + "' cell: " + e.getMessage());
		}
	}

	private String getValueFromBopTableCell(String headerName) {
		String value = "";
		try {
			// Step 1️⃣: Locate all header cells
			List<WebElement> headers = driver.findElements(By.xpath("//table[@id='standaradTable']//thead//th"));
			int targetColIndex = -1;

			for (int i = 0; i < headers.size(); i++) {
				String headerText = headers.get(i).getText().trim();
				if (headerText.equalsIgnoreCase(headerName.trim())) {
					targetColIndex = i + 1; // XPath uses 1-based index
					LoggerUtil.info("✅ Found header '" + headerName + "' at column index: " + targetColIndex);
					break;
				}
			}

			// Step 2️⃣: Validate if column was found
			if (targetColIndex == -1) {
				LoggerUtil.fail("❌ Header '" + headerName + "' not found in BOP table.");
				return "";
			}

			// Step 3️⃣: Locate the input box in the first row for the identified column
			String cellXpath = "//table[@id='standaradTable']//tbody[@id='bopStandardBody']/tr[1]/*[" + targetColIndex
					+ "]//input";
			WebElement cellInput = Base.waitForExpectedElement(By.xpath(cellXpath));

			// Step 4️⃣: Fetch value (prefer 'value' attribute, fallback to getText)
			value = cellInput.getAttribute("value");
			if (value == null || value.trim().isEmpty()) {
				value = cellInput.getText().trim();
			}

			LoggerUtil.pass("📋 Retrieved value from column '" + headerName + "' = '" + value + "'.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while fetching value from '" + headerName + "' cell: " + e.getMessage());
		}
		return value;
	}

	public static final By fetchingDataFromCommodityGrp = By.xpath(
			"//select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']");

	public HashMap<String, String> VerifySavedDataValidationFromCustomerSide(String EnterpartDescriptionNumber,
			HashMap<String, String> ExpectedDataMap) throws InterruptedException {

		LoggerUtil.info("==============================================");

		LoggerUtil.info(" VALIDATION STARTED: [Part Attribute Page]");

		LoggerUtil.info("==============================================");

		HashMap<String, String> ActualDataMap = new HashMap<>();
		LoggerUtil.info(" Starting Customer-side validation for Part: " + EnterpartDescriptionNumber);

		try {
			// Step 1️⃣ Search setup
			Thread.sleep(1200);
			clickOnElement(ClickingSearchButtonFromUiPartMaster);
			LoggerUtil.info("Clicked main 'Search' button in Part Master.");

			clearAndEnterText(waitForExpectedElement(EnterSearchValueForPartNumberAndDescriptionAfterImportData),
					EnterpartDescriptionNumber);
			LoggerUtil.info("Entered search text: " + EnterpartDescriptionNumber);

			clickOnElement(ClickingSearchButtonPartMasterVerifingPartDescription);
			LoggerUtil.info("Triggered validation search.");

			// Step 2️ Select 'Sales' radio button
			List<WebElement> radioButtons = driver.findElements(clickingRadioButtonByName);
			boolean salesSelected = false;
			for (WebElement radioLabel : radioButtons) {
				if (radioLabel.getText().trim().equalsIgnoreCase("Sales")) {
					WebElement radioInput = radioLabel.findElement(By.xpath("./preceding-sibling::input"));
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", radioInput);
					LoggerUtil.pass(" Selected 'Sales' radio button successfully.");
					salesSelected = true;
					break;
				}
			}
			if (!salesSelected)
				LoggerUtil.warn(" 'Sales' radio button not found. Continuing.");

			// Step 3️⃣ Load data
			clickOnElement(clickingSearchButtonToValidatePartDescription);
			Thread.sleep(2500);
			LoggerUtil.info("Loaded Customer-side results for part.");

			// Step 4️⃣ Open Customer record
			clickLinkUnderHeader("Customer", "rishicustomer-Tbilisi-0004");
			LoggerUtil.info("Clicked Customer link: rishicustomer-Tbilisi-0004");
			Thread.sleep(1500);

			// Step 5️⃣ Capture actual values
			String actualPartNumber = getValueByLabelName("Part Number");
			String actualPartDescription = getValueByLabelName("Part Description");

			String actualComGrp = waitForExpectedElement(fetchingDataFromCommodityGrp).getText().trim();

			ActualDataMap.put("Part Number", actualPartNumber);
			ActualDataMap.put("Part Description", actualPartDescription);
			ActualDataMap.put("Commodity Group", actualComGrp);

			LoggerUtil
					.info(String.format("Fetched UI values → [Part Number: %s] [Description: %s] [Commodity Group: %s]",
							actualPartNumber, actualPartDescription, actualComGrp));

			// Step 6️⃣ Validate each field
			validateField("Part Number", ExpectedDataMap.get("Part Number"), actualPartNumber);
			validateField("Part Description", ExpectedDataMap.get("Part Description"), actualPartDescription);
			validateField("Commodity Group", ExpectedDataMap.get("Commodity Group"), actualComGrp);

			// Step 7️⃣ Optional – Validate “Other Factor” values if present in HashMap
			try {
				for (int i = 1; i <= 3; i++) {
					String expectedFactorValue = ExpectedDataMap.get("OtherFactor" + i + "_Value");
					if (expectedFactorValue != null) {
						By factorLocator = By.id("OtherFactor" + i + "C");
						String actualFactorValue = waitForExpectedElement(factorLocator).getAttribute("value").trim();
						ActualDataMap.put("OtherFactor" + i + "_Value", actualFactorValue);
						validateField("Other Factor " + i, expectedFactorValue, actualFactorValue);
					}
				}
			} catch (Exception factorEx) {
				LoggerUtil.warn(" Unable to validate Other Factor values (fields not found or not visible).");
			}

			LoggerUtil.pass(" Completed Customer-side validation for part: " + EnterpartDescriptionNumber);

		} catch (Exception e) {
			LoggerUtil.error(
					" Exception during validation for part '" + EnterpartDescriptionNumber + "': " + e.getMessage());
		}

		return ActualDataMap;
	}

	public HashMap<String, String> VerifySavedDataValidationFromSupplierSide(String EnterpartDescriptionNumber,
			HashMap<String, String> ExpectedDataMap) throws InterruptedException {

		LoggerUtil.info("==============================================");

		LoggerUtil.info(" VALIDATION STARTED: [Part Attribute Page]");

		LoggerUtil.info("==============================================");

		HashMap<String, String> ActualDataMap = new HashMap<>();
		LoggerUtil.info(" Starting Customer-side validation for Part: " + EnterpartDescriptionNumber);

		try {

			String actualPartNumber = getValueByLabelName("Part Number");
			String actualPartDescription = getValueByLabelName("Part Description");

			String actualComGrp = waitForExpectedElement(fetchingDataFromCommodityGrp).getText().trim();

			ActualDataMap.put("Part Number", actualPartNumber);
			ActualDataMap.put("Part Description", actualPartDescription);
			ActualDataMap.put("Commodity Group", actualComGrp);

			LoggerUtil
					.info(String.format("Fetched UI values → [Part Number: %s] [Description: %s] [Commodity Group: %s]",
							actualPartNumber, actualPartDescription, actualComGrp));

			// Step 2 Validate each field
			validateField("Part Number", ExpectedDataMap.get("Part Number"), actualPartNumber);
			validateField("Part Description", ExpectedDataMap.get("Part Description"), actualPartDescription);
			validateField("Commodity Group", ExpectedDataMap.get("Commodity Group"), actualComGrp);

			// Step 7️⃣ Optional – Validate “Other Factor” values if present in HashMap
			try {
				for (int i = 1; i <= 3; i++) {
					String expectedFactorValue = ExpectedDataMap.get("OtherFactor" + i + "_Value");
					if (expectedFactorValue != null) {
						By factorLocator = By.id("OtherFactor" + i + "C");
						String actualFactorValue = waitForExpectedElement(factorLocator).getAttribute("value").trim();
						ActualDataMap.put("OtherFactor" + i + "_Value", actualFactorValue);
						validateField("Other Factor " + i, expectedFactorValue, actualFactorValue);
					}
				}
			} catch (Exception factorEx) {
				LoggerUtil.warn(" Unable to validate Other Factor values (fields not found or not visible).");
			}

			LoggerUtil.pass(" Completed Customer-side validation for part: " + EnterpartDescriptionNumber);

		} catch (Exception e) {
			LoggerUtil.error(
					" Exception during validation for part '" + EnterpartDescriptionNumber + "': " + e.getMessage());
		}

		return ActualDataMap;
	}

	/**
	 * Helper function to compare Expected vs Actual field values.
	 */
	private void validateField(String fieldName, String expected, String actual) {
		if (expected == null || expected.isEmpty()) {
			LoggerUtil.warn(" Expected value missing for field: " + fieldName);
			return;
		}
		if (actual == null || actual.isEmpty()) {
			LoggerUtil.error(" Actual value not found for field: " + fieldName);
			return;
		}

		if (expected.trim().equalsIgnoreCase(actual.trim())) {
			LoggerUtil.pass(" [" + fieldName + "] Match → Expected: " + expected + " | Actual: " + actual);
		} else {
			LoggerUtil.error(" [" + fieldName + "] Mismatch → Expected: " + expected + " | Actual: " + actual);
		}
	}

	public static final By FetchingTotatlOtherFactors = By.xpath("//input[@id='TotalPartCostPC_SS']");
	public static final By FetchingPartCostPerPc = By.xpath("//input[@id='PartCostPC_SS']");

	public HashMap<String, String> VerifyFillExcelFilepartMasterDetailsCosting()
			throws IOException, InterruptedException {

		HashMap<String, String> storeDetailCostingInfo = new HashMap<>();

		File latestFile = getLatestFilePartMasterForDetailCostingFile();
		if (latestFile == null) {
			LoggerUtil.error(" No Detail Costing file found.");
			return storeDetailCostingInfo;
		}

		String filePath = latestFile.getAbsolutePath();
		LoggerUtil.info(" Latest Detail Costing file detected: " + filePath);

		// ========== Generate Random Test Data ==========
		String BOML1 = "1";
		String QtyAssy = "1";
		String PartNo = faker.number().digits(2) + "-" + faker.number().digits(2) + "-" + faker.number().digits(2);
		String PartDescription = faker.name().firstName() + PartNo;
		String PartUom = DataProp.getProperty("PartUomPartMaster");
		String CustomerPart = "1";
		String CostingModule = "Standard Shapes";
		String ManufacturingCategory = "Stamping";
		String SubCategory = "Light 1-150T";
		String RmInputCategory = "Sheet";
		String RmType = "Yearly";
		String RMInputShape = "Ferrous Casting";
		String CommodityGroup = "Plastic";
		String Classification = "Plastics-1";
		String SpecificGrade = "PL-1";
		String Year = "2021-2022";
		String Density = "2";
		String SelectedMonthQHY = "Jan";
		String ProcurementType = "Part";
		String PackagingCost = faker.number().digits(2);
		String FreightCost = faker.number().digits(2);
		String ProcessCost = faker.number().digits(2);
		String OhpOthers = faker.number().digits(2);
		String NetWeight = faker.number().digits(2);
		String GrossWeight = NetWeight + faker.number().digits(2);

		int targetRow = 2;

		// ========== Write values into Excel ==========
		ExcelFiller.setCellValue(filePath, 0, targetRow, 0, ValueType.STRING, Arrays.asList(BOML1));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 8, ValueType.STRING, Arrays.asList(QtyAssy));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 9, ValueType.STRING, Arrays.asList(PartNo));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 10, ValueType.STRING, Arrays.asList(PartDescription));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 11, ValueType.STRING, Arrays.asList(CustomerPart));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 12, ValueType.DROPDOWN, Arrays.asList(ProcurementType));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 13, ValueType.DROPDOWN, Arrays.asList(PartUom));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 24, ValueType.DROPDOWN, Arrays.asList(CostingModule));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 27, ValueType.DROPDOWN, Arrays.asList(RmInputCategory));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 29, ValueType.STRING, Arrays.asList("50.0000000"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 30, ValueType.STRING, Arrays.asList("48"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 32, ValueType.DROPDOWN, Arrays.asList(RmType));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 33, ValueType.DROPDOWN, Arrays.asList("Ferrous Metals"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 34, ValueType.DROPDOWN, Arrays.asList("Steel-21"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 35, ValueType.DROPDOWN, Arrays.asList("CuZn-2"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 39, ValueType.DROPDOWN, Arrays.asList("2024-2025"));
		ExcelFiller.setCellValue(filePath, 0, targetRow, 40, ValueType.DROPDOWN, Arrays.asList("Q1"));

		// ========== Store all values in HashMap ==========
		storeDetailCostingInfo.put("BOM Level", BOML1);
		storeDetailCostingInfo.put("Qty/Assy", QtyAssy);
		storeDetailCostingInfo.put("Part Number", PartNo);
		storeDetailCostingInfo.put("Part Description", PartDescription);
		storeDetailCostingInfo.put("Customer Part", CustomerPart);
		storeDetailCostingInfo.put("Procurement Type", ProcurementType);
		storeDetailCostingInfo.put("Part UOM", PartUom);
		storeDetailCostingInfo.put("Costing Module", CostingModule);
		storeDetailCostingInfo.put("RM Input Category", RmInputCategory);
		storeDetailCostingInfo.put("Gross Weight", "50.0000000");
		storeDetailCostingInfo.put("Net Weight", "48");
		storeDetailCostingInfo.put("RM Type", RmType);
		storeDetailCostingInfo.put("Commodity Group", "Ferrous Metals");
		storeDetailCostingInfo.put("Classification", "Steel-21");
		storeDetailCostingInfo.put("Specific Grade", "CuZn-2");
		storeDetailCostingInfo.put("Year", "2024-2025");
		storeDetailCostingInfo.put("Quarter", "Q1");
		storeDetailCostingInfo.put("Density", Density);
		storeDetailCostingInfo.put("Selected Month", SelectedMonthQHY);
		storeDetailCostingInfo.put("Packaging Cost", PackagingCost);
		storeDetailCostingInfo.put("Freight Cost", FreightCost);
		storeDetailCostingInfo.put("Process Cost", ProcessCost);
		storeDetailCostingInfo.put("OHP Others", OhpOthers);
		storeDetailCostingInfo.put("GrossWeightCalc", GrossWeight);
		storeDetailCostingInfo.put("ManufacturingCategory", ManufacturingCategory);
		storeDetailCostingInfo.put("SubCategory", SubCategory);
		storeDetailCostingInfo.put("RMInputShape", RMInputShape);
		storeDetailCostingInfo.put("CommodityGroup", CommodityGroup);
		storeDetailCostingInfo.put("Classification2", Classification);
		storeDetailCostingInfo.put("SpecificGrade2", SpecificGrade);
		storeDetailCostingInfo.put("Year2", Year);

		// ====== Add Excel Read Values into HashMap (without changing existing code)
		// ======
		String PartNumberFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 9);
		String PartDescriptionFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 10);
		String ProcurementTypeFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 12);
		String CommodityGroupFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 33);
		String GroupClassificationFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 34);
		String SpecificGradeFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 35);
		String SOBDataFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 28);
		String TotalPartCostFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 70);
		String TotalGrossWtkgsOrLengthmm = ExcelUtil.getDataCell(filePath, 0, targetRow, 29);
		String yearFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 39);
		String periodFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 40);
		String RmCostPerUnitFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 42);
		String PartFinishWeightFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 30);
		String ScrapCostPerKg = ExcelUtil.getDataCell(filePath, 0, targetRow, 46);
		String ScrapWeightPerKg = ExcelUtil.getDataCell(filePath, 0, targetRow, 31);
		String RmCostPerPcFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 51);
		String ScrapCostPerPcFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 55);
		String NetRmCostPerPcFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 57);
		String ShapeFromExcel = ExcelUtil.getDataCell(filePath, 0, targetRow, 27);
		// Store Excel values in same map with new keys
		storeDetailCostingInfo.put("Excel_PartNumber", PartNumberFromExcel);
		storeDetailCostingInfo.put("Excel_PartDescription", PartDescriptionFromExcel);
		storeDetailCostingInfo.put("Excel_ProcurementType", ProcurementTypeFromExcel);
		storeDetailCostingInfo.put("Excel_CommodityGroup", CommodityGroupFromExcel);
		storeDetailCostingInfo.put("Excel_GroupClassification", GroupClassificationFromExcel);
		storeDetailCostingInfo.put("Excel_SpecificGrade", SpecificGradeFromExcel);
		storeDetailCostingInfo.put("Excel_SOBData", SOBDataFromExcel);
		storeDetailCostingInfo.put("Excel_TotalPartCost", TotalPartCostFromExcel);
		storeDetailCostingInfo.put("Excel_TotalGrossWt", TotalGrossWtkgsOrLengthmm);
		storeDetailCostingInfo.put("Excel_Year", yearFromExcel);
		storeDetailCostingInfo.put("Excel_period", periodFromExcel);
		storeDetailCostingInfo.put("Excel_RmCostPerUnit", RmCostPerUnitFromExcel);
		storeDetailCostingInfo.put("Excel_PartFinishWeight", PartFinishWeightFromExcel);
		storeDetailCostingInfo.put("Excel_ScrapCostPerKg", ScrapCostPerKg);
		storeDetailCostingInfo.put("Excel_ScrapWeightPerKg", ScrapWeightPerKg);
		storeDetailCostingInfo.put("Excel_RmCostPerPc", RmCostPerPcFromExcel);
		storeDetailCostingInfo.put("Excel_ScrapCostPerPc", ScrapCostPerPcFromExcel);
		storeDetailCostingInfo.put("Excel_NetRmCostPerPc", NetRmCostPerPcFromExcel);
		storeDetailCostingInfo.put("Excel_ShapeFromExcel", ShapeFromExcel);

		///////////////////////////////////// Second Tab Part Master Detaill Costing
		///////////////////////////////////// ///////////////////////////////////////////////

		storeDetailCostingInfo.put("", TotalGrossWtkgsOrLengthmm);

		LoggerUtil.info("Excel Values Added to HashMap: " + storeDetailCostingInfo);

		// Save file changes
		ExcelUtil.openSaveCloseExcelFile(filePath);

		LoggerUtil.info(" Final Detail Costing Data Map: " + storeDetailCostingInfo);
		return storeDetailCostingInfo;
	}

	public void uploadFileForSelectedRadio(String radioOption, String filePath) throws InterruptedException {

		Thread.sleep(4999);
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));
		JavascriptExecutor js = (JavascriptExecutor) driver;

		List<WebElement> buttons = driver.findElements(clickingButtonsPartMaster);
		ClickingButtonPartMasters(buttons, "Export / Import");
		Thread.sleep(2000);

		LoggerUtil.info("⏳ Starting upload for radio option: " + radioOption);

		// STEP 1 – Click the correct radio input (not just the label)
		WebElement radioInput = null;
		switch (radioOption.trim().toLowerCase()) {
		case "part master":
			radioInput = driver.findElement(
					By.xpath("//label[normalize-space()='Part Master']/preceding-sibling::input[@type='radio']"));
			break;
		case "old costing":
			radioInput = driver.findElement(
					By.xpath("//label[normalize-space()='Old Costing']/preceding-sibling::input[@type='radio']"));
			break;
		case "detail costing":
			radioInput = driver.findElement(
					By.xpath("//label[normalize-space()='Detail Costing']/preceding-sibling::input[@type='radio']"));
			break;
		default:
			throw new IllegalArgumentException("❌ Invalid radio option: " + radioOption);
		}

		js.executeScript("arguments[0].click();", radioInput);
		LoggerUtil.info("🔘 Clicked on radio option: " + radioOption);

		Thread.sleep(3000);
		// STEP 2 – Determine Import button ID (classic switch)
		String importButtonId = null;
		switch (radioOption.trim().toLowerCase()) {
		case "part master":
			importButtonId = "Import";
			break;
		case "old costing":
			importButtonId = "ImportOldCosting";
			break;
		case "detail costing":
			importButtonId = "ImportDetailCosting";
			break;
		default:
			throw new IllegalArgumentException(" Unknown option: " + radioOption);
		}

		By importButtonLocator = By.id(importButtonId);

		// STEP 3 – Wait until Import button becomes visible
		wait.until(driver1 -> {
			WebElement el = driver1.findElement(importButtonLocator);
			String style = el.getAttribute("style");
			return style != null && !style.contains("display: none");
		});

		WebElement importBtn = driver.findElement(importButtonLocator);
		LoggerUtil.info("🖱️ '" + importButtonId + "' is now visible, clicking it...");

		js.executeScript("arguments[0].scrollIntoView(true);", importBtn);
		js.executeScript("arguments[0].click();", importBtn);

		// STEP 4 – Locate the hidden file input used for upload
		WebElement fileInput = wait.until(ExpectedConditions.presenceOfElementLocated(By.id("excelUploadpartmaster")));
		js.executeScript("arguments[0].style.display='block';", fileInput);
		LoggerUtil.info(" Unhid <input type='file'> element.");

		// STEP 5 – Send Excel file path
		fileInput.sendKeys(filePath);
		LoggerUtil.info(" File path sent successfully: " + filePath);

		Thread.sleep(5400);

		LoggerUtil.info(" Completed upload process for: " + radioOption);
	}

	public List<String> getValuesByHeaderName(String headerName) {
		List<String> values = new ArrayList<>();
		try {
			// XPath dynamically maps header to column cells without any numeric index
			List<WebElement> cells = Base.driver
					.findElements(By.xpath("//table[@id='commodtiyTable']//tbody//tr/td[count("
							+ "//table[@id='commodtiyTable']//thead//th[normalize-space(.)='" + headerName
							+ "']/preceding-sibling::th)+1]"));

			for (WebElement cell : cells) {
				values.add(cell.getText().trim());
			}

		} catch (Exception e) {
			LoggerUtil.error("Error fetching values for header: " + headerName + " → " + e.getMessage());
		}

		return values;
	}

	public void clickSupplierByHeader(String headerName, String expectedSupplier) {
		try {
			// Find all supplier cells under the given header dynamically
			List<WebElement> supplierCells = Base.driver
					.findElements(By.xpath("//table[@id='commodtiyTable']//tbody//tr/td[count("
							+ "//table[@id='commodtiyTable']//thead//th[normalize-space(.)='" + headerName
							+ "']/preceding-sibling::th)+1]"));

			boolean clicked = false;

			for (WebElement cell : supplierCells) {
				// Get anchor inside the supplier cell (each supplier link)
				WebElement supplierLink = null;
				try {
					supplierLink = cell.findElement(By.xpath(".//a"));
				} catch (Exception ignored) {
				}

				if (supplierLink != null) {
					String supplierName = supplierLink.getText().trim();
					LoggerUtil.info("Found supplier: " + supplierName);

					if (supplierName.equalsIgnoreCase(expectedSupplier)) {
						((JavascriptExecutor) Base.driver).executeScript("arguments[0].click();", supplierLink);
						LoggerUtil.info("✅ Clicked supplier link successfully: " + supplierName);
						clicked = true;
						break;
					}
				}
			}

			if (!clicked) {
				LoggerUtil.error("❌ Supplier '" + expectedSupplier + "' not found in '" + headerName + "' column.");
			}

		} catch (Exception e) {
			LoggerUtil.error("Error clicking supplier by header '" + headerName + "': " + e.getMessage());
		}
	}

	public void VerifyPartNumberAreSavedOrNotWithSupplierSide(String EnterpartDescriptionNumber,
			HashMap<String, String> excelDataMap) throws InterruptedException {

		LoggerUtil.info("🔍 Starting verification for Part: " + EnterpartDescriptionNumber);

		Thread.sleep(7000);
		clickOnElement(ClickingSearchButtonFromUiPartMaster);
		LoggerUtil.info("Clicked main Search button in Part Master.");

		Thread.sleep(1500);
		clearAndEnterText(waitForExpectedElement(EnterSearchValueForPartNumberAndDescriptionAfterImportData),
				EnterpartDescriptionNumber);
		LoggerUtil.info("Entered search text: " + EnterpartDescriptionNumber);

		clickOnElement(ClickingSearchButtonPartMasterVerifingPartDescription);
		LoggerUtil.info("Clicked Part Master Search to validate description.");

		// Select 'Procurement' radio button
		List<WebElement> RadioButtonNames = driver.findElements(clickingRadioButtonByName);
		boolean procurementSelected = false;
		for (WebElement RadioBtnname : RadioButtonNames) {
			String RadioBtnNameText = RadioBtnname.getText().trim();
			if (RadioBtnNameText.equalsIgnoreCase("Procurement")) {
				WebElement RadioBtn = RadioBtnname.findElement(By.xpath("./preceding-sibling::input"));
				RadioBtn.click();
				LoggerUtil.info("Selected 'Procurement' radio button successfully.");
				procurementSelected = true;
				Thread.sleep(1500);
				break;
			}
		}
		if (!procurementSelected) {
			LoggerUtil.error("'Procurement' radio button not found. Proceeding with next step.");
		}

		// Click Search to open results
		clickOnElement(clickingSearchButtonToValidatePartDescription);
		LoggerUtil.info("Clicked Search to validate part description.");
		Thread.sleep(2500);

		String FromExcelPartNumber = excelDataMap.get("Part Number");
		String FromExcelPartDescription = excelDataMap.get("Part Description");

		// ✅ Fetch actual values dynamically (no index)
		List<String> partNumbers = getValuesByHeaderName("Part No.");
		List<String> partDescriptions = getValuesByHeaderName("Part Description");

		if (partNumbers.isEmpty() || partDescriptions.isEmpty()) {
			LoggerUtil.error("No data found in the table for: " + EnterpartDescriptionNumber);
		} else {
			LoggerUtil.info("UI Part Numbers found: " + partNumbers);
			LoggerUtil.info("UI Part Descriptions found: " + partDescriptions);

			boolean matchFound = false;
			for (int i = 0; i < partNumbers.size(); i++) {

				String uiPartNo = partNumbers.get(i).trim();
				String uiPartDesc = partDescriptions.get(i).trim();

				LoggerUtil.info("Comparing UI vs Excel → Part No: [UI=" + uiPartNo + ", Excel=" + FromExcelPartNumber
						+ "] | Description: [UI=" + uiPartDesc + ", Excel=" + FromExcelPartDescription + "]");

				if (uiPartNo.equalsIgnoreCase(FromExcelPartNumber)
						&& uiPartDesc.equalsIgnoreCase(FromExcelPartDescription)) {

					LoggerUtil.info("✅ Verified Successfully → Part No: " + uiPartNo + " | Description: " + uiPartDesc
							+ " matches Excel data.");
					matchFound = true;
					break;
				}
			}

			if (!matchFound) {
				LoggerUtil.error("❌ Mismatch → Excel Part [No=" + FromExcelPartNumber + ", Desc="
						+ FromExcelPartDescription + "] not found in UI table.");
			}
		}

		clickSupplierByHeader("Suppliers", DataProp.getProperty("SupplierNamePartMaster"));

	}

	public static final By FetchingDataFromCellBox = By.xpath(
			"//div[@id='partAttributeDiv']/descendant::label[contains(text(),'')]/parent::div/following-sibling::div/input");

	public void VerifyFetchDataFromPartAttribute(HashMap<String, String> storeDetailCostingInfo) {
		SoftAssert softAssert = new SoftAssert();

		try {
			// ====== Expected Data from Excel ======
			String ExpectedPartNumberExcel = storeDetailCostingInfo.get("Excel_PartNumber");
			String ExpectedPartDescription = storeDetailCostingInfo.get("Excel_PartDescription");
			String ExpectedProcurementType = storeDetailCostingInfo.get("Excel_ProcurementType");
			String ExpectedCommodityGroup = storeDetailCostingInfo.get("Excel_CommodityGroup");
			String ExpectedSobValue = storeDetailCostingInfo.get("Excel_SOBData");
			String ExpectedCalculationCost = storeDetailCostingInfo.get("Excel_TotalPartCost");

			LoggerUtil.info("===== Starting Verification for Part Attribute Section =====");

			// ============================================================
			// 1. Part Number Validation
			// ============================================================
			try {
				WebElement partNumber = driver.findElement(By.xpath(
						"//div[@id='partAttributeDiv']//label[normalize-space(text())='Part Number']/parent::div/following-sibling::div/input"));
				String partNumberValue = partNumber.getAttribute("value").trim();

				LoggerUtil
						.info("Fetched UI Part Number: " + partNumberValue + " | Expected: " + ExpectedPartNumberExcel);

				if (partNumberValue.equals(ExpectedPartNumberExcel)) {
					LoggerUtil.info(" Part Number matched successfully.");
				} else {
					LoggerUtil.error(" Part Number mismatch! Expected: " + ExpectedPartNumberExcel + " | Actual: "
							+ partNumberValue);
				}

				softAssert.assertEquals(partNumberValue, ExpectedPartNumberExcel, "Part Number mismatch.");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying Part Number: " + e.getMessage());
			}

			// ============================================================
			// 2. Part Description Validation
			// ============================================================
			try {
				WebElement partDescription = driver.findElement(By.xpath(
						"//div[@id='partAttributeDiv']//label[normalize-space(text())='Part Description']/parent::div/following-sibling::div/input"));
				String partDescriptionValue = partDescription.getAttribute("value").trim();

				LoggerUtil.info("Fetched UI Part Description: " + partDescriptionValue + " | Expected: "
						+ ExpectedPartDescription);

				if (partDescriptionValue.equals(ExpectedPartDescription)) {
					LoggerUtil.info(" Part Description matched successfully.");
				} else {
					LoggerUtil.error(" Part Description mismatch! Expected: " + ExpectedPartDescription + " | Actual: "
							+ partDescriptionValue);
				}

				softAssert.assertEquals(partDescriptionValue, ExpectedPartDescription, "Part Description mismatch.");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying Part Description: " + e.getMessage());
			}

			// ============================================================
			// 3. Procurement Type Validation (Select2 Dropdown)
			// ============================================================
			try {
				WebElement procurementType = driver.findElement(By.xpath(
						"//div[@id='partAttributeDiv']//label[normalize-space(text())='Procurement Type']/parent::div/following-sibling::div//span[contains(@class,'select2-selection__rendered')]"));
				String procurementTypeValue = procurementType.getAttribute("title").trim();

				LoggerUtil.info("Fetched UI Procurement Type: " + procurementTypeValue + " | Expected: "
						+ ExpectedProcurementType);

				if (procurementTypeValue.equals(ExpectedProcurementType)) {
					LoggerUtil.info(" Procurement Type matched successfully.");
				} else {
					LoggerUtil.error(" Procurement Type mismatch! Expected: " + ExpectedProcurementType + " | Actual: "
							+ procurementTypeValue);
				}

				softAssert.assertEquals(procurementTypeValue, ExpectedProcurementType, "Procurement Type mismatch.");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying Procurement Type: " + e.getMessage());
			}

			// ============================================================
			// 4. Commodity Group Validation (Dropdown)
			// ============================================================
			try {
				WebElement commodityGroupElement = driver.findElement(By.xpath(
						"//select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']"));
				String commodityGroupValue = commodityGroupElement.getText().trim();

				LoggerUtil.info("Fetched UI Commodity Group: " + commodityGroupValue + " | Expected: "
						+ ExpectedCommodityGroup);

				if (commodityGroupValue.equals(ExpectedCommodityGroup)) {
					LoggerUtil.info(" Commodity Group matched successfully.");
				} else {
					LoggerUtil.error(" Commodity Group mismatch! Expected: " + ExpectedCommodityGroup + " | Actual: "
							+ commodityGroupValue);
				}

				softAssert.assertEquals(commodityGroupValue, ExpectedCommodityGroup, "Commodity Group mismatch.");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying Commodity Group: " + e.getMessage());
			}

			// ============================================================
			// 5. SOB % Validation (Numeric Tolerance)
			// ============================================================
			try {
				WebElement sobData = driver.findElement(By.xpath(
						"//div[@id='analysis']//label[contains(normalize-space(text()),'SOB %')]/parent::div/following-sibling::div/input[@id='CustSob']"));
				String sobValue = sobData.getAttribute("value").trim();

				LoggerUtil.info("Fetched SOB Value from UI: " + sobValue + " | Expected: " + ExpectedSobValue);

				double actualSob = 0.0, expectedSob = 0.0;
				try {
					actualSob = Double.parseDouble(sobValue);
					expectedSob = Double.parseDouble(ExpectedSobValue);
				} catch (NumberFormatException e) {
					LoggerUtil.error("SOB value format error: " + e.getMessage());
				}

				DecimalFormat df = new DecimalFormat("#.###");
				String formattedActual = df.format(actualSob);
				String formattedExpected = df.format(expectedSob);

				if (formattedActual.equals(formattedExpected)) {
					LoggerUtil.info(" SOB Value Matched Successfully | UI: " + formattedActual + " | Excel: "
							+ formattedExpected);
				} else {
					LoggerUtil.error(" SOB Value Mismatch | UI: " + formattedActual + " | Excel: " + formattedExpected);
				}

				softAssert.assertEquals(formattedActual, formattedExpected, "SOB Value mismatch after rounding");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying SOB %: " + e.getMessage());
			}

			// ============================================================
			// 6. Calculation Cost/Unit Validation
			// ============================================================
			try {
				WebElement calculationCostUnit = driver.findElement(By.xpath(
						"//div[@id='analysis']//label[contains(normalize-space(text()),'Calculation Cost/Unit')]/parent::div/following-sibling::div/input[@id='CalculatePrice']"));
				String calculationCostValue = calculationCostUnit.getAttribute("value").trim();

				LoggerUtil.info("Fetched Calculation Cost/Unit: " + calculationCostValue + " | Expected: "
						+ ExpectedCalculationCost);

				if (calculationCostValue.equals(ExpectedCalculationCost)) {
					LoggerUtil.info(" Calculation Cost/Unit matched successfully.");
				} else {
					LoggerUtil.error(" Calculation Cost/Unit mismatch! Expected: " + ExpectedCalculationCost
							+ " | Actual: " + calculationCostValue);
				}

				softAssert.assertEquals(calculationCostValue, ExpectedCalculationCost,
						"Calculation Cost/Unit mismatch.");
			} catch (Exception e) {
				LoggerUtil.error("Error verifying Calculation Cost/Unit: " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.error("Unexpected error during Part Attribute verification: " + e.getMessage());
		} finally {
			softAssert.assertAll(); // Aggregate all results at end
			LoggerUtil.info("===== Verification completed for Part Attribute section =====");
		}
	}

	public static final By TabNameList = By.xpath("//ul[@class='nav nav-pills']//a");

	public static final By FetchingDataFinalBlankWeightKg = By.xpath(
			"//div[@id='Finalblankwithouttriiger']//label[@id='FinalBlankwtlbl']/parent::div/following-sibling::div/input");

	public static final By fetchingCommodityGroupSecondTabDetailCosting = By.xpath(
			"//select[@id='commodityGroupId_SS']/following-sibling::span/descendant::span[@id='select2-commodityGroupId_SS-container']");

	public static final By FetchingGroupClasificationSecondTabDetailsCosting = By.xpath(
			"//select[@id='subGroupId_SS']/following-sibling::span/descendant::span[@id='select2-subGroupId_SS-container']");

	public static final By fetchingyearId = By.id("Year");

	public static final By Fetchingperiod = By.id("RmPeriod_SS");

	public static final By fetchingspecificgrade = By.id("RmGradeId_SS");

	public static final By fetchingRmCostperkg = By.xpath("//input[@id='RmCost_SS']");

	public static final By fetchingPartFinishweightkg = By.xpath(
			"//div[@class='row mb-1 align-items-center hideshowforSticker']/descendant::input[@id='partFinishWt_SS']");

	public static final By fetchingScrapRealozation = By
			.xpath("//div[@class='row']/descendant::input[@id='scrapRealization2_SS']");

	public static final By fetchingScrapCostPerKg = By.xpath("//input[@id='scrapCost_SS']");

	public static final By fetchingScrapWtPerKg = By.xpath("//input[@id='ScrapWtKg_SS']");

	public static final By fetchingNumberofPartsBlank = By.xpath("//input[@id='noOfNest_SS']");

	public static final By fetchingRmCostPerPc = By.xpath("//input[@id='rmCosPC_SS']");

	public static final By fetchingScrapCostperPc = By.xpath("//input[@id='scrapCostPC_SS']");

	public static final By fetchingNetRmCostPerPc = By.xpath("//input[@id='NetRMCost_SS']");

	public static final By fetchingPercentageOfRmYield = By.xpath("//input[@id='YieldNew']");

	public static final By fetchingTotalPartPerPcWithAmortization = By
			.xpath("//input[@id='TotalPartCostWithAmortizationPC_SS']");

	public static final By fetchingRmInputCategoryData = By.id("rmInputDrop");

	public static final By FetchingShapeData = By.id("ddlShapes");

	public void VerifyValidateDataWithExcelFile(HashMap<String, String> storeDetailCostingInfo)
			throws InterruptedException {

		Thread.sleep(3000);

		// ===== Expected values from Excel =====
		String ExpectedFinalWeight = storeDetailCostingInfo.get("Excel_TotalGrossWt");
		String ExpectedCommodityGroup = storeDetailCostingInfo.get("Excel_CommodityGroup");
		String ExpectedGroupClassification = storeDetailCostingInfo.get("Excel_GroupClassification");
		String ExpectedSpecificGrade = storeDetailCostingInfo.get("Excel_SpecificGrade");
		String ExpectedYear = storeDetailCostingInfo.get("Excel_Year");
		String ExpectedPeriod = storeDetailCostingInfo.get("Excel_period");
		String ExpectedRmCostPerKg = storeDetailCostingInfo.get("Excel_RmCostPerUnit");
		String ExpectedPartFinishWeightKg = storeDetailCostingInfo.get("Excel_PartFinishWeight");
		String ExpectedScrapCostPerKg = storeDetailCostingInfo.get("Excel_ScrapCostPerKg");
		String ExpectedScrapWeightPerKg = storeDetailCostingInfo.get("Excel_ScrapWeightPerKg");
		String ExpectedRmCostPerPc = storeDetailCostingInfo.get("Excel_RmCostPerPc");
		String ExpectedScrapCostPerPc = storeDetailCostingInfo.get("Excel_ScrapCostPerPc");
		String ExpectedNetRmCostPerPc = storeDetailCostingInfo.get("Excel_NetRmCostPerPc");
		String ExpectedRmInputShape = storeDetailCostingInfo.get("Excel_ShapeFromExcel");

		LoggerUtil.info("===== Starting Validation from Part Price Calculations Tab =====");

		// ===== Navigate to Part Price Calculations tab =====
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equals("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
				break;
			}
		}

		Thread.sleep(4000);

		// ===== Fetch actual UI values =====
		String uiFinalWeight = waitForExpectedElement(FetchingDataFinalBlankWeightKg).getAttribute("value");
		String uiCommodityGroup = waitForExpectedElement(fetchingCommodityGroupSecondTabDetailCosting).getText();
		String uiGroupClassification = waitForExpectedElement(FetchingGroupClasificationSecondTabDetailsCosting)
				.getText();
		String uiYear = new Select(waitForExpectedElement(fetchingyearId)).getFirstSelectedOption().getText().trim();
		String uiPeriod = new Select(waitForExpectedElement(Fetchingperiod)).getFirstSelectedOption().getText().trim();
		String uiSpecificGrade = new Select(waitForExpectedElement(fetchingspecificgrade)).getFirstSelectedOption()
				.getText().trim();
		String uiRmCostPerKg = waitForExpectedElement(fetchingRmCostperkg).getAttribute("value");
		String uiPartFinishWeightKg = waitForExpectedElement(fetchingPartFinishweightkg).getAttribute("value");
		String uiScrapCostPerKg = waitForExpectedElement(fetchingScrapCostPerKg).getAttribute("value");
		String uiScrapWeightPerKg = waitForExpectedElement(fetchingScrapWtPerKg).getAttribute("value");
		String uiRmCostPerPc = waitForExpectedElement(fetchingRmCostPerPc).getAttribute("value");
		String uiScrapCostPerPc = waitForExpectedElement(fetchingScrapCostperPc).getAttribute("value");
		String uiNetRmCostPerPc = waitForExpectedElement(fetchingNetRmCostPerPc).getAttribute("value");

		String uiRmInputCat = new Select(waitForExpectedElement(fetchingRmInputCategoryData)).getFirstSelectedOption()
				.getText().trim();
		String uiShape = new Select(waitForExpectedElement(FetchingShapeData)).getFirstSelectedOption().getText()
				.trim();

		// ===== Comparison Helper =====
		compareAndLog("Final Weight (Kg)", ExpectedFinalWeight, uiFinalWeight);
		compareAndLog("Commodity Group", ExpectedCommodityGroup, uiCommodityGroup);
		compareAndLog("Group Classification", ExpectedGroupClassification, uiGroupClassification);
		compareAndLog("Specific Grade", ExpectedSpecificGrade, uiSpecificGrade);
		compareAndLog("Year", ExpectedYear, uiYear);
		compareAndLog("Period", ExpectedPeriod, uiPeriod);
		compareAndLog("RM Cost per Kg", ExpectedRmCostPerKg, uiRmCostPerKg);
		compareAndLog("Part Finish Weight (Kg)", ExpectedPartFinishWeightKg, uiPartFinishWeightKg);
		compareAndLog("Scrap Cost per Kg", ExpectedScrapCostPerKg, uiScrapCostPerKg);
		compareAndLog("Scrap Weight per Kg", ExpectedScrapWeightPerKg, uiScrapWeightPerKg);
		compareAndLog("RM Cost per Pc", ExpectedRmCostPerPc, uiRmCostPerPc);
		compareAndLog("Scrap Cost per Pc", ExpectedScrapCostPerPc, uiScrapCostPerPc);
		compareAndLog("Net RM Cost per Pc", ExpectedNetRmCostPerPc, uiNetRmCostPerPc);
		compareAndLog("RM Input Category", "Standard Shapes", uiRmInputCat);
		compareAndLog("Shape", ExpectedRmInputShape, uiShape);

		LoggerUtil.info("===== Validation Completed for Part Price Calculations Tab =====");
	}

	public static final By ClickingThreeBarsButtonforDetailsCosting = By
			.xpath("//*[@id='PartPriceCalculationsTab']/descendant::button[@title='Export Data']");
	public static final By SelectingOptionsThreeBars = By
			.xpath("//div[@class='dropdown-content']/button[contains(text(),'')]");

	private static File getLatestExportedPDFFileByPartNumber(String partNumber) {
		String downloadPath = System.getProperty("user.dir") + "\\downloads";
		File dir = new File(downloadPath);

		// Filter files: start with part number and end with .pdf
		File[] files = dir.listFiles((folder, name) -> name.startsWith(partNumber) && name.endsWith(".pdf"));

		if (files == null || files.length == 0) {
			LoggerUtil.warn("⚠ No PDF file found for part number: " + partNumber);
			return null;
		}

		// Find the latest modified file
		File latestFile = files[0];
		for (File file : files) {
			if (file.lastModified() > latestFile.lastModified()) {
				latestFile = file;
			}
		}

		LoggerUtil.info("📄 Latest exported PDF file found for part: " + latestFile.getName());
		return latestFile;
	}

	private static File getLatestExportedExcelFileByPartNumber(String partNumber) {
		String downloadPath = System.getProperty("user.dir") + "\\downloads";
		File dir = new File(downloadPath);

		// filter files: start with part number and end with .xlsx
		File[] files = dir.listFiles((folder, name) -> name.startsWith(partNumber + "_") && name.endsWith(".xlsx"));

		if (files == null || files.length == 0) {
			LoggerUtil.warn(" No Excel file found for part number: " + partNumber);
			return null;
		}

		// find latest modified file
		File latestFile = files[0];
		for (File file : files) {
			if (file.lastModified() > latestFile.lastModified()) {
				latestFile = file;
			}
		}

		LoggerUtil.info(" Latest exported Excel file found for part: " + latestFile.getName());
		return latestFile;
	}

	public static final By selectingDropdownCostingTypeBomMaster = By.id("custSup");
	public static final By selectingDropdownCompanyName = By.id("CompSel");
	public static final By selectingDropdownCustomerName = By.id("custSel");
	public static final By selectingDropdownProductmodel = By.id("pmSel");
	public static final By clickingExportButton = By.xpath("//button[@id='download']");
	public static final By clickingBomSaveButton = By.xpath("//button[@id='bomSave']");

	public void VerifySelectingBopAndExportingFile(String EnterCastingTypeBomMaster) throws InterruptedException {

		Thread.sleep(2000);
		selectDropDownValue(selectingDropdownCostingTypeBomMaster, EnterCastingTypeBomMaster, "visibleText");
		Thread.sleep(2000);
		selectDropDownValue(selectingDropdownCompanyName, "COSTMASTER-0304-MOHALI", "visibleText");
		Thread.sleep(2000);
		selectDropDownValue(selectingDropdownCustomerName, "Rishicustomer-Tbilisi", "visibleText");
		Thread.sleep(2000);
		selectDropDownValue(selectingDropdownProductmodel, "JKLakshmi-001", "visibleText");
		Thread.sleep(2000);
		clickOnElement(clickingExportButton);

		Thread.sleep(8000);

		getLatestBOMFile();
	}

	public void fillBom(String partnumber, String PartDescription, String partnumber1, String PartDescription1)
			throws InterruptedException {

		Thread.sleep(7000);
		File file = getLatestBOMFile();

		String filepath = file.getAbsolutePath();

		ExcelFiller.setCellValue(filepath, 0, 5, 1, ExcelFiller.ValueType.INTEGER, Arrays.asList("1"));
		ExcelFiller.setCellValue(filepath, 0, 5, 15, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(partnumber));
//		ExcelFiller.setCellValue(filepath, 0, 5, 16, ExcelFiller.ValueType.STRING, Arrays.asList(PartDescription));
		ExcelFiller.setCellValue(filepath, 0, 5, 18, ExcelFiller.ValueType.DROPDOWN, Arrays.asList("Assy"));
		ExcelFiller.setCellValue(filepath, 0, 5, 20, ExcelFiller.ValueType.INTEGER, Arrays.asList("1"));
		ExcelFiller.setCellValue(filepath, 0, 5, 21, ExcelFiller.ValueType.DROPDOWN, Arrays.asList("Actual"));

		// Second Row

		ExcelFiller.setCellValue(filepath, 0, 6, 1, ExcelFiller.ValueType.INTEGER, Arrays.asList("1"));
		ExcelFiller.setCellValue(filepath, 0, 6, 15, ExcelFiller.ValueType.DROPDOWN, Arrays.asList(partnumber1));
//		ExcelFiller.setCellValue(filepath, 0, 6, 16, ExcelFiller.ValueType.STRING, Arrays.asList(PartDescription1));
		ExcelFiller.setCellValue(filepath, 0, 6, 18, ExcelFiller.ValueType.DROPDOWN, Arrays.asList("Assy"));
		ExcelFiller.setCellValue(filepath, 0, 6, 20, ExcelFiller.ValueType.INTEGER, Arrays.asList("1"));
		ExcelFiller.setCellValue(filepath, 0, 6, 21, ExcelFiller.ValueType.DROPDOWN, Arrays.asList("Actual"));

	}

	public static final By importBomFile = By.xpath("//input[@id='AttachmentFile']");

	public void importBOMExcelFile() {
		try {
			LoggerUtil.info(" Starting BOM Excel import...");

			// Step 1 – Get the latest BOM file
			File file = getLatestBOMFile();
			if (file == null) {
				LoggerUtil.error("." + " No BOM Excel file found in downloads folder.");
				return;
			}
			String filePath = file.getAbsolutePath();
			LoggerUtil.info(" File selected for upload: " + filePath);

			ExcelUtil.openSaveCloseExcelFile(filePath);
			Thread.sleep(2000);
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(20));

			// Step 2 – Click the Import button to open the file picker dialog
			WebElement importBtn = wait.until(ExpectedConditions.elementToBeClickable(By.id("Import")));
			LoggerUtil.info(" Clicking Import button to open file dialog...");
			importBtn.click();

			Thread.sleep(2500); // give time for Windows dialog to appear

			uploadFileUsingRobot(filePath);

			Thread.sleep(3000);
			clickOnElement(clickingBomSaveButton);

			String ActualToastmessage = waitForExpectedElement(toastMessage).getText().trim();
			String ExpectedToastmessage = "BOM data saved successfully.";
			System.out.println(ActualToastmessage);
			Assert.assertEquals(ActualToastmessage, ExpectedToastmessage);
		} catch (Exception e) {
			LoggerUtil.error(" Error during BOM Excel import: " + e.getMessage());
			e.printStackTrace();
		}
	}

	private static void uploadFileUsingRobot(String filePath) {
		try {
			// Step 1️ – Copy file path to clipboard
			StringSelection selection = new StringSelection(filePath);
			Toolkit.getDefaultToolkit().getSystemClipboard().setContents(selection, null);

			Robot robot = new Robot();

			// Step 2️ – Wait for the dialog to appear
			Thread.sleep(3000);

			// Step 3️ – Click in the "File name" box to force focus
			// 👇 Adjust these coordinates once by moving your mouse to the box and noting
			// its position.
			robot.mouseMove(420, 560);
			robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);
			robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);
			Thread.sleep(500);

			// Step 4️ – Paste (Ctrl + V)
			robot.keyPress(KeyEvent.VK_CONTROL);
			robot.keyPress(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_V);
			robot.keyRelease(KeyEvent.VK_CONTROL);
			LoggerUtil.info(" File path pasted: " + filePath);
			Thread.sleep(1000);

			// Step 5️ – Press Enter to confirm
			robot.keyPress(KeyEvent.VK_ENTER);
			robot.keyRelease(KeyEvent.VK_ENTER);
			LoggerUtil.info(" Pressed Enter to confirm file selection.");

		} catch (Exception e) {
			LoggerUtil.error(" Robot upload failed: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public static final By clickingCostingTypeBoxFromCopyCosting = By
			.xpath("//select[@id='costingtypeCpyproc' or @id='costingtypeCpysales']/following-sibling::div/button");
	public static final By SelectingCostingTypeFormCopyCosting = By
			.xpath("//select[@id='costingtypeCpyproc' or @id='costingtypeCpysales']" + "/following-sibling::div"
					+ "//button[contains(@class,'multiselect-option')]" + "//label");
	public static final By clickingCustomerNameBoxFromCopyCosting = By
			.xpath("//select[@id='customerSel2Copy' or @id='customerSelCopy']/following-sibling::div/button");

	public static final By EnterSearchBoxCustomerNameForCopyCosting = By.xpath(
			"//select[@id='customerSel2Copy' or @id='customerSelCopy']/following-sibling::div/descendant::input[@type='search']");

	public static final By selectingCustomerNameFromCopyCosting = By.xpath(
			"//select[@id='customerSelCopy']/following-sibling::div/descendant::button[@style='display: block;']//label");

	public static final By clickingProductModelBox = By
			.xpath("//select[@id='pmSel2Copy' or @id='pmSelCopy']/following-sibling::div/button");
	public static final By selectingProductModelFromCopyCosting = By.xpath(
			"//select[@id='pmSel2Copy' or @id='pmSelCopy']/following-sibling::div/descendant::button[contains(@class,'multiselect-option dropdown')]//label");
	public static final By clickingPartNumberBox = By
			.xpath("//select[@id='ddlmultiplelinenos2' or @id='ddlmultiplelinenos']/following-sibling::div/button");
	public static final By EnterSearchValueInPartNumberSearchBoxCopyCosting = By
			.xpath("//select[@id='ddlmultiplelinenos']/following-sibling::div/descendant::input[@type='search']");
	public static final By selectingPartNumberFromCopyCosting = By.xpath(
			"//select[@id='ddlmultiplelinenos2' or @id='ddlmultiplelinenos']/following-sibling::div/descendant::button[contains(@class,'dropdown-item multiselect')]/following-sibling::button//label");
	public static final By clickingCopyButtonFromCopyCosting = By
			.xpath("//div[@id='modalCopy']/descendant::button[@id='tab2Savecstsale' or @id='tab2Save']");

	public static final By clickingCrossButton = By
			.xpath("//div[@id='modalCopy']/descendant::button[@aria-label='Close']");
	public static final By clickingOhpDropdownboxForCopyCosting = By
			.xpath("//select[@id='copyOhpDetails_Sale']/following-sibling::div/button");
	public static final By EnterValueSearchBoxForOhp = By
			.xpath("//select[@id='copyOhpDetails_Sale']/following-sibling::div/descendant::input[@type='search']");
	public static final By fetchingLabelNameFromohpDropdown = By
			.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//label");

	public static final By fetchingCostingTypeDropdownOptions = By.xpath(
			"//select[@id='costingtypeCpysales' or @id='costingtypeCpyproc']/following-sibling::div/descendant::label[contains(.,'')]");

	public static final By ClickingSupplierDropdownForCopyCosting = By
			.xpath("//select[@id='supCopy']/following-sibling::div/button");
	public static final By SupplierNameForCopyCosting = By
			.xpath("//select[@id='supCopy']/following-sibling::div/descendant::label[contains(.,'')]");

	public static final By fetchingCostingTypeDropdownOptionsForCustomer = By
			.xpath("//select[@id='costingtypeCpyproc']/following-sibling::div/descendant::label[contains(.,'')]");
	public static final By clickingProductModelBoxCopyCostingForCustomer = By
			.xpath("//select[@id='pmSel2Copy' or @id='pmSelCopy']/following-sibling::div/button");
	public static final By ClickingCustomerDropdownCopyCostingForCustomer = By
			.xpath("//select[@id='customerSel2Copy' ]/following-sibling::div/button");
	public static final By EnterCustomerNameSearchBoxCustomerDropdownCopyCostingCustomerside = By
			.xpath("//select[@id='customerSel2Copy' ]/following-sibling::div/descendant::input[@type='search']");
	public static final By SelectingCustomerNameListForCopyCostingCustomerSide = By.xpath(
			"//select[@id='customerSel2Copy']/following-sibling::div/descendant::button[@style='display: block;']//label");

	public static final By ClickingPartNumberBoxCopyCostingCustomerSide = By
			.xpath("//select[@id='ddlmultiplelinenos2']/following-sibling::div/button");
	public static final By EnterPartNumberInSearchBoxCopyCostingCustomerSide = By
			.xpath("//select[@id='ddlmultiplelinenos2']/following-sibling::div/descendant::input[@type='search']");
	public static final By FetchingPartNumberTextForCopyCostingCustomerSide = By.xpath(
			"//select[@id='ddlmultiplelinenos2']/following-sibling::div/descendant::button[contains(@class,'dropdown-item multiselect')]/following-sibling::button//label");

	public static final By FetchingProductModelNumberByTextCustomerSideCopyCosting = By.xpath(
			"//select[@id='pmSel2Copy' ]/following-sibling::div/descendant::button[contains(@class,'multiselect-option dropdown')]//label");

	public void clickingThreeBarAndCopyAllCostingForCustomer(String EnterName, String EnterCustomerNameValue,
			String partnumber) throws InterruptedException {
		try {
			LoggerUtil.info("===== START: Copy Costing For Customer =====");

			// Step 1: Navigate to 'Part Price Calculations' tab
			LoggerUtil.info("Step 1️⃣ Navigating to 'Part Price Calculations' tab...");
			Thread.sleep(399);
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass(" Navigated to 'BOP' tab successfully.");
					break;
				}
			}

			// Step 2: Open Three-Bar menu and choose 'Copy Costing'
			Thread.sleep(6000);
			LoggerUtil.info("Step 2️⃣ Clicking on the Three-Bar button and selecting 'Copy Costing'...");
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			for (WebElement option : driver.findElements(SelectingOptionsThreeBars)) {
				if (option.getText().trim().equals("Copy Costing")) {
					option.click();
					LoggerUtil.pass("✅ Selected 'Copy Costing' option successfully.");
					break;
				}
			}

			// Step 3: Select costing type
			Thread.sleep(2000);
			LoggerUtil.info("Step 3️⃣ Selecting costing type from dropdown...");
			clickOnElement(By.xpath(
					"//select[@id='costingtypeCpyproc']/following-sibling::div/button[contains(@class,'multiselect')]"));
			for (WebElement option : driver.findElements(fetchingCostingTypeDropdownOptionsForCustomer)) {
				if (option.getText().trim().equals(EnterName)) {
					option.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.info("✅ Selected costing type: " + EnterName);
					break;
				}
			}

			// Step 4: Select customer
			Thread.sleep(2000);
			LoggerUtil.info("Step 4️⃣ Selecting customer: " + EnterCustomerNameValue);
			clickOnElement(ClickingCustomerDropdownCopyCostingForCustomer);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterCustomerNameSearchBoxCustomerDropdownCopyCostingCustomerside),
					EnterCustomerNameValue);
			// Wait until visible customer list is displayed (those having display:block)
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
			wait.until(ExpectedConditions.presenceOfAllElementsLocatedBy(By.xpath(
					"//select[@id='customerSel2Copy']/following-sibling::div//button[@style='display: block;']")));

			List<WebElement> customerButtons = driver.findElements(By.xpath(
					"//select[@id='customerSel2Copy']/following-sibling::div//button[@style='display: block;']"));
			boolean customerClicked = false;

			for (WebElement btn : customerButtons) {
				try {
					WebElement label = btn.findElement(By.xpath(".//label"));
					String labelText = label.getText().trim();
					LoggerUtil.info("Button text read by Selenium → [" + labelText + "]");

					if (labelText.toLowerCase().contains(EnterCustomerNameValue.toLowerCase().trim())) {
						try {
							WebElement radio = label.findElement(By.xpath("./preceding-sibling::input"));
							((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", radio);
							radio.click();
							LoggerUtil.pass("✅ Clicked Customer (normal click): " + labelText);
						} catch (Exception e) {
							((JavascriptExecutor) driver).executeScript("arguments[0].click();", label);
							LoggerUtil.pass("✅ Clicked Customer (JS click): " + labelText);
						}
						customerClicked = true;
						break;
					}
				} catch (Exception ex) {
					LoggerUtil.warn("Skipping one button: " + ex.getMessage());
				}
			}

			if (!customerClicked) {
				LoggerUtil.fail("❌ No visible customer label found for: " + EnterCustomerNameValue);
			}

			// Step 5: Select Product Model
			Thread.sleep(2000);
			LoggerUtil.info("Step 5️⃣ Selecting Product Model...");
			clickOnElement(clickingProductModelBox);
			Thread.sleep(2000);
			for (WebElement model : driver.findElements(FetchingProductModelNumberByTextCustomerSideCopyCosting)) {
				if (model.getText().trim().equals(DataProp.getProperty("ProductModelName&No.PartMaster"))) {
					model.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.info("✅ Selected Product Model: " + model.getText().trim());
					break;
				}
			}

			// Step 6: Select Part Number
			Thread.sleep(2000);
			LoggerUtil.info("Step 6️⃣ Selecting Part Number: " + partnumber);
			clickOnElement(ClickingPartNumberBoxCopyCostingCustomerSide);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterPartNumberInSearchBoxCopyCostingCustomerSide), partnumber);

			for (WebElement option : driver.findElements(FetchingPartNumberTextForCopyCostingCustomerSide)) {
				if (option.getText().trim().equals(partnumber)) {
					option.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.info("✅ Selected Part Number: " + partnumber);
					break;
				}
			}

			// Step 7: Select OHP
			Thread.sleep(2000);
			LoggerUtil.info("Step 7️⃣ Selecting OHP...");
			clickOnElement(By.xpath("//div[@id='modalCopy']//h5"));
			Thread.sleep(2000);
			clickOnElement(clickingOhpDropdownboxForCopyCosting);

			WebElement searchBox = waitForExpectedElement(EnterValueSearchBoxForOhp);
			String ohpValue = DataProp.getProperty("OHPCustomerSide").trim();
			((JavascriptExecutor) driver).executeScript(
					"arguments[0].value = arguments[1]; arguments[0].dispatchEvent(new Event('input', { bubbles: true }));",
					searchBox, ohpValue);
			LoggerUtil.info("Entered OHP search value: [" + ohpValue + "]");

			WebDriverWait waitOHP = new WebDriverWait(driver, Duration.ofSeconds(10));
			List<WebElement> ohpOptions = waitOHP.until(ExpectedConditions.presenceOfAllElementsLocatedBy(
					By.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//label")));

			boolean ohpFound = false;
			for (WebElement option : ohpOptions) {
				if (option.getText().trim().equalsIgnoreCase(ohpValue)) {
					((JavascriptExecutor) driver).executeScript("arguments[0].click();",
							option.findElement(By.xpath("./preceding-sibling::input[@type='radio']")));
					LoggerUtil.pass("✅ Selected OHP option: " + option.getText().trim());
					ohpFound = true;
					break;
				}
			}
			if (!ohpFound)
				LoggerUtil.fail("❌ OHP option not found for: " + ohpValue);

			// Step 8: Click Copy button
			Thread.sleep(2000);
			LoggerUtil.info("Step 8️⃣ Clicking Copy button...");
			try {
				By copyButtonsLocator = By.xpath("//div[@id='modalCopy']//button[@id='tab2Savecstsale']");
				WebDriverWait waitCopy = new WebDriverWait(driver, Duration.ofSeconds(15));
				waitCopy.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(copyButtonsLocator));

				List<WebElement> copyButtons = driver.findElements(copyButtonsLocator);
				WebElement activeButton = null;
				for (WebElement btn : copyButtons) {
					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", btn);
					Thread.sleep(300);
					if (btn.isDisplayed() && btn.isEnabled()) {
						activeButton = btn;
						break;
					}
				}

				if (activeButton != null) {
					try {
						waitCopy.until(ExpectedConditions.elementToBeClickable(activeButton));
						activeButton.click();
						LoggerUtil.pass("✅ Clicked Copy button successfully (normal click).");
					} catch (Exception e) {
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", activeButton);
						LoggerUtil.pass("✅ Clicked Copy button successfully (via JavaScript).");
					}
				} else {
					LoggerUtil.fail("❌ No active Copy button found in modal.");
				}

			} catch (Exception e) {
				LoggerUtil.error("❌ Error locating Copy button: " + e.getMessage());
			}

			// Step 9: Validate Toast
			Thread.sleep(1000);
			LoggerUtil.info("Step 9️⃣ Validating success toast message...");
			String expectedToast = "Costing data copied successfully";
			String actualToast = waitForExpectedElement(toastMessage).getText();
			if (expectedToast.equals(actualToast)) {
				LoggerUtil.pass("✅ Toast message matched successfully: " + actualToast);
			} else {
				LoggerUtil.fail("❌ Toast message mismatch. Expected: " + expectedToast + ", Found: " + actualToast);
			}

			// Step 10: Close popup
			Thread.sleep(3000);
			LoggerUtil.info("Step 🔟 Closing Copy Costing popup.");
			clickOnElement(clickingCrossButton);
			Thread.sleep(456);
			LoggerUtil.pass("✅ Copy Costing for Customer completed successfully.");

			LoggerUtil.info("===== END: Copy Costing For Customer =====");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in Copy Costing process: " + e.getMessage());

			throw e;
		}
	}

	public void clickingThreeBarAndCopyAllCosting(String EnterName, String EnterCustomerNameValue,
			String EnterSuppliername, String partnumber) throws InterruptedException {

		Thread.sleep(399);
		try {
			// Step 1️: Navigate to the BOP tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info(" Navigated to 'BOP' tab successfully.");
					break;
				}
			}

			Thread.sleep(6000);
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);

			List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);

			for (WebElement ThreeBarLink : ThreeBarOptions) {
				String BarLinkText = ThreeBarLink.getText().trim();
				if (BarLinkText.equals("Copy Costing")) {
					ThreeBarLink.click();
					break;
				}
			}

			Thread.sleep(2000);

			// Step 1️⃣: Open dropdown (works for both costingtypeCpyproc &
			// costingtypeCpysales)
			clickOnElement(By.xpath(
					"//select[@id='costingtypeCpyproc' or @id='costingtypeCpysales']/following-sibling::div/button[contains(@class,'multiselect')]"));
			LoggerUtil.info("✅ Dropdown opened successfully.");

			List<WebElement> optionsTexts = driver.findElements(fetchingCostingTypeDropdownOptions);
			for (WebElement option : optionsTexts) {
				String name = option.getText().trim();
				if (name.equals(EnterName)) {
					WebElement dropRadioButton = option.findElement(By.xpath("./preceding-sibling::input"));
					dropRadioButton.click();
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(clickingCustomerNameBoxFromCopyCosting);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterSearchBoxCustomerNameForCopyCosting), EnterCustomerNameValue);

			List<WebElement> CustomerNames = driver.findElements(selectingCustomerNameFromCopyCosting);
			for (WebElement CustomerName : CustomerNames) {
				String CustomerNameText = CustomerName.getText().trim();
				if (CustomerNameText.equals(EnterCustomerNameValue)) {
					WebElement CustomerRadioButton = CustomerName.findElement(By.xpath("./preceding-sibling::input"));
					CustomerRadioButton.click();
					break;
				}
			}

			LoggerUtil.info("QA Has To Take Static Name");

			Thread.sleep(2000);
			clickOnElement(clickingProductModelBox);
			Thread.sleep(2000);

			List<WebElement> optionsproductModelFromCopyCosting = driver
					.findElements(selectingProductModelFromCopyCosting);
			for (WebElement productmodelname : optionsproductModelFromCopyCosting) {
				String productmodelText = productmodelname.getText().trim();
				if (productmodelText.equals(DataProp.getProperty("ProductModelName&No.PartMaster"))) {
					WebElement RadioButtonProductmodel = productmodelname
							.findElement(By.xpath("./preceding-sibling::input"));
					RadioButtonProductmodel.click();
					break;
				}
			}

			Thread.sleep(2000);

			// Check if the supplier dropdown exists and is visible
			List<WebElement> supplierDropdownList = driver.findElements(ClickingSupplierDropdownForCopyCosting);
			if (!supplierDropdownList.isEmpty() && supplierDropdownList.get(0).isDisplayed()) {
				LoggerUtil.info("✅ Supplier dropdown available — proceeding to select supplier.");

				// Click to open dropdown
				clickOnElement(ClickingSupplierDropdownForCopyCosting);
				Thread.sleep(1000);

				// Fetch all supplier names
				List<WebElement> supplierNames = driver.findElements(SupplierNameForCopyCosting);
				for (WebElement supplier : supplierNames) {
					String supplierText = supplier.getText().trim();
					if (supplierText.equals(EnterSuppliername)) {
						WebElement radioButton = supplier
								.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", radioButton);
						LoggerUtil.pass("✅ Selected supplier (blank entry or matched condition).");
						break;
					}
				}
			}

			Thread.sleep(3000);

			clickOnElement(clickingPartNumberBox);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueInPartNumberSearchBoxCopyCosting), partnumber);

			List<WebElement> optionpartnumbers = driver.findElements(selectingPartNumberFromCopyCosting);
			for (WebElement optionpartnumber : optionpartnumbers) {
				String optiontext = optionpartnumber.getText().trim();
				if (optiontext.equals(partnumber)) {
					WebElement checkboxesPartnumber = optionpartnumber
							.findElement(By.xpath("./preceding-sibling::input"));
					checkboxesPartnumber.click();
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(By.xpath("//div[@id='modalCopy']//h5"));
			Thread.sleep(2000);
			clickOnElement(clickingOhpDropdownboxForCopyCosting);

			WebElement searchBox = waitForExpectedElement(EnterValueSearchBoxForOhp);
			String ohpValue = DataProp.getProperty("OhpName").trim();

			((JavascriptExecutor) driver).executeScript(
					"arguments[0].value = arguments[1].trim();"
							+ "arguments[0].dispatchEvent(new Event('input', { bubbles: true }));",
					searchBox, ohpValue);

			LoggerUtil.info("Entered OHP search value precisely: [" + ohpValue + "]");

			WebDriverWait wait1 = new WebDriverWait(driver, Duration.ofSeconds(10));
			List<WebElement> ohpOptions = wait1.until(ExpectedConditions.presenceOfAllElementsLocatedBy(
					By.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//label")));

			LoggerUtil.info("Found " + ohpOptions.size() + " OHP options.");

			boolean found = false;
			for (WebElement option : ohpOptions) {
				String optionText = option.getText().trim();
				LoggerUtil.info("Found dropdown option: [" + optionText + "]");
				if (optionText.equalsIgnoreCase(ohpValue)) {
					WebElement radioButton = option.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", radioButton);
					LoggerUtil.pass("Selected OHP option: [" + optionText + "]");
					found = true;
					break;
				}
			}
			if (!found) {
				LoggerUtil.fail("OHP option not found for value: [" + ohpValue + "]");
			}

			Thread.sleep(2000);
			LoggerUtil.info("➡️ Entering Copy button detection block...");

			try {
				WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(15));
				By copyButtonsLocator = By
						.xpath("//div[@id='modalCopy']//button[@id='tab2Savecstsale' or @id='tab2Save']");

				// Wait until at least one copy button appears
				wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(copyButtonsLocator));

				List<WebElement> buttons = driver.findElements(copyButtonsLocator);
				LoggerUtil.info("Detected " + buttons.size() + " possible Copy buttons inside modalCopy.");

				WebElement activeButton = null;

				for (WebElement btn : buttons) {
					// Scroll into view for reliable isDisplayed() evaluation
					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", btn);
					Thread.sleep(300);

					if (btn.isDisplayed() && btn.isEnabled()) {
						activeButton = btn;
						LoggerUtil.info("Visible Copy button detected → id: " + btn.getAttribute("id") + ", position: "
								+ btn.getLocation().toString());
						break;
					}
				}

				if (activeButton != null) {
					try {
						wait.until(ExpectedConditions.elementToBeClickable(activeButton));
						activeButton.click();
						LoggerUtil.pass("✅ Clicked Copy button normally with id: " + activeButton.getAttribute("id"));
					} catch (Exception e) {
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", activeButton);
						LoggerUtil.pass("✅ Clicked Copy button via JS with id: " + activeButton.getAttribute("id"));
					}
				} else {
					LoggerUtil.error("❌ No visible Copy button found in modalCopy (both hidden).");
				}

			} catch (Exception e) {
				LoggerUtil.error("❌ Error while locating Copy button: " + e.getMessage());
			}

			Thread.sleep(2000);
			String ExpectedToastmsg = "Costing data copied successfully";
			String ActualToastmsg = waitForExpectedElement(toastMessage).getText();
			if (ExpectedToastmsg.equals(ActualToastmsg)) {
				LoggerUtil.info("Toast message Matched Successfully.");
			} else {
				LoggerUtil.error("Toast message did not match. Actual: " + ActualToastmsg);
			}

			Thread.sleep(3000);
			clickOnElement(clickingCrossButton);
			Thread.sleep(456);

		} catch (Exception e) {
			System.out.println("Element not Found: " + e.getMessage());
		}
	}

	public static final By clickingOhpCopyCostingForSupplier = By
			.xpath("//select[@id='copyOhpDetails']/following-sibling::div/button");
	public static final By EnterValueSearchBoxForSupplierOhp = By
			.xpath("//select[@id='copyOhpDetails']/following-sibling::div/descendant::input[@type='search']");
	public static final By clickingPartNumberForSupplierCopyCosting = By
			.xpath("//select[@id='ddlmultiplelinenos']/following-sibling::div/button");

	public void clickingThreeBarAndCopyAllCostingForSupplier(String EnterName, String EnterCustomerNameValue,
			String EnterSuppliername, String partnumber) throws InterruptedException {

		Thread.sleep(399);
		try {
			// Step 1️: Navigate to the BOP tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info(" Navigated to 'Part Price Calculations' tab successfully.");
					break;
				}
			}

			Thread.sleep(6000);
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(2000);
			List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);
			Thread.sleep(2000);
			for (WebElement ThreeBarLink : ThreeBarOptions) {
				String BarLinkText = ThreeBarLink.getText().trim();
				if (BarLinkText.equals("Copy Costing")) {
					ThreeBarLink.click();
					break;
				}
			}

			Thread.sleep(2000);

			// Step 1️⃣: Open dropdown (works for both costingtypeCpyproc &
			// costingtypeCpysales)
			clickOnElement(By.xpath(
					"//select[@id='costingtypeCpyproc' or @id='costingtypeCpysales']/following-sibling::div/button[contains(@class,'multiselect')]"));
			LoggerUtil.info(" Dropdown opened successfully.");

			List<WebElement> optionsTexts = driver.findElements(fetchingCostingTypeDropdownOptions);
			for (WebElement option : optionsTexts) {
				String name = option.getText().trim();
				if (name.equals(EnterName)) {
					WebElement dropRadioButton = option.findElement(By.xpath("./preceding-sibling::input"));
					dropRadioButton.click();
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(clickingCustomerNameBoxFromCopyCosting);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterSearchBoxCustomerNameForCopyCosting), EnterCustomerNameValue);

			List<WebElement> CustomerNames = driver.findElements(selectingCustomerNameFromCopyCosting);
			for (WebElement CustomerName : CustomerNames) {
				String CustomerNameText = CustomerName.getText().trim();
				if (CustomerNameText.equals(EnterCustomerNameValue)) {
					WebElement CustomerRadioButton = CustomerName.findElement(By.xpath("./preceding-sibling::input"));
					CustomerRadioButton.click();
					break;
				}
			}

			LoggerUtil.info("QA Has To Take Static Name");

			Thread.sleep(2000);
			clickOnElement(clickingProductModelBox);
			Thread.sleep(2000);

			List<WebElement> optionsproductModelFromCopyCosting = driver
					.findElements(selectingProductModelFromCopyCosting);
			for (WebElement productmodelname : optionsproductModelFromCopyCosting) {
				String productmodelText = productmodelname.getText().trim();
				if (productmodelText.equals(DataProp.getProperty("ProductModelName&No.PartMaster"))) {
					WebElement RadioButtonProductmodel = productmodelname
							.findElement(By.xpath("./preceding-sibling::input"));
					RadioButtonProductmodel.click();
					break;
				}
			}

			Thread.sleep(2000);

			// Check if the supplier dropdown exists and is visible
			List<WebElement> supplierDropdownList = driver.findElements(ClickingSupplierDropdownForCopyCosting);
			if (!supplierDropdownList.isEmpty() && supplierDropdownList.get(0).isDisplayed()) {
				LoggerUtil.info("✅ Supplier dropdown available — proceeding to select supplier.");

				// Click to open dropdown
				clickOnElement(ClickingSupplierDropdownForCopyCosting);
				Thread.sleep(1000);

				// Fetch all supplier names
				List<WebElement> supplierNames = driver.findElements(SupplierNameForCopyCosting);
				for (WebElement supplier : supplierNames) {
					String supplierText = supplier.getText().trim();
					if (supplierText.equals(EnterSuppliername)) {
						WebElement radioButton = supplier
								.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
						((JavascriptExecutor) driver).executeScript("arguments[0].click();", radioButton);
						LoggerUtil.pass(" Selected supplier (blank entry or matched condition).");
						break;
					}
				}
			}

			Thread.sleep(9000);

			// Use Actions class to ensure stable click on dropdown
			WebElement partDropdown = waitForExpectedElement(clickingPartNumberForSupplierCopyCosting);
			new Actions(driver).moveToElement(partDropdown).click().perform();

			LoggerUtil.info("✅ Clicked on 'Part Number for Supplier Copy Costing' dropdown using Actions class.");

			Thread.sleep(4000);

			// Search part number
			clearAndEnterText(waitForExpectedElement(EnterSearchValueInPartNumberSearchBoxCopyCosting), partnumber);
			LoggerUtil.info("Searching Part Number: " + partnumber);

			// Wait for dropdown rebuild
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
			wait.until(ExpectedConditions.presenceOfAllElementsLocatedBy(By.xpath(
					"//select[@id='ddlmultiplelinenos']/following-sibling::div//button[@style='display: block;']")));

			// Fetch only visible list items
			List<WebElement> optionPartNumbers = driver.findElements(By.xpath(
					"//select[@id='ddlmultiplelinenos']/following-sibling::div//button[@style='display: block;']"));

			boolean partClicked = false;

			for (WebElement option : optionPartNumbers) {
				try {
					WebElement label = option.findElement(By.xpath(".//label"));
					String labelText = label.getText().trim();
					LoggerUtil.info("Found Part Number option: [" + labelText + "]");

					if (labelText.equalsIgnoreCase(partnumber.trim())) {
						try {
							// Locate input preceding label (same structure as your working customer block)
							WebElement checkBox = label.findElement(By.xpath("./preceding-sibling::input"));
							((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", checkBox);
							checkBox.click();
							LoggerUtil.pass("✅ Part Number selected successfully (normal click): " + labelText);
						} catch (Exception e) {
							// JS fallback if standard click fails
							((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", label);
							((JavascriptExecutor) driver).executeScript("arguments[0].click();", label);
							LoggerUtil.pass("✅ Part Number selected successfully (JS click): " + labelText);
						}
						partClicked = true;
						break;
					}

				} catch (Exception ex) {
					LoggerUtil.warn("Skipping entry due to transient structure: " + ex.getMessage());
				}
			}

			if (!partClicked) {
				LoggerUtil.fail("❌ No visible Part Number found matching: " + partnumber);
			}

			clickOnElement(By.xpath("//div[@id='modalCopy']//h5"));
			Thread.sleep(2000);
			clickOnElement(clickingOhpCopyCostingForSupplier);

			WebElement searchBox = waitForExpectedElement(EnterValueSearchBoxForSupplierOhp);
			String ohpValue = DataProp.getProperty("OHP").trim();

			((JavascriptExecutor) driver).executeScript(
					"arguments[0].value = arguments[1].trim();"
							+ "arguments[0].dispatchEvent(new Event('input', { bubbles: true }));",
					searchBox, ohpValue);

			LoggerUtil.info("Entered OHP search value precisely: [" + ohpValue + "]");

			WebDriverWait wait1 = new WebDriverWait(driver, Duration.ofSeconds(10));
			List<WebElement> ohpOptions = wait1.until(ExpectedConditions.presenceOfAllElementsLocatedBy(
					By.xpath("//div[contains(@class,'multiselect-container') and contains(@class,'show')]//label")));

			boolean found = false;
			for (WebElement option : ohpOptions) {
				String optionText = option.getText().trim();

				if (optionText.equalsIgnoreCase(DataProp.getProperty("OHP"))) {
					WebElement radioButton = option.findElement(By.xpath("./preceding-sibling::input[@type='radio']"));
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", radioButton);
					LoggerUtil.pass("Selected OHP option: [" + optionText + "]");
					found = true;
					break;
				}
			}
			if (!found) {
				LoggerUtil.fail("OHP option not found for value: [" + ohpValue + "]");
			}

			Thread.sleep(2000);
			LoggerUtil.info("➡️ Entering Copy button detection block...");

			try {
				By copyButtonsLocator = By.xpath("//div[@class='modal-content']//button[@id='tab2Save']");
				WebDriverWait wait11 = new WebDriverWait(driver, Duration.ofSeconds(15));

				// Wait until button is actually clickable (not just present)
				WebElement copyButton = wait11.until(ExpectedConditions.elementToBeClickable(copyButtonsLocator));

				// Scroll into view and give animation time
				((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", copyButton);
				Thread.sleep(500);

				try {
					// Try normal click first
					copyButton.click();
					LoggerUtil.pass(" Clicked Copy button normally.");
				} catch (Exception e1) {
					// If blocked by overlay, click via JS
					((JavascriptExecutor) driver).executeScript("arguments[0].click();", copyButton);
					LoggerUtil.pass(" Clicked Copy button using JavaScript.");
				}

			} catch (Exception e) {
				LoggerUtil.error(" Failed to click Copy button: " + e.getMessage());
				e.printStackTrace();
			}

			Thread.sleep(1100);
			String ExpectedToastmsg = "Costing data copied successfully";
			String ActualToastmsg = waitForExpectedElement(toastMessage).getText();
			if (ExpectedToastmsg.equals(ActualToastmsg)) {
				LoggerUtil.info("Toast message Matched Successfully.");
			} else {
				LoggerUtil.error("Toast message did not match. Actual: " + ActualToastmsg);
			}

			clickOnElement(clickingCrossButton);
			Thread.sleep(456);

		} catch (Exception e) {
			System.out.println("Element not Found: " + e.getMessage());
		}

	}

	public void VerifyStartValidationBop() throws InterruptedException {

		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("BOP")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'BOP' tab for data verification.");
				break;
			}
		}
		Thread.sleep(1000);

		try {
			// Step 1️⃣: Fetch latest captured BOP data
			Map<String, String> data = getCapturedBopData();
			if (data == null || data.isEmpty()) {
				LoggerUtil.error(" No BOP data available. Run clickAddBopAndVerifyTable() before validation.");
				return;
			}

			LoggerUtil.info(" Starting BOP validation from captured map...");
			LoggerUtil.info("Stored BOP Data: " + getCapturedBopSummaryData());

			// Step 2️⃣: Optional headers to skip when empty
			Set<String> skipIfEmpty = new HashSet<>(
					Arrays.asList("Part No.", "Supply Currency", "Freight & Insurance %", "Landed Cost/Unit"));

			int passCount = 0;
			int warnCount = 0;
			int failCount = 0;

			// Step 3️⃣: Field presence validation
			for (Map.Entry<String, String> entry : data.entrySet()) {
				String header = entry.getKey();
				String value = entry.getValue() == null ? "" : entry.getValue().trim();

				if (value.isEmpty()) {
					if (skipIfEmpty.contains(header)) {
						LoggerUtil.info(" Skipping optional empty field: " + header);
						warnCount++;
					} else {
						LoggerUtil.fail(" Missing value for header: " + header);
						failCount++;
					}
				} else {
					LoggerUtil.pass(" " + header + " → " + value);
					passCount++;
				}
			}

			// Step 4️⃣: Parse numeric fields
			double qtyPerPc = parseDoubleSafe(data.get("Qty/Pc"));
			double partCostPerUnit = parseDoubleSafe(data.get("Part Cost/Unit"));

			double dutiesPct = parseDoubleSafe(data.get("Duties%"));
			double freightPct = parseDoubleSafe(data.get("Freight & Insurance %"));
			double otherCost = parseDoubleSafe(data.get("Other Cost"));
			double bopHandlingPct = parseDoubleSafe(data.get("BOP Handling%"));
			double subTotalUI = parseDoubleSafe(data.get("Sub Total"));
			double totalCostUI = parseDoubleSafe(data.get("Total Cost"));

			// Step 5️⃣: Sub Total validation (Qty × Cost)
			double expectedSubTotal = round(qtyPerPc * partCostPerUnit, 6);
			if (almostEqual(subTotalUI, expectedSubTotal, 0.001)) {
				LoggerUtil.pass(" Sub Total check passed. Expected: " + expectedSubTotal + " | Actual: " + subTotalUI);
			} else {
				LoggerUtil.fail(" Sub Total check failed. Expected: " + expectedSubTotal + " | Actual: " + subTotalUI);
				failCount++;
			}

			// Step 6️⃣: Compute expected Total Cost
			double expectedTotal = subTotalUI;
			if (!Double.isNaN(dutiesPct) && dutiesPct != 0.0)
				expectedTotal += subTotalUI * (dutiesPct / 100.0);
			if (!Double.isNaN(freightPct) && freightPct != 0.0)
				expectedTotal += subTotalUI * (freightPct / 100.0);
			if (!Double.isNaN(otherCost) && otherCost != 0.0)
				expectedTotal += otherCost;
			if (!Double.isNaN(bopHandlingPct) && bopHandlingPct != 0.0)
				expectedTotal += subTotalUI * (bopHandlingPct / 100.0);

			expectedTotal = round(expectedTotal, 6);

			if (almostEqual(totalCostUI, expectedTotal, 0.001)) {
				LoggerUtil.pass(" Total Cost check passed. Expected: " + expectedTotal + " | Actual: " + totalCostUI);
			} else {
				LoggerUtil.fail(" Total Cost check failed. Expected: " + expectedTotal + " | Actual: " + totalCostUI);
				failCount++;
			}

			// Step 7️⃣: Final Summary with Tab Context
			LoggerUtil.info("------------------------------------------------------");
			LoggerUtil.info("[Tab: BOP Table] → Summary → Total Headers: " + data.size() + " | Passed: " + passCount
					+ " | Warnings: " + warnCount + " | Failed: " + failCount);
			LoggerUtil.info("------------------------------------------------------");

			if (failCount == 0) {
				LoggerUtil.pass("✅ BOP Table validation completed successfully.");
			} else {
				LoggerUtil.error("❌ BOP Table validation completed with " + failCount + " failure(s).");
			}

			// List of skipped fields (to display under warning)
			List<String> skippedFields = new ArrayList<>();

			for (Map.Entry<String, String> entry : data.entrySet()) {
				String header = entry.getKey();
				String value = entry.getValue() == null ? "" : entry.getValue().trim();
				if (value.isEmpty() && skipIfEmpty.contains(header)) {
					skippedFields.add(header);
				}
			}

			String warningDetails = skippedFields.isEmpty() ? "None"
					: String.join(", ", skippedFields) + " → Empty but optional fields skipped (hence warnings).";

			LoggerUtil.info("[Tab: BOP Table] → Summary → Total Headers: " + data.size() + " | Passed: " + passCount
					+ " | Warnings: " + warnCount + " | Failed: " + failCount);

			LoggerUtil.info("⚠️ Warning Reason → " + warningDetails);
			LoggerUtil.info("------------------------------------------------------");

		} catch (Exception ex) {
			LoggerUtil.error(" Exception in VerifyStartValidationBop(): " + ex.getMessage());
		}
	}

	public static final By FetchingPartnoPackagingAndTransportaion = By
			.xpath("//form[@id='frm_Packaging']/descendant::lable[normalize-space(text())='Part No']");
	public static final By FetchingDataPackagingAndTransportaion = By
			.xpath("//form[@id='frm_Packaging']/descendant::label[normalize-space(text())='Company Name -Code']");
	public static final By FetchingPartDescriptionDataPackagingAndTransportaion = By
			.xpath("//form[@id='frm_Packaging']/descendant::label[normalize-space(text())='Part Description']");

	// form[@id='frm_Packaging']/descendant::lable[normalize-space(text())='Part
	// No']/parent::div/following-sibling::div/input[@id='tpPartNo']
	public void VerifyValidationPackagingAndTransportationTab(String partNumber, String partdescription) {
		LoggerUtil.info("===== Starting Validation for [Packaging and Transportation] Tab =====");

		try {
			// Step 1️⃣: Navigate to Packaging & Transportation tab
			boolean tabFound = false;
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Packaging and Transportation")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Packaging and Transportation' tab successfully.");
					tabFound = true;
					break;
				}
			}
			if (!tabFound) {
				LoggerUtil.fail("Tab 'Packaging and Transportation' not found in the current screen.");
				return;
			}

			// Step 2️⃣: Validate 'Part No' label and value
			WebElement partNoLabel = waitForExpectedElement(FetchingPartnoPackagingAndTransportaion);
			if (partNoLabel == null) {
				LoggerUtil.fail("Label 'Part No' not found in Packaging and Transportation tab.");
			} else {
				String labelText = partNoLabel.getText().trim();
				if (labelText.equals("Part No")) {
					WebElement inputField = partNoLabel
							.findElement(By.xpath("./parent::div/following-sibling::div/input"));
					String actualPartNumber = inputField.getAttribute("value").trim();

					if (actualPartNumber.equals(partNumber)) {
						LoggerUtil.pass("Part Number matched successfully. [Expected: " + partNumber + " | Actual: "
								+ actualPartNumber + "]");
					} else {
						LoggerUtil.fail("Part Number mismatch detected. [Expected: " + partNumber + " | Actual: "
								+ actualPartNumber + "]");
					}
				} else {
					LoggerUtil.error("Unexpected label found instead of 'Part No': " + labelText);
				}
			}

			// Step 3️⃣: Validate 'Company Name -Code'
			boolean companyLabelFound = false;
			List<WebElement> allLabels = driver.findElements(FetchingDataPackagingAndTransportaion);
			for (WebElement label : allLabels) {
				String labelText = label.getText().trim();
				if (labelText.equals("Company Name -Code")) {
					companyLabelFound = true;
					WebElement inputField = label.findElement(By.xpath("./parent::div/following-sibling::div/input"));
					String actualCompanyValue = inputField.getAttribute("value").trim();
					String expectedCompanyValue = DataProp.getProperty("CompanyNamePartMaster");

					if (actualCompanyValue.equals(expectedCompanyValue)) {
						LoggerUtil.pass("CompanyName Name and Code matched. [Expected: " + expectedCompanyValue
								+ " | Actual: " + actualCompanyValue + "]");
					} else {
						LoggerUtil.error("CompanyName Name and Code mismatch. [Expected: " + expectedCompanyValue
								+ " | Actual: " + actualCompanyValue + "]");
					}
					break;
				}
			}
			if (!companyLabelFound) {
				LoggerUtil.fail("Label 'Company Name -Code' not found in Packaging and Transportation tab.");
			}

			// Step 4️⃣: Validate 'Part Description'
			WebElement descLabel = waitForExpectedElement(FetchingPartDescriptionDataPackagingAndTransportaion);
			if (descLabel == null) {
				LoggerUtil.fail("Label 'Part Description' not found in Packaging and Transportation tab.");
			} else {
				String descLabelText = descLabel.getText().trim();
				if (descLabelText.equals("Part Description")) {
					WebElement inputField = descLabel
							.findElement(By.xpath("./parent::div/following-sibling::div/input"));
					String actualPartDescription = inputField.getAttribute("value").trim();

					if (actualPartDescription.equals(partdescription)) {
						LoggerUtil.pass("Part Description matched successfully. [Expected: " + partdescription
								+ " | Actual: " + actualPartDescription + "]");
					} else {
						LoggerUtil.error("Part Description mismatch. [Expected: " + partdescription + " | Actual: "
								+ actualPartDescription + "]");
					}
				} else {
					LoggerUtil.error("Unexpected label found instead of 'Part Description': " + descLabelText);
				}
			}

			LoggerUtil.info("===== Completed Validation for [Packaging and Transportation] Tab =====");

		} catch (Exception e) {
			LoggerUtil.error("Exception occurred during Packaging and Transportation validation: " + e.getMessage());
			LoggerUtil.logException(e);
		}
	}

	/** Safe numeric parse. Returns NaN when null/blank/non-numeric. */
	private double parseDoubleSafe(String s) {
		try {
			if (s == null)
				return Double.NaN;
			s = s.trim();
			if (s.isEmpty())
				return Double.NaN;
			return Double.parseDouble(s);
		} catch (Exception e) {
			return Double.NaN;
		}
	}

	/** Tolerance-based equality for doubles. */
	private boolean almostEqual(double a, double b, double eps) {
		return Math.abs(a - b) <= eps;
	}

	/** Rounding helper for logging/consistency. */
	private double round(double v, int scale) {
		BigDecimal bd = new BigDecimal(Double.toString(v));
		bd = bd.setScale(scale, RoundingMode.HALF_UP);
		return bd.doubleValue();
	}

	public static final By FetchingNameFromButtonsToolingCost = By.xpath("//button[@id='btnAddToolingCost']");
	public static final By ReaderHeaderNamesFromToolingTable = By.xpath("//table[@id='tableToolingCost']/thead/tr/th");

	// Class-level field to store last entered Tooling Cost data for validation use
	// Class-level field (as you already have)
	private static HashMap<String, String> storedToolingCostData = new HashMap<>();

	public HashMap<String, String> EnterToolingCost(String partNumber) throws InterruptedException {

		LoggerUtil.info("===== Filling Tooling Cost Form for Part: " + partNumber + " =====");

		JavascriptExecutor js = (JavascriptExecutor) driver;
		HashMap<String, String> toolingData = new HashMap<>();

		try {
			Thread.sleep(1500);

			// ------------------------------------------
			// 1) Navigate to Tooling Cost Tab
			// ------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Tooling Cost")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to Tooling Cost tab.");
					break;
				}
			}

			Thread.sleep(2000);

			// =====================================================
			// 🔥 HARD GUARD — STOP IF TOOLING TAB NOT READY
			// =====================================================
			if (!validateToolingCostTabReady()) {
				LoggerUtil.error("❌ Aborting EnterToolingCost due to Tooling Cost tab not ready.");
				return toolingData;
			}

			// ------------------------------------------
			// 2) Click ADD New Row
			// ------------------------------------------
			WebElement addButton = waitForExpectedElement(By.xpath("//button[contains(text(),' Add Tool')]"));

			js.executeScript("arguments[0].scrollIntoView(true);", addButton);
			addButton.click();
			LoggerUtil.pass("Clicked Add New Tooling Row button.");

			Thread.sleep(1500);

			// ------------------------------------------
			// 3) Dropdown + Input Fields
			// ------------------------------------------

			selectDropdownById("ToolPartNodrp", "Manual Entry", "Tool Number");
			toolingData.put("ToolPartNodrp", "Manual Entry");
			Thread.sleep(2000);

			enterTextById("ToolPartNo", "12345", "Enter Tool No.");
			toolingData.put("ToolPartNo", "12345");
			Thread.sleep(2000);

			enterTextById("ToolDesc", "Automation Tool Description", "Tool Description");
			toolingData.put("ToolDesc", "Automation Tool Description");
			Thread.sleep(2000);

			selectDropdownById("SupplierToolfor", "0801-Celesta", "Supplier Name & Code");
			toolingData.put("SupplierToolfor", "0801-Celesta");
			Thread.sleep(2000);

			selectDropdownById("Toolowinership", "Customer Paid", "Tool Ownership");
			toolingData.put("Toolowinership", "Customer Paid");
			Thread.sleep(2000);

			selectDropdownById("ToolType", "Carbide tool", "Tool Type");
			toolingData.put("ToolType", "Carbide tool");
			Thread.sleep(2000);

			// ------------------------------------------
			// 4) Envelope dimensions
			// ------------------------------------------
			enterTextById("PartEnvelopeLength", "25.50", "Part Envelope Length");
			toolingData.put("PartEnvelopeLength", "25.50");
			Thread.sleep(2000);

			enterTextById("PartEnvelopeWidth", "12.10", "Part Envelope Width");
			toolingData.put("PartEnvelopeWidth", "12.10");
			Thread.sleep(2000);

			enterTextById("PartEnvelopeHeight", "5.30", "Part Envelope Height");
			toolingData.put("PartEnvelopeHeight", "5.30");
			Thread.sleep(2000);

			// ------------------------------------------
			// 5) Newly Added Fields
			// ------------------------------------------
			enterTextById("SettledToolCost", "500000", "Settled Tool Cost");
			toolingData.put("SettledToolCost", "500000");
			Thread.sleep(2000);

			enterTextById("ToolAdvance", "100000", "Tool Advance");
			toolingData.put("ToolAdvance", "100000");
			Thread.sleep(2000);

			enterTextById("FirstYrVolume", "20000", "First Year Volume");
			toolingData.put("FirstYrVolume", "20000");
			Thread.sleep(2000);

			enterTextById("SecondYrVolume", "18000", "Second Year Volume");
			toolingData.put("SecondYrVolume", "18000");
			Thread.sleep(2000);

			enterTextById("ThirdYrVolume", "15000", "Third Year Volume");
			toolingData.put("ThirdYrVolume", "15000");
			Thread.sleep(2000);

			enterTextById("FourthYrVolume", "12000", "Fourth Year Volume");
			toolingData.put("FourthYrVolume", "12000");
			Thread.sleep(2000);

			enterTextById("FifthYrVolume", "10000", "Fifth Year Volume");
			toolingData.put("FifthYrVolume", "10000");
			Thread.sleep(2000);

			enterTextById("Toollife", "tool-101", "Tool Life");
			toolingData.put("Toollife", "tool-101");

			LoggerUtil.pass("🎉 All Tooling Cost fields entered successfully!");

			// =============================================
			// SAVE & TOAST
			// =============================================
			try {
				LoggerUtil.info("Attempting to click Save button in Tooling Cost tab...");

				WebElement saveBtn = waitForExpectedElement(By.id("btnSaveToolingCost"));
				js.executeScript("arguments[0].scrollIntoView(true);", saveBtn);
				saveBtn.click();
				LoggerUtil.pass("Clicked Save button successfully.");

				WebElement toast = waitForExpectedElement(By.xpath("//div[contains(@class,'toast-message')]"));

				String toastMsg = toast.getText().trim();
				LoggerUtil.pass("Toast Message Displayed: " + toastMsg);
				Thread.sleep(5000);

			} catch (Exception e) {
				LoggerUtil.error("❌ Error while clicking Save or reading toast → " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ EnterToolingCost Failed → " + e.getMessage());
		}

		storedToolingCostData = new HashMap<>(toolingData);
		return toolingData;
	}

	private boolean validateToolingCostTabReady() {

		try {
			// 1️⃣ Check Tooling Cost tab header
			By toolingHeader = By.xpath("//h3[contains(text(),'Tooling Cost')]");
			WebElement header = Base.waitForExpectedElement(toolingHeader);

			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ Tooling Cost header NOT visible.");
				return false;
			}
			LoggerUtil.pass("✔ Tooling Cost header visible.");

			// 2️⃣ Check Add Tool button existence + visibility
			By addToolBtn = By.xpath("//button[contains(text(),' Add Tool')]");

			List<WebElement> buttons = driver.findElements(addToolBtn);
			if (buttons.isEmpty()) {
				LoggerUtil.error("❌ Add Tool button NOT present in DOM.");
				return false;
			}

			if (!buttons.get(0).isDisplayed()) {
				LoggerUtil.error("❌ Add Tool button present but NOT visible.");
				return false;
			}

			LoggerUtil.pass("✔ Add Tool button visible.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ Tooling Cost readiness check failed → " + e.getMessage());
			return false;
		}
	}

	public static final By ClickingSaveButtonToolCostTabFor = By.id("btnSaveToolingCost");

	public void selectSupplierSelect2(String selectId, String visibleText) {
		try {
			JavascriptExecutor js = (JavascriptExecutor) driver;

			// CLICK on select2 box
			WebElement box = driver.findElement(By.xpath("//select[@id='" + selectId + "']/following-sibling::span"));
			js.executeScript("arguments[0].click();", box);

			Thread.sleep(500);

			// TYPE in search box
			WebElement search = driver.findElement(By.xpath("//input[@class='select2-search__field']"));
			search.sendKeys(visibleText);
			Thread.sleep(1000);

			// CLICK matching item
			WebElement option = driver.findElement(
					By.xpath("//li[contains(@class,'select2-results__option') and text()='" + visibleText + "']"));
			js.executeScript("arguments[0].click();", option);

			LoggerUtil.pass("Selected Supplier: " + visibleText);

		} catch (Exception e) {
			LoggerUtil.error("❌ Supplier Select2 failed → " + e.getMessage());
		}
	}

	public void enterTextById(String id, String value, String fieldName) {
		try {
			WebElement el = new WebDriverWait(driver, Duration.ofSeconds(15))
					.until(ExpectedConditions.visibilityOfElementLocated(By.id(id)));

			el.click();
			el.clear();
			el.sendKeys(value);

			LoggerUtil.pass("✔ Entered [" + value + "] in " + fieldName);
		} catch (Exception e) {
			LoggerUtil.error("❌ Error entering value for [" + fieldName + "] → " + e.getMessage());
		}
	}

	public void selectDropdownById(String id, String value, String fieldName) {
		try {
			WebElement dropdown = new WebDriverWait(driver, Duration.ofSeconds(15))
					.until(ExpectedConditions.visibilityOfElementLocated(By.id(id)));

			Select sel = new Select(dropdown);
			sel.selectByVisibleText(value);

			LoggerUtil.pass("✔ Selected dropdown [" + fieldName + "] = " + value);
		} catch (Exception e) {
			LoggerUtil.error("❌ Error selecting dropdown for [" + fieldName + "] → " + e.getMessage());
		}
	}

	// 🔥 Mapping of Header Name → Input Field ID
	private Map<String, String> headerToInputId = new HashMap<>();

	// static initializer OR constructor mei load kar sakte ho
	{
		headerToInputId.put("Tool No.", "ToolPartNodrp");
		headerToInputId.put("Enter Tool No.", "ToolPartNo");
		headerToInputId.put("Tool Description", "ToolDesc");
		headerToInputId.put("Supplier Name and Code", "SupplierToolfor");
		headerToInputId.put("Tool Owner ship", "Toolowinership");
		headerToInputId.put("Tool Start Date", "ToolStartdate");
		headerToInputId.put("Tool Type", "ToolType");
		headerToInputId.put("Part Envelope Length(mm)", "PartEnvelopeLength");
		headerToInputId.put("Part Envelope Width(mm)", "PartEnvelopeWidth");
		headerToInputId.put("Part Envelope Height(mm)", "PartEnvelopeHeight");
		headerToInputId.put("Tool Size Length(mm)", "ToolSizeLength");
		headerToInputId.put("Tool Size Width(mm)", "ToolSizeWidth");
		headerToInputId.put("Tool Size Height(mm)", "ToolSizeHeight");
		headerToInputId.put("Tool Material", "ToolMaterial");
		headerToInputId.put("Tool Material Denstiy", "ToolMaterialDensity");
		headerToInputId.put("Tool Envelope Weight", "ToolEnvelopeWt");
		headerToInputId.put("Tool WeightFactor", "ToolWtFactor");
		headerToInputId.put("Tool Weight(Kg)", "ToolWt");
		headerToInputId.put("Tool Rate", "ToolTypeRatepull");
		headerToInputId.put("Tool Cost", "txtToolCost");
		headerToInputId.put("Additional cost", "txtToolDelta");
		headerToInputId.put("Remarks", "txtToolRemarks");
		headerToInputId.put("Tool Cost Direct Entry", "ToolCostDirectEntry");
		headerToInputId.put("Settled Tool Cost", "SettledToolCost");
		headerToInputId.put("Tool Advance", "ToolAdvance");
		headerToInputId.put("Amortization Amount", "AmtAmount");
		headerToInputId.put("Supply Tenure Months", "SupplyTenureMonths");
		headerToInputId.put("Annual Interest Factor", "AnInterestFactor");
		headerToInputId.put("First Year Volume", "FirstYrVolume");
		headerToInputId.put("Second Year Volume", "SecondYrVolume");
		headerToInputId.put("Third Year Volume", "ThirdYrVolume");
		headerToInputId.put("Fourth Year Volume", "FourthYrVolume");
		headerToInputId.put("Fifth Year Volume", "FifthYrVolume");
		headerToInputId.put("Amortization Quantity", "AmtQuantity");
		headerToInputId.put("Amortization/PC", "AmortizationPC");
		headerToInputId.put("No of Parts Per Tool", "PartPerTool");
		headerToInputId.put("Second Applicable Part No.", "PartNo185");
		headerToInputId.put("Part Description", "partdesc");
		headerToInputId.put("Final Amortization/PC", "FinalAmortizationPC");
		headerToInputId.put("Tool Life", "Toollife");
		headerToInputId.put("Remarks-Last", "Remarks");

	}

	private void EnterValueInToolingCostTable(String columnName, String valueToEnter) throws InterruptedException {

		// Mapping header → correct HTML input/select ID
		Map<String, String> headerToInputId = new HashMap<>();

		// --- DROPDOWN FIELDS ---
		headerToInputId.put("Tool No.", "ToolPartNodrp"); // Select dropdown
		headerToInputId.put("Supplier Name and Code", "SupplierTool"); // Select dropdown
		headerToInputId.put("Tool Owner ship", "Ownership"); // Select dropdown
		headerToInputId.put("Tool Type", "ToolType"); // Select dropdown

		// --- INPUT FIELDS ---
		headerToInputId.put("Enter Tool No.", "ToolNo");
		headerToInputId.put("Tool Description", "ToolDescription");

		headerToInputId.put("Part Envelope Length(mm)", "PEL");
		headerToInputId.put("Part Envelope Width(mm)", "PEW");
		headerToInputId.put("Part Envelope Height(mm)", "PEH");

		headerToInputId.put("Tool Cost", "ToolCost");
		headerToInputId.put("Additional cost", "AdditionalCost");

		headerToInputId.put("Settled Tool Cost", "SettledToolCost");
		headerToInputId.put("Tool Advance", "ToolAdvance");

		headerToInputId.put("First Year Volume", "FirstYearVolume");
		headerToInputId.put("Second Year Volume", "SecondYearVolume");
		headerToInputId.put("Third Year Volume", "ThirdYearVolume");
		headerToInputId.put("Fourth Year Volume", "FourthYearVolume");
		headerToInputId.put("Fifth Year Volume", "FifthYearVolume");

		// Validate that mapping exists
		if (!headerToInputId.containsKey(columnName)) {
			LoggerUtil.error("❌ No Input ID found for Header: " + columnName);
			return;
		}

		String inputId = headerToInputId.get(columnName);
		WebElement element = null;

		try {
			element = waitForExpectedElement(By.id(inputId));

			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", element);
			Thread.sleep(300);

			String tagName = element.getTagName().toLowerCase();

			if (tagName.equals("select")) {
				// Dropdown handling
				new Select(element).selectByVisibleText(valueToEnter);
				LoggerUtil.pass("✔ Selected dropdown [" + columnName + "] = " + valueToEnter);
			} else {
				// Input textbox handling
				element.clear();
				element.sendKeys(valueToEnter);
				element.sendKeys(Keys.TAB);
				LoggerUtil.pass("✔ Entered text [" + columnName + "] = " + valueToEnter);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Error entering value for [" + columnName + "] → " + e.getMessage());
		}
	}

	public void enterValueByHeader(String headerName, String value) {
		try {
			String inputId = headerToInputId.get(headerName);

			if (inputId == null) {
				LoggerUtil.error("❌ No input mapping found for header: " + headerName);
				return;
			}

			WebElement element = waitForExpectedElement(By.id(inputId));
			element.clear();
			element.sendKeys(value);

			LoggerUtil.pass("Entered value '" + value + "' in header '" + headerName + "'");
		} catch (Exception e) {
			LoggerUtil.error("❌ Could not enter value for header: " + headerName + " → " + e.getMessage());
		}
	}

	/**
	 * Getter method for retrieving the last entered Tooling Cost data. Can be used
	 * inside validation methods.
	 */
	public static HashMap<String, String> getStoredToolingCostData() {
		return new HashMap<>(storedToolingCostData);
	}

	// 🔵 Mapping: Internal MAP keys → UI Table column headers
	private static final Map<String, String> TOOLING_HEADER_MAP = new HashMap<>();
	static {

		TOOLING_HEADER_MAP.put("ToolPartNo", "Enter Tool No.");
		TOOLING_HEADER_MAP.put("ToolDesc", "Tool Description");

		TOOLING_HEADER_MAP.put("PartEnvelopeLength", "Part Envelope Length(mm)");
		TOOLING_HEADER_MAP.put("PartEnvelopeWidth", "Part Envelope Width(mm)");
		TOOLING_HEADER_MAP.put("PartEnvelopeHeight", "Part Envelope Height(mm)");

		TOOLING_HEADER_MAP.put("ToolCost", "Tool Cost");
		TOOLING_HEADER_MAP.put("AdditionalCost", "Additional cost");
		TOOLING_HEADER_MAP.put("TotalToolCost", "Total Tool Cost");

		TOOLING_HEADER_MAP.put("SettledToolCost", "Settled Tool Cost");
		TOOLING_HEADER_MAP.put("ToolAdvance", "Tool Advance");

		TOOLING_HEADER_MAP.put("FirstYrVolume", "First Year Volume");
		TOOLING_HEADER_MAP.put("SecondYrVolume", "Second Year Volume");
		TOOLING_HEADER_MAP.put("ThirdYrVolume", "Third Year Volume");
		TOOLING_HEADER_MAP.put("FourthYrVolume", "Fourth Year Volume");
		TOOLING_HEADER_MAP.put("FifthYrVolume", "Fifth Year Volume");
	}

	private boolean validateToolingCostTableReady() {

		try {

			// 1️⃣ Verify Tooling Cost header
			By toolingHeadingLocator = By.xpath("//h3[contains(text(),'Tooling Cost')]");

			WebElement header = Base.waitForExpectedElement(toolingHeadingLocator);
			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ Tooling Cost header NOT visible.");
				return false;
			}
			LoggerUtil.pass("✔ Tooling Cost header visible.");

			// 2️⃣ Verify table body present
			List<WebElement> rows = driver.findElements(By.xpath("//table[@id='tableToolingCost']/tbody/tr"));

			if (rows.isEmpty()) {
				LoggerUtil.error("❌ Tooling Cost table loaded but NO rows present.");
				return false;
			}

			// 3️⃣ Verify first row visible
			if (!rows.get(0).isDisplayed()) {
				LoggerUtil.error("❌ Tooling Cost first row NOT visible.");
				return false;
			}

			LoggerUtil.pass("✔ Tooling Cost table & first row ready.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ Tooling Cost readiness check failed → " + e.getMessage());
			return false;
		}
	}

	public void VerifyToolingCostValidation() throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info(" VALIDATION STARTED: [Tooling Cost Section]");
		LoggerUtil.info("==============================================");

		// -------------------------------------------------
		// Navigate again to Tooling Cost tab
		// -------------------------------------------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Tooling Cost")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Tooling Cost' tab for verification.");
				break;
			}
		}

		// -------------------------------------------------
		// ✅ PAGE / TABLE READINESS CHECK (MANDATORY)
		// -------------------------------------------------
		if (!validateToolingCostTableReady()) {
			LoggerUtil.fail("❌ Tooling Cost page NOT ready. Validation aborted.");
			return;
		}

		try {

			JavascriptExecutor js = (JavascriptExecutor) driver;

			// -------------------------------------------------
			// FETCH STORED VALUES
			// -------------------------------------------------
			HashMap<String, String> expected = getStoredToolingCostData();

			if (expected == null || expected.isEmpty()) {
				LoggerUtil.warn("⚠ No stored Tooling Cost data found to validate. Run EnterToolingCost() first.");
				return;
			}

			LoggerUtil.info("🔍 Starting validation for " + expected.size() + " Tooling Cost fields...");

			// -------------------------------------------------
			// HEADER NORMALIZATION MAP
			// -------------------------------------------------
			HashMap<String, String> headerMap = new HashMap<>();

			headerMap.put("ToolPartNodrp", "Tool No.");
			headerMap.put("ToolPartNo", "Enter Tool No.");
			headerMap.put("ToolDesc", "Tool Description");

			headerMap.put("SupplierToolfor", "Supplier Name and Code");
			headerMap.put("Toolowinership", "Tool Owner ship");
			headerMap.put("ToolType", "Tool Type");

			headerMap.put("PartEnvelopeLength", "Part Envelope Length(mm)");
			headerMap.put("PartEnvelopeWidth", "Part Envelope Width(mm)");
			headerMap.put("PartEnvelopeHeight", "Part Envelope Height(mm)");

			headerMap.put("SettledToolCost", "Settled Tool Cost");
			headerMap.put("ToolAdvance", "Tool Advance");

			headerMap.put("FirstYrVolume", "First Year Volume");
			headerMap.put("SecondYrVolume", "Second Year Volume");
			headerMap.put("ThirdYrVolume", "Third Year Volume");
			headerMap.put("FourthYrVolume", "Fourth Year Volume");
			headerMap.put("FifthYrVolume", "Fifth Year Volume");

			headerMap.put("Toollife", "Tool Life");

			// -------------------------------------------------
			// VALIDATION LOOP
			// -------------------------------------------------
			int pass = 0, fail = 0, warn = 0;

			for (Map.Entry<String, String> entry : expected.entrySet()) {

				String key = entry.getKey().trim();
				String expectedValue = entry.getValue().trim();

				if (!headerMap.containsKey(key)) {
					LoggerUtil.warn("⚠ Header not mapped for key: " + key);
					warn++;
					continue;
				}

				String tableHeader = headerMap.get(key);

				try {

					// 1️⃣ Find Column Index
					List<WebElement> headers = driver.findElements(By.xpath("//table[@id='tableToolingCost']//th"));

					int colIndex = -1;
					for (int i = 0; i < headers.size(); i++) {
						String h = headers.get(i).getText().trim().replace("\u00A0", "");
						if (h.equalsIgnoreCase(tableHeader)) {
							colIndex = i + 1;
							break;
						}
					}

					if (colIndex == -1) {
						LoggerUtil.warn("⚠ Column not found in UI for header: " + tableHeader);
						warn++;
						continue;
					}

					// 2️⃣ Read Actual Cell Value
					WebElement cell = driver.findElement(
							By.xpath("//table[@id='tableToolingCost']/tbody/tr[last()]/td[" + colIndex + "]"));

					js.executeScript("arguments[0].scrollIntoView({block:'center'});", cell);

					String actualValue;
					if (!cell.findElements(By.tagName("input")).isEmpty()) {
						actualValue = cell.findElement(By.tagName("input")).getAttribute("value").trim();
					} else if (!cell.findElements(By.tagName("select")).isEmpty()) {
						Select s = new Select(cell.findElement(By.tagName("select")));
						actualValue = s.getFirstSelectedOption().getText().trim();
					} else {
						actualValue = cell.getText().trim();
					}

					actualValue = actualValue.replace(",", "").trim();
					expectedValue = expectedValue.replace(";", "").trim();

					// 3️⃣ Compare
					if (actualValue.equalsIgnoreCase(expectedValue)) {
						LoggerUtil.pass("PASS: [" + tableHeader + "] Expected = " + expectedValue + " | Actual = "
								+ actualValue);
						pass++;
					} else {
						LoggerUtil.fail("FAIL: [" + tableHeader + "] Expected = " + expectedValue + " | Actual = "
								+ actualValue);
						fail++;
					}

				} catch (Exception ex) {
					LoggerUtil.error("❌ Error validating " + tableHeader + " → " + ex.getMessage());
					fail++;
				}
			}

			// -------------------------------------------------
			// SUMMARY
			// -------------------------------------------------
			LoggerUtil.info("==============================================");
			LoggerUtil.info(" VALIDATION SUMMARY");
			LoggerUtil.info("==============================================");
			LoggerUtil.info(" Checked  : " + expected.size());
			LoggerUtil.info(" Passed   : " + pass);
			LoggerUtil.info(" Failed   : " + fail);
			LoggerUtil.info(" Warnings : " + warn);
			LoggerUtil.info("==============================================");

			if (fail > 0) {
				LoggerUtil.fail("❌ Validation completed with " + fail + " mismatches.");
			} else {
				LoggerUtil.pass("✅ All Tooling Cost values validated successfully!");
			}

		} catch (Exception e) {
			LoggerUtil.fail("Validation failed: " + e.getMessage());
			LoggerUtil.logException(e);
		}
	}

////////////////////////////////////////////////////////////////////////////////////////
///
///
///
///Supplier Side Copy Costing
///
///
////////////////////////////////////////////////////////////////////////////////////////////
	// ===================== Helpers =====================
	private By TBL_HEADERS = By.xpath("//table[@id='modelTable']/thead/tr/th");
	private By TBL_ROWS = By.xpath("//table[@id='modelTable']/tbody/tr");

	private Map<String, Integer> buildHeaderIndex() throws InterruptedException {
		int maxRetries = 3;

		for (int retry = 0; retry < maxRetries; retry++) {
			try {
				List<WebElement> ths = driver.findElements(TBL_HEADERS);

				Map<String, Integer> idx = new LinkedHashMap<>();

				for (int i = 0; i < ths.size(); i++) {
					idx.put(ths.get(i).getText().trim(), i); // this line used to throw stale
				}

				return idx; // success
			} catch (StaleElementReferenceException ex) {
				LoggerUtil.warn("⚠ Header stale — retry " + (retry + 1));
				Thread.sleep(400);
			}
		}

		LoggerUtil.error("❌ Failed to read table headers after retries.");
		return new LinkedHashMap<>();
	}

	private String cellText(WebElement row, int columnIndex) throws InterruptedException {
		int retries = 3;
		for (int r = 0; r < retries; r++) {
			try {
				return row.findElements(By.tagName("td")).get(columnIndex).getText().trim();
			} catch (StaleElementReferenceException ex) {
				LoggerUtil.warn("⚠ Cell stale — retry " + (r + 1));
				Thread.sleep(300);
			}
		}
		return "";
	}

	private boolean equalsRelaxed(String header, String exp, String act) {
		if (exp == null)
			exp = "";
		if (act == null)
			act = "";
		if (header.equalsIgnoreCase("Company Name") || header.equalsIgnoreCase("Customer")) {
			String ne = exp.replace('\u00A0', ' ').replaceAll("\\s+", " ").trim().toLowerCase();
			String na = act.replace('\u00A0', ' ').replaceAll("\\s+", " ").trim().toLowerCase();
			return ne.equals(na) || ne.contains(na) || na.contains(ne);
		}
		return exp.trim().equalsIgnoreCase(act.trim());
	}

	private void clickFirstNonEmptySupplierCell(WebElement matchedRow, List<String> headerNames) {
		List<WebElement> tds = matchedRow.findElements(By.tagName("td"));
		for (int i = 0; i < headerNames.size() && i < tds.size(); i++) {
			String h = headerNames.get(i);
			if (h.startsWith("Supplier Detail")) {
				WebElement cell = tds.get(i);
				String txt = cell.getText().trim();
				if (!txt.isEmpty()) {
					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});", cell);
					try {
						try {
							cell.click();
						} catch (Exception e) {
							((JavascriptExecutor) driver).executeScript("arguments[0].click();", cell);
						}
						LoggerUtil.pass("🟢 Clicked Supplier cell → " + txt);
					} catch (Exception e) {
						LoggerUtil.warn("Supplier cell present but not clickable. Reason: " + e.getMessage());
					}
					return;
				}
			}
		}
		LoggerUtil.warn("No non-empty 'Supplier Detail' cell found to click.");
	}

	// ===================== Main (use after your search) =====================
	public void verifyRowByHeaderAndClickSupplier(String partNumber, String partDescription) {
		try {
			LoggerUtil.info("==============================================");
			LoggerUtil.info(" [View Table Part Master For Supplier Name By Supplier Header Coloumn]");
			LoggerUtil.info("==============================================");

			// Step 1️⃣: Build header index
			Map<String, Integer> headerIdx = buildHeaderIndex();
			if (headerIdx.isEmpty()) {
				LoggerUtil.fail("No table headers found for #modelTable.");
				return;
			}

			List<String> headerNames = new ArrayList<>(headerIdx.keySet());
			LoggerUtil.info("✅ Total Headers Found: " + headerNames.size());
			LoggerUtil.info("Headers → " + headerNames);

			// Step 2️⃣: Expected values (based on header mapping)
			LinkedHashMap<String, String> expected = new LinkedHashMap<>();
			expected.put("Company Name", DataProp.getProperty("CompanyNamePartMaster"));
			expected.put("Part No.", partNumber);
			expected.put("Part Description", partDescription);
			expected.put("Part UOM", "Hourly");
			expected.put("Product Category", "rishi");
			expected.put("Product Model Name and No.", DataProp.getProperty("ProductModelName&No.PartMaster"));
			expected.put("Special Product Category", "ACCESSORIES");
			expected.put("Customer", DataProp.getProperty("CustomerNamePartMaster"));
			expected.put("Supplier Detail 1", DataProp.getProperty("SupplierNamePartMaster")); // ✅ Supplier validation

			LoggerUtil.info("🧩 Validation Targets → " + expected.keySet());

			// Step 3️⃣: Fetch rows
			List<WebElement> rows = driver.findElements(TBL_ROWS);
			if (rows.isEmpty()) {
				LoggerUtil.fail("❌ No rows found in the table after filtering.");
				return;
			}

			WebElement matchedRow = null;
			for (WebElement row : rows) {
				boolean partMatch = false;
				boolean supplierMatch = false;

				// Fetch current Part No. from this row
				Integer partColIndex = headerIdx.get("Part No.");
				if (partColIndex != null) {
					String actualPart = cellText(row, partColIndex);
					if (actualPart.equalsIgnoreCase(partNumber)) {
						partMatch = true;
					}
				}

				if (!partMatch) {
					continue; // Skip this row if part number doesn’t match
				}

				// Validate other headers (soft)
				for (Map.Entry<String, String> entry : expected.entrySet()) {
					String header = entry.getKey();
					String expectedVal = entry.getValue();
					Integer colIndex = headerIdx.get(header);
					if (colIndex == null)
						continue;

					String actualVal = cellText(row, colIndex);

					if (equalsRelaxed(header, expectedVal, actualVal)) {
						LoggerUtil
								.pass("[" + header + "] Match → Expected: " + expectedVal + " | Actual: " + actualVal);
					} else {
						if (header.equalsIgnoreCase("Supplier Detail 1")) {
							LoggerUtil
									.error("Supplier mismatch → Expected: " + expectedVal + " | Actual: " + actualVal);
						} else {
							LoggerUtil.warn(" [" + header + "] mismatch ignored → Expected: " + expectedVal
									+ " | Actual: " + actualVal);
						}
					}

					// Track supplier match separately
					if (header.equalsIgnoreCase("Supplier Detail 1") && equalsRelaxed(header, expectedVal, actualVal)) {
						supplierMatch = true;
					}
				}

				if (partMatch) {
					matchedRow = row;
					if (supplierMatch) {
						LoggerUtil.pass(" Row matched successfully for Part: " + partNumber + " (Supplier verified)");
					} else {
						LoggerUtil.pass(" Row matched by Part No. (Supplier not verified, continuing click).");
					}
					break;
				}
			}

			// Step 4 : Click Supplier cell if matched
			if (matchedRow != null) {
				clickFirstNonEmptySupplierCell(matchedRow, headerNames);
			} else {
				LoggerUtil.fail(" No matching row found for Part: " + partNumber);
			}

			LoggerUtil.info("==============================================");

			LoggerUtil.info(
					"VALIDATION COMPLETED: [View Table Part Master For Supplier Name By Supplier Header Coloumn]");

			LoggerUtil.info("==============================================");
		} catch (Exception ex) {
			LoggerUtil.error("❌ Exception in verifyRowByHeaderAndClickSupplier → " + ex.getMessage());
			ex.printStackTrace();
		}
	}

	public Map<String, String> VerifyPartNumberAreSavedOrNotWithSupplierSide(String SelectFilterByLabel,
			String PartNumber, String PartDescription) throws InterruptedException {

		LoggerUtil.info("===== START: Verify Part Number & Description View Table PartMaster =====");

		Map<String, String> partData = new HashMap<>();

		try {
			Thread.sleep(2000);

			// Step 1️⃣: Perform search
			clickOnElement(partMasterViewBtn);
			Thread.sleep(2000);
			searchBtnPartMasterFilterIcon(SelectFilterByLabel);
			Thread.sleep(2000);
			searchBoxPartMaster(PartNumber);
			Thread.sleep(2500);

			// Step 2️⃣: Verify row and click supplier side
			verifyRowByHeaderAndClickSupplier(PartNumber, PartDescription);

			// Step 3️⃣: Store values after successful verification
			partData.put("Part Number", PartNumber);
			partData.put("Part Description", PartDescription);
			partData.put("Filter Used", SelectFilterByLabel);

			LoggerUtil.pass("✅ Part found successfully: " + PartNumber + " | Description: " + PartDescription);
			LoggerUtil.info("Stored Part Data: " + partData);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while verifying part number on Supplier Side: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Verify Part Number & Description (Supplier Side) =====");

		return partData;
	}

	public static final By partMasterViewBtn = By.id("modelView");

	public static final By ClickingPartMasterFilterIcon = By
			.xpath("//div//input[@id='searchBoxPartMaster']/following-sibling::i");
	public static final By searchBtnPartMasterFilterIconLabelList = By.xpath("//div[@id='chkPartMaster']//label");

	private void searchBtnPartMasterFilterIcon(String target) throws InterruptedException {
		LoggerUtil.info("Opening Part Master filter and selecting: " + target);
		Thread.sleep(500);
		waitForUIBlockersToDisappear();
		Thread.sleep(500);
		clickOnElement1(ClickingPartMasterFilterIcon);
		Thread.sleep(500);
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
		List<WebElement> options = driver.findElements(searchBtnPartMasterFilterIconLabelList);

		String wanted = target == null ? "" : target.trim();

		boolean matched = false;
		for (WebElement option : options) {
			String labelText = option.getText() == null ? "" : option.getText().trim();
			if (labelText.equalsIgnoreCase(wanted)) {
				option.click();
				LoggerUtil.info("Filter value selected: " + labelText);
				matched = true;
				break;
			}
		}

		if (!matched) {
			LoggerUtil.fail("Filter value not found in list: " + wanted);
			throw new AssertionError("Filter option not found: " + wanted);
		}
	}

	public static final By searchBoxPartMaster = By.xpath("//input[@id='searchBoxPartMaster']");
	public static final By searchBtnPartMaster = By.xpath("//button[@id='btnSearchPart']");

	private void searchBoxPartMaster(String txt) {
		sendKeysToTextBox(searchBoxPartMaster, txt);
		try {
			Thread.sleep(4000);
		} catch (InterruptedException e) {

			e.printStackTrace();
		}
		clickOnElement1(searchBtnPartMaster);
	}

	public static final By FetachHeadingPartAttribute = By
			.xpath("div[@id='partAttributeDiv']//span[normalize-space(text())='Part Attributes/']");
	public static final By EnterSobValue = By.xpath("//form[@id='tab1Form']/descendant::input[@id='CustSob']");
	public static final By FetchingDataPartDescriptionValue = By
			.xpath("//form[@id='tab1Form']/descendant::input[@id='Partdesc']");
	public static final By fetchingPartnumberValue = By.xpath("//form[@id='tab1Form']/descendant::input[@id='PartNo']");

	/**
	 * This method performs the complete workflow of the "Part Attributes" tab: 1.
	 * Ensures the tab is visible and active (with fallback navigation) 2. Opens the
	 * Commodity Group dropdown 3. Searches and selects the required Commodity Group
	 * 4. Enters SOB (Supplier On Behalf) value with 3-decimal formatting 5. Saves
	 * the data and validates the toast message 6. Fetches the saved SOB value from
	 * UI after saving 7. Returns a map containing all validated and stored values
	 *
	 * @param CommodityGroupName The Commodity Group to be selected in the dropdown
	 * @return Map<String,String> containing all stored values for later validation
	 */
	public Map<String, String> verifyFetchDataAndWriteInPartAttributes(String CommodityGroupName)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verifying and Writing Data in 'Part Attributes' Tab (Procurement) =====");

		Map<String, String> storedData = new HashMap<>();

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		try {

			Thread.sleep(1000);

			// ============================================================
			// STEP 0: Ensure the 'Part Attributes' tab is active (NEW METHOD)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);

			// ============================================================
			// STEP 1: OPEN COMMODITY GROUP DROPDOWN
			// ============================================================
			LoggerUtil.info("STEP 1: Opening Commodity Group dropdown...");
			clickOnElement(SelectingCommodityGroupDropdown);
			Thread.sleep(2000);

			List<WebElement> initialList = driver.findElements(listCommodityGroupnames);

			if (initialList.isEmpty()) {
				LoggerUtil.info("✅ No options visible initially (expected before search).");
			} else {
				LoggerUtil.warn("⚠ Dropdown already contains " + initialList.size() + " options before searching.");
			}

			// ============================================================
			// STEP 2: SEARCH COMMODITY GROUP
			// ============================================================
			LoggerUtil.info("STEP 2: Searching for Commodity Group: " + CommodityGroupName);
			clearAndEnterText(waitForExpectedElement(EnterCommodityGroupNameInSearchBoxfirstab), CommodityGroupName);
			Thread.sleep(2000);

			List<WebElement> filteredOptions = driver.findElements(listCommodityGroupnames);

			if (!filteredOptions.isEmpty()) {
				LoggerUtil.pass("✅ " + filteredOptions.size() + " Commodity Group options loaded after search.");
			} else {
				LoggerUtil.error("❌ No Commodity Group options found for: " + CommodityGroupName);
			}

			// ============================================================
			// STEP 3: SELECT THE REQUIRED COMMODITY GROUP
			// ============================================================
			LoggerUtil.info("STEP 3: Selecting desired Commodity Group from search result...");
			boolean found = false;

			for (WebElement option : filteredOptions) {
				String nameText = option.getText().trim();
				if (nameText.equals(CommodityGroupName)) {
					option.click();
					LoggerUtil.pass("✅ Selected Commodity Group: " + CommodityGroupName);
					found = true;
					break;
				}
			}

			if (!found) {
				LoggerUtil.error("❌ Commodity Group '" + CommodityGroupName + "' NOT found after search.");
			}

			storedData.put("CommodityGroup", CommodityGroupName);

			// ============================================================
			// STEP 4: ENTER SOB VALUE
			// ============================================================
			LoggerUtil.info("STEP 4: Entering SOB value...");
			String enteredSOBValue = "10.125";

			clearAndEnterText(waitForExpectedElement(EnterSobValue), enteredSOBValue);

			storedData.put("SOB", String.format("%.3f", Double.parseDouble(enteredSOBValue)));
			LoggerUtil.info("Entered SOB Value: " + enteredSOBValue + " → Stored As (3dp): " + storedData.get("SOB"));

			// ============================================================
			// STEP 5: SAVE & CAPTURE TOAST
			// ============================================================
			LoggerUtil.info("STEP 5: Clicking Save on Part Attributes...");
			clickOnElement(ClickingSaveButtonPartMaster);

			String actualToastMsg = waitForExpectedElement(toastMessage).getText().trim();
			storedData.put("ToastMessage", actualToastMsg);

			if (actualToastMsg.equals("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✅ Toast Message Verified.");
			} else {
				LoggerUtil.error("❌ Unexpected Toast: " + actualToastMsg);
			}

			// ============================================================
			// STEP 6: RE-FETCH SOB FOR CONFIRMATION
			// ============================================================
			LoggerUtil.info("STEP 6: Fetching SOB value from UI after save for extra confirmation...");

			try {
				WebElement savedValueField = waitForExpectedElement(EnterSobValue);
				String uiSOBValue = savedValueField.getAttribute("value").trim();

				storedData.put("SOB", String.format("%.3f", Double.parseDouble(uiSOBValue)));
				LoggerUtil.info(
						"UI SOB Value after save: " + uiSOBValue + " → Normalized (3dp): " + storedData.get("SOB"));

			} catch (Exception e) {
				LoggerUtil.warn("⚠ Could not fetch saved SOB value from UI: " + e.getMessage());
			}

			Thread.sleep(2000);

		} catch (Exception e) {
			LoggerUtil.error("❌ Unexpected error in 'Part Attributes' workflow (Procurement): " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: 'Part Attributes' Tab Flow Completed (Procurement) =====");
		return storedData;
	}

	private void navigateToTab(String tabName) {
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase(tabName)) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to tab → " + tabName);
				return;
			}
		}
		LoggerUtil.warn("⚠ Tab not found: " + tabName);
	}

	public void ensurePartAttributesTabLoaded(By headingLocator) {

		LoggerUtil.info("===== ENSURE PART ATTRIBUTES TAB (BOOTSTRAP FORCE) =====");

		JavascriptExecutor js = (JavascriptExecutor) driver;

		// =====================================================
		// STEP 1: FIRST CHECK – HEADER ALREADY VISIBLE?
		// =====================================================
		try {
			List<WebElement> headers = driver.findElements(headingLocator);
			if (!headers.isEmpty() && headers.get(0).isDisplayed()) {
				LoggerUtil.pass("✔ Part Attributes already active. No switch required.");
				return;
			}
		} catch (Exception ignored) {
		}

		LoggerUtil.warn("⚠ Header not visible. Forcing Bootstrap tab switch...");

		// =====================================================
		// STEP 2: FORCE BOOTSTRAP TAB SWITCH (JS)
		// =====================================================
		try {
			// Force Part Price Calculations FIRST (reset state)
			js.executeScript("$('a[href=\"#PartPriceCalculationsTab\"]').tab('show');");

			Thread.sleep(500);

			// Now FORCE Part Attributes tab
			js.executeScript("$('a[href=\"#PartAttributesTsab\"]').tab('show');");

		} catch (Exception e) {
			LoggerUtil.error("❌ JS Bootstrap tab execution failed");
			throw new RuntimeException(e);
		}

		// =====================================================
		// STEP 3: HARD VERIFY HEADER
		// =====================================================
		try {
			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(6));
			WebElement heading = wait.until(ExpectedConditions.visibilityOfElementLocated(headingLocator));

			if (heading.isDisplayed()) {
				LoggerUtil.pass("✔ Part Attributes tab FORCEFULLY activated via Bootstrap JS");
				return;
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Part Attributes header not visible even after Bootstrap force");
			throw new RuntimeException("Part Attributes tab activation failed");
		}
	}

	public static void debugPrintUnicode(String label, String value) {
		System.out.println("----- " + label + " Unicode Debug -----");
		for (char c : value.toCharArray()) {
			System.out.println("'" + c + "' → " + String.format("\\u%04x", (int) c));
		}
		System.out.println("------------------------------------------");
	}

	public void VeirfyDataHasBeenSavedCorrectlyOrNotForSupplierEnd(Map<String, String> storedData)
			throws InterruptedException {

		LoggerUtil.info("===== START: Validating Saved Data for Supplier End (Part Attributes Tab) =====");

		// Locators
		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");
		By SelectedCommodityGroupText = By.xpath(
				"//select[@id='commodityDrop']/following::span/descendant::span[@id='select2-commodityDrop-container']");

		By PartDescriptionValue = By.xpath("//form[@id='tab1Form']/descendant::input[@id='Partdesc']");
		By PartNumberValue = By.xpath("//form[@id='tab1Form' ]/descendant::input[@id='Partno' or @id='PartNo']");

		try {
			Thread.sleep(2000);

			// ============================================================
			// STEP 1: Ensure the 'Part Attributes' tab is active (NEW STABLE LOGIC)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);

			Thread.sleep(3000);

			// ============================================================
			// STEP 2: Capture current UI values
			// ============================================================
			String actualCommodityGroup = waitForExpectedElement(SelectedCommodityGroupText).getText().trim();
			String actualPartDescription = waitForExpectedElement(PartDescriptionValue).getAttribute("value").trim();
			String actualPartNumber = waitForExpectedElement(PartNumberValue).getAttribute("value").trim();

			// ============================================================
			// STEP 3: Fetch Expected values
			// ============================================================
			String expectedCommodityGroup = storedData.get("CommodityGroup");
			String expectedPartDescription = storedData.get("Part Description");
			String expectedPartNumber = storedData.get("Part Number");

			// ============================================================
			// STEP 4: Log Expected vs Actual
			// ============================================================
			LoggerUtil.info("Expected Part Number: " + expectedPartNumber);
			LoggerUtil.info("Expected Part Description: " + expectedPartDescription);
			LoggerUtil.info("Expected Commodity Group: " + expectedCommodityGroup);

			LoggerUtil.info("Actual Part Number: " + actualPartNumber);
			LoggerUtil.info("Actual Part Description: " + actualPartDescription);
			LoggerUtil.info("Actual Commodity Group: " + actualCommodityGroup);

			// ============================================================
			// STEP 5: VALIDATIONS
			// ============================================================
			if (expectedPartNumber != null && expectedPartNumber.equalsIgnoreCase(actualPartNumber)) {
				LoggerUtil.pass("Part Number matched successfully.");
			} else {
				LoggerUtil.error(
						"Part Number mismatch! Expected: " + expectedPartNumber + ", Found: " + actualPartNumber);
			}

			if (expectedPartDescription != null && expectedPartDescription.equalsIgnoreCase(actualPartDescription)) {
				LoggerUtil.pass("Part Description matched successfully.");
			} else {
				LoggerUtil.error("Part Description mismatch! Expected: " + expectedPartDescription + ", Found: "
						+ actualPartDescription);
			}

			if (expectedCommodityGroup != null && expectedCommodityGroup.equalsIgnoreCase(actualCommodityGroup)) {
				LoggerUtil.pass("Commodity Group matched successfully.");
			} else {
				LoggerUtil.error("Commodity Group mismatch! Expected: " + expectedCommodityGroup + ", Found: "
						+ actualCommodityGroup);
			}

			// SOB Validation
			String actualSOBRaw = waitForExpectedElement(EnterSobValue).getAttribute("value").trim();
			String formattedActualSOB = String.format("%.3f", Double.parseDouble(actualSOBRaw));
			String expectedSOB = storedData.get("SOB");

			if (expectedSOB != null && formattedActualSOB.equals(expectedSOB)) {
				LoggerUtil.pass("SOB matched successfully → " + formattedActualSOB);
			} else {
				LoggerUtil.error("SOB mismatch → Expected: " + expectedSOB + " | Actual: " + formattedActualSOB);
			}

			LoggerUtil.pass("All validations completed successfully for Supplier-end saved data.");

		} catch (Exception e) {
			LoggerUtil.error("Error while validating Supplier-end saved data: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Supplier-End Data Validation Completed =====");
	}

	public void VeirfyDataHasBeenSavedCorrectlyOrNotForSupplierEndForUpdate(Map<String, String> data)
			throws InterruptedException {

		LoggerUtil.info("===== START: Supplier-End Data Validation (UPDATE) =====");

		By headingLocator = By.xpath("//div[@id='partAttributeDiv']//span[contains(text(),'Part Attributes')]");
		By commodityGroupSpan = By.id("select2-commodityDrop-container");
		By partNoLocator = By.xpath("//input[@id='PartNo' or @id='Partno']");
		By partDescLocator = By.id("Partdesc");

		try {
			// ================================
			// STEP 0: EXPECTED VALUES FROM MAP
			// ================================
			String expectedPartNo = safeGet(data, "Part Number");
			String expectedPartDesc = safeGet(data, "Part Description");
			String expectedCommodityGroup = safeGet(data, "CommodityGroup");

			String expectedSOBRaw = data.get("UpdatedSOB");

			if (expectedSOBRaw == null || expectedSOBRaw.trim().isEmpty()) {
				expectedSOBRaw = data.get("UIValueAfterUpdate");
			}

			if (expectedSOBRaw == null || expectedSOBRaw.trim().isEmpty()) {
				LoggerUtil.error("❌ expectedSOB NOT found in map! Keys: " + data.keySet());
			}

			String expectedSOB = normalize3(expectedSOBRaw);

			LoggerUtil.info("🔹 Expected Part Number: " + expectedPartNo);
			LoggerUtil.info("🔹 Expected Part Description: " + expectedPartDesc);
			LoggerUtil.info("🔹 Expected Commodity Group: " + expectedCommodityGroup);
			LoggerUtil.info("🔹 Expected SOB (3dp): " + expectedSOB);

			// ================================
			// STEP 1: ENSURE TAB IS ACTIVE (using common helper)
			// ================================
			ensurePartAttributesTabLoaded(headingLocator);
			Thread.sleep(1500);

			// ================================
			// STEP 2: CAPTURE ACTUAL VALUES
			// ================================
			String actualPartNo = waitForExpectedElement(partNoLocator).getAttribute("value").trim();
			String actualPartDesc = waitForExpectedElement(partDescLocator).getAttribute("value").trim();

			String actualCommodityGroup = waitForExpectedElement(commodityGroupSpan).getText().trim();

			WebElement sobField = waitForExpectedElement(EnterSobValue);
			String actualSOB = normalize3(sobField.getAttribute("value").trim());

			LoggerUtil.info("🔹 Actual Part Number: " + actualPartNo);
			LoggerUtil.info("🔹 Actual Part Description: " + actualPartDesc);
			LoggerUtil.info("🔹 Actual Commodity Group: " + actualCommodityGroup);
			LoggerUtil.info("🔹 Actual SOB (3dp): " + actualSOB);

			// ================================
			// STEP 3: VALIDATIONS
			// ================================
			if (expectedPartNo.equals(actualPartNo)) {
				LoggerUtil.pass("✔ Part Number matched successfully.");
			} else {
				LoggerUtil.error("❌ Part Number mismatch! Expected: " + expectedPartNo + ", Found: " + actualPartNo);
			}

			if (expectedPartDesc.equals(actualPartDesc)) {
				LoggerUtil.pass("✔ Part Description matched successfully.");
			} else {
				LoggerUtil.error(
						"❌ Part Description mismatch! Expected: " + expectedPartDesc + ", Found: " + actualPartDesc);
			}

			if (expectedCommodityGroup.equals(actualCommodityGroup)) {
				LoggerUtil.pass("✔ Commodity Group matched successfully.");
			} else {
				LoggerUtil.error("❌ Commodity Group mismatch! Expected: " + expectedCommodityGroup + ", Found: "
						+ actualCommodityGroup);
			}

			if (expectedSOB.equals(actualSOB)) {
				LoggerUtil.pass("✔ SOB matched successfully → " + actualSOB);
			} else {
				LoggerUtil.error("❌ SOB mismatch! Expected: " + expectedSOB + ", Found: " + actualSOB);
			}

			LoggerUtil.pass("PASS: All validations completed for Supplier-end updated data.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Error in Supplier-End Update Validation: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Supplier-End Data Validation (UPDATE) =====");
	}

	/**
	 * Safe getter: null aaye to "" de dega, taaki NPE na aaye.
	 */
	private String safeGet(Map<String, String> map, String key) {
		String val = map.get(key);
		return (val == null) ? "" : val.trim();
	}

	/**
	 * 3 decimal normalize helper
	 */
	private String normalize3(String val) {
		try {
			if (val == null || val.trim().isEmpty())
				return "";
			BigDecimal bd = new BigDecimal(val.trim());
			bd = bd.setScale(3, RoundingMode.HALF_UP);
			return bd.toPlainString();
		} catch (Exception e) {
			return val; // agar parse na ho paye to original return kar do
		}
	}

	public HashMap<String, String> VerifySaveDataPriceCalculationTabStandardShapesCustomerSide(String rmInputCategory,
			String shapeOption, String commodityGroup, String groupClassification, String yearValue, String periodValue,
			String specificGrade, String entryType, String blankGrossWeight, String netWeight)
			throws InterruptedException {

		HashMap<String, String> finalMap = new HashMap<>();
		String ohp = DataProp.getProperty("OHPCustomerSide");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Standard Shapes - Customer)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);
			finalMap.put("RM Input Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected → " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Dropdown Selections
			// ---------------------------------------------------------
			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			finalMap.put("Shape", shapeOption);

			selectDropDownValue(CommodityGroupDropdownStandardShapes, commodityGroup, "visibleText");
			finalMap.put("Commodity Group", commodityGroup);

			selectDropDownValue(GroupClassificationDropdownStandardShapes, groupClassification, "visibleText");
			finalMap.put("Group Classification", groupClassification);

			selectDropDownValue(yearDropdownStandardShapes, yearValue, "visibleText");
			finalMap.put("Year", yearValue);

			selectDropDownValue(PeriodDropdownStandardShapes, periodValue, "visibleText");
			finalMap.put("Period", periodValue);

			selectDropDownValue(SpecificGradeDropdownStandardShapes, specificGrade, "visibleText");
			finalMap.put("Specific Grade", specificGrade);

			// ---------------------------------------------------------
			// STEP 4 → Entry Type Radios
			// ---------------------------------------------------------
			clickOnElement(DirectEntryRadioButtonMarginStandardShapes);
			clickOnElement(DirectEntryRadioButtonNumberOfPieciesStandardShapes);
			clickOnElement(DirectEntryRadioButtonRejectionWastageStandardShapes);

			// ---------------------------------------------------------
			// STEP 5 → Dimension & Weight Inputs
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterLengethValueStandardShapes), "23.50");
			finalMap.put("Length", "23.50");

			clearAndEnterText(waitForExpectedElement(EnterWidthValuesStandardShapes), "12.75");
			finalMap.put("Width", "12.75");

			clearAndEnterText(waitForExpectedElement(EnterRejectionBlankWtStandarShapes), "65.20");
			finalMap.put("Rejection Blank Wt", "65.20");

			clearAndEnterText(waitForExpectedElement(EnterBlankGrossWtKgDirectStandardShapes), blankGrossWeight);
			finalMap.put("Blank Gross Wt", blankGrossWeight);

			clearAndEnterText(waitForExpectedElement(FinishWtkgperpcStandardShapes), netWeight);
			finalMap.put("Net Weight", netWeight);

			// ---------------------------------------------------------
			// STEP 6 → OHP Selection
			// ---------------------------------------------------------
			Thread.sleep(2000);
			scrollToElement(waitForExpectedElement(ClickingOhpButtonStandardShapes));
			Thread.sleep(2000);
			clickOnElement(ClickingOhpButtonStandardShapes);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(EnterOhpValueStandardShapes), ohp);
			Thread.sleep(2000);
			finalMap.put("OHP", ohp);

			for (WebElement Ohp : driver.findElements(ohplistStandardShapes)) {
				if (Ohp.getText().trim().equals(ohp)) {
					Ohp.click();
					break;
				}
			}

			// ---------------------------------------------------------
			// STEP 7 → Cost Inputs (Decimal)
			// ---------------------------------------------------------
			enterAndStore(finalMap, "Rejection %", EnterRejectionStandardShapes, "78.11");
			enterAndStore(finalMap, "Packing", EnterPackingValuestandardShapes, "43.22");
			enterAndStore(finalMap, "Insurance", EnterInsuranceValueStandarShapes, "66.33");
			enterAndStore(finalMap, "Profit", EnterProfitValueStandarShapes, "54.44");
			enterAndStore(finalMap, "Overhead", EnterOverheadValueStandardShapes, "54.55");
			enterAndStore(finalMap, "Incoterms", EnterIncoTermsValueStandarShapes, "54.66");
			enterAndStore(finalMap, "ICC", EnterIccValueStandardShapes, "54.77");
			enterAndStore(finalMap, "Freight", EnterFreightValueStandardShapes, "54.88");

			enterAndStore(finalMap, "Other Factor 1", EnterOtherFactor1StandardShapes, "54.11");
			enterAndStore(finalMap, "Other Factor 2", EnterOtherFactor2StandardShapes, "54.22");
			enterAndStore(finalMap, "Other Factor 3", EnterOtherFactor3StandardShapes, "54.33");

			enterAndStore(finalMap, "Remarks", EnterRemarksValueStandardShapes, "Save_Remarks");
			enterAndStore(finalMap, "Tool Cost", EnterToolcastValueStandardShapes, "54.55");
			enterAndStore(finalMap, "Amortization Qty", EnterAmortizationQtyStandardShapes, "54.66");

			LoggerUtil.pass("All Standard Shapes cost values entered successfully");

			// ---------------------------------------------------------
			// STEP 8 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonstandardShapes);
			LoggerUtil.pass("Clicked Save button");

			// ---------------------------------------------------------
			// STEP 8A → Toast (Optional, Non-Blocking)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);
				if (toast.isDisplayed()) {
					String toastMsg = toast.getText().trim();
					finalMap.put("ToastMessage", toastMsg);
					LoggerUtil.pass("Toast Message displayed → " + toastMsg);
				}
			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed after save");
				finalMap.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			if (e instanceof NoSuchElementException
					|| (e.getCause() != null && e.getCause() instanceof NoSuchElementException)) {
				LoggerUtil.warn("Optional element not found → " + e.getMessage());
			} else {
				LoggerUtil.error("Unexpected exception during Standard Shapes save flow → " + e.getMessage());
			}
		}

		// ---------------------------------------------------------
		// FINAL LOGGING
		// ---------------------------------------------------------
		LoggerUtil.info("========== FINAL STORED MAP VALUES ==========");
		finalMap.forEach((k, v) -> LoggerUtil.info(k + " → " + v));
		LoggerUtil.info("=============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return finalMap;
	}

	public void validatePriceCalculationTabStandardShapes(HashMap<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Standard Shapes )");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → DROPDOWN VALIDATIONS
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("RM Input Category"), "RM Input Category");

			validateDropdownByVisibleText(DropdownlistShapeOptions, expectedData.get("Shape"), "Shape");

			validateDropdownValue(CommodityGroupDropdownStandardShapes, expectedData.get("Commodity Group"),
					"Commodity Group");

			validateDropdownValue(GroupClassificationDropdownStandardShapes, expectedData.get("Group Classification"),
					"Group Classification");

			validateDropdownValue(yearDropdownStandardShapes, expectedData.get("Year"), "Year");

			validateDropdownValue(PeriodDropdownStandardShapes, expectedData.get("Period"), "Period");

			validateDropdownValue(SpecificGradeDropdownStandardShapes, expectedData.get("Specific Grade"),
					"Specific Grade");

			validateDropdownValue(ClickingOhpButtonStandardShapes, expectedData.get("OHP"), "OHP");

			// ---------------------------------------------------------
			// STEP 3 → RADIO BUTTON VALIDATIONS
			// ---------------------------------------------------------
			validateRadioButton(DirectEntryRadioButtonMarginStandardShapes, "Margin - Direct Entry");

			validateRadioButton(DirectEntryRadioButtonNumberOfPieciesStandardShapes, "Number of Pieces - Direct Entry");

			validateRadioButton(DirectEntryRadioButtonRejectionWastageStandardShapes,
					"Rejection / Wastage - Direct Entry");

			// ---------------------------------------------------------
			// STEP 4 → INPUT FIELD VALIDATIONS (DECIMAL SAFE)
			// ---------------------------------------------------------
			validateInput("Length", EnterLengethValueStandardShapes, expectedData);

			validateInput("Width", EnterWidthValuesStandardShapes, expectedData);

			validateInput("Rejection Blank Wt", EnterRejectionBlankWtStandarShapes, expectedData);

			validateInput("Blank Gross Wt", EnterBlankGrossWtKgDirectStandardShapes, expectedData);

			validateInput("Net Weight", FinishWtkgperpcStandardShapes, expectedData);

			validateInput("Rejection %", EnterRejectionStandardShapes, expectedData);

			validateInput("Packing", EnterPackingValuestandardShapes, expectedData);

			validateInput("Insurance", EnterInsuranceValueStandarShapes, expectedData);

			validateInput("Profit", EnterProfitValueStandarShapes, expectedData);

			validateInput("Overhead", EnterOverheadValueStandardShapes, expectedData);

			validateInput("Incoterms", EnterIncoTermsValueStandarShapes, expectedData);

			validateInput("ICC", EnterIccValueStandardShapes, expectedData);

			validateInput("Freight", EnterFreightValueStandardShapes, expectedData);

			validateInput("Other Factor 1", EnterOtherFactor1StandardShapes, expectedData);

			validateInput("Other Factor 2", EnterOtherFactor2StandardShapes, expectedData);

			validateInput("Other Factor 3", EnterOtherFactor3StandardShapes, expectedData);

			validateInput("Remarks", EnterRemarksValueStandardShapes, expectedData);

			validateInput("Tool Cost", EnterToolcastValueStandardShapes, expectedData);

			validateInput("Amortization Qty", EnterAmortizationQtyStandardShapes, expectedData);

			LoggerUtil.pass("✔ All Standard Shapes values validated successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Standard Shapes validation → " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Standard Shapes )");
		LoggerUtil.info("==============================================");
	}

	public void validateDropdownByVisibleText(By locator, String expected, String fieldName) {

		try {
			Select select = new Select(waitForExpectedElement(locator));
			String actual = select.getFirstSelectedOption().getText().trim();

			if (actual.equalsIgnoreCase(expected)) {
				LoggerUtil.pass("✔ " + fieldName + " matched → " + expected);
			} else {
				LoggerUtil.fail("❌ " + fieldName + " mismatch | Expected = " + expected + " | Actual = " + actual);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Error validating dropdown (text) → " + fieldName + " → " + e.getMessage());
		}
	}

	public HashMap<String, String> UpdatePriceCalculationTabStandardShapes() throws InterruptedException {

		HashMap<String, String> updatedData = new HashMap<>();

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Update Price Calculation (Standard Shapes )");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → UPDATE INPUT FIELDS ONLY (DECIMAL VALUES)
			// ---------------------------------------------------------
			enterAndStore(updatedData, "Length", EnterLengethValueStandardShapes, "25.75");

			enterAndStore(updatedData, "Width", EnterWidthValuesStandardShapes, "14.35");

			enterAndStore(updatedData, "Rejection Blank Wt", EnterRejectionBlankWtStandarShapes, "68.45");

			enterAndStore(updatedData, "Blank Gross Wt", EnterBlankGrossWtKgDirectStandardShapes, "36.80");

			enterAndStore(updatedData, "Net Weight", FinishWtkgperpcStandardShapes, "33.60");

			enterAndStore(updatedData, "Rejection %", EnterRejectionStandardShapes, "82.25");

			enterAndStore(updatedData, "Packing", EnterPackingValuestandardShapes, "46.55");

			enterAndStore(updatedData, "Insurance", EnterInsuranceValueStandarShapes, "69.75");

			enterAndStore(updatedData, "Profit", EnterProfitValueStandarShapes, "58.40");

			enterAndStore(updatedData, "Overhead", EnterOverheadValueStandardShapes, "59.15");

			enterAndStore(updatedData, "Incoterms", EnterIncoTermsValueStandarShapes, "60.35");

			enterAndStore(updatedData, "ICC", EnterIccValueStandardShapes, "61.20");

			enterAndStore(updatedData, "Freight", EnterFreightValueStandardShapes, "62.90");

			enterAndStore(updatedData, "Other Factor 1", EnterOtherFactor1StandardShapes, "55.55");

			enterAndStore(updatedData, "Other Factor 2", EnterOtherFactor2StandardShapes, "56.65");

			enterAndStore(updatedData, "Other Factor 3", EnterOtherFactor3StandardShapes, "57.75");

			enterAndStore(updatedData, "Remarks", EnterRemarksValueStandardShapes, "Update_Remarks");

			enterAndStore(updatedData, "Tool Cost", EnterToolcastValueStandardShapes, "58.85");

			enterAndStore(updatedData, "Amortization Qty", EnterAmortizationQtyStandardShapes, "57.90");

			LoggerUtil.pass("All Standard Shapes input values UPDATED successfully");

			// ---------------------------------------------------------
			// STEP 3 → Save Updated Data
			// ---------------------------------------------------------

			clickOnElement(ClickingSaveButtonstandardShapes);
			LoggerUtil.pass("Clicked Save button for Update");

			// ---------------------------------------------------------
			// STEP 3B → TOAST (optional)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);

				if (toast.isDisplayed()) {
					String toastmsg = toast.getText().trim();
					updatedData.put("ToastMessage", toastmsg);
					LoggerUtil.pass("Toast Message displayed after Update → " + toastmsg);
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed after Update");
				updatedData.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			if (e instanceof NoSuchElementException
					|| (e.getCause() != null && e.getCause() instanceof NoSuchElementException)) {

				LoggerUtil.warn("Optional element not found during update → " + e.getMessage());

			} else {
				LoggerUtil.error("Unexpected exception during Standard Shapes update flow → " + e.getMessage());
			}
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Update Price Calculation (Standard Shapes)");
		LoggerUtil.info("==============================================");

		return updatedData;
	}

	public HashMap<String, String> VerifySaveDataPriceCalculationTabStandardShapesSupplierSide(String rmInputCategory,
			String shapeOption, String commodityGroup, String groupClassification, String yearValue, String periodValue,
			String specificGrade, String entryType, String blankGrossWeight, String netWeight)
			throws InterruptedException {

		HashMap<String, String> finalMap = new HashMap<>();
		String ohp = DataProp.getProperty("OHP");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Standard Shapes - Supplier)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);
			finalMap.put("RM Input Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected → " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Dropdown Selections
			// ---------------------------------------------------------
			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			finalMap.put("Shape", shapeOption);

			selectDropDownValue(CommodityGroupDropdownStandardShapes, commodityGroup, "visibleText");
			finalMap.put("Commodity Group", commodityGroup);

			selectDropDownValue(GroupClassificationDropdownStandardShapes, groupClassification, "visibleText");
			finalMap.put("Group Classification", groupClassification);

			selectDropDownValue(yearDropdownStandardShapes, yearValue, "visibleText");
			finalMap.put("Year", yearValue);

			selectDropDownValue(PeriodDropdownStandardShapes, periodValue, "visibleText");
			finalMap.put("Period", periodValue);

			selectDropDownValue(SpecificGradeDropdownStandardShapes, specificGrade, "visibleText");
			finalMap.put("Specific Grade", specificGrade);

			// ---------------------------------------------------------
			// STEP 4 → Entry Type Radios
			// ---------------------------------------------------------
			clickOnElement(DirectEntryRadioButtonMarginStandardShapes);
			clickOnElement(DirectEntryRadioButtonNumberOfPieciesStandardShapes);
			clickOnElement(DirectEntryRadioButtonRejectionWastageStandardShapes);

			// ---------------------------------------------------------
			// STEP 5 → Dimension & Weight Inputs
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterLengethValueStandardShapes), "23.50");
			finalMap.put("Length", "23.50");

			clearAndEnterText(waitForExpectedElement(EnterWidthValuesStandardShapes), "12.75");
			finalMap.put("Width", "12.75");

			clearAndEnterText(waitForExpectedElement(EnterRejectionBlankWtStandarShapes), "65.20");
			finalMap.put("Rejection Blank Wt", "65.20");

			clearAndEnterText(waitForExpectedElement(EnterBlankGrossWtKgDirectStandardShapes), blankGrossWeight);
			finalMap.put("Blank Gross Wt", blankGrossWeight);

			clearAndEnterText(waitForExpectedElement(FinishWtkgperpcStandardShapes), netWeight);
			finalMap.put("Net Weight", netWeight);

			// ---------------------------------------------------------
			// STEP 6 → OHP Selection
			// ---------------------------------------------------------
			Thread.sleep(2000);
			scrollToElement(waitForExpectedElement(ClickingOhpButtonStandardShapes));
			Thread.sleep(2000);
			clickOnElement(ClickingOhpButtonStandardShapes);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterOhpValueStandardShapes), ohp);
			Thread.sleep(2000);
			finalMap.put("OHP", ohp);

			for (WebElement Ohp : driver.findElements(ohplistStandardShapes)) {
				if (Ohp.getText().trim().equals(ohp)) {
					Ohp.click();
					break;
				}
			}

			// ---------------------------------------------------------
			// STEP 7 → Cost Inputs (Decimal)
			// ---------------------------------------------------------
			enterAndStore(finalMap, "Rejection %", EnterRejectionStandardShapes, "78.11");
			enterAndStore(finalMap, "Packing", EnterPackingValuestandardShapes, "43.22");
			enterAndStore(finalMap, "Insurance", EnterInsuranceValueStandarShapes, "66.33");
			enterAndStore(finalMap, "Profit", EnterProfitValueStandarShapes, "54.44");
			enterAndStore(finalMap, "Overhead", EnterOverheadValueStandardShapes, "54.55");
			enterAndStore(finalMap, "Incoterms", EnterIncoTermsValueStandarShapes, "54.66");
			enterAndStore(finalMap, "ICC", EnterIccValueStandardShapes, "54.77");
			enterAndStore(finalMap, "Freight", EnterFreightValueStandardShapes, "54.88");

			enterAndStore(finalMap, "Other Factor 1", EnterOtherFactor1StandardShapes, "54.11");
			enterAndStore(finalMap, "Other Factor 2", EnterOtherFactor2StandardShapes, "54.22");
			enterAndStore(finalMap, "Other Factor 3", EnterOtherFactor3StandardShapes, "54.33");

			enterAndStore(finalMap, "Remarks", EnterRemarksValueStandardShapes, "Update_Remarks");
			enterAndStore(finalMap, "Tool Cost", EnterToolcastValueStandardShapes, "54.55");
			enterAndStore(finalMap, "Amortization Qty", EnterAmortizationQtyStandardShapes, "54.66");

			LoggerUtil.pass("All Standard Shapes cost values entered successfully");

			// ---------------------------------------------------------
			// STEP 8 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonstandardShapes);
			LoggerUtil.pass("Clicked Save button");

			// ---------------------------------------------------------
			// STEP 8A → Toast (Optional, Non-Blocking)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);
				if (toast.isDisplayed()) {
					String toastMsg = toast.getText().trim();
					finalMap.put("ToastMessage", toastMsg);
					LoggerUtil.pass("Toast Message displayed → " + toastMsg);
				}
			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed after save");
				finalMap.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			if (e instanceof NoSuchElementException
					|| (e.getCause() != null && e.getCause() instanceof NoSuchElementException)) {
				LoggerUtil.warn("Optional element not found → " + e.getMessage());
			} else {
				LoggerUtil.error("Unexpected exception during Standard Shapes save flow → " + e.getMessage());
			}
		}

		// ---------------------------------------------------------
		// FINAL LOGGING
		// ---------------------------------------------------------
		LoggerUtil.info("========== FINAL STORED MAP VALUES ==========");
		finalMap.forEach((k, v) -> LoggerUtil.info(k + " → " + v));
		LoggerUtil.info("=============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return finalMap;
	}

	private void validateRadioButton(By locator, String radioName) {

		try {
			WebElement radio = waitForExpectedElement(locator);

			if (radio.isSelected()) {
				LoggerUtil.pass("✔ Radio Button selected → " + radioName);
			} else {
				LoggerUtil.fail("❌ Radio Button NOT selected → " + radioName);
			}

		} catch (Exception e) {
			LoggerUtil.fail("❌ Unable to validate Radio Button → " + radioName + " | Reason: " + e.getMessage());
		}
	}

	public Map<String, String> verifyUpdateDataInPartAttributes(String CommodityGroupName) throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE DATA IN 'Part Attributes' TAB (PROCUREMENT) =====");

		By headingLocator = By.xpath("//div[@id='partAttributeDiv']//span[contains(text(),'Part Attributes')]");
		Map<String, String> updatedData = new HashMap<>();

		try {
			// =========== STEP 0: Ensure Tab Active =============
			List<WebElement> headings = driver.findElements(headingLocator);

			if (headings.isEmpty() || !headings.get(0).isDisplayed()) {
				LoggerUtil.warn("⚠ Tab not active → Re-loading");

				navigateToTab("Part Price Calculations");
				Thread.sleep(1200);

				// ---- Updated Stable Navigation (NO METHOD NAME CHANGE) ----
				int maxRetry = 4;
				boolean loaded = false;

				for (int i = 1; i <= maxRetry; i++) {
					LoggerUtil.info("Attempt " + i + " to load Part Attributes tab");

					navigateToTab("Part Attributes");
					Thread.sleep(1000);

					try {
						WebElement heading = waitForExpectedElement(headingLocator);
						if (heading.isDisplayed()) {
							LoggerUtil.pass("✔ Part Attributes tab active (Attempt " + i + ")");
							loaded = true;
							break;
						}
					} catch (Exception ex) {
						LoggerUtil.warn("⚠ Heading not visible → retrying...");
					}

					Thread.sleep(600);
				}

				if (!loaded) {
					LoggerUtil.error("❌ Part Attributes tab did not load after multiple retries.");
				}
			}
			// -------------------------------
			// STEP 1: OPEN COMMODITY GROUP
			// -------------------------------
			LoggerUtil.info("STEP 1: Opening Commodity Group dropdown...");
			clickOnElement(SelectingCommodityGroupDropdown);
			Thread.sleep(1500);

			// Search Commodity Group
			clearAndEnterText(waitForExpectedElement(EnterCommodityGroupNameInSearchBoxfirstab), CommodityGroupName);
			Thread.sleep(1500);

			List<WebElement> list = driver.findElements(listCommodityGroupnames);
			boolean found = false;

			for (WebElement item : list) {
				if (item.getText().trim().equals(CommodityGroupName)) {
					LoggerUtil.info("STEP 2: Selected Commodity Group: " + CommodityGroupName);
					item.click();
					found = true;
					break;
				}
			}

			if (!found) {
				LoggerUtil.error("❌ Commodity Group NOT found for update: " + CommodityGroupName);
			}

			updatedData.put("CommodityGroup", CommodityGroupName);

			// -------------------------------
			// STEP 3: FETCH OLD SOB VALUE
			// -------------------------------
			WebElement sobField = waitForExpectedElement(EnterSobValue);
			String oldValue = sobField.getAttribute("value").trim();

			LoggerUtil.info("STEP 3: OLD SOB Value: " + oldValue);

			// -------------------------------
			// STEP 4: ENTER NEW SOB VALUE (UPDATED)
			// -------------------------------
			String newSOBValue = "25.789"; // 🔥 UPDATE VALUE
			clearAndEnterText(sobField, newSOBValue);

			updatedData.put("UpdatedSOB", String.format("%.3f", Double.parseDouble(newSOBValue)));

			LoggerUtil.pass("STEP 4: UPDATED SOB → Old: " + oldValue + " | New: " + newSOBValue);

			// -------------------------------
			// STEP 5: SAVE & VALIDATE TOAST
			// -------------------------------
			clickOnElement(ClickingSaveButtonPartMaster);

			String toastMsg = waitForExpectedElement(toastMessage).getText().trim();
			updatedData.put("ToastMessage", toastMsg);

			if (toastMsg.equals("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✔ Update Toast Valid: " + toastMsg);
			} else {
				LoggerUtil.error("❌ Unexpected toast: " + toastMsg);
			}

			// -------------------------------
			// STEP 6: FETCH UI SOB AFTER SAVE
			// -------------------------------
			WebElement uiField = waitForExpectedElement(EnterSobValue);
			String uiValue = uiField.getAttribute("value").trim();

			updatedData.put("UIValueAfterUpdate", String.format("%.3f", Double.parseDouble(uiValue)));

			LoggerUtil.info("STEP 6: After Save UI SOB Value: " + uiValue);

			Thread.sleep(1500);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error in Update Part Attributes Flow: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: UPDATE COMPLETED FOR PART ATTRIBUTES (PROCUREMENT) =====");

		return updatedData;
	}

	public HashMap<String, String> updateNonFerrousCastingValuesPriceCalculation() throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE NON-FERROUS CASTING INPUT FIELDS =====");

		HashMap<String, String> updatedMap = new HashMap<>();

		try {
			// STEP 1 → Navigate to "Part Price Calculations" tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab (UPDATE mode).");
					break;
				}
			}

			Thread.sleep(3000);

			LoggerUtil.info("Updating ONLY TEXT INPUT FIELDS (Dropdowns not touched)...");

			// ---------------- UPDATE ALL TEXT FIELDS ----------------

			updateValue(EnterPartFinishWeightPerKgValue, "250.987", "PartFinishWeightPerKg", updatedMap);
			updateValue(EnterCastingYeildNonFerrousCastingValue, "40", "CastingYield", updatedMap);
			updateValue(EnterMeltLossFieldNonFerrousCastingValue, "15", "MeltLoss", updatedMap);
			updateValue(EnterScrapRealizationNonFerrousCastingValue, "70", "ScrapRealization", updatedMap);

			updateValue(EnterRejectiongValueNonFerrousCasting, "18", "Rejection", updatedMap);
			updateValue(EnterPackingValueNonFerrousCasting, "25", "Packing", updatedMap);
			updateValue(EnterInsuranceNonFerrousCasting, "12", "Insurance", updatedMap);
			updateValue(EnterProfitNonFerrousCasting, "50", "Profit", updatedMap);
			updateValue(EnterOverHeadNonFerrousCasting, "28", "OverHead", updatedMap);
			updateValue(EnterIncoTermNonFerrousCasting, "39", "IncoTerm", updatedMap);
			updateValue(EnterIccNonFerrousCasting, "11", "ICC", updatedMap);

			updateValue(EnterFreightPerKgNonFerrousCasting, "36", "FreightPerKg", updatedMap);
			updateValue(EnterForWardingNonFerrousCasting, "15", "Forwarding", updatedMap);

			updateValue(EnterFactor1NonFerrousCasting, "3", "Factor1", updatedMap);
			updateValue(EnterFactor2NonFerrousCasting, "5", "Factor2", updatedMap);
			updateValue(EnterFactor3NonFerrousCasting, "50", "Factor3", updatedMap);

			updateValue(EnterRemarksNonFerrousCasting, "UPDATED-REMARKS", "Remarks", updatedMap);

			updateValue(EnterToolCostNonFerrousCasting, "9.876", "ToolCost", updatedMap);
			updateValue(EnterAmortizationQuantityNonFerrousCasting, "500", "AmortizationQty", updatedMap);
			updateValue(EnterToolAmoritizationPerPcNonFerrousCasting, "34.55", "ToolAmortizationPerPc", updatedMap);
			updateValue(ToolMantinanceCostNonFerrousCasting, "30", "ToolMaintenanceCost", updatedMap);

			// -------------------------------------------------------------
			// STEP 3 → SAVE UPDATED DATA
			// -------------------------------------------------------------

			clickOnElement(ClickingSaveButtonNonFerrousCasting);

			String toast = driver.findElement(toastMessage).getText().trim();
			updatedMap.put("ToastMessage", toast);

			if (toast.contains("success"))
				LoggerUtil.pass("✔ Updated Non-Ferrous Casting values saved successfully → " + toast);
			else
				LoggerUtil.error("❌ Update save failed → " + toast);

		} catch (Exception e) {
			LoggerUtil.fail("Error while updating Non-Ferrous Casting values → " + e.getMessage());
		}

		LoggerUtil.info("===== END: UPDATE NON-FERROUS CASTING INPUT FIELDS =====");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return updatedMap;
	}

	private void updateValue(By locator, String newValue, String label, HashMap<String, String> map) {
		try {
			WebElement element = waitForExpectedElement(locator);
			element.clear();
			element.sendKeys(newValue);

			map.put(label, newValue);

			LoggerUtil.pass("UPDATED [" + label + "] → " + newValue);
		} catch (Exception e) {
			LoggerUtil.error("FAILED to update [" + label + "] → " + e.getMessage());
		}
	}

	public static final By clickingEstimateButton = By.xpath(
			"//div[@class='header-element d-none d-sm-block estimate_cs_bar_cs']/a[normalize-space(.)='Estimates']");
	public static final By clickingOptionForSupplierOrCustomer = By
			.xpath("//div[@id='leftSideBarDiv']/descendant::ul/li/a[normalize-space(.)='']");

	public void VerifyClickingEstimateButton(String Name) throws InterruptedException {

		clickOnElement(clickingEstimateButton);
		Thread.sleep(1000);

		List<WebElement> HeirerichySuppCusto = driver.findElements(clickingOptionForSupplierOrCustomer);

		// wait.until(ExpectedConditions.visibilityOfAllElements(HeirerichySuppCusto));

		for (WebElement SuppCustonames : HeirerichySuppCusto) {

			String SuppCustoText = SuppCustonames.getText().trim();

			if (SuppCustoText.equals(Name)) {

				SuppCustonames.click();
				break;

			}
		}

	}

	public static final By clickingCommodityDropdownForForGing = By.xpath("//select[@id='commodityGroupCal']");
	public static final By GroupClassificationDropdownDropdownForging = By.xpath("//select[@id='TypeOfMaterial']");

	public static final By yearDropdownForForging = By.xpath("//select[@id='YearForging']");
	public static final By periodDropdownForging = By.xpath("//select[@id='RmPeriod_Forging']");
	public static final By specificDropdownForging = By.xpath("//select[@id='MaterialGradeCal']");

	public void clickRadioButton(By locator, String description) {

		LoggerUtil.info("Trying to click radio button: " + description);

		try {
			// Step 1: Wait for visibility
			WebElement radio = waitForExpectedElement(locator);

			// Step 2: Wait for clickability
			WaitForElementClickable(locator, 20);

			// Step 3: Verify presence on UI
			if (!radio.isDisplayed()) {
				LoggerUtil.error(description + " radio button is NOT visible on the page.");
				return;
			}

			if (!radio.isEnabled()) {
				LoggerUtil.error(description + " radio button is DISABLED.");
				return;
			}

			// Step 4: Click only if not already selected
			if (!radio.isSelected()) {

				try {
					radio.click();
					LoggerUtil.pass("Clicked on " + description + " radio button.");
				} catch (Exception e) {

					LoggerUtil.info(description + " click failed, trying JS click.");

					JavascriptExecutor js = (JavascriptExecutor) driver;
					js.executeScript("arguments[0].click();", radio);

					LoggerUtil.pass("Clicked using JavaScript: " + description);
				}

			} else {
				LoggerUtil.info(description + " radio button already selected.");
			}

		} catch (Exception e) {
			LoggerUtil.error("Unexpected error while clicking radio button: " + description + " → " + e.getMessage());
		}
	}

	public void waitForUIBlockersToDisappear() {
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));

		try {
			// Wait for loader/progress bar to disappear
			wait.until(ExpectedConditions.invisibilityOfElementLocated(
					By.xpath("//div[contains(@class,'progress-container') and contains(@style,'block')]")));
		} catch (Exception e) {
			LoggerUtil.info("Progress loader not found or already hidden.");
		}

		try {
			// Wait for sticky header to settle
			wait.until(ExpectedConditions.invisibilityOfElementLocated(By
					.xpath("//div[contains(@class,'header-content-right') and @style='position: fixed; top: 0px;']")));
		} catch (Exception e) {
			LoggerUtil.info("Sticky header is not blocking click area.");
		}
	}

	public static final By EnterForgeWeightInKg = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='ForgeWightInput']");
	public static final By EnterPartingLinePerimeterinmm = By.xpath("//input[@id='PartingWtPeri']");
	public static final By SelectingBlankingProcessFromDropdown = By.xpath("//select[@id='BlankingPro']");

	public static final By EffectiveInputLength = By.xpath("//input[@id='EffInputLen']");
	public static final By EnterBlankWtDirectEntry = By.xpath("//input[@id='BlankWtDirectEntry']");
	public static final By EnterCutMarginMm = By.xpath("//input[@id='CutMargin2']");
	public static final By EnterNumberOfPieces = By.xpath("//input[@onkeyup='forgingCalculation()']");
	public static final By EnterBlankWtKgForForgeing = By.xpath("//input[@id='BlankWtDirectEntry']");
	public static final By RejectionWastageOnBlankWt = By.xpath("//input[@id='RejectionBlankWt']");
	public static final By EnterpartFinishWeightPerPc = By.xpath("//input[@id='PartFinish']");
	public static final By EnterScrapRealization = By.xpath("//input[@id='ScrapReal2']");
	public static final By ClickingOhpDropdownForForgeing = By.xpath(
			"//select[@id='forgingOhp']/following-sibling::span/descendant::span[@id='select2-forgingOhp-container']");
	public static final By EnteringValueOhpSearchBox = By
			.xpath("//span[@class='select2-search select2-search--dropdown']/input[@type='search']");
	public static final By OhpOptionsForGeing = By.xpath("//ul[@id='select2-forgingOhp-results']/li");
	public static final By EnterRejectionValue = By.xpath("//input[@id='RejectionText2']");
	public static final By EnterPackingCellBox = By.xpath("//input[@oninput='checkFour(this)' and @id='PackingText2']");
	public static final By EnterInsuranceValue = By
			.xpath("//input[@oninput='checkFour(this)' and @id='InsuranceText2']");
	public static final By EnterProfitValue = By.xpath("//input[@oninput='checkFour(this)' and @id='ProfitText2']");
	public static final By EnterOverHeadValue = By.xpath("//input[@oninput='checkFour(this)' and @id='OverheadText2']");
	public static final By EnterICCValue = By.xpath("//input[@id='ICCText2']");
	public static final By EnterFrieghtKgCellBoxValue = By.xpath("//input[@id='FrightText2']");
	public static final By EnterFactorValue1 = By.xpath("//input[@id='OtherFactor1C_FO']");
	public static final By EnterFactorValue2 = By.xpath("//input[@id='OtherFactor2C_FO']");
	public static final By EnterFactorValue3 = By.xpath("//input[@id='OtherFactor3C_FO']");
	public static final By EnterRemarksValue = By.xpath("//input[@id='Remarks_F']");
	public static final By EnterToolCostValue = By.xpath("//input[@id='ToolCost']");
	public static final By EnterQuantityValue = By.xpath("//input[@id='Quantity']");
	public static final By EnterToolAmortizationValue = By.xpath("//input[@id='ToolAmortizationPC']");
	public static final By EnterToolMantinanceCost = By.xpath("//input[@id='ToolMaintenance']");
	public static final By ClickingSaveButtonForging = By.xpath("//button[@id='forgingSaveSave']");

	public static final By FetchingDataFromScrapCostperKgFromPriceCalculationForForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='ScrapCost']");
	public static final By fetchingDataFromScrapWtPerKgPriceCalculationTabForForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='ScrapWtKg']");

	public static final By fetchingRmCostPerkgPriceCalculationForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='RMCostPC']");

	public static final By FetchingScrapCostkgPriceCalculationForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='ScrapCostPC']");

	public static final By fetchingNetRmCostPerPcForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='NetRMCostPC']");

	public static final By FEtchingPerCentageRmYieldForging = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='ForgingYield']");

	public static final By FetchingDataEndPeiceSiZe = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='EndPiece1']");

	public static final By FetchingPieceAllowances = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='EndPcAllowance']");

	public static final By FetchingCutMarginEffort = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='CutMargin1']");

	public static final By FetchingFinalBlankWtKg = By
			.xpath("//div[@id='partAttributeDivForging']/descendant::input[@id='FinalBlankWt']");

//	public void StoreData() {
//		
//		
//		String FEtchingValuefromScrapCost = waitForExpectedElement(FetchingDataFromScrapCostperKgFromPriceCalculationForForging).getAttribute("value").trim();
//		
//		String fetchingValueFromScrapWt = waitForExpectedElement(fetchingDataFromScrapWtPerKgPriceCalculationTabForForging).getAttribute("value").trim();
//		
//		String fetchingValueFrmRmCostPerKg = waitForExpectedElement(fetchingRmCostPerkgPriceCalculationForging).getAttribute("value").trim();
//		
//		String FetchingScrapCostPerKg = waitForExpectedElement(FetchingScrapCostkgPriceCalculationForging).getAttribute("value").trim();
//		
//		String NetRmCostPerpc = waitForExpectedElement(fetchingNetRmCostPerPcForging).getAttribute("value").trim();
//		
//		String FetchingDataPerCentageRmYieldForging = waitForExpectedElement(FEtchingPerCentageRmYieldForging).getAttribute("value").trim();
//		
//		String FEtchingPieceAllowances = waitForExpectedElement(FetchingPieceAllowances).getAttribute("value").trim();
//		
//		
//	}
//	

	/**
	 * -----------------------------------------------------------------------------
	 * METHOD: VerifySavePriceCalculationValue(...)
	 * -----------------------------------------------------------------------------
	 * PURPOSE: This method automates the complete Price Calculation flow for
	 * Forging. It performs: 1. Navigation to "Part Price Calculations" tab 2.
	 * Selection of RM Category, Shape, Commodity, Group, Year, Period & Grade 3.
	 * Enables Direct Entry mode by selecting all required radio buttons 4. Enters
	 * all forging related numeric values (taken from HashMap) 5. Selects OHP value
	 * (from property file as required) 6. Enters Costing Parameters (Rejection,
	 * Packing, Insurance, OHP, ICC, etc.) 7. Saves the form and validates toast
	 * message
	 *
	 * IMPORTANT: - All values used in calculations are taken ONLY from HashMap
	 * ‘map’ (No property file). - Only dropdown values like OHP remain from
	 * property file, as per user requirement. - Method returns a complete HashMap
	 * of all entered values for validation.
	 *
	 * PARAMETERS:
	 * 
	 * @param rmInputCategory     → RM Input Category dropdown value
	 * @param shapeOption         → Shape Option dropdown value
	 * @param CommodityGrp        → Commodity Group dropdown value
	 * @param groupClassification → Group Classification dropdown value
	 * @param yearValue           → Year dropdown value
	 * @param periodValue         → Period dropdown value
	 * @param specificGrade       → Specific Grade dropdown value
	 *
	 *                            RETURNS:
	 * @return HashMap<String,String> → All the values entered in the UI
	 *
	 *         -----------------------------------------------------------------------------
	 */

	public static final By DirectEntryOHPRadioBtn = By
			.xpath("//*[@id='DivForging']/descendant::input[@id='amortDirect']");

	public static final By ClickingCommodityDropdownForging = By.xpath(
			"//select[@id='commodityGroupCal']/following-sibling::span/descendant::span[@id='select2-commodityGroupCal-container']");
	public static final By EnterCommoditySearcgboxForging = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");
	public static final By listValueCommdityForging = By.xpath("//ul[@id='select2-commodityGroupCal-results']/li");

	public HashMap<String, String> VerifySavePriceCalculationValueForging(String rmInputCategory, String shapeOption,
			String CommodityGrp, String groupClassification, String yearValue, String periodValue, String specificGrade)
			throws InterruptedException {

		LoggerUtil.info("===== START: VerifySavePriceCalculationValue (PROCUREMENT • FORGING) =====");

		HashMap<String, String> map = new HashMap<>();

		// ================================
		// FIXED INPUT VALUES
		// ================================
		map.put("ForgeWeight", "12.4532");
		map.put("Perimeter", "19.73737");
		map.put("BlankWtDirect", "30.322");
		map.put("CutMargin", "11.2121");
		map.put("NoOfPieces", "15.7653");
		map.put("BlankWtKg", "12.3232");
		map.put("RejectionWastage", "12");
		map.put("FinishWeight", "10");
		map.put("ScrapRealization", "19.4123");

		map.put("RejectionValue", "20.543");
		map.put("Packing", "32.543");
		map.put("Insurance", "4.444");
		map.put("Profit", "64.3676");
		map.put("OverHead", "11");
		map.put("ICC", "2.67");
		map.put("Freight", "1.432");
		map.put("Factor1", "123");
		map.put("Factor2", "123");
		map.put("Factor3", "123");
		map.put("Remarks", "fc48");

		map.put("ToolCost", "432");
		map.put("Quantity", "3565");
		map.put("ToolAmortization", "37.4343");
		map.put("Maintenance", "21.4356");

		// ================================
		// DROPDOWN VALUES
		// ================================
		map.put("RmInputCategory", rmInputCategory);
		map.put("ShapeOption", shapeOption);
		map.put("CommodityGrp", CommodityGrp);
		map.put("GroupClassification", groupClassification);
		map.put("YearValue", yearValue);
		map.put("PeriodValue", periodValue);
		map.put("SpecificGrade", specificGrade);

		// ================================
		// OHP VALUE
		// ================================
		map.put("OHP", DataProp.getProperty("OHP"));

		try {

			// ================================
			// Navigate to Tab
			// ================================
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}
			Thread.sleep(2000);

			// ================================
			// DROPDOWNS
			// ================================
			new Select(waitForExpectedElement(RmInputCategoryDropdownn)).selectByVisibleText(rmInputCategory);
			LoggerUtil.info("Selected RmInputCategory → " + rmInputCategory);
			Thread.sleep(2000);

			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			LoggerUtil.info("Selected ShapeOption → " + shapeOption);
			Thread.sleep(3000);

			clickOnElement(ClickingCommodityDropdownForging);
			Thread.sleep(400);

			clearAndEnterText(waitForExpectedElement(EnterCommoditySearcgboxForging), CommodityGrp);
			LoggerUtil.info("Entered Commodity Search → " + CommodityGrp);

			for (WebElement c : driver.findElements(listValueCommdityForging)) {
				if (c.getText().trim().equals(CommodityGrp)) {
					c.click();
					LoggerUtil.info("Selected CommodityGrp → " + CommodityGrp);
					break;
				}
			}
			Thread.sleep(2000);

			selectDropDownValue(GroupClassificationDropdownDropdownForging, groupClassification, "visibleText");
			LoggerUtil.info("Selected Classification → " + groupClassification);
			Thread.sleep(2000);

			selectDropDownValue(yearDropdownForForging, yearValue, "visibleText");
			LoggerUtil.info("Selected Year → " + yearValue);
			Thread.sleep(2000);

			selectDropDownValue(periodDropdownForging, periodValue, "visibleText");
			LoggerUtil.info("Selected Period → " + periodValue);
			Thread.sleep(2000);

			selectDropDownValue(specificDropdownForging, specificGrade, "visibleText");
			LoggerUtil.info("Selected Specific Grade → " + specificGrade);
			Thread.sleep(2000);

			// ================================
			// RADIO BUTTONS
			// ================================
			clickRadioButton(By.id("inpblank1"), "Direct Entry");
			LoggerUtil.info("Clicked Radio → Direct Entry");
			Thread.sleep(2000);

			clickRadioButton(By.id("cutmgn1"), "Cut Margin");
			LoggerUtil.info("Clicked Radio → Cut Margin");
			Thread.sleep(2000);

			clickRadioButton(By.id("noofpcs1"), "No. of Pieces");
			LoggerUtil.info("Clicked Radio → No. of Pieces");
			Thread.sleep(2000);

			clickRadioButton(By.id("blankWtRadiodirect"), "Blank Weight");
			LoggerUtil.info("Clicked Radio → Blank Weight");
			Thread.sleep(2000);

			// ================================
			// ENTER NUMERIC INPUTS — with logging
			// ================================
			String[] keys = { "ForgeWeight", "Perimeter", "BlankWtDirect", "CutMargin", "NoOfPieces", "BlankWtKg",
					"RejectionWastage", "FinishWeight", "ScrapRealization" };

			By[] locators = { EnterForgeWeightInKg, EnterPartingLinePerimeterinmm, EnterBlankWtDirectEntry,
					EnterCutMarginMm, EnterNumberOfPieces, EnterBlankWtKgForForgeing, RejectionWastageOnBlankWt,
					EnterpartFinishWeightPerPc, EnterScrapRealization };

			for (int i = 0; i < keys.length; i++) {
				clearAndEnterText(waitForExpectedElement(locators[i]), map.get(keys[i]));
				LoggerUtil.info("Entered " + keys[i] + " → " + map.get(keys[i]));
				Thread.sleep(2000);
			}

			// ================================
			// SYSTEM CALCULATED VALUES STORED
			// ================================
			map.put("CutMarginEffort", waitForExpectedElement(FetchingCutMarginEffort).getAttribute("value"));
			map.put("FinalBlankWtKg", waitForExpectedElement(FetchingFinalBlankWtKg).getAttribute("value"));
			map.put("ScrapCostPerKg",
					waitForExpectedElement(FetchingDataFromScrapCostperKgFromPriceCalculationForForging)
							.getAttribute("value"));
			map.put("ScrapWtPerKg", waitForExpectedElement(fetchingDataFromScrapWtPerKgPriceCalculationTabForForging)
					.getAttribute("value"));
			map.put("RmCostPerKg",
					waitForExpectedElement(fetchingRmCostPerkgPriceCalculationForging).getAttribute("value"));
			map.put("ScrapCostKg",
					waitForExpectedElement(FetchingScrapCostkgPriceCalculationForging).getAttribute("value"));
			map.put("NetRmCostPerPc", waitForExpectedElement(fetchingNetRmCostPerPcForging).getAttribute("value"));
			map.put("RmYieldPercentage",
					waitForExpectedElement(FEtchingPerCentageRmYieldForging).getAttribute("value"));
			map.put("PieceAllowances", waitForExpectedElement(FetchingPieceAllowances).getAttribute("value"));

			// ================================
			// OHP DROPDOWN
			// ================================
			Thread.sleep(2000);
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownForForgeing));
			Thread.sleep(2000);

			clickOnElement(ClickingOhpDropdownForForgeing);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnteringValueOhpSearchBox), map.get("OHP"));
			LoggerUtil.info("Entered OHP search → " + map.get("OHP"));
			Thread.sleep(1200);

			for (WebElement ohp : driver.findElements(OhpOptionsForGeing)) {
				if (ohp.getText().trim().equals(map.get("OHP"))) {
					ohp.click();
					LoggerUtil.info("Selected OHP → " + map.get("OHP"));
					break;
				}
			}
			Thread.sleep(2000);

			// ================================
			// OTHER COST FIELDS
			// ================================
			String[] keys2 = { "RejectionValue", "Packing", "Insurance", "Profit", "OverHead", "ICC", "Freight",
					"Factor1", "Factor2", "Factor3", "Remarks" };

			By[] locators2 = { EnterRejectionValue, EnterPackingCellBox, EnterInsuranceValue, EnterProfitValue,
					EnterOverHeadValue, EnterICCValue, EnterFrieghtKgCellBoxValue, EnterFactorValue1, EnterFactorValue2,
					EnterFactorValue3, EnterRemarksValue };

			for (int i = 0; i < keys2.length; i++) {
				clearAndEnterText(waitForExpectedElement(locators2[i]), map.get(keys2[i]));
				LoggerUtil.info("Entered " + keys2[i] + " → " + map.get(keys2[i]));
				Thread.sleep(1500);
			}

			// ================================
			// TOOL COST VALUES
			// ================================
			clearAndEnterText(waitForExpectedElement(EnterToolCostValue), map.get("ToolCost"));
			LoggerUtil.info("Entered ToolCost → " + map.get("ToolCost"));
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterQuantityValue), map.get("Quantity"));
			LoggerUtil.info("Entered Quantity → " + map.get("Quantity"));
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterToolAmortizationValue), map.get("ToolAmortization"));
			LoggerUtil.info("Entered ToolAmortization → " + map.get("ToolAmortization"));
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterToolMantinanceCost), map.get("Maintenance"));
			LoggerUtil.info("Entered Maintenance → " + map.get("Maintenance"));
			Thread.sleep(2000);

			// ================================
			// SAVE + TOAST
			// ================================
			waitClickable(ClickingSaveButtonForging).click();
			Thread.sleep(2000);

			String Toastmsg = waitForExpectedElement(toastMessage).getText().trim();
			LoggerUtil.info("Toast message → " + Toastmsg);

			((JavascriptExecutor) driver).executeScript("window.scrollTo(0,0);");
			Thread.sleep(2000);

		} catch (Exception e) {
			LoggerUtil.error("Exception during Price Calculation: " + e.getMessage());
		}
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return map;
	}

	private static WebElement waitClickable(By by) {
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(20));
		return wait.until(ExpectedConditions.elementToBeClickable(by));
	}

	private static void scrollIntoViewSmooth(WebElement ele) {
		try {
			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("arguments[0].scrollIntoView({behavior:'smooth', block:'center'});", ele);

			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(20));
			wait.until(ExpectedConditions.visibilityOf(ele));
		} catch (Exception e) {
			System.out.println("scrollIntoViewSmooth failed → " + e.getMessage());
		}
	}

	/**
	 * -----------------------------------------------------------------------------
	 * METHOD: VerifySavePriceCalculationValue(...)
	 * -----------------------------------------------------------------------------
	 * PURPOSE: This method automates the complete Price Calculation flow for
	 * Forging. It performs: 1. Navigation to "Part Price Calculations" tab 2.
	 * Selection of RM Category, Shape, Commodity, Group, Year, Period & Grade 3.
	 * Enables Direct Entry mode by selecting all required radio buttons 4. Enters
	 * all forging related numeric values (taken from HashMap) 5. Selects OHP value
	 * (from property file as required) 6. Enters Costing Parameters (Rejection,
	 * Packing, Insurance, OHP, ICC, etc.) 7. Saves the form and validates toast
	 * message
	 *
	 * IMPORTANT: - All values used in calculations are taken ONLY from HashMap
	 * ‘map’ (No property file). - Only dropdown values like OHP remain from
	 * property file, as per user requirement. - Method returns a complete HashMap
	 * of all entered values for validation.
	 *
	 * PARAMETERS:
	 * 
	 * @param rmInputCategory     → RM Input Category dropdown value
	 * @param shapeOption         → Shape Option dropdown value
	 * @param CommodityGrp        → Commodity Group dropdown value
	 * @param groupClassification → Group Classification dropdown value
	 * @param yearValue           → Year dropdown value
	 * @param periodValue         → Period dropdown value
	 * @param specificGrade       → Specific Grade dropdown value
	 *
	 *                            RETURNS:
	 * @return HashMap<String,String> → All the values entered in the UI
	 *
	 *         -----------------------------------------------------------------------------
	 */
	public static final By clickingRadiobtnDirectEntryAmortizationQtn = By.id("amortDirect");

	public HashMap<String, String> VerifyUpdatePriceCalculationValueForForging() throws InterruptedException {

		HashMap<String, String> updatedData = new HashMap<>();

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Update Price Calculation (Forging )");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → UPDATE ONLY INPUT FIELDS (DECIMAL VALUES)
			// (Dropdowns / Radios untouched)
			// ---------------------------------------------------------
			enterAndStore(updatedData, "ForgeWeight", EnterForgeWeightInKg, "13.7532");
			enterAndStore(updatedData, "Perimeter", EnterPartingLinePerimeterinmm, "21.4373");
			enterAndStore(updatedData, "BlankWtDirect", EnterBlankWtDirectEntry, "31.8220");
			enterAndStore(updatedData, "CutMargin", EnterCutMarginMm, "12.7121");
			enterAndStore(updatedData, "NoOfPieces", EnterNumberOfPieces, "16.9653");
			enterAndStore(updatedData, "BlankWtKg", EnterBlankWtKgForForgeing, "13.5232");
			enterAndStore(updatedData, "RejectionWastage", RejectionWastageOnBlankWt, "14.25");
			enterAndStore(updatedData, "FinishWeight", EnterpartFinishWeightPerPc, "11.50");
			enterAndStore(updatedData, "ScrapRealization", EnterScrapRealization, "20.9123");

			Thread.sleep(1500);

			enterAndStore(updatedData, "RejectionValue", EnterRejectionValue, "22.543");
			enterAndStore(updatedData, "Packing", EnterPackingCellBox, "34.543");
			enterAndStore(updatedData, "Insurance", EnterInsuranceValue, "5.444");
			enterAndStore(updatedData, "Profit", EnterProfitValue, "66.3676");
			enterAndStore(updatedData, "OverHead", EnterOverHeadValue, "12.50");
			enterAndStore(updatedData, "ICC", EnterICCValue, "3.17");
			enterAndStore(updatedData, "Freight", EnterFrieghtKgCellBoxValue, "1.932");
			enterAndStore(updatedData, "Factor1", EnterFactorValue1, "124.50");
			enterAndStore(updatedData, "Factor2", EnterFactorValue2, "125.50");
			enterAndStore(updatedData, "Factor3", EnterFactorValue3, "126.50");
			enterAndStore(updatedData, "Remarks", EnterRemarksValue, "update_fc48");

			scrollToElement(waitForExpectedElement(EnterToolCostValue));
			Thread.sleep(1200);

			enterAndStore(updatedData, "ToolCost", EnterToolCostValue, "452.75");
			enterAndStore(updatedData, "Quantity", EnterQuantityValue, "3765.25");
			enterAndStore(updatedData, "ToolAmortization", EnterToolAmortizationValue, "39.9343");
			enterAndStore(updatedData, "Maintenance", EnterToolMantinanceCost, "23.9356");

			LoggerUtil.pass("All Forging input values UPDATED successfully");

			// ---------------------------------------------------------
			// STEP 3 → Save Updated Data
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonForging);
			LoggerUtil.pass("Clicked Save button for Update");

			// ---------------------------------------------------------
			// STEP 4 → Toast (optional, should not stop execution)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);

				if (toast.isDisplayed()) {
					String toastmsg = toast.getText().trim();
					updatedData.put("ToastMessage", toastmsg);
					LoggerUtil.pass("Toast Message displayed after Update → " + toastmsg);
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed after Update");
				updatedData.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Forging Update → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Update Price Calculation (Forging )");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return updatedData;
	}

	public void openDirectEntrySection() throws InterruptedException {

		// Step 1: Click on Part Price Calculations tab
		WebElement tab = waitForExpectedElement(By.xpath("//a[contains(.,'Part Price Calculations')]"));

		((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", tab);
		((JavascriptExecutor) driver).executeScript("arguments[0].click();", tab);
		LoggerUtil.info("Opened 'Part Price Calculations' tab.");

		// Step 2: Wait for the radio block to exist in DOM (no header assumption)
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(30));
		WebElement firstRadio = wait.until(ExpectedConditions.presenceOfElementLocated(By.id("optionsRadioDirect")));

		// Step 3: Scroll that radio into view (it is lower in the page)
		((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});", firstRadio);
		Thread.sleep(500);
		LoggerUtil.info("Scrolled to Direct Entry radio button section and ensured presence.");
	}

	public void waitForCostingSectionToLoad() {

		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(40));

		try {
			wait.until(ExpectedConditions.visibilityOfElementLocated(
					By.xpath("//div[@id='panelDiv' or @id='mainDiv' or contains(@class,'costing')]")));
			LoggerUtil.info("Costing section loaded successfully.");
		} catch (Exception e) {
			LoggerUtil.error("Costing section did not load in time: " + e.getMessage());
		}
	}

	public void verifyPartAttributeDataHasBeenSaveOrNotCustomerSide(Map<String, String> map) {

		LoggerUtil.info("===== START: Verifying Saved 'Part Attributes' Values =====");

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		try {
			// =========== STEP 0: Ensure Tab Active =============
			List<WebElement> headings = driver.findElements(headingLocator);

			if (headings.isEmpty() || !headings.get(0).isDisplayed()) {
				LoggerUtil.warn("⚠ Tab not active → Re-loading");

				navigateToTab("Part Price Calculations");
				Thread.sleep(1200);

				// ---- Updated Stable Navigation (NO METHOD NAME CHANGE) ----
				int maxRetry = 4;
				boolean loaded = false;

				for (int i = 1; i <= maxRetry; i++) {
					LoggerUtil.info("Attempt " + i + " to load Part Attributes tab");

					navigateToTab("Part Attributes");
					Thread.sleep(1000);

					try {
						WebElement heading = waitForExpectedElement(headingLocator);
						if (heading.isDisplayed()) {
							LoggerUtil.pass("✔ Part Attributes tab active (Attempt " + i + ")");
							loaded = true;
							break;
						}
					} catch (Exception ex) {
						LoggerUtil.warn("⚠ Heading not visible → retrying...");
					}

					Thread.sleep(600);
				}

				if (!loaded) {
					LoggerUtil.error("❌ Part Attributes tab did not load after multiple retries.");
				}
			}

			LoggerUtil.info("----- START FIELD VALIDATIONS -----");

			// ------------------------------------------------------------
			// STEP 1 — TEXT BOX VALIDATIONS
			// ------------------------------------------------------------

			validatePartAttributeValue(EnterAnnualRequirnmentOfProduct, map.get("AnnualRequirement"),
					"Annual Requirement");

			validatePartAttributeValue(EnterAverageMonthlyRequirnmentOfproduct, map.get("AverageRequirement"),
					"Average Monthly Requirement");

			validatePartAttributeValue(EnterLotSize, map.get("LotSize"), "Lot Size");

			// ------------------------------------------------------------
			// STEP 2 — SELECT2 DROPDOWN VALIDATION (Commodity Group)
			// ------------------------------------------------------------

			try {
				LoggerUtil.info("Validating Commodity Group dropdown...");

				WebElement selected = waitForExpectedElement(By.xpath(
						"//select[@id='commodityDrop']/following-sibling::span//span[@id='select2-commodityDrop-container']"));

				String actualValue = selected.getText().trim();
				String expectedValue = map.get("CommodityGroup");

				if (actualValue.equals(expectedValue)) {
					LoggerUtil.pass("Commodity Group MATCHED → " + expectedValue);
				} else {
					LoggerUtil.fail(
							"Commodity Group MISMATCH → Expected: " + expectedValue + " | Actual: " + actualValue);
				}

			} catch (Exception e) {
				LoggerUtil.error("❌ ERROR validating Commodity Group: " + e.getMessage());
			}

			LoggerUtil.info("✔ Completed Part Attributes saved value verification.");

		} catch (Exception e) {
			LoggerUtil.error("❌ ERROR in verifyPartAttributeDataHasBeenSaveOrNotCustomerSide: " + e.getMessage());
			LoggerUtil.logException(e);
		}
	}

	private void validatePartAttributeValue(By locator, String expected, String fieldName) {
		try {
			WebElement ele = waitForExpectedElement(locator);
			String actual = ele.getAttribute("value");

			if (actual == null || actual.trim().isEmpty()) {
				actual = ele.getText();
			}

			expected = (expected == null ? "" : expected.trim());
			actual = (actual == null ? "" : actual.trim());

			// ------- NUMERIC MATCH (BigDecimal) -------
			if (isNumeric(expected) && isNumeric(actual)) {
				BigDecimal exp = new BigDecimal(expected);
				BigDecimal act = new BigDecimal(actual);

				if (exp.compareTo(act) == 0) {
					LoggerUtil.pass(fieldName + " matched → Expected: " + expected + " | Actual: " + actual);
				} else {
					LoggerUtil.error(fieldName + " mismatch → Expected: " + expected + " | Actual: " + actual);
				}
			}
			// ------- STRING MATCH -------
			else {
				if (expected.equals(actual)) {
					LoggerUtil.pass(fieldName + " matched → Expected: " + expected + " | Actual: " + actual);
				} else {
					LoggerUtil.error(fieldName + " mismatch → Expected: " + expected + " | Actual: " + actual);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("Error verifying " + fieldName + ": " + e.getMessage());
		}
	}

	public void verifyPriceCalculationDataHasBeenSaveOrNotForForging(HashMap<String, String> map)
			throws InterruptedException {

		LoggerUtil.info("===== START: VERIFY UPDATED FIELDS (FORGING) =====");

		try {
			// STEP 1: Navigate to Price Calculation Tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Price Calculation tab");
					break;
				}
			}
			Thread.sleep(2000);

			// ========== FIELD-WISE VALIDATION (NO ASSERTION) ==========

			validateField("ForgeWeight", map.get("ForgeWeight"),
					waitForExpectedElement(EnterForgeWeightInKg).getAttribute("value"));

			validateField("Perimeter", map.get("Perimeter"),
					waitForExpectedElement(EnterPartingLinePerimeterinmm).getAttribute("value"));

			validateField("BlankWtDirect", map.get("BlankWtDirect"),
					waitForExpectedElement(EnterBlankWtDirectEntry).getAttribute("value"));

			validateField("CutMargin", map.get("CutMargin"),
					waitForExpectedElement(EnterCutMarginMm).getAttribute("value"));

			validateField("NoOfPieces", map.get("NoOfPieces"),
					waitForExpectedElement(EnterNumberOfPieces).getAttribute("value"));

			validateField("BlankWtKg", map.get("BlankWtKg"),
					waitForExpectedElement(EnterBlankWtKgForForgeing).getAttribute("value"));

			validateField("RejectionWastage", map.get("RejectionWastage"),
					waitForExpectedElement(RejectionWastageOnBlankWt).getAttribute("value"));

			validateField("FinishWeight", map.get("FinishWeight"),
					waitForExpectedElement(EnterpartFinishWeightPerPc).getAttribute("value"));

			validateField("ScrapRealization", map.get("ScrapRealization"),
					waitForExpectedElement(EnterScrapRealization).getAttribute("value"));

			validateField("RejectionValue", map.get("RejectionValue"),
					waitForExpectedElement(EnterRejectionValue).getAttribute("value"));

			validateField("Packing", map.get("Packing"),
					waitForExpectedElement(EnterPackingCellBox).getAttribute("value"));

			validateField("Insurance", map.get("Insurance"),
					waitForExpectedElement(EnterInsuranceValue).getAttribute("value"));

			validateField("Profit", map.get("Profit"), waitForExpectedElement(EnterProfitValue).getAttribute("value"));

			validateField("OverHead", map.get("OverHead"),
					waitForExpectedElement(EnterOverHeadValue).getAttribute("value"));

			validateField("ICC", map.get("ICC"), waitForExpectedElement(EnterICCValue).getAttribute("value"));

			validateField("Freight", map.get("Freight"),
					waitForExpectedElement(EnterFrieghtKgCellBoxValue).getAttribute("value"));

			validateField("Factor1", map.get("Factor1"),
					waitForExpectedElement(EnterFactorValue1).getAttribute("value"));

			validateField("Factor2", map.get("Factor2"),
					waitForExpectedElement(EnterFactorValue2).getAttribute("value"));

			validateField("Factor3", map.get("Factor3"),
					waitForExpectedElement(EnterFactorValue3).getAttribute("value"));

			validateField("Remarks", map.get("Remarks"),
					waitForExpectedElement(EnterRemarksValue).getAttribute("value"));

			validateField("ToolCost", map.get("ToolCost"),
					waitForExpectedElement(EnterToolCostValue).getAttribute("value"));

			validateField("Quantity", map.get("Quantity"),
					waitForExpectedElement(EnterQuantityValue).getAttribute("value"));

			validateField("ToolAmortization", map.get("ToolAmortization"),
					waitForExpectedElement(EnterToolAmortizationValue).getAttribute("value"));

			validateField("Maintenance", map.get("Maintenance"),
					waitForExpectedElement(EnterToolMantinanceCost).getAttribute("value"));

		} catch (Exception e) {
			LoggerUtil.error("Unexpected exception in Forging validation → " + e.getMessage());
		}

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		LoggerUtil.info("===== END: VERIFY UPDATED FIELDS (FORGING) =====");
	}

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationNONFerrousCaseting(String rmInputCategory,
			String EnterCommodityGroupValue, String enterClassificationValue, String EnterYear, String EnterPeriod,
			String EnterSpecificGradeValue) throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: SAVE PRICE CALCULATION (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		HashMap<String, String> map = new HashMap<>();

		try {

			// ---------------------------------------------------------
			// STEP 0 → Store Input Parameters
			// ---------------------------------------------------------
			map.put("RmInputCategory", rmInputCategory);
			map.put("CommodityGroup", EnterCommodityGroupValue);
			map.put("GroupClassification", enterClassificationValue);
			map.put("Year", EnterYear);
			map.put("Period", EnterPeriod);
			map.put("SpecificGrade", EnterSpecificGradeValue);

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}
			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category & Casting Type
			// ---------------------------------------------------------
			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);
			map.put("SelectedRmInputCategory", rmInputCategory);
			LoggerUtil.pass("RM Input Category Selected → " + rmInputCategory);

			Thread.sleep(1200);
			clickOnElement(ClickingRadioButtonNonFerrousCasting);
			LoggerUtil.pass("Non-Ferrous Casting radio selected");
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Commodity Group Selection
			// ---------------------------------------------------------
			clickOnElement(ClickingCommodityDropdownNonFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterSearchValueCommodityGroupValueNonFerrousCasting),
					EnterCommodityGroupValue);
			LoggerUtil.pass("Commodity Group Entered → " + EnterCommodityGroupValue);

			Thread.sleep(1200);
			for (WebElement ele : driver.findElements(optionCommodiytDropdown)) {
				if (ele.getText().trim().equals(EnterCommodityGroupValue)) {
					ele.click();
					LoggerUtil.pass("Commodity Group Selected → " + EnterCommodityGroupValue);
					break;
				}
			}

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 4 → Group Classification
			// ---------------------------------------------------------
			clickOnElement(clickingGroupClassificationNonFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterGroupClassificationValueNonFerrousCasting),
					enterClassificationValue);
			LoggerUtil.pass("Classification Entered → " + enterClassificationValue);

			Thread.sleep(1200);
			for (WebElement ele : driver.findElements(ClassificationDropdownOptionNonFerrousCasting)) {
				if (ele.getText().trim().equals(enterClassificationValue)) {
					ele.click();
					LoggerUtil.pass("Classification Selected → " + enterClassificationValue);
					break;
				}
			}

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → Year, Period, Specific Grade
			// ---------------------------------------------------------
			selectDropDownValue(selectingYearValueForNonFerrousCasting, EnterYear, "visibleText");
			map.put("SelectedYear", EnterYear);
			LoggerUtil.pass("Year Selected → " + EnterYear);

			Thread.sleep(1200);

			selectDropDownValue(SelectingPeriodFromDropdownNonFerrousCasting, EnterPeriod, "visibleText");
			map.put("SelectedPeriod", EnterPeriod);
			LoggerUtil.pass("Period Selected → " + EnterPeriod);

			Thread.sleep(1200);

			clickOnElement(clickingSpecificDropdownNonFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterSpecificGradeNameNonFerrousCasting), EnterSpecificGradeValue);
			LoggerUtil.pass("Specific Grade Entered → " + EnterSpecificGradeValue);

			Thread.sleep(1200);
			for (WebElement ele : driver.findElements(optionSpecificDropdownNonFerrousCasting)) {
				if (ele.getText().trim().equals(EnterSpecificGradeValue)) {
					ele.click();
					LoggerUtil.pass("Specific Grade Selected → " + EnterSpecificGradeValue);
					break;
				}
			}

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 6 → Numeric Inputs
			// ---------------------------------------------------------
			enterValue("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, "234.4553", map);
			enterValue("CastingYield", EnterCastingYeildNonFerrousCastingValue, "32", map);
			enterValue("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, "12", map);
			enterValue("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, "65", map);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 7 → OHP Selection
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownNonFerrousCasting));
			Thread.sleep(1500);

			clickOnElement(ClickingOhpDropdownNonFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterOhpnameDropdownSearchBoxNonFerrousCasting),
					DataProp.getProperty("OHP"));
			map.put("OHPName", DataProp.getProperty("OHP"));
			LoggerUtil.pass("OHP Entered → " + DataProp.getProperty("OHP"));

			Thread.sleep(1200);
			for (WebElement ohp : driver.findElements(SelectoptionOhpDropdownNonFerrousCastingForProcurnmentSide)) {
				if (ohp.getText().trim().equals(DataProp.getProperty("OHP"))) {
					ohp.click();
					LoggerUtil.pass("OHP Selected → " + DataProp.getProperty("OHP"));
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 8 → Cost & Tool Inputs
			// ---------------------------------------------------------
			enterValue("Rejection", EnterRejectiongValueNonFerrousCasting, "12", map);
			enterValue("Packing", EnterPackingValueNonFerrousCasting, "21", map);
			enterValue("Insurance", EnterInsuranceNonFerrousCasting, "10", map);
			enterValue("Profit", EnterProfitNonFerrousCasting, "45", map);
			enterValue("OverHead", EnterOverHeadNonFerrousCasting, "21", map);
			enterValue("IncoTerm", EnterIncoTermNonFerrousCasting, "34", map);
			enterValue("ICC", EnterIccNonFerrousCasting, "9", map);
			enterValue("FreightPerKg", EnterFreightPerKgNonFerrousCasting, "32", map);
			enterValue("Forwarding", EnterForWardingNonFerrousCasting, "11", map);
			enterValue("Factor1", EnterFactor1NonFerrousCasting, "2", map);
			enterValue("Factor2", EnterFactor2NonFerrousCasting, "3", map);
			enterValue("Factor3", EnterFactor3NonFerrousCasting, "43", map);
			enterValue("Remarks", EnterRemarksNonFerrousCasting, "2.43433", map);

			enterValue("ToolCost", EnterToolCostNonFerrousCasting, "2.433", map);
			enterValue("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, "233", map);
			enterValue("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, "24343", map);
			enterValue("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, "23", map);

			// ---------------------------------------------------------
			// STEP 9 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonNonFerrousCasting);
			LoggerUtil.pass("Clicked Save button");

			Thread.sleep(1500);

			try {
				WebElement toast = driver.findElement(toastMessage);
				if (toast.isDisplayed()) {
					map.put("ToastMessage", toast.getText().trim());
					LoggerUtil.pass("Toast Message → " + toast.getText().trim());
				}
			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed");
				map.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in Non-Ferrous Casting Save → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: SAVE PRICE CALCULATION (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		return map;
	}

	public HashMap<String, String> updatePriceCalculationNonFerrousCasting() throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Update Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		HashMap<String, String> updatedMap = new HashMap<>();

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Update numeric inputs
			// ---------------------------------------------------------
			enterValue("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, "240.7788", updatedMap);

			enterValue("CastingYield", EnterCastingYeildNonFerrousCastingValue, "36", updatedMap);

			enterValue("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, "15", updatedMap);

			enterValue("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, "72", updatedMap);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Cost fields
			// ---------------------------------------------------------
			enterValue("Rejection", EnterRejectiongValueNonFerrousCasting, "18", updatedMap);
			enterValue("Packing", EnterPackingValueNonFerrousCasting, "26", updatedMap);
			enterValue("Insurance", EnterInsuranceNonFerrousCasting, "14", updatedMap);
			enterValue("Profit", EnterProfitNonFerrousCasting, "52", updatedMap);
			enterValue("OverHead", EnterOverHeadNonFerrousCasting, "29", updatedMap);
			enterValue("IncoTerm", EnterIncoTermNonFerrousCasting, "41", updatedMap);
			enterValue("ICC", EnterIccNonFerrousCasting, "13", updatedMap);
			enterValue("FreightPerKg", EnterFreightPerKgNonFerrousCasting, "37", updatedMap);
			enterValue("Forwarding", EnterForWardingNonFerrousCasting, "16", updatedMap);
			enterValue("Factor1", EnterFactor1NonFerrousCasting, "6", updatedMap);
			enterValue("Factor2", EnterFactor2NonFerrousCasting, "7", updatedMap);
			enterValue("Factor3", EnterFactor3NonFerrousCasting, "52", updatedMap);
			enterValue("Remarks", EnterRemarksNonFerrousCasting, "update_nf", updatedMap);

			// ---------------------------------------------------------
			// STEP 4 → Tooling
			// ---------------------------------------------------------
			enterValue("ToolCost", EnterToolCostNonFerrousCasting, "5.988", updatedMap);
			enterValue("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, "455", updatedMap);
			enterValue("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, "32555", updatedMap);
			enterValue("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, "39", updatedMap);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonNonFerrousCasting);
			LoggerUtil.pass("Clicked Save button for update");

			Thread.sleep(1500);

			try {
				WebElement toast = driver.findElement(toastMessage);
				updatedMap.put("ToastMessage", toast.getText().trim());
				LoggerUtil.pass("Toast → " + toast.getText().trim());
			} catch (NoSuchElementException e) {
				updatedMap.put("ToastMessage", "NOT_DISPLAYED");
				LoggerUtil.fail("Toast not displayed after update");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during update → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Update Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		return updatedMap;
	}

	public void validatePriceCalculationNonFerrousCasting(HashMap<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown validations
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("SelectedRmInputCategory"),
					"RM Input Category");

			validateDropdownValue(selectingYearValueForNonFerrousCasting, expectedData.get("SelectedYear"), "Year");

			validateDropdownValue(SelectingPeriodFromDropdownNonFerrousCasting, expectedData.get("SelectedPeriod"),
					"Period");

			// ---------------------------------------------------------
			// STEP 3 → Numeric validations
			// ---------------------------------------------------------
			validateInput("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, expectedData);

			validateInput("CastingYield", EnterCastingYeildNonFerrousCastingValue, expectedData);

			validateInput("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, expectedData);

			validateInput("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, expectedData);

			// ---------------------------------------------------------
			// STEP 4 → OHP validation
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownNonFerrousCasting));
			Thread.sleep(1200);

			validateDropdownValue(ClickingOhpDropdownNonFerrousCasting, expectedData.get("OHPName"), "OHP");

			// ---------------------------------------------------------
			// STEP 5 → Cost & Tool validation
			// ---------------------------------------------------------
			validateInput("Rejection", EnterRejectiongValueNonFerrousCasting, expectedData);
			validateInput("Packing", EnterPackingValueNonFerrousCasting, expectedData);
			validateInput("Insurance", EnterInsuranceNonFerrousCasting, expectedData);
			validateInput("Profit", EnterProfitNonFerrousCasting, expectedData);
			validateInput("OverHead", EnterOverHeadNonFerrousCasting, expectedData);
			validateInput("IncoTerm", EnterIncoTermNonFerrousCasting, expectedData);
			validateInput("ICC", EnterIccNonFerrousCasting, expectedData);
			validateInput("FreightPerKg", EnterFreightPerKgNonFerrousCasting, expectedData);
			validateInput("Forwarding", EnterForWardingNonFerrousCasting, expectedData);
			validateInput("Factor1", EnterFactor1NonFerrousCasting, expectedData);
			validateInput("Factor2", EnterFactor2NonFerrousCasting, expectedData);
			validateInput("Factor3", EnterFactor3NonFerrousCasting, expectedData);
			validateInput("Remarks", EnterRemarksNonFerrousCasting, expectedData);

			validateInput("ToolCost", EnterToolCostNonFerrousCasting, expectedData);
			validateInput("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, expectedData);
			validateInput("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, expectedData);
			validateInput("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, expectedData);

			LoggerUtil.pass("✔ Non-Ferrous Casting validation successful");

		} catch (Exception e) {
			LoggerUtil.error("❌ Validation failed → " + e.getMessage());
			throw e;
		}

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");
	}

	public void validatePriceCalculationNONFerrousCasting(HashMap<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}
			Thread.sleep(3000);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown validations
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("SelectedRmInputCategory"),
					"RM Input Category");

			validateDropdownValue(selectingYearValueForNonFerrousCasting, expectedData.get("SelectedYear"), "Year");

			validateDropdownValue(SelectingPeriodFromDropdownNonFerrousCasting, expectedData.get("SelectedPeriod"),
					"Period");

			// ---------------------------------------------------------
			// STEP 3 → Numeric field validations
			// ---------------------------------------------------------
			validateInput("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, expectedData);

			validateInput("CastingYield", EnterCastingYeildNonFerrousCastingValue, expectedData);

			validateInput("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, expectedData);

			validateInput("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, expectedData);

			// ---------------------------------------------------------
			// STEP 4 → OHP validation
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownNonFerrousCasting));
			Thread.sleep(1500);

			validateDropdownValue(ClickingOhpDropdownNonFerrousCasting, expectedData.get("OHPName"), "OHP");

			// ---------------------------------------------------------
			// STEP 5 → Cost + Tool validations
			// ---------------------------------------------------------
			validateInput("Rejection", EnterRejectiongValueNonFerrousCasting, expectedData);
			validateInput("Packing", EnterPackingValueNonFerrousCasting, expectedData);
			validateInput("Insurance", EnterInsuranceNonFerrousCasting, expectedData);
			validateInput("Profit", EnterProfitNonFerrousCasting, expectedData);
			validateInput("OverHead", EnterOverHeadNonFerrousCasting, expectedData);
			validateInput("IncoTerm", EnterIncoTermNonFerrousCasting, expectedData);
			validateInput("ICC", EnterIccNonFerrousCasting, expectedData);
			validateInput("FreightPerKg", EnterFreightPerKgNonFerrousCasting, expectedData);
			validateInput("Forwarding", EnterForWardingNonFerrousCasting, expectedData);
			validateInput("Factor1", EnterFactor1NonFerrousCasting, expectedData);
			validateInput("Factor2", EnterFactor2NonFerrousCasting, expectedData);
			validateInput("Factor3", EnterFactor3NonFerrousCasting, expectedData);
			validateInput("Remarks", EnterRemarksNonFerrousCasting, expectedData);

			validateInput("ToolCost", EnterToolCostNonFerrousCasting, expectedData);
			validateInput("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, expectedData);
			validateInput("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, expectedData);
			validateInput("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, expectedData);

			LoggerUtil.pass("✔ Non-Ferrous Casting validation completed successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Validation failed → " + e.getMessage());
			throw e;
		}
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Non-Ferrous Casting)");
		LoggerUtil.info("==============================================");
	}

	public void verifyPriceCalculationDataHasBeenSaveOrNotFERROUSCASTING(HashMap<String, String> map)
			throws InterruptedException {

		// Navigate to tab
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
				break;
			}
		}

		LoggerUtil.info("=============== START VALIDATION (FERROUS CASTING PROCUREMENT) ================");

		// *** VALIDATE START IN SAME SEQUENCE AS ENTERED ***

		// 1. Rm Input Category
		validateField("RmInputCategory", map.get("SelectedRmInputCategory"),
				new Select(waitForExpectedElement(RmInputCategoryDropdownn)).getFirstSelectedOption().getText());

		// 2. Classification
		validateField("Classification", map.get("SelectedClassification"),
				new Select(waitForExpectedElement(SelectingGroupClassificationFerrous)).getFirstSelectedOption()
						.getText());

		// 3. Year
		validateField("Year", map.get("SelectedYear"),
				new Select(waitForExpectedElement(selectingYearValueFromYearDropdownFerrousCasting))
						.getFirstSelectedOption().getText());

		// 4. Period
		validateField("Period", map.get("SelectedPeriod"),
				new Select(waitForExpectedElement(selectingRmPeriodFerrousCasting)).getFirstSelectedOption().getText());

		// 5. Specific Grade
		validateField("SpecificGrade", map.get("SelectedSpecificGrade"),
				new Select(waitForExpectedElement(selectingSpecificGradeFerrousCasting)).getFirstSelectedOption()
						.getText());

		// 6. Cast Weight
		validateField("CastWeight", map.get("CastWeight"),
				waitForExpectedElement(EnterCastWeightKgFerrousCasting).getAttribute("value").trim());

		// 7. Finish Weight
		validateField("FinishWeight", map.get("FinishWeight"),
				waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting).getAttribute("value").trim());

		// 8. Scrap Realization
		validateField("ScrapRealization", map.get("ScrapRealization"),
				waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value").trim());

		// 9. Scrap Cost/Kg
		validateField("ScrapCostPerKg", map.get("ScrapCostPerKg"),
				waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim());

		// 10. RM Cost/PC
		validateField("RmCostPerPc", map.get("RmCostPerPc"),
				waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim());

		// ------------------ 11. Corrected OHP Validation ------------------
		LoggerUtil.info("Validating OHP Selected Value...");

		String actualOHP = waitForExpectedElement(By.xpath(
				"//select[@id='ferrousOhp']/following-sibling::span/descendant::span[@id='select2-ferrousOhp-container']"))
				.getText().trim();

		String expectedOHP = map.get("OHP");

		// correct order → expected, actual
		validateField("OHP", expectedOHP, actualOHP);
		// -------------------------------------------------------------------

		// 12. Rejection Value
		validateField("RejectionValue", map.get("RejectionValue"),
				waitForExpectedElement(EnterRejectionValueFerrousCasting).getAttribute("value").trim());

		// 13. Insurance
		validateField("Insurance", map.get("Insurance"),
				waitForExpectedElement(EnterInsuranceFerrousCasting).getAttribute("value").trim());

		// 14. Packing
		validateField("Packing", map.get("Packing"),
				waitForExpectedElement(EnterPackingcellFerrousCating).getAttribute("value").trim());

		// 15. Profit
		validateField("Profit", map.get("Profit"),
				waitForExpectedElement(EnterProfitValueForFerrousCasting).getAttribute("value").trim());

		// 16. OverHead
		validateField("OverHead", map.get("OverHead"),
				waitForExpectedElement(EnterOverHeadValueForFerrousCasting).getAttribute("value").trim());

		// 17. Incoterms
		validateField("Incoterms", map.get("Incoterms"),
				waitForExpectedElement(EnterIncoTermsForFerrousCasting).getAttribute("value").trim());

		// 18. Freight
		validateField("Freight", map.get("Freight"),
				waitForExpectedElement(EnterFrieghtKgFerrousCasting).getAttribute("value").trim());

		// 19. Factor 1
		validateField("Factor1", map.get("Factor1"),
				waitForExpectedElement(EnterOtherFactor1FerrousCasting).getAttribute("value").trim());

		// 20. Factor 2
		validateField("Factor2", map.get("Factor2"),
				waitForExpectedElement(EnterOtherFactor2FerrousCasting).getAttribute("value").trim());

		// 21. Factor 3
		validateField("Factor3", map.get("Factor3"),
				waitForExpectedElement(EnterOtherFactor3FerrousCasting).getAttribute("value").trim());

		// 22. Remarks
		validateField("Remarks", map.get("Remarks"),
				waitForExpectedElement(EnterRemarksValueForFerrousCasting).getAttribute("value").trim());

		// 23. Tool Cost
		validateField("ToolCost", map.get("ToolCost"),
				waitForExpectedElement(EnterToolCastValueFerrousCasting).getAttribute("value").trim());

		// 24. Amortization Quantity
		validateField("AmortizationQty", map.get("AmortizationQty"),
				waitForExpectedElement(EnterAmortizationQuantityFerrousCasting).getAttribute("value").trim());

		// 25. Tool Amortization / Pc
		validateField("ToolAmortization", map.get("ToolAmortization"),
				waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting).getAttribute("value").trim());

		// 26. Tool Maintenance
		validateField("ToolMaintenance", map.get("ToolMaintenance"),
				waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting).getAttribute("value").trim());

		// 27. Part Cost Per Pc A (Calculated)
		validateField("PartCostPerPcA", map.get("PartCostPerPcA"),
				waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim());

		// 28. Part Cost With Amortization
		validateField("TotalPartCostPerPcAWithAmortization", map.get("TotalPartCostPerPcAWithAmortization"),
				waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization).getAttribute("value").trim());

		LoggerUtil.info("=============== END OF VALIDATION ================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

	}

	private void verifyOHPSelected(By locator, String expectedValue, String fieldName) {
		try {
			WebElement ele = waitForExpectedElement(locator);

			// For bootstrap dropdowns: first check "value", then text().
			String actualValue = ele.getAttribute("value");

			if (actualValue == null || actualValue.trim().isEmpty()) {
				actualValue = ele.getText();
			}

			actualValue = actualValue.trim();

			if (actualValue.equalsIgnoreCase(expectedValue.trim())) {
				LoggerUtil.pass(
						fieldName + " selected correctly → Expected: " + expectedValue + " | Actual: " + actualValue);
			} else {
				LoggerUtil.error(fieldName + " mismatch → Expected: " + expectedValue + " | Actual: " + actualValue);
			}

		} catch (Exception e) {
			LoggerUtil.error("Unable to verify OHP dropdown selection → " + e.getMessage());
		}
	}

	public void validateUpdatedNonFerrousCastingValuesPriceCalc(Map<String, String> updatedMap)
			throws InterruptedException {

		LoggerUtil.info("===============================================");
		LoggerUtil.info("   START: VALIDATION OF UPDATED PRICE FIELDS");
		LoggerUtil.info("===============================================");

		if (updatedMap == null || updatedMap.isEmpty()) {
			LoggerUtil.error("❌ Updated Map is EMPTY! Validation cannot start.");
			return;
		}

		// STEP 1 → Go to tab
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to Part Price Calculations tab.");
				break;
			}
		}
		Thread.sleep(2500);

		int passCount = 0;
		int failCount = 0;

		// ---- VALIDATE ALL UPDATED TEXT FIELDS ----
		passCount += validateField("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, updatedMap);
		passCount += validateField("CastingYield", EnterCastingYeildNonFerrousCastingValue, updatedMap);
		passCount += validateField("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, updatedMap);
		passCount += validateField("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, updatedMap);

		passCount += validateField("Rejection", EnterRejectiongValueNonFerrousCasting, updatedMap);
		passCount += validateField("Packing", EnterPackingValueNonFerrousCasting, updatedMap);
		passCount += validateField("Insurance", EnterInsuranceNonFerrousCasting, updatedMap);
		passCount += validateField("Profit", EnterProfitNonFerrousCasting, updatedMap);
		passCount += validateField("OverHead", EnterOverHeadNonFerrousCasting, updatedMap);
		passCount += validateField("IncoTerm", EnterIncoTermNonFerrousCasting, updatedMap);
		passCount += validateField("ICC", EnterIccNonFerrousCasting, updatedMap);

		passCount += validateField("FreightPerKg", EnterFreightPerKgNonFerrousCasting, updatedMap);
		passCount += validateField("Forwarding", EnterForWardingNonFerrousCasting, updatedMap);

		passCount += validateField("Factor1", EnterFactor1NonFerrousCasting, updatedMap);
		passCount += validateField("Factor2", EnterFactor2NonFerrousCasting, updatedMap);
		passCount += validateField("Factor3", EnterFactor3NonFerrousCasting, updatedMap);

		passCount += validateField("Remarks", EnterRemarksNonFerrousCasting, updatedMap);

		passCount += validateField("ToolCost", EnterToolCostNonFerrousCasting, updatedMap);
		passCount += validateField("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, updatedMap);
		passCount += validateField("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, updatedMap);
		passCount += validateField("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, updatedMap);

		failCount = updatedMap.size() - passCount;

		LoggerUtil.info("===============================================");
		LoggerUtil.info("VALIDATION SUMMARY (PRICE CALCULATION UPDATE)");
		LoggerUtil.info("PASS COUNT → " + passCount);
		LoggerUtil.info("FAIL COUNT → " + failCount);

		if (failCount == 0)
			LoggerUtil.pass("✔ ALL UPDATED NON-FERROUS PRICE CALCULATION VALUES MATCH!");
		else
			LoggerUtil.error("❌ SOME FIELDS FAILED VALIDATION!");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		LoggerUtil.info("===============================================");
	}

	private int validateField(String key, By locator, Map<String, String> updatedMap) {
		try {
			String expected = updatedMap.get(key);

			if (expected == null) {
				LoggerUtil.warn("⚠ Skipped validation for [" + key + "] → Not updated");
				return 0;
			}

			WebElement ele = waitForExpectedElement(locator);
			String actual = ele.getAttribute("value").trim();

			if (actual.equals(expected)) {
				LoggerUtil.pass("PASS → [" + key + "] Expected=" + expected + " | Actual=" + actual);
				return 1;
			} else {
				LoggerUtil.error("FAIL → [" + key + "] Expected=" + expected + " | Actual=" + actual);
				return 0;
			}

		} catch (Exception e) {
			LoggerUtil.error("EXCEPTION validating [" + key + "] → " + e.getMessage());
			return 0;
		}
	}

	public void validateBopTable(HashMap<String, String> bopMap) throws InterruptedException {

		LoggerUtil.info("--------------------------------------------------");
		LoggerUtil.info("     STARTING BOP VALIDATION (UI ↔ MAP)");
		LoggerUtil.info("--------------------------------------------------");

		// 🔒 FAIL FAST IF EXPECTED MAP INVALID
		if (bopMap == null || bopMap.isEmpty()) {
			LoggerUtil.error("❌ BOP validation aborted → Expected data map is NULL / EMPTY");
			return;
		}

		LoggerUtil.info("Expected BOP values received → " + bopMap);

		Thread.sleep(2000);

		// ------------------------- PART NO -------------------------
		try {

			By bopHeadingLocator = By.xpath("//h3[contains(text(),'Standard Bought out or Imported')]");

			// FORCE MOVE TO BOP TAB
			forceMoveToBOP();

			if (!validateStandardBopTableReady()) {
				LoggerUtil.error("❌ Aborting Standard BOP validation due to table not ready.");
				return;
			}

			WebElement header = Base.waitForExpectedElement(bopHeadingLocator);
			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ BOP header not visible after tab switch");
				return;
			}
			LoggerUtil.pass("✔ BOP page loaded successfully");

			String uiPartNo = waitForExpectedElement(By.xpath("//span[@id='select2-item_partnostandard_1-container']"))
					.getText().trim();

			String expectedPartNoRaw = bopMap.get("PartNo");

			if (expectedPartNoRaw == null || expectedPartNoRaw.trim().isEmpty()) {
				LoggerUtil.error("❌ Expected Part No is NULL / EMPTY → Update flow failed");
			} else {
				String expectedPartNo = normalize3(expectedPartNoRaw);
				if (uiPartNo.equals(expectedPartNo)) {
					LoggerUtil.pass("Part No matched → " + expectedPartNo);
				} else {
					LoggerUtil.error("Part No mismatch → Expected: " + expectedPartNo + " | Actual: " + uiPartNo);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception validating Part No → " + e.getMessage());
		}

		// ------------------------- QTY/PC -------------------------
		try {
			String expectedQtyRaw = bopMap.get("QtyPerPc");

			if (expectedQtyRaw == null || expectedQtyRaw.trim().isEmpty()) {
				LoggerUtil.error("❌ Expected Qty/Pc is NULL / EMPTY → Update flow failed");
			} else {
				String uiQty = normalize3(getValueFromBopTableCell("Qty/Pc"));
				String expectedQty = normalize3(expectedQtyRaw);

				if (uiQty.equals(expectedQty)) {
					LoggerUtil.pass("Qty/Pc matched → " + expectedQty);
				} else {
					LoggerUtil.error("Qty/Pc mismatch → Expected: " + expectedQty + " | Actual: " + uiQty);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception validating Qty/Pc → " + e.getMessage());
		}

		// ------------------------- PART COST / UNIT -------------------------
		try {
			String expectedCostRaw = bopMap.get("PartCostPerUnit");

			if (expectedCostRaw == null || expectedCostRaw.trim().isEmpty()) {
				LoggerUtil.error("❌ Expected Part Cost/Unit is NULL / EMPTY → Update flow failed");
			} else {
				String uiCost = normalize3(getValueFromBopTableCell("Part Cost/Unit"));
				String expectedCost = normalize3(expectedCostRaw);

				if (uiCost.equals(expectedCost)) {
					LoggerUtil.pass("Part Cost/Unit matched → " + expectedCost);
				} else {
					LoggerUtil.error("Part Cost/Unit mismatch → Expected: " + expectedCost + " | Actual: " + uiCost);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception validating Part Cost/Unit → " + e.getMessage());
		}

		// ------------------------- TOTAL COST (UI) -------------------------
		// ------------------------- TOTAL COST (UI) -------------------------
		try {
		    String qtyRaw = bopMap.get("QtyPerPc");
		    String partCostRaw = bopMap.get("PartCostPerUnit");

		    if (qtyRaw == null || partCostRaw == null) {
		        LoggerUtil.error("❌ Qty or Part Cost missing → cannot validate Total Cost");
		    } else {
		        double qty = Double.parseDouble(qtyRaw);
		        double partCost = Double.parseDouble(partCostRaw);

		        // 🔥 Expected calculated by test itself
		        String expectedTotal =
		                normalize3(String.format("%.3f", qty * partCost));

		        // 🔥 WAIT until UI recalculates
		        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
		        wait.until(d -> {
		            String uiVal = normalize3(getValueFromBopTableCell("Total Cost"));
		            return uiVal.equals(expectedTotal);
		        });

		        // 🔥 Actual from UI
		        String actualTotal =
		                normalize3(getValueFromBopTableCell("Total Cost"));

		        if (actualTotal.equals(expectedTotal)) {
		            LoggerUtil.pass("Total Cost (UI) matched → " + expectedTotal);
		        } else {
		            LoggerUtil.error("Total Cost (UI) mismatch → Expected: "
		                    + expectedTotal + " | Actual: " + actualTotal);
		        }
		    }

		} catch (Exception e) {
		    LoggerUtil.error("Exception validating Total Cost (UI) → " + e.getMessage());
		}

		// ------------------------- TOTAL COST EXTRA FIXED -------------------------
		try {
			String expectedExtra = bopMap.get("TotalCost_ExtraCell");

			if (expectedExtra == null || expectedExtra.trim().isEmpty()) {
				LoggerUtil.info("Skipping Extra Cell validation because expected value is blank/empty.");
			} else {
				String uiExtra = normalize3(waitForExpectedElement(TotalCostExtraCell).getAttribute("value").trim());
				expectedExtra = normalize3(expectedExtra);

				if (uiExtra.equals(expectedExtra)) {
					LoggerUtil.pass("Total Cost (Extra Cell) matched → " + expectedExtra);
				} else {
					LoggerUtil.error(
							"Total Cost (Extra Cell) mismatch → Expected: " + expectedExtra + " | Actual: " + uiExtra);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception validating Extra Cell Total Cost → " + e.getMessage());
		}

		// ------------------------- HEADER VALUES -------------------------
		LoggerUtil.info("------ VALIDATING ALL HEADER VALUES ------");

		for (String key : bopMap.keySet()) {

			if (!key.startsWith("Header_"))
				continue;

			String headerName = key.replace("Header_", "").trim();

			if (headerName.equals("Qty/Pc") || headerName.equals("Part Cost/Unit") || headerName.equals("Total Cost"))
				continue;

			String expectedRaw = bopMap.get(key);

			if (expectedRaw == null || expectedRaw.trim().isEmpty()) {
				LoggerUtil.info("Skipping header validation for blank expected value → " + headerName);
				continue;
			}

			try {
				String expected = normalize3(expectedRaw);
				String uiValue = normalize3(getValueFromBopTableCell(headerName));

				if (uiValue.equals(expected)) {
					LoggerUtil.pass(headerName + " matched → " + expected);
				} else {
					LoggerUtil.error(headerName + " mismatch → Expected: " + expected + " | Actual: " + uiValue);
				}

			} catch (Exception e) {
				LoggerUtil.error("Exception validating '" + headerName + "' → " + e.getMessage());
			}
		}

		LoggerUtil.info("--------------------------------------------------");
		LoggerUtil.info("           BOP VALIDATION COMPLETED");
		LoggerUtil.info("--------------------------------------------------");
	}

	private boolean validateStandardBopTableReady() {

		try {
			// 1️⃣ Verify BOP header
			By bopHeadingLocator = By.xpath("//h3[contains(text(),'Standard Bought out or Imported')]");

			WebElement header = Base.waitForExpectedElement(bopHeadingLocator);
			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ Standard BOP header NOT visible.");
				return false;
			}
			LoggerUtil.pass("✔ Standard BOP header visible.");

			// 2️⃣ Verify table body present
			List<WebElement> rows = driver.findElements(By.xpath("//tbody[@id='bopStandardBody']/tr"));

			if (rows.isEmpty()) {
				LoggerUtil.error("❌ Standard BOP table loaded but NO rows present.");
				return false;
			}

			if (!rows.get(0).isDisplayed()) {
				LoggerUtil.error("❌ Standard BOP first row NOT visible.");
				return false;
			}

			LoggerUtil.pass("✔ Standard BOP table & first row ready.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ Standard BOP readiness check failed → " + e.getMessage());
			return false;
		}
	}

	public void validateBopInHouseTable(HashMap<String, String> bopMap) throws InterruptedException {

		LoggerUtil.info("--------------------------------------------------");
		LoggerUtil.info("   STARTING BOP IN-HOUSE VALIDATION (UI ↔ MAP)");
		LoggerUtil.info("--------------------------------------------------");

		if (!validateInHouseTableReady()) {
			LoggerUtil.error("❌ There is no data in Bop in House Table ");
			return;
		}

		try {

			// Step 1️⃣: Navigate to BOP Tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("BOP")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'BOP' tab successfully.");
					break;
				}
			}
			Thread.sleep(2000);

			// Step 2️⃣: Verify In-House header visible
			String headerText = waitForExpectedElement(FetchingBopHeaderInHouse).getText().trim();
			if (!headerText.contains("In House")) {
				LoggerUtil.error("❌ In House BOP section NOT visible on validation.");
			} else {
				LoggerUtil.pass("✔ In House BOP section visible for validation.");
			}

			// Step 3️⃣: Build Header Map
			List<WebElement> headernames = driver.findElements(TableHeadersNamesBopInhouseTable);
			Map<String, Integer> headerIndex = new LinkedHashMap<>();

			for (int i = 0; i < headernames.size(); i++) {
				headerIndex.put(headernames.get(i).getText().trim(), i);
			}

			LoggerUtil.info("ℹ In-House Header Map: " + headerIndex);

			// Step 4️⃣: Get first data row
			List<WebElement> rows = driver.findElements(By.xpath("//tbody[@id='bopInhouseBody']/tr"));
			if (rows.isEmpty()) {
				LoggerUtil.error("❌ No rows found in BOP In-House table.");
				return;
			}

			WebElement row = rows.get(0);
			List<WebElement> cells = row.findElements(By.xpath("./th | ./td"));

			// =========================================================
			// 1️⃣ VALIDATE PART NO (Select2)
			// =========================================================
			try {
				WebElement inhousePartSpan = waitForExpectedElement(By.id("select2-item_partnoinhouse_1-container"));

				String uiPartNo = inhousePartSpan.getText().trim();
				String expectedPartNo = bopMap.get("Part No") != null ? bopMap.get("Part No").trim() : "";

				if (uiPartNo.equals(expectedPartNo)) {
					LoggerUtil.pass("Part No (In-House) matched → " + expectedPartNo);
				} else {
					LoggerUtil.error(
							"Part No (In-House) mismatch → Expected: " + expectedPartNo + " | Actual: " + uiPartNo);
				}

			} catch (Exception e) {
				LoggerUtil.error("Exception validating In-House Part No → " + e.getMessage());
			}

			// =========================================================
			// 2️⃣ VALIDATE Qty/Pc
			// =========================================================
			try {
				if (headerIndex.containsKey("Qty/Pc")) {

					int idx = headerIndex.get("Qty/Pc");
					WebElement qtyCell = cells.get(idx);
					WebElement qtyInput = qtyCell.findElement(By.tagName("input"));

					String uiQty = normalize3(qtyInput.getAttribute("value").trim());
					String expectedQty = normalize3(bopMap.get("Qty/Pc"));

					if (uiQty.equals(expectedQty)) {
						LoggerUtil.pass("Qty/Pc (In-House) matched → " + expectedQty);
					} else {
						LoggerUtil
								.error("Qty/Pc (In-House) mismatch → Expected: " + expectedQty + " | Actual: " + uiQty);
					}

				} else {
					LoggerUtil.info("Header 'Qty/Pc' not found. Skipping Qty validation.");
				}

			} catch (Exception e) {
				LoggerUtil.error("Exception validating Qty/Pc (In-House) → " + e.getMessage());
			}

			// =========================================================
			// 3️⃣ VALIDATE Part Cost/Unit
			// =========================================================
			try {
				if (headerIndex.containsKey("Part Cost/Unit")) {

					int idx = headerIndex.get("Part Cost/Unit");
					WebElement cell = cells.get(idx);
					WebElement input = cell.findElement(By.tagName("input"));

					String uiCost = normalize3(input.getAttribute("value").trim());
					String expectedCost = normalize3(bopMap.get("Part Cost/Unit"));

					if (uiCost.equals(expectedCost)) {
						LoggerUtil.pass("Part Cost/Unit (In-House) matched → " + expectedCost);
					} else {
						LoggerUtil.error("Part Cost/Unit (In-House) mismatch → Expected: " + expectedCost
								+ " | Actual: " + uiCost);
					}

				} else {
					LoggerUtil.info("Header 'Part Cost/Unit' not found. Skipping.");
				}

			} catch (Exception e) {
				LoggerUtil.error("Exception validating Part Cost/Unit (In-House) → " + e.getMessage());
			}

			// =========================================================
			// 4️⃣ VALIDATE Total Cost
			// =========================================================
			try {
				if (headerIndex.containsKey("Total Cost")) {

					int idx = headerIndex.get("Total Cost");
					WebElement cell = cells.get(idx);
					WebElement input = cell.findElement(By.tagName("input"));

					String uiTotal = normalize3(input.getAttribute("value").trim());
					String expectedTotal = normalize3(bopMap.get("Total Cost"));

					if (uiTotal.equals(expectedTotal)) {
						LoggerUtil.pass("Total Cost (In-House) matched → " + expectedTotal);
					} else {
						LoggerUtil.error("Total Cost (In-House) mismatch → Expected: " + expectedTotal + " | Actual: "
								+ uiTotal);
					}

				} else {
					LoggerUtil.info("Header 'Total Cost' not found. Skipping.");
				}

			} catch (Exception e) {
				LoggerUtil.error("Exception validating Total Cost (In-House) → " + e.getMessage());
			}

			// =========================================================
			// 5️⃣ VALIDATE OTHER HEADERS (GENERIC VALIDATION)
			// =========================================================
			LoggerUtil.info("------ VALIDATING ALL IN-HOUSE HEADER VALUES ------");

			for (String header : headerIndex.keySet()) {

				if (header.equals("Part No.") || header.equals("Qty/Pc") || header.equals("Part Cost/Unit")
						|| header.equals("Total Cost")) {
					continue;
				}

				String expectedRaw = bopMap.get(header);

				if (expectedRaw == null || expectedRaw.trim().isEmpty()) {
					LoggerUtil.info("Skipping blank expected value → " + header);
					continue;
				}

				try {
					int idx = headerIndex.get(header);
					WebElement cell = cells.get(idx);

					String uiValue;

					List<WebElement> inputs = cell.findElements(By.tagName("input"));
					if (!inputs.isEmpty()) {
						uiValue = normalize3(inputs.get(0).getAttribute("value").trim());
					} else {
						uiValue = normalize3(cell.getText().trim());
					}

					String expected = normalize3(expectedRaw);

					if (uiValue.equals(expected)) {
						LoggerUtil.pass(header + " (In-House) matched → " + expected);
					} else {
						LoggerUtil.error(
								header + " (In-House) mismatch → Expected: " + expected + " | Actual: " + uiValue);
					}

				} catch (Exception e) {
					LoggerUtil.error("Exception validating '" + header + "' (In-House) → " + e.getMessage());
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in validateBopInHouseTable → " + e.getMessage());
		}

		LoggerUtil.info("--------------------------------------------------");
		LoggerUtil.info("       BOP IN-HOUSE VALIDATION COMPLETED");
		LoggerUtil.info("--------------------------------------------------");
	}

	private boolean validateInHouseTableReady() {

		try {
			// 1️⃣ Header check
			WebElement header = waitForExpectedElement(FetchingBopHeaderInHouse);
			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ In-House BOP header NOT visible.");
				return false;
			}
			LoggerUtil.pass("✔ In-House BOP header visible.");

			// 2️⃣ Table body check
			List<WebElement> rows = driver.findElements(By.xpath("//tbody[@id='bopInhouseBody']/tr"));

			if (rows.isEmpty()) {
				LoggerUtil.error("❌ In-House BOP table loaded but NO rows present.");
				return false;
			}

			if (!rows.get(0).isDisplayed()) {
				LoggerUtil.error("❌ In-House BOP first row NOT visible.");
				return false;
			}

			LoggerUtil.pass("✔ In-House BOP table & first row ready.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ In-House BOP table readiness check failed → " + e.getMessage());
			return false;
		}
	}

	public void VerifyUpdatedToolingCostValues(HashMap<String, String> expected) throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info(" 🔵 UPDATE VALIDATION STARTED: [Tooling Cost Section]");
		LoggerUtil.info("==============================================");

		if (expected == null || expected.isEmpty()) {
			LoggerUtil.warn("⚠ Expected UPDATE map is empty/null. Skipping validation.");
			return;
		}

		Thread.sleep(1500);

		// STEP 1: Navigate to Tooling Cost Tab
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Tooling Cost")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Tooling Cost' tab for UPDATE validation.");
				break;
			}
		}
		Thread.sleep(1000);

		JavascriptExecutor js = (JavascriptExecutor) driver;

		LoggerUtil.info("🔍 Starting UPDATE validation for " + expected.size() + " fields...");

		int passCount = 0, failCount = 0, warnCount = 0;

		js.executeScript("window.scrollBy(0,300);");
		Thread.sleep(600);

		for (Map.Entry<String, String> entry : expected.entrySet()) {

			String key = entry.getKey();

			if (key.equalsIgnoreCase("ToastMessage")) {
				continue;
			}

			if (!TOOLING_HEADER_MAP.containsKey(key)) {
				LoggerUtil.warn("⚠ Skipped (Not part of UPDATE validation) → " + key);
				warnCount++;
				continue;
			}

			String header = TOOLING_HEADER_MAP.get(key);
			String expectedVal = entry.getValue();

			try {
				// FIND COLUMN INDEX
				List<WebElement> headers = driver.findElements(By.xpath("//table[@id='tableToolingCost']//th"));
				int colIndex = -1;

				for (int i = 0; i < headers.size(); i++) {
					if (headers.get(i).getText().trim().equalsIgnoreCase(header)) {
						colIndex = i + 1;
						break;
					}
				}

				if (colIndex == -1) {
					LoggerUtil.warn("⚠ UI header NOT FOUND → " + header);
					warnCount++;
					continue;
				}

				WebElement element = driver.findElement(By.xpath("//table[@id='tableToolingCost']/tbody/tr[1]/td["
						+ colIndex + "]//*[self::input or self::span]"));

				js.executeScript("arguments[0].scrollIntoView({block:'center'});", element);
				Thread.sleep(200);

				String actual;

				if (element.getTagName().equalsIgnoreCase("input")) {
					actual = element.getAttribute("value") != null ? element.getAttribute("value").trim() : "";
				} else {
					actual = element.getText() != null ? element.getText().trim() : "";
				}

				// Optional: simple normalization for numbers
				String expNorm = expectedVal.trim();
				String actNorm = actual.trim();

				if (expNorm.equals(actNorm)) {
					LoggerUtil.pass("PASS → [" + header + "] Expected=" + expNorm + " | Actual=" + actNorm);
					passCount++;
				} else {
					LoggerUtil.error("FAIL → [" + header + "] Expected=" + expNorm + " | Actual=" + actNorm);
					failCount++;
				}

			} catch (Exception e) {
				LoggerUtil.error("⚠ Error validating field → " + key + " → " + e.getMessage());
				failCount++;
			}
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info(" SUMMARY:");
		LoggerUtil.info("==============================================");
		LoggerUtil.info("Passed: " + passCount);
		LoggerUtil.info("Failed: " + failCount);
		LoggerUtil.info("Warnings: " + warnCount);

		if (failCount > 0)
			LoggerUtil.fail("❌ UPDATE Validation FAILED");
		else
			LoggerUtil.pass("✅ ALL UPDATED TOOLING VALUES MATCH PERFECTLY.");

		LoggerUtil.info("==============================================");
	}

	public void exitToolingEditMode() throws InterruptedException {

		LoggerUtil.info("Exiting Tooling edit mode before Save");

		Actions actions = new Actions(driver);

		// Commit the value
		actions.sendKeys(Keys.TAB).perform();
		Thread.sleep(200);

		// Exit inline editor
		actions.sendKeys(Keys.ESCAPE).perform();
		Thread.sleep(200);

		// Hard blur outside tooling table
		((JavascriptExecutor) driver).executeScript("document.body.click();");

		Thread.sleep(500);
	}

	public HashMap<String, String> SavePriceCalculationTabForgingProcurement(String rmInputCategory, String shapeOption,
			String commodityGrp, String groupClassification, String yearValue, String periodValue, String specificGrade)
			throws InterruptedException {

		HashMap<String, String> map = new HashMap<>();
		String ohp = DataProp.getProperty("OHP");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Forging - Procurement)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}
			Thread.sleep(2000);

			// 🔥 HARD GUARD
			if (!validateForgingPriceTabReady()) {
				LoggerUtil.error("❌  Forging Price save – page not ready.");
				return map;
			}

			// ---------------------------------------------------------
			// STEP 2 → Dropdown Selections
			// ---------------------------------------------------------
			LoggerUtil.info("Selecting RM Input Category → " + rmInputCategory);
			new Select(waitForExpectedElement(RmInputCategoryDropdownn)).selectByVisibleText(rmInputCategory);
			map.put("RmInputCategory", rmInputCategory);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Shape Option → " + shapeOption);
			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			map.put("ShapeOption", shapeOption);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Commodity Group → " + commodityGrp);
			selectDropDownValue(clickingCommodityDropdownForForGing, commodityGrp, "visibleText");
			map.put("CommodityGrp", commodityGrp);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Group Classification → " + groupClassification);
			selectDropDownValue(GroupClassificationDropdownDropdownForging, groupClassification, "visibleText");
			map.put("GroupClassification", groupClassification);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Year → " + yearValue);
			selectDropDownValue(yearDropdownForForging, yearValue, "visibleText");
			map.put("YearValue", yearValue);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Period → " + periodValue);
			selectDropDownValue(periodDropdownForging, periodValue, "visibleText");
			map.put("PeriodValue", periodValue);

			Thread.sleep(1500);
			LoggerUtil.info("Selecting Specific Grade → " + specificGrade);
			selectDropDownValue(specificDropdownForging, specificGrade, "visibleText");
			map.put("SpecificGrade", specificGrade);

			// ---------------------------------------------------------
			// STEP 3 → Radio Buttons
			// ---------------------------------------------------------
			LoggerUtil.info("Selecting radio buttons for Direct Entry");
			clickOnElement(By.id("inpblank1"));
			clickOnElement(By.id("cutmgn1"));
			clickOnElement(By.id("noofpcs1"));
			clickOnElement(By.id("blankWtRadiodirect"));
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Primary Inputs
			// ---------------------------------------------------------
			LoggerUtil.info("Entering primary forging inputs");
			clearAndEnterText(waitForExpectedElement(EnterForgeWeightInKg), "12.45");
			clearAndEnterText(waitForExpectedElement(EnterPartingLinePerimeterinmm), "19.73");
			clearAndEnterText(waitForExpectedElement(EnterBlankWtDirectEntry), "30.32");
			clearAndEnterText(waitForExpectedElement(EnterCutMarginMm), "11.21");
			clearAndEnterText(waitForExpectedElement(EnterNumberOfPieces), "15.76");
			clearAndEnterText(waitForExpectedElement(EnterBlankWtKgForForgeing), "12.32");
			clearAndEnterText(waitForExpectedElement(RejectionWastageOnBlankWt), "12");
			clearAndEnterText(waitForExpectedElement(EnterpartFinishWeightPerPc), "10");
			clearAndEnterText(waitForExpectedElement(EnterScrapRealization), "19.41");

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 6 → OHP
			// ---------------------------------------------------------
			LoggerUtil.info("Selecting OHP → " + ohp);
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownForForgeing));
			clickOnElement(ClickingOhpDropdownForForgeing);
			Thread.sleep(3000);
			clearAndEnterText(waitForExpectedElement(EnteringValueOhpSearchBox), ohp);

			for (WebElement ele : driver.findElements(OhpOptionsForGeing)) {
				if (ele.getText().trim().equals(ohp)) {
					ele.click();
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(DirectEntryOHPRadioBtn);

			// ---------------------------------------------------------
			// STEP 8 → Save
			// ---------------------------------------------------------
			LoggerUtil.info("Clicking Save button for Forging Price Calculation");
			clickOnElement(ClickingSaveButtonForging);
			LoggerUtil.pass("Clicked Save button");

			String toastMsg = waitForExpectedElement(toastMessage).getText().trim();
			LoggerUtil.pass("Toast Message → " + toastMsg);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Forging Save → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Forging - Procurement)");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		return map;
	}

	private boolean validateForgingPriceTabReady() {

		try {
			// Header check
			By headerLocator = By.xpath("//h3[contains(text(),'Part Price Calculations')]");
			WebElement header = waitForExpectedElement(headerLocator);

			if (!header.isDisplayed()) {
				LoggerUtil.error("❌ Part Price Calculations header NOT visible.");
				return false;
			}
			LoggerUtil.pass("✔ Part Price Calculations page loaded.");

			// Save button presence (page fully loaded indicator)
			List<WebElement> saveBtns = driver.findElements(ClickingSaveButtonForging);
			if (saveBtns.isEmpty()) {
				LoggerUtil.error("❌ Save button NOT present on Forging Price page.");
				return false;
			}

			LoggerUtil.pass("✔ Forging Price page ready for input.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ Forging Price page readiness failed → " + e.getMessage());
			return false;
		}
	}

	public void validatePriceCalculationTabForging(HashMap<String, String> expectedData) throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Forging)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → DROPDOWN VALIDATIONS
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("RmInputCategory"), "RM Input Category");

			validateDropdownValue(DropdownlistShapeOptions, expectedData.get("ShapeOption"), "Shape Option");

			validateDropdownValue(clickingCommodityDropdownForForGing, expectedData.get("CommodityGrp"),
					"Commodity Group");

			validateDropdownValue(GroupClassificationDropdownDropdownForging, expectedData.get("GroupClassification"),
					"Group Classification");

			validateDropdownValue(yearDropdownForForging, expectedData.get("YearValue"), "Year");

			validateDropdownValue(periodDropdownForging, expectedData.get("PeriodValue"), "Period");

			validateDropdownValue(specificDropdownForging, expectedData.get("SpecificGrade"), "Specific Grade");

			// ---------------------------------------------------------
			// STEP 3 → RADIO BUTTON VALIDATIONS (Same as Save selection)
			// ---------------------------------------------------------
			validateRadioButton(By.id("inpblank1"), "Direct Entry");
			validateRadioButton(By.id("cutmgn1"), "Cut Margin");
			validateRadioButton(By.id("noofpcs1"), "No Of Pieces");
			validateRadioButton(By.id("blankWtRadiodirect"), "Blank Weight Direct");

			// ---------------------------------------------------------
			// STEP 4 → INPUT FIELD VALIDATIONS (DECIMAL SAFE)
			// ---------------------------------------------------------
			validateInput("ForgeWeight", EnterForgeWeightInKg, expectedData);
			validateInput("Perimeter", EnterPartingLinePerimeterinmm, expectedData);
			validateInput("BlankWtDirect", EnterBlankWtDirectEntry, expectedData);
			validateInput("CutMargin", EnterCutMarginMm, expectedData);
			validateInput("NoOfPieces", EnterNumberOfPieces, expectedData);
			validateInput("BlankWtKg", EnterBlankWtKgForForgeing, expectedData);
			validateInput("RejectionWastage", RejectionWastageOnBlankWt, expectedData);
			validateInput("FinishWeight", EnterpartFinishWeightPerPc, expectedData);
			validateInput("ScrapRealization", EnterScrapRealization, expectedData);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → CALCULATED / FETCHED FIELD VALIDATIONS (Read-only)
			// ---------------------------------------------------------
			validateInput("CutMarginEffort", FetchingCutMarginEffort, expectedData);
			validateInput("FinalBlankWtKg", FetchingFinalBlankWtKg, expectedData);
			validateInput("ScrapCostPerKg", FetchingDataFromScrapCostperKgFromPriceCalculationForForging, expectedData);
			validateInput("ScrapWtPerKg", fetchingDataFromScrapWtPerKgPriceCalculationTabForForging, expectedData);
			validateInput("RmCostPerKg", fetchingRmCostPerkgPriceCalculationForging, expectedData);
			validateInput("ScrapCostKg", FetchingScrapCostkgPriceCalculationForging, expectedData);
			validateInput("NetRmCostPerPc", fetchingNetRmCostPerPcForging, expectedData);
			validateInput("RmYieldPercentage", FEtchingPerCentageRmYieldForging, expectedData);
			validateInput("PieceAllowances", FetchingPieceAllowances, expectedData);

			// ---------------------------------------------------------
			// STEP 6 → OHP & COST FIELD VALIDATIONS
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownForForgeing));
			Thread.sleep(1200);

			validateDropdownValue(ClickingOhpDropdownForForgeing, expectedData.get("OHP"), "OHP");

			validateRadioButton(DirectEntryOHPRadioBtn, "Direct Entry OHP");

			validateInput("RejectionValue", EnterRejectionValue, expectedData);
			validateInput("Packing", EnterPackingCellBox, expectedData);
			validateInput("Insurance", EnterInsuranceValue, expectedData);
			validateInput("Profit", EnterProfitValue, expectedData);
			validateInput("OverHead", EnterOverHeadValue, expectedData);
			validateInput("ICC", EnterICCValue, expectedData);
			validateInput("Freight", EnterFrieghtKgCellBoxValue, expectedData);
			validateInput("Factor1", EnterFactorValue1, expectedData);
			validateInput("Factor2", EnterFactorValue2, expectedData);
			validateInput("Factor3", EnterFactorValue3, expectedData);
			validateInput("Remarks", EnterRemarksValue, expectedData);

			validateInput("ToolCost", EnterToolCostValue, expectedData);
			validateInput("Quantity", EnterQuantityValue, expectedData);
			validateInput("ToolAmortization", EnterToolAmortizationValue, expectedData);
			validateInput("Maintenance", EnterToolMantinanceCost, expectedData);

			LoggerUtil.pass("✔ All Forging values validated successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Forging validation → " + e.getMessage());
			throw e;
		}

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Forging )");
		LoggerUtil.info("==============================================");
	}

	public HashMap<String, String> SavePriceCalculationTabForgingCustomerSide(String rmInputCategory,
			String shapeOption, String commodityGrp, String groupClassification, String yearValue, String periodValue,
			String specificGrade) throws InterruptedException {

		HashMap<String, String> map = new HashMap<>();
		String ohp = DataProp.getProperty("OHPCustomerSide");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Forging - Customer)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown selections
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(rmInputCategory);
			map.put("RmInputCategory", rmInputCategory);

			Thread.sleep(1500);
			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			map.put("ShapeOption", shapeOption);

			Thread.sleep(1500);
			selectDropDownValue(clickingCommodityDropdownForForGing, commodityGrp, "visibleText");
			map.put("CommodityGrp", commodityGrp);

			Thread.sleep(1500);
			selectDropDownValue(GroupClassificationDropdownDropdownForging, groupClassification, "visibleText");
			map.put("GroupClassification", groupClassification);

			Thread.sleep(1500);
			selectDropDownValue(yearDropdownForForging, yearValue, "visibleText");
			map.put("YearValue", yearValue);

			Thread.sleep(1500);
			selectDropDownValue(periodDropdownForging, periodValue, "visibleText");
			map.put("PeriodValue", periodValue);

			Thread.sleep(1500);
			selectDropDownValue(specificDropdownForging, specificGrade, "visibleText");
			map.put("SpecificGrade", specificGrade);

			// ---------------------------------------------------------
			// STEP 3 → Radio buttons (Direct Entry)
			// ---------------------------------------------------------
			clickOnElement(By.id("inpblank1"));
			clickOnElement(By.id("cutmgn1"));
			clickOnElement(By.id("noofpcs1"));
			clickOnElement(By.id("blankWtRadiodirect"));

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Input fields
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterForgeWeightInKg), "12.85");
			map.put("ForgeWeight", "12.85");

			clearAndEnterText(waitForExpectedElement(EnterPartingLinePerimeterinmm), "20.45");
			map.put("Perimeter", "20.45");

			selectDropDownValue(SelectingBlankingProcessFromDropdown,
					DataProp.getProperty("BlankingProcessDropdownValueFromPriceCalculation"), "visibleText");

			Thread.sleep(1500);

			clearAndEnterText(waitForExpectedElement(EnterBlankWtDirectEntry), "29.45");
			map.put("BlankWtDirect", "29.45");

			clearAndEnterText(waitForExpectedElement(EnterCutMarginMm), "10.55");
			map.put("CutMargin", "10.55");

			clearAndEnterText(waitForExpectedElement(EnterNumberOfPieces), "14.75");
			map.put("NoOfPieces", "14.75");

			clearAndEnterText(waitForExpectedElement(EnterBlankWtKgForForgeing), "11.95");
			map.put("BlankWtKg", "11.95");

			clearAndEnterText(waitForExpectedElement(RejectionWastageOnBlankWt), "11.25");
			map.put("RejectionWastage", "11.25");

			clearAndEnterText(waitForExpectedElement(EnterpartFinishWeightPerPc), "9.50");
			map.put("FinishWeight", "9.50");

			clearAndEnterText(waitForExpectedElement(EnterScrapRealization), "18.65");
			map.put("ScrapRealization", "18.65");

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 5 → OHP selection (Customer)
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownForForgeing));
			Thread.sleep(1500);

			clickOnElement(ClickingOhpDropdownForForgeing);
			Thread.sleep(1500);
			clearAndEnterText(waitForExpectedElement(EnteringValueOhpSearchBox), ohp);
			map.put("OHP", ohp);

			for (WebElement ele : driver.findElements(OhpOptionsForGeing)) {
				if (ele.getText().trim().equals(ohp)) {
					ele.click();
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(DirectEntryOHPRadioBtn);

			// ---------------------------------------------------------
			// STEP 6 → Cost fields
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterRejectionValue), "18.25");
			map.put("RejectionValue", "18.25");

			clearAndEnterText(waitForExpectedElement(EnterPackingCellBox), "30.75");
			map.put("Packing", "30.75");

			clearAndEnterText(waitForExpectedElement(EnterInsuranceValue), "3.75");
			map.put("Insurance", "3.75");

			clearAndEnterText(waitForExpectedElement(EnterProfitValue), "60.45");
			map.put("Profit", "60.45");

			clearAndEnterText(waitForExpectedElement(EnterOverHeadValue), "10.25");
			map.put("OverHead", "10.25");

			clearAndEnterText(waitForExpectedElement(EnterICCValue), "2.35");
			map.put("ICC", "2.35");

			clearAndEnterText(waitForExpectedElement(EnterFrieghtKgCellBoxValue), "1.25");
			map.put("Freight", "1.25");

			clearAndEnterText(waitForExpectedElement(EnterFactorValue1), "110.25");
			map.put("Factor1", "110.25");

			clearAndEnterText(waitForExpectedElement(EnterFactorValue2), "111.25");
			map.put("Factor2", "111.25");

			clearAndEnterText(waitForExpectedElement(EnterFactorValue3), "112.25");
			map.put("Factor3", "112.25");

			clearAndEnterText(waitForExpectedElement(EnterRemarksValue), "cust_save");

			// ---------------------------------------------------------
			// STEP 7 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonForging);
			LoggerUtil.pass("Clicked Save button");

			try {
				WebElement toast = driver.findElement(toastMessage);
				if (toast.isDisplayed()) {
					String toastMsg = toast.getText().trim();
					map.put("ToastMessage", toastMsg);
					LoggerUtil.pass("Toast Message → " + toastMsg);
				}
			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed");
				map.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Forging Customer Save → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Forging - Customer)");
		LoggerUtil.info("==============================================");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return map;
	}

	/////////////////// For Update Forging
	/////////////////// ////////////////////////////////////////////

	public Map<String, String> verifyFetchDataAndWriteInPartAttributesForUpdates(String CommodityGroupName)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verifying and Writing Data in 'Part Attributes' Tab =====");

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");
		Map<String, String> storedData = new HashMap<>();

		try {
			// ----------------------------------------------------------------------
			// STEP 0: VALIDATE OR ACTIVATE TAB
			// ----------------------------------------------------------------------

			List<WebElement> headings = driver.findElements(headingLocator);
			WebElement heading = (!headings.isEmpty() && headings.get(0).isDisplayed()) ? headings.get(0) : null;

			if (heading != null) {
				LoggerUtil.info("✅ 'Part Attributes' tab is already active and visible.");
			} else {
				LoggerUtil.warn("⚠ Heading not visible yet. Attempting tab re-navigation.");

				Thread.sleep(1000);
				navigateToTab("Part Price Calculations"); // First go to parent/main tab
				Thread.sleep(2500);

				navigateToTab("Part Attributes"); // Come back again to reload section
				Thread.sleep(2000);

				heading = waitForExpectedElement(headingLocator);
				LoggerUtil.pass("✅ 'Part Attributes' tab reloaded successfully after re-navigation.");
			}

			// ----------------------------------------------------------------------
			// STEP 1: OPEN COMMODITY GROUP DROPDOWN
			// ----------------------------------------------------------------------

			clickOnElement(SelectingCommodityGroupDropdown);
			Thread.sleep(2000);

			List<WebElement> initialList = driver.findElements(listCommodityGroupnames);

			if (initialList.isEmpty()) {
				LoggerUtil.info("✅ No options visible initially (expected before search).");
			} else {
				LoggerUtil.warn("⚠ Dropdown already contains " + initialList.size() + " options before searching.");
			}

			// ----------------------------------------------------------------------
			// STEP 2: SEARCH FOR COMMODITY GROUP
			// ----------------------------------------------------------------------

			clearAndEnterText(waitForExpectedElement(EnterCommodityGroupNameInSearchBoxfirstab), CommodityGroupName);
			Thread.sleep(2000);

			List<WebElement> filteredOptions = driver.findElements(listCommodityGroupnames);

			if (!filteredOptions.isEmpty()) {
				LoggerUtil.pass("✅ " + filteredOptions.size() + " Commodity Group options loaded after search.");
			} else {
				LoggerUtil.error("❌ No Commodity Group options found for: " + CommodityGroupName);
			}

			// ----------------------------------------------------------------------
			// STEP 3: SELECT THE REQUIRED COMMODITY GROUP
			// ----------------------------------------------------------------------

			boolean found = false;
			for (WebElement option : filteredOptions) {
				String nameText = option.getText().trim();
				if (nameText.equals(CommodityGroupName)) {
					option.click();
					LoggerUtil.pass("✅ Selected Commodity Group: " + CommodityGroupName);
					found = true;
					break;
				}
			}

			if (!found) {
				LoggerUtil.error("❌ Commodity Group '" + CommodityGroupName + "' NOT found after search.");
			}

			storedData.put("CommodityGroup", CommodityGroupName);

			// ----------------------------------------------------------------------
			// STEP 4: ENTER SOB (SUPPLIER ON BEHALF) VALUE
			// ----------------------------------------------------------------------

			String enteredSOBValue = "15"; // Input value
			clearAndEnterText(waitForExpectedElement(EnterSobValue), enteredSOBValue);

			// Store formatted SOB value (always 3 decimals)
			storedData.put("SOB", String.format("%.3f", Double.parseDouble(enteredSOBValue)));

			LoggerUtil.info(
					"Entered SOB Value: " + enteredSOBValue + " → Stored As (3 decimals): " + storedData.get("SOB"));

			// ----------------------------------------------------------------------
			// STEP 5: CLICK SAVE AND CAPTURE TOAST MESSAGE
			// ----------------------------------------------------------------------

			clickOnElement(ClickingSaveButtonPartMaster);

			String actualToastMsg = waitForExpectedElement(toastMessage).getText().trim();
			storedData.put("ToastMessage", actualToastMsg);

			if (actualToastMsg.equals("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✅ Toast Message Matched Successfully.");
			} else {
				LoggerUtil.error("❌ Unexpected Toast: " + actualToastMsg);
			}

			// ----------------------------------------------------------------------
			// STEP 6: VERIFY SOB VALUE FROM UI AFTER SAVE
			// ----------------------------------------------------------------------

			try {
				WebElement savedValueField = waitForExpectedElement(EnterSobValue);
				String uiSOBValue = savedValueField.getAttribute("value").trim();

				storedData.put("UIValueAfterSave", String.format("%.3f", Double.parseDouble(uiSOBValue)));

				LoggerUtil.info("SOB Value displayed after save: " + uiSOBValue);

			} catch (Exception e) {
				LoggerUtil.warn("⚠ Could not fetch saved SOB value from UI after save.");
			}

			Thread.sleep(2000);

		} catch (Exception e) {
			LoggerUtil.error("❌ Unexpected error in 'Part Attributes' workflow: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: 'Part Attributes' Tab Flow Completed =====");
		return storedData;
	}

	public HashMap<String, String> clickAddBopAndVerifyTableForUpdate() {

	    HashMap<String, String> bopMap = new HashMap<>();

	    LoggerUtil.info("===== START: UPDATE BOP ENTRY PROCESS =====");

	    try {
	        // -----------------------------------------
	        // STEP 1 → FORCE MOVE TO BOP TAB
	        // -----------------------------------------
	        forceMoveToBOP();
	        LoggerUtil.info("Navigated to BOP tab (Update Mode).");

	        // -----------------------------------------
	        // STEP 2 → VERIFY TABLE EXISTS
	        // -----------------------------------------
	        waitForExpectedElement(By.xpath("//table[@id='standaradTable']"));
	        LoggerUtil.pass("BOP Table visible.");

	        // -----------------------------------------
	        // STEP 3 → FETCH OLD VALUES
	        // -----------------------------------------
	        String oldPartNo = waitForExpectedElement(
	                By.xpath("//span[@id='select2-item_partnostandard_1-container']")
	        ).getText().trim();

	        String oldQty = getValueFromBopTableCell("Qty/Pc");
	        String oldTotalCost = getValueFromBopTableCell("Total Cost");

	        LoggerUtil.info("OLD Part No     : " + oldPartNo);
	        LoggerUtil.info("OLD Qty/Pc      : " + oldQty);
	        LoggerUtil.info("OLD Total Cost  : " + oldTotalCost);

	        // -----------------------------------------
	        // STEP 4 → UPDATE PART NO
	        // -----------------------------------------
	        WebElement dropdown = waitForExpectedElement(
	                By.xpath("//select[@id='item_partnostandard_1']/following-sibling::span")
	        );

	        try {
	            dropdown.click();
	        } catch (Exception e) {
	            ((JavascriptExecutor) driver).executeScript("arguments[0].click();", dropdown);
	        }

	        By optionLocator = By.xpath("//ul[@id='select2-item_partnostandard_1-results']/li");

	        WebDriverWait optionWait = new WebDriverWait(driver, Duration.ofSeconds(20));
	        optionWait.until(ExpectedConditions.numberOfElementsToBeMoreThan(optionLocator, 0));

	        List<WebElement> options = driver.findElements(optionLocator);

	        boolean partSelected = false;
	        for (WebElement option : options) {

	            String val = option.getText().trim();

	            if (val.equals("M5 pressure rivet nut-28102024")) {

	                ((JavascriptExecutor) driver).executeScript(
	                        "arguments[0].scrollIntoView({block:'center'});", option);
	                Thread.sleep(200);

	                ((JavascriptExecutor) driver).executeScript("arguments[0].click();", option);

	                bopMap.put("PartNo", val);
	                LoggerUtil.pass("Updated Part No → " + val);
	                partSelected = true;
	                break;
	            }
	        }

	        if (!partSelected) {
	            LoggerUtil.fail("Updated Part No not found in dropdown");
	        }

	        // -----------------------------------------
	        // STEP 5 → UPDATE QTY/PC
	        // -----------------------------------------
	     // STEP 5 → UPDATE QTY/PC
	        String newQty = "3";
	        enterValueInBopTableCell("Qty/Pc", newQty);
	        bopMap.put("QtyPerPc", newQty);
	        LoggerUtil.pass("Updated Qty/Pc → " + newQty);

	        // 🔥 IMPORTANT: trigger UI calculation
	        new Actions(driver).sendKeys(Keys.TAB).perform();
	        Thread.sleep(800);


	        // -----------------------------------------
	        // STEP 6 → FETCH NEW CALCULATED VALUES
	        // -----------------------------------------
	        String newPartCost = getValueFromBopTableCell("Part Cost/Unit");
	        bopMap.put("PartCostPerUnit", newPartCost);

	        String newTotalCost = getValueFromBopTableCell("Total Cost");
	        bopMap.put("TotalCost_UI", newTotalCost);

	        try {
	            String extraCell = waitForExpectedElement(TotalCostExtraCell)
	                    .getAttribute("value").trim();
	            bopMap.put("TotalCost_ExtraCell", extraCell);
	        } catch (Exception e) {
	            bopMap.put("TotalCost_ExtraCell", "");
	        }

	        // -----------------------------------------
	        // STEP 7 → EXIT EDIT MODE SAFELY
	        // -----------------------------------------
	        Actions actions = new Actions(driver);
	        actions.sendKeys(Keys.TAB).perform();
	        Thread.sleep(200);
	        actions.sendKeys(Keys.ESCAPE).perform();
	        Thread.sleep(200);

	        ((JavascriptExecutor) driver).executeScript("document.querySelector('h3').click();");
	        Thread.sleep(500);

	        // -----------------------------------------
	        // STEP 8 → WAIT UNTIL SAVE ENABLED
	        // -----------------------------------------
	        WebDriverWait saveEnableWait = new WebDriverWait(driver, Duration.ofSeconds(20));
	        saveEnableWait.until(d -> {
	            WebElement btn = d.findElement(By.id("bopSave"));
	            String disabled = btn.getAttribute("disabled");
	            String cls = btn.getAttribute("class");
	            return (disabled == null || disabled.equals("false")) && !cls.contains("disabled");
	        });

	        LoggerUtil.pass("Save button enabled.");

	        // -----------------------------------------
	        // STEP 9 → SAVE UPDATED ROW
	        // -----------------------------------------
	        WebElement saveBtn = waitForExpectedElement(By.id("bopSave"));
	        saveBtn.click();
	        LoggerUtil.pass("Save button clicked for UPDATE.");

	        WebDriverWait toastWait = new WebDriverWait(driver, Duration.ofSeconds(5));
	        String toast = toastWait.until(
	                ExpectedConditions.visibilityOfElementLocated(toastMessage)
	        ).getText().trim();

	        bopMap.put("ToastMessage", toast);
	        LoggerUtil.pass("Toast received → " + toast);

	    } catch (Exception e) {
	        LoggerUtil.error("❌ Exception in BOP UPDATE flow → " + e.getMessage());
	        
	    }

	    LoggerUtil.info("===== END: UPDATE BOP ENTRY PROCESS =====");
	    return bopMap;
	}


	public static final By clickingSaveButtonToolingCost = By.xpath("//input[@id='btnSaveToolingCost']");

	public void forceMoveToToolingTab() throws Exception {

		LoggerUtil.info("Force switching to Tooling Cost tab");

		JavascriptExecutor js = (JavascriptExecutor) driver;

		try {
			// Bootstrap tab show
			js.executeScript("if (window.jQuery) {" + "  $('a[href=\"#ToolingCostTab\"]').tab('show');" + "}");

			Thread.sleep(500);

			// Hard DOM activation (fallback)
			js.executeScript(
					"document.querySelectorAll('.nav.nav-pills a').forEach(e => e.classList.remove('active','show'));"
							+ "document.querySelectorAll('.tab-pane').forEach(e => e.classList.remove('active','show','in'));"
							+ "var tab = document.querySelector('a[href=\"#ToolingCostTab\"]');"
							+ "if(tab){ tab.classList.add('active','show'); }"
							+ "var pane = document.querySelector('#ToolingCostTab');"
							+ "if(pane){ pane.classList.add('active','show','in'); }");

			LoggerUtil.pass("✔ Forced switch to Tooling Cost tab executed");

		} catch (Exception e) {
			LoggerUtil.error("❌ Failed to force switch to Tooling Cost tab → " + e.getMessage());
			throw e;
		}
	}

	private boolean validateToolingUpdatePageLoaded() {

		try {
			// 🔑 Master indicator: any one mandatory input
			By masterField = By.id("ToolPartNo");

			List<WebElement> fields = driver.findElements(masterField);

			if (fields.isEmpty()) {
				LoggerUtil.error("❌ Tooling Cost UPDATE page not loaded (ToolPartNo not present).");
				return false;
			}

			if (!fields.get(0).isDisplayed()) {
				LoggerUtil.error("❌ Tooling Cost UPDATE page present but NOT visible.");
				return false;
			}

			LoggerUtil.pass("✔ Tooling Cost UPDATE page loaded successfully.");
			return true;

		} catch (Exception e) {
			LoggerUtil.error("❌ Tooling UPDATE page validation failed → " + e.getMessage());
			return false;
		}
	}

	public HashMap<String, String> updateExistingToolingCostValues() throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE TOOLING COST (Only Input Fields Updated) =====");

		HashMap<String, String> updatedData = new HashMap<>();

		try {
			// -----------------------------------------
			// STEP 1 → FORCE MOVE TO TOOLING TAB
			// -----------------------------------------
			forceMoveToToolingTab();
			Thread.sleep(1500);

			// -----------------------------------------
			// 🔥 HARD GUARD → PAGE MUST BE LOADED
			// -----------------------------------------
			if (!validateToolingUpdatePageLoaded()) {
				LoggerUtil.fail("❌ Aborting Tooling Cost UPDATE — page not loaded.");
				return updatedData;
			}

			LoggerUtil.info("Updating ONLY input fields (dropdown unchanged).");

			// -----------------------------------------
			// STEP 2 → SAFE DROPDOWN (UPDATE MODE)
			// -----------------------------------------
			By toolNoDropdown = By.id("ToolPartNodrp");

			if (!driver.findElements(toolNoDropdown).isEmpty() && driver.findElement(toolNoDropdown).isDisplayed()) {

				selectDropdownById("ToolPartNodrp", "Manual Entry", "Tool Number");
				updatedData.put("ToolPartNodrp", "Manual Entry");
				LoggerUtil.pass("Tool Number dropdown updated.");

				Thread.sleep(1000);
			} else {
				LoggerUtil.info("Skipping Tool Number dropdown (Update mode / not visible).");
			}

			// -----------------------------------------
			// STEP 3 → INPUT FIELDS (NOW SAFE)
			// -----------------------------------------
			safeEnterValue(By.id("ToolPartNo"), "999", "Enter Tool No");
			updatedData.put("ToolPartNo", "999");

			safeEnterValue(By.id("ToolDesc"), "Updated-Manual-999", "Tool Description");
			updatedData.put("ToolDesc", "Updated-Manual-999");

			safeEnterValue(By.id("PartEnvelopeLength"), "20.5566", "Envelope Length");
			updatedData.put("PartEnvelopeLength", "20.5566");

			safeEnterValue(By.id("PartEnvelopeWidth"), "21.5566", "Envelope Width");
			updatedData.put("PartEnvelopeWidth", "21.5566");

			safeEnterValue(By.id("PartEnvelopeHeight"), "5.1234", "Envelope Height");
			updatedData.put("PartEnvelopeHeight", "5.1234");

			safeEnterValue(By.id("txtToolDelta"), "2.5567", "Additional Cost");
			updatedData.put("ToolDelta", "2.5567");

			safeEnterValue(By.id("SettledToolCost"), "9", "Settled Tool Cost");
			updatedData.put("SettledToolCost", "9");

			safeEnterValue(By.id("ToolAdvance"), "3", "Tool Advance");
			updatedData.put("ToolAdvance", "3");

			safeEnterValue(By.id("FirstYrVolume"), "5", "First Year Volume");
			updatedData.put("FirstYrVolume", "5");

			safeEnterValue(By.id("SecondYrVolume"), "4", "Second Year Volume");
			updatedData.put("SecondYrVolume", "4");

			safeEnterValue(By.id("ThirdYrVolume"), "6", "Third Year Volume");
			updatedData.put("ThirdYrVolume", "6");

			safeEnterValue(By.id("FourthYrVolume"), "7", "Fourth Year Volume");
			updatedData.put("FourthYrVolume", "7");

			safeEnterValue(By.id("FifthYrVolume"), "8", "Fifth Year Volume");
			updatedData.put("FifthYrVolume", "8");

			safeEnterValue(By.id("ToolCostDirectEntry"), "12.5678", "Total Tool Cost");
			updatedData.put("ToolCostDirectEntry", "12.5678");

			// -----------------------------------------
			// STEP 4 → SAVE
			// -----------------------------------------
			exitToolingEditMode();

			WebElement saveBtn = waitForExpectedElement(clickingSaveButtonToolingCost);
			saveBtn.click();
			LoggerUtil.pass("Tooling Save button clicked successfully.");

			String toast = waitForExpectedElement(toastMessage).getText().trim();
			updatedData.put("ToastMessage", toast);

			if (toast.toLowerCase().contains("success")) {
				LoggerUtil.pass("✔ Tooling Cost UPDATED Successfully → " + toast);
			} else {
				LoggerUtil.error("❌ UPDATE FAILED → " + toast);
			}

		} catch (Exception e) {
			LoggerUtil.fail("❌ Error while updating tooling cost → " + e.getMessage());
		}

		return updatedData;
	}

	private void safeEnterValue(By locator, String value, String fieldName) {
		try {

			JavascriptExecutor js = (JavascriptExecutor) driver;

			// Always scroll before finding the element
			js.executeScript("window.scrollBy(0,350);");
			Thread.sleep(400);

			WebElement element = wait.until(ExpectedConditions.visibilityOfElementLocated(locator));

			// Scroll element to center
			js.executeScript("arguments[0].scrollIntoView({block:'center'});", element);
			Thread.sleep(300);

			// Remove td overlay
			new Actions(driver).moveToElement(element).pause(Duration.ofMillis(200)).perform();

			// Focus & click
			js.executeScript("arguments[0].focus();", element);
			js.executeScript("arguments[0].click();", element);
			Thread.sleep(200);

			// Clear & type
			element.sendKeys(Keys.CONTROL + "a");
			element.sendKeys(Keys.DELETE);
			element.sendKeys(value);

			LoggerUtil.pass("✔ Updated [" + fieldName + "] → " + value);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error entering [" + fieldName + "] → " + e.getMessage());
		}
	}

	public String GetValueFromToolingTableCell(String headerName) {

		try {
			// STEP 1 → Find Header Index
			List<WebElement> headers = driver.findElements(By.xpath("//table[@id='tableToolingCost']/thead/tr/th"));

			int headerIndex = -1;

			for (int i = 0; i < headers.size(); i++) {
				String h = headers.get(i).getText().trim();

				if (h.equalsIgnoreCase(headerName.trim())) {
					headerIndex = i + 1;
					break;
				}
			}

			if (headerIndex == -1) {
				LoggerUtil.error("❌ Header Not Found: " + headerName);
				return "";
			}

			// STEP 2 → Fetch the <td> of row 1
			WebElement td = driver
					.findElement(By.xpath("//table[@id='tableToolingCost']/tbody/tr[1]/td[" + headerIndex + "]"));

			// STEP 3 → Try INPUT
			try {
				WebElement input = td.findElement(By.xpath(".//input"));
				String val = input.getAttribute("value");
				return val == null ? "" : val.trim();
			} catch (Exception ignored) {
			}

			// STEP 4 → Try TEXTAREA
			try {
				WebElement textarea = td.findElement(By.xpath(".//textarea"));
				return textarea.getAttribute("value").trim();
			} catch (Exception ignored) {
			}

			// STEP 5 → Try SELECT normal
			try {
				WebElement select = td
						.findElement(By.xpath(".//select[not(contains(@class,'select2-hidden-accessible'))]"));
				Select dd = new Select(select);
				return dd.getFirstSelectedOption().getText().trim();
			} catch (Exception ignored) {
			}

			// STEP 6 → Try SELECT2 visible text
			try {
				WebElement select2 = td
						.findElement(By.xpath(".//span[contains(@class,'select2-selection__rendered')]"));
				return select2.getText().trim();
			} catch (Exception ignored) {
			}

			// STEP 7 → Try SPAN / LABEL fallback
			try {
				WebElement label = td.findElement(By.xpath(".//span | .//label"));
				return label.getText().trim();
			} catch (Exception ignored) {
			}

			// STEP 8 → Or plain text inside td
			String text = td.getText().trim();
			return text;

		} catch (Exception e) {
			LoggerUtil.error("❌ ERROR in GetValueFromToolingTableCell(" + headerName + ") → " + e.getMessage());
			return "";
		}
	}

	public static final By FetchingToastmsgForDetailCosting = By.xpath("//*[@id='toast-container']/div/div");

	public void VerifyThreeBarFunctionalityStandardShapes(String RminputCategoryValue, String partNumber)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verify Three-Bar Functionality (Forging) =====");

		try {
			// STEP 1 → Navigate to tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
					break;
				}
			}

			// STEP 2 → Select RM Input Category
			Select dropdownRminput = new Select(waitForExpectedElement(RmInputCategoryDropdownn));

			boolean exists = dropdownRminput.getOptions().stream()
					.anyMatch(opt -> opt.getText().trim().equalsIgnoreCase(RminputCategoryValue));

			if (exists) {
				dropdownRminput.selectByVisibleText(RminputCategoryValue);
				LoggerUtil.pass("Selected RM Input Category → " + RminputCategoryValue);
			} else {
				LoggerUtil.error("RM Input Category NOT FOUND → " + RminputCategoryValue);
			}

			selectDropDownValue(DropdownlistShapeOptions, "Sheet", "visibleText");
			Thread.sleep(3000);

			// STEP 3 → Open Three Bars
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(2000);

			List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);

			if (ThreeBarOptions == null || ThreeBarOptions.isEmpty()) {
				LoggerUtil.error("Three-bar options list is NULL or EMPTY. Cannot continue.");
			} else {
				LoggerUtil.info("Three-bar menu loaded → Total Options: " + ThreeBarOptions.size());
			}

			// STEP 4 → Export Whole Report
			boolean exportClicked = false;

			for (WebElement option : ThreeBarOptions) {
				if (option.getText().trim().equals("Export Whole Report")) {
					option.click();
					LoggerUtil.pass("Clicked → Export Whole Report");
					exportClicked = true;
					break;
				}
			}

			if (!exportClicked) {
				LoggerUtil.error("'Export Whole Report' NOT FOUND in Three-Bar Menu");
			}

			Thread.sleep(5000);
			getLatestCustomExcelFileForging();

			// STEP 5 → Click three-bar again for next export
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(1500);

			// STEP 6 → Consolidated Assembly
			boolean consolidateClicked = false;

			for (WebElement option : ThreeBarOptions) {
				if (option.getText().trim().equals("Consolidated Assembly")) {
					option.click();
					LoggerUtil.pass("Clicked → Consolidated Assembly");
					consolidateClicked = true;
					break;
				}
			}

			if (!consolidateClicked) {
				LoggerUtil.error("'Consolidated Assembly' option NOT FOUND in menu.");
			}

			Thread.sleep(2000);

			// STEP 7 → Validate Toast Message
			String actualToast = waitForExpectedElement(FetchingToastmsgForDetailCosting).getText().trim();
			LoggerUtil.info("Fetched Toast Message → " + actualToast);

			String expectedToast = "Consolidated Assembly Exported SucessFully.";

			if (actualToast.equalsIgnoreCase(expectedToast)) {
				LoggerUtil.pass("Toast Message Validation PASSED.");
			} else {
				LoggerUtil.error("Toast Message MISMATCH → Expected: " + expectedToast + " | Actual: " + actualToast);
			}

		} catch (Exception e) {
			LoggerUtil.error("Unexpected Exception in VerifyThreeBarFunctionalityForging → " + e.getMessage());
		}

		LoggerUtil.info("===== END: Verify Three-Bar Functionality (Forging) =====");
	}

	public void VerifyThreeBarFunctionalityForging(String RminputCategoryValue, String partNumber)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verify Three-Bar Functionality (Forging) =====");

		try {
			// STEP 1 → Navigate to tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
					break;
				}
			}

			// STEP 2 → Select RM Input Category
			Select dropdownRminput = new Select(waitForExpectedElement(RmInputCategoryDropdownn));

			boolean exists = dropdownRminput.getOptions().stream()
					.anyMatch(opt -> opt.getText().trim().equalsIgnoreCase(RminputCategoryValue));

			if (exists) {
				dropdownRminput.selectByVisibleText(RminputCategoryValue);
				LoggerUtil.pass("Selected RM Input Category → " + RminputCategoryValue);
			} else {
				LoggerUtil.error("RM Input Category NOT FOUND → " + RminputCategoryValue);
			}

			selectDropDownValue(DropdownlistShapeOptions, "Sheet", "visibleText");
			Thread.sleep(3000);

			// STEP 3 → Open Three Bars
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(2000);

			List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);

			if (ThreeBarOptions == null || ThreeBarOptions.isEmpty()) {
				LoggerUtil.error("Three-bar options list is NULL or EMPTY. Cannot continue.");
			} else {
				LoggerUtil.info("Three-bar menu loaded → Total Options: " + ThreeBarOptions.size());
			}

			// STEP 4 → Export Whole Report
			boolean exportClicked = false;

			for (WebElement option : ThreeBarOptions) {
				if (option.getText().trim().equals("Export Whole Report")) {
					option.click();
					LoggerUtil.pass("Clicked → Export Whole Report");
					exportClicked = true;
					break;
				}
			}

			if (!exportClicked) {
				LoggerUtil.error("'Export Whole Report' NOT FOUND in Three-Bar Menu");
			}

			Thread.sleep(5000);
			getLatestCustomExcelFileForging();

			// STEP 5 → Click three-bar again for next export
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(1500);

			// STEP 6 → Consolidated Assembly
			boolean consolidateClicked = false;

			for (WebElement option : ThreeBarOptions) {
				if (option.getText().trim().equals("Consolidated Assembly")) {
					option.click();
					LoggerUtil.pass("Clicked → Consolidated Assembly");
					consolidateClicked = true;
					break;
				}
			}

			if (!consolidateClicked) {
				LoggerUtil.error("'Consolidated Assembly' option NOT FOUND in menu.");
			}

			Thread.sleep(2000);

			// STEP 7 → Validate Toast Message
			String actualToast = waitForExpectedElement(FetchingToastmsgForDetailCosting).getText().trim();
			LoggerUtil.info("Fetched Toast Message → " + actualToast);

			String expectedToast = "Consolidated Assembly Exported SucessFully.";

			if (actualToast.equalsIgnoreCase(expectedToast)) {
				LoggerUtil.pass("Toast Message Validation PASSED.");
			} else {
				LoggerUtil.error("Toast Message MISMATCH → Expected: " + expectedToast + " | Actual: " + actualToast);
			}

		} catch (Exception e) {
			LoggerUtil.error("Unexpected Exception in VerifyThreeBarFunctionalityForging → " + e.getMessage());
		}

		LoggerUtil.info("===== END: Verify Three-Bar Functionality (Forging) =====");
	}

	public void VerifyThreeBarFunctionalityForgingForCopyCosting(String RminputCategoryValue)
			throws InterruptedException {

		// Step 1: Navigate to the correct tab
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
				break;
			}
		}

		wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(RmInputCategoryDropdownn));
		Select dropdownRminput = new Select(waitForExpectedElement(RmInputCategoryDropdownn));

		boolean isStandardShapesPresent = dropdownRminput.getOptions().stream()
				.anyMatch(opt -> opt.getText().trim().equalsIgnoreCase(RminputCategoryValue));

		if (isStandardShapesPresent) {
			dropdownRminput.selectByVisibleText(RminputCategoryValue);
			LoggerUtil.info("Selected " + RminputCategoryValue + " from RM Input Category dropdown.");
		} else {
			LoggerUtil.error(RminputCategoryValue + " option NOT found in RM Input Category dropdown.");
			Assert.fail("Required RM Input Category not found: " + RminputCategoryValue);
		}

		wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(DropdownlistShapeOptions));
		selectDropDownValue(DropdownlistShapeOptions, "Sheet", "visibleText");

		Thread.sleep(3000);

		clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
		Thread.sleep(2000);

		/**
		 * ------------------------------------------- NEW SAFE LIST CHECK (Null + Empty
		 * Check) -------------------------------------------
		 */
		List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);

		if (ThreeBarOptions == null || ThreeBarOptions.isEmpty()) {
			LoggerUtil.error("Three-bar options list is NULL or EMPTY. Cannot perform export.");
			Assert.fail("No options found under three-bar menu.");
		} else {
			LoggerUtil.info("Three-bar list loaded successfully. Total Options: " + ThreeBarOptions.size());
		}

		// EXPORT WHOLE REPORT
		boolean exportReportClicked = false;

		for (WebElement ThreeBarLink : ThreeBarOptions) {
			String BarLinkText = ThreeBarLink.getText().trim();

			if (BarLinkText.equals("Copy Costing")) {
				ThreeBarLink.click();
				LoggerUtil.info("Clicked on 'Copy Costing'.");
				exportReportClicked = true;
				break;
			}
		}

		if (!exportReportClicked) {
			LoggerUtil.error("'Copy Costing' option NOT found under three-bar list.");
			Assert.fail("Export Whole Report not available in menu.");
		}

	}

	public void EnterValueInSalessSideAndSave(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredCustomerNameFromText, String RequiredProducCategoryName, String RequiredProducModelName,
			String RequiredSpecialProductCategory) throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);
			Thread.sleep(1000);

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);
			Thread.sleep(1500);

			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");

			clickOnElement(clickingUomDropdown);

			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			Thread.sleep(1200);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);
			boolean uomFound = false;

			if (ListValues != null && !ListValues.isEmpty()) {
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						uomFound = true;
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						break;
					}
				}
				if (!uomFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);

			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering.");
			}

			Thread.sleep(1500);

			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");

			clickOnElement(clickingCompanyNameDropdown);
			Thread.sleep(1200);

			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);
			for (WebElement Companies : ListCompanyName) {
				if (Companies.getText().trim().equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + RequiredName);
					break;
				}
			}

			Thread.sleep(1200);

			// ========================== Radio Button Selection ==========================
			LoggerUtil.info("===== STEP 4: Selecting Radio Button =====");

			for (WebElement Pagename : driver.findElements(FetchingNamesFromPartMaster)) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Radio Button → " + pagenametext);
					break;
				}
			}
			Thread.sleep(1200);

			// ========================== Customer Selection ==========================
			LoggerUtil.info("===== STEP 5: Selecting Customer =====");

			clickOnElement(clickingCustomerDropdown);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);
			Thread.sleep(1200);

			for (WebElement Customer : driver.findElements(CustomerListDropdown)) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");

			clickOnElement(ClickingProductCategoryDropdown);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);
			Thread.sleep(1200);

			for (WebElement ProductCat : driver.findElements(ProductCategoryDropdownName)) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");

			Thread.sleep(2000);
			clickOnElement(clickingProductModelNameDropdown);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
			Thread.sleep(1200);

			for (WebElement productname : driver.findElements(ProductModelNameTextFromDropdownList)) {
				if (productname.getText().trim().equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + RequiredProducModelName);
					break;
				}
			}

			Thread.sleep(1200);

			// ========================== Special Product Category
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");

			clickOnElement(clickingSpecialProductCategory);
			Thread.sleep(1000);

			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);
			Thread.sleep(1000);

			for (WebElement ProductCategory : driver.findElements(specialProductCategoryListValuesDropdown)) {
				if (ProductCategory.getText().trim().equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + RequiredSpecialProductCategory);
					break;
				}
			}

			// ========================== Save Button ==========================
			LoggerUtil.info("===== STEP 9: Saving =====");

			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked Save.");

			// ========================== Toast ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast validated correctly.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSalessSideAndSave: " + e.getMessage());
			LoggerUtil.logException(e);
		}
	}

	public void EnterValueInsalesTypeSideAndSaveForCopyCosting(String EnterPartNumber, String EnterPartDescription,
			String EnterPartUomName, String RequiredName, String RequiredRadionButtonName,
			String RequiredCustomerNameFromText,

			String RequiredProducCategoryName, String RequiredProducModelName, String RequiredSpecialProductCategory)
			throws InterruptedException {

		try {
			LoggerUtil.info("===== STEP 1: Enter Part Details =====");

			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartNumber), EnterPartNumber);
			LoggerUtil.pass("Entered Part Number → " + EnterPartNumber);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(PartMasterPage.enterOnPartDescription), EnterPartDescription);
			LoggerUtil.pass("Entered Part Description → " + EnterPartDescription);

			Thread.sleep(2000);
			// ========================== UOM Selection ==========================
			LoggerUtil.info("===== STEP 2: Selecting Part UOM Value =====");
			clickOnElement(clickingUomDropdown);

			LoggerUtil.info("Clicked on UOM dropdown.");

			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueInSearchBoxPartMaster), EnterPartUomName);
			LoggerUtil.info("Entered search keyword in UOM search box → " + EnterPartUomName);
			Thread.sleep(2000);

			List<WebElement> ListValues = driver.findElements(listUomDropdownPartMaster);

			if (ListValues != null && !ListValues.isEmpty()) {
				boolean matchFound = false;
				for (WebElement ListValue : ListValues) {
					String ActualValueText = ListValue.getText().trim();
					if (ActualValueText.equalsIgnoreCase(EnterPartUomName)) {
						ListValue.click();
						LoggerUtil.pass("Selected UOM → " + ActualValueText);
						matchFound = true;
						break;
					}
				}
				if (!matchFound)
					LoggerUtil.fail("No exact UOM match found for → " + EnterPartUomName);
			} else {
				LoggerUtil.fail("No UOM dropdown rows found after filtering — possible locator/search issue.");
			}

			Thread.sleep(2000);
			// ========================== Company Name Selection ==========================
			LoggerUtil.info("===== STEP 3: Selecting Company Name =====");
			clickOnElement(clickingCompanyNameDropdown);
			Thread.sleep(2000);
			List<WebElement> ListCompanyName = driver.findElements(FetchingCompanyNames);

			Thread.sleep(2000);
			for (WebElement Companies : ListCompanyName) {
				String CompanyNameText = Companies.getText().trim();
				if (CompanyNameText.equals(RequiredName)) {
					Companies.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Company Name → " + CompanyNameText);
					break;
				}
			}

			// ========================== Radio Button Selection ==========================
			LoggerUtil.info("===== STEP 4: Selecting  Radio Button By Name =====");
			List<WebElement> PageHeadersName = driver.findElements(FetchingNamesFromPartMaster);
			for (WebElement Pagename : PageHeadersName) {
				String pagenametext = Pagename.getText().trim();
				if (pagenametext.contains(RequiredRadionButtonName)) {
					Pagename.findElement(By.tagName("input")).click();
					LoggerUtil.pass("Selected Supplier Radio Button → " + pagenametext);
					break;
				}
			}
			Thread.sleep(2000);

			// ========================================= Customer Selection
			// ========================================================//

			Thread.sleep(2000);
			clickOnElement(clickingCustomerDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchboxCustomerName), RequiredCustomerNameFromText);

			Thread.sleep(2000);
			List<WebElement> CustomerNameList = driver.findElements(CustomerListDropdown);

			for (WebElement Customer : CustomerNameList) {
				String CustomerText = Customer.getText().trim();
				if (CustomerText.contains(RequiredCustomerNameFromText)) {
					Customer.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Customer → " + CustomerText);
					break;
				}
			}

			// ========================== Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 6: Selecting Product Category =====");
			clickOnElement(ClickingProductCategoryDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchBoxProductCategoryName), RequiredProducCategoryName);

			Thread.sleep(2000);
			List<WebElement> ProductCategories = driver.findElements(ProductCategoryDropdownName);
			for (WebElement ProductCat : ProductCategories) {
				String TextproductCategory = ProductCat.getText().trim();
				if (TextproductCategory.contains(RequiredProducCategoryName)) {
					ProductCat.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Category → " + TextproductCategory);
					break;
				}
			}

			// ========================== Product Model Selection ==========================
			LoggerUtil.info("===== STEP 7: Selecting Product Model =====");
			clickOnElement(clickingProductModelNameDropdown);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterValueSearchBoxForProductModel), RequiredProducModelName);
			Thread.sleep(2000);
			List<WebElement> Productmodalnames = driver.findElements(ProductModelNameTextFromDropdownList);
			for (WebElement productname : Productmodalnames) {
				String Producttextname = productname.getText().trim();
				if (Producttextname.equals(RequiredProducModelName)) {
					productname.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Product Model → " + Producttextname);
					break;
				}
			}

			Thread.sleep(2000);
			// ========================== Special Product Category Selection
			// ==========================
			LoggerUtil.info("===== STEP 8: Selecting Special Product Category =====");
			clickOnElement(clickingSpecialProductCategory);
			Thread.sleep(2000);
			clearAndEnterText(waitForExpectedElement(EnterSearchValueProductCategory), RequiredSpecialProductCategory);

			List<WebElement> productCategoryNames = driver.findElements(specialProductCategoryListValuesDropdown);
			for (WebElement ProductCategory : productCategoryNames) {
				String productCategoryText = ProductCategory.getText().trim();
				if (productCategoryText.equals(RequiredSpecialProductCategory)) {
					ProductCategory.findElement(By.xpath("./preceding-sibling::input")).click();
					LoggerUtil.pass("Selected Special Product Category → " + productCategoryText);
					break;
				}
			}

			// ========================== Save Button Click ==========================
			LoggerUtil.info("===== STEP 9: Clicking Save Button =====");
			List<WebElement> Buttons = driver.findElements(clickingButtonsPartMaster);
			ClickingButtonPartMasters(Buttons, "Save");
			LoggerUtil.pass("Clicked on 'Save' button successfully.");

			// ========================== Toast Message Verification
			// ==========================
			LoggerUtil.info("===== STEP 10: Verifying Toast Message =====");
			VerifyToastMessage("Part Master details saved successfully.");
			LoggerUtil.pass("Toast message verification completed successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in EnterValueInSupplierSideAndSave: " + e.getMessage());
			e.printStackTrace();
		}
	}

	public Map<String, String> VerifyPartNumberAreSavedOrNotWithSalesSide(String SelectFilterByLabel, String PartNumber,
			String PartDescription) throws InterruptedException {

		LoggerUtil.info("===== START: Verify Part Number & Description view table partMaster =====");

		Map<String, String> partData = new HashMap<>();

		try {
			Thread.sleep(2000);

			clickOnElement(partMasterViewBtn);
			Thread.sleep(2000);

			searchBtnPartMasterFilterIcon(SelectFilterByLabel);
			Thread.sleep(2000);

			searchBoxPartMaster(PartNumber);
			Thread.sleep(2500);

			verifyRowByHeaderSales(PartNumber, PartDescription);

			partData.put("Part Number", PartNumber);
			partData.put("Part Description", PartDescription);
			partData.put("Filter Used", SelectFilterByLabel);

			LoggerUtil.pass("✔ Part found successfully: " + PartNumber + " | Description: " + PartDescription);
			LoggerUtil.info("Stored Part Data: " + partData);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error while verifying part number on Sales Side: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Verify Part Number & Description (Sales Side) Part Master View Table =====");
		return partData;
	}

	public void verifyRowByHeaderSales(String partNumber, String partDescription) {
		try {
			LoggerUtil.info("==============================================");
			LoggerUtil.info(" [View Table Part Master For Sales Name By Sales Header Coloumn]");
			LoggerUtil.info("==============================================");

			// Step 1️⃣: Build header index
			Map<String, Integer> headerIdx = buildHeaderIndex();
			if (headerIdx.isEmpty()) {
				LoggerUtil.fail("No table headers found for #modelTable.");
				return;
			}

			List<String> headerNames = new ArrayList<>(headerIdx.keySet());
			LoggerUtil.info("✅ Total Headers Found: " + headerNames.size());
			LoggerUtil.info("Headers → " + headerNames);

			// Step 2️⃣: Expected values (based on header mapping)
			LinkedHashMap<String, String> expected = new LinkedHashMap<>();
			expected.put("Company Name", DataProp.getProperty("CompanyNamePartMaster"));
			expected.put("Part No.", partNumber);
			expected.put("Part Description", partDescription);
			expected.put("Part UOM", "Hourly");
			expected.put("Product Category", "rishi");
			expected.put("Product Model Name and No.", DataProp.getProperty("ProductModelName&No.PartMaster"));
			expected.put("Special Product Category", "ACCESSORIES");
			expected.put("Customer", DataProp.getProperty("CustomerNamePartMaster")); // Sales side validation

			LoggerUtil.info("🧩 Validation Targets → " + expected.keySet());

			// Step 3️⃣: Fetch rows
			List<WebElement> rows = driver.findElements(TBL_ROWS);
			if (rows.isEmpty()) {
				LoggerUtil.fail("❌ No rows found in the table after filtering.");
				return;
			}

			WebElement matchedRow = null;
			for (WebElement row : rows) {
				boolean partMatch = false;
				boolean CustomerMatch = false;

				// Fetch current Part No. from this row
				Integer partColIndex = headerIdx.get("Part No.");
				if (partColIndex != null) {
					String actualPart = cellText(row, partColIndex);
					if (actualPart.equalsIgnoreCase(partNumber)) {
						partMatch = true;
					}
				}

				if (!partMatch) {
					continue; // Skip this row if part number doesn’t match
				}

				// Validate other headers (soft)
				for (Map.Entry<String, String> entry : expected.entrySet()) {
					String header = entry.getKey();
					String expectedVal = entry.getValue();
					Integer colIndex = headerIdx.get(header);
					if (colIndex == null)
						continue;

					String actualVal = cellText(row, colIndex);

					if (equalsRelaxed(header, expectedVal, actualVal)) {
						LoggerUtil
								.pass("[" + header + "] Match → Expected: " + expectedVal + " | Actual: " + actualVal);
					} else {
						if (header.equalsIgnoreCase("Sales Detail 1")) {
							LoggerUtil.error("Sales mismatch → Expected: " + expectedVal + " | Actual: " + actualVal);
						} else {
							LoggerUtil.warn(" [" + header + "] mismatch ignored → Expected: " + expectedVal
									+ " | Actual: " + actualVal);
						}
					}

					// Track Sales match separately
					if (header.equalsIgnoreCase("Customer") && equalsRelaxed(header, expectedVal, actualVal)) {
						CustomerMatch = true;
					}
				}

				if (partMatch) {
					matchedRow = row;
					if (CustomerMatch) {
						LoggerUtil.pass(" Row matched successfully for Part: " + partNumber + " (Sales verified)");
					} else {
						LoggerUtil.pass(" Row matched by Part No. (Sales not verified, continuing click).");
					}
					break;
				}
			}

			// Step 4 : Click Customer cell if matched
			if (matchedRow != null) {
				clickFirstNonEmptySalesCell(matchedRow, headerNames);
			} else {
				LoggerUtil.fail(" No matching row found for Part: " + partNumber);
			}

			LoggerUtil.info("==============================================");

			LoggerUtil.info("VALIDATION COMPLETED: [View Table Part Master For Sales Name By Customer Header Coloumn]");

			LoggerUtil.info("==============================================");
		} catch (Exception ex) {
			LoggerUtil.error("❌ Exception in verifyRowByHeaderAndClickSales → " + ex.getMessage());
			ex.printStackTrace();
		}
	}

	private void clickFirstNonEmptySalesCell(WebElement matchedRow, List<String> headerNames) {
		List<WebElement> tds = matchedRow.findElements(By.tagName("td"));
		for (int i = 0; i < headerNames.size() && i < tds.size(); i++) {
			String h = headerNames.get(i);
			if (h.startsWith("Customer")) {
				WebElement cell = tds.get(i);
				String txt = cell.getText().trim();
				if (!txt.isEmpty()) {
					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});", cell);
					try {
						try {
							cell.click();
						} catch (Exception e) {
							((JavascriptExecutor) driver).executeScript("arguments[0].click();", cell);
						}
						LoggerUtil.pass("🟢 Clicked Sales cell → " + txt);
					} catch (Exception e) {
						LoggerUtil.warn("Sales cell present but not clickable. Reason: " + e.getMessage());
					}
					return;
				}
			}
		}
		LoggerUtil.warn("No non-empty 'Sales Detail' cell found to click.");
	}

	public static final By EnterAnnualRequirnmentOfProduct = By.id("AnnualRequirement");
	public static final By EnterAverageMonthlyRequirnmentOfproduct = By.id("AverageMonthly");
	public static final By EnterLotSize = By.id("LotSize");

	public Map<String, String> verifyFetchDataAndWriteInPartAttributesCustomerSide(String CommodityGroupName)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verifying and Writing Data in 'Part Attributes' Tab =====");

		Map<String, String> storedData = new HashMap<>();

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		try {

			Thread.sleep(1200);

			// ============================================================
			// STEP 0: Ensure the 'Part Attributes' tab is active (NEW REUSABLE METHOD)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);

			// ============================================================
			// STEP 1: OPEN COMMODITY GROUP DROPDOWN
			// ============================================================
			WebElement dropdown = waitForExpectedElement(SelectingCommodityGroupDropdown);
			Actions actions = new Actions(driver);

			actions.moveToElement(dropdown).click().perform();
			Thread.sleep(500);

			WebElement searchBox = waitForExpectedElement(EnterCommodityGroupNameInSearchBoxfirstab);
			searchBox.clear();
			searchBox.sendKeys(CommodityGroupName);
			Thread.sleep(600);

			WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(5));
			wait.until(ExpectedConditions.visibilityOfElementLocated(listCommodityGroupnames));

			List<WebElement> options = driver.findElements(listCommodityGroupnames);
			boolean found = false;

			for (WebElement opt : options) {

				String text = opt.getText().trim();
				LoggerUtil.info("Option found → " + text);

				if (text.equalsIgnoreCase(CommodityGroupName)) {

					((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView({block:'center'});", opt);

					Thread.sleep(200);

					actions.moveToElement(opt).pause(Duration.ofMillis(150)).click().perform();

					LoggerUtil.pass("✔ Selected Commodity Group via Actions → " + CommodityGroupName);

					storedData.put("CommodityGroup", CommodityGroupName);
					found = true;
					break;
				}
			}

			if (!found) {
				LoggerUtil.error("❌ Commodity Group NOT FOUND in dropdown → " + CommodityGroupName);
			}

			storedData.put("CommodityGroup", CommodityGroupName);

			// ============================================================
			// STEP 4: ENTER VALUES IN FIELDS
			// ============================================================
			String AnnualRequirementProduct = "200";
			clearAndEnterText(waitForExpectedElement(EnterAnnualRequirnmentOfProduct), AnnualRequirementProduct);
			storedData.put("AnnualRequirement", AnnualRequirementProduct);

			String AverageRequirementProduct = "20";
			clearAndEnterText(waitForExpectedElement(EnterAverageMonthlyRequirnmentOfproduct),
					AverageRequirementProduct);
			storedData.put("AverageRequirement", AverageRequirementProduct);

			String LotSize = "30.33";
			clearAndEnterText(waitForExpectedElement(EnterLotSize), LotSize);
			storedData.put("LotSize", LotSize);

			LoggerUtil.pass("✔ Entered & stored all Part Attribute values");

			// ============================================================
			// STEP 5: SAVE & CAPTURE TOAST
			// ============================================================
			clickOnElement(ClickingSaveButtonPartMaster);

			String toast = waitForExpectedElement(toastMessage).getText().trim();
			storedData.put("ToastMessage", toast);

			if (toast.equals("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✔ Toast Verified");
			} else {
				LoggerUtil.error("❌ Toast mismatch: " + toast);
			}

			Thread.sleep(700);

		} catch (Exception e) {
			LoggerUtil.error("❌ Error in Part Attributes write process → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		return storedData;
	}

	public HashMap<String, String> VerifySavePriceCalculationValueForCustomer(String rmInputCategory,
			String shapeOption, String CommodityGrp, String groupClassification, String yearValue, String periodValue,
			String specificGrade) throws InterruptedException {

		LoggerUtil.info("===== START: VerifySavePriceCalculationValue (CUSTOMER • FORGING) =====");

		HashMap<String, String> map = new HashMap<>();

		// ================================
		// FIXED INPUT VALUES
		// ================================
		map.put("ForgeWeight", "1223.4532");
		map.put("Perimeter", "192.73737");
		map.put("BlankWtDirect", "30.322");
		map.put("CutMargin", "11.2121");
		map.put("NoOfPieces", "15.7653");
		map.put("BlankWtKg", "12.3232");
		map.put("RejectionWastage", "12");
		map.put("FinishWeight", "10");
		map.put("ScrapRealization", "19.4123");

		map.put("RejectionValue", "20.543");
		map.put("Packing", "32.543");
		map.put("Insurance", "4.444");
		map.put("Profit", "64.3676");
		map.put("OverHead", "11");
		map.put("ICC", "2.67");
		map.put("Freight", "1.432");
		map.put("Factor1", "123");
		map.put("Factor2", "123");
		map.put("Factor3", "123");
		map.put("Remarks", "fc48");

		map.put("ToolCost", "432");
		map.put("Quantity", "3565");
		map.put("ToolAmortization", "37.4343");
		map.put("Maintenance", "21.4356");

		// ================================
		// DROPDOWNS VALUES
		// ================================
		map.put("RmInputCategory", rmInputCategory);
		map.put("ShapeOption", shapeOption);
		map.put("CommodityGrp", CommodityGrp);
		map.put("GroupClassification", groupClassification);
		map.put("YearValue", yearValue);
		map.put("PeriodValue", periodValue);
		map.put("SpecificGrade", specificGrade);

		// ================================
		// CUSTOMER SIDE OHP VALUE
		// ================================
		map.put("OHPCustomerSide", DataProp.getProperty("OHPCustomerSide"));

		try {

			// ================================
			// Navigate to Tab
			// ================================
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}
			Thread.sleep(2000);

			// ================================
			// SELECT DROPDOWNS
			// ================================
			new Select(waitForExpectedElement(RmInputCategoryDropdownn)).selectByVisibleText(rmInputCategory);
			LoggerUtil.info("Selected RmInputCategory → " + rmInputCategory);
			Thread.sleep(1200);

			new Select(waitForExpectedElement(DropdownlistShapeOptions)).selectByVisibleText(shapeOption);
			LoggerUtil.info("Selected ShapeOption → " + shapeOption);
			Thread.sleep(1200);

			clickOnElement(ClickingCommodityDropdownForging);
			Thread.sleep(400);

			clearAndEnterText(waitForExpectedElement(EnterCommoditySearcgboxForging), CommodityGrp);

			for (WebElement c : driver.findElements(listValueCommdityForging)) {
				if (c.getText().trim().equals(CommodityGrp)) {
					c.click();
					LoggerUtil.info("Selected CommodityGrp → " + CommodityGrp);
					break;
				}
			}
			Thread.sleep(1200);

			new Select(waitForExpectedElement(GroupClassificationDropdownDropdownForging))
					.selectByVisibleText(groupClassification);
			LoggerUtil.info("Selected Classification → " + groupClassification);
			Thread.sleep(1200);

			new Select(waitForExpectedElement(yearDropdownForForging)).selectByVisibleText(yearValue);
			LoggerUtil.info("Selected Year → " + yearValue);
			Thread.sleep(1200);

			new Select(waitForExpectedElement(periodDropdownForging)).selectByVisibleText(periodValue);
			LoggerUtil.info("Selected Period → " + periodValue);
			Thread.sleep(1200);

			new Select(waitForExpectedElement(specificDropdownForging)).selectByVisibleText(specificGrade);
			LoggerUtil.info("Selected Specific Grade → " + specificGrade);
			Thread.sleep(1200);

			// ================================
			// RADIO BUTTONS
			// ================================
			clickRadioButton(By.id("inpblank1"), "Direct Entry");
			Thread.sleep(800);

			clickRadioButton(By.id("cutmgn1"), "Cut Margin");
			Thread.sleep(800);

			clickRadioButton(By.id("noofpcs1"), "No. of Pieces");
			Thread.sleep(800);

			clickRadioButton(By.id("blankWtRadiodirect"), "Blank Weight");
			Thread.sleep(800);

			// ================================
			// ENTER NUMERIC INPUTS (LOOP)
			// ================================
			String[] keys = { "ForgeWeight", "Perimeter", "BlankWtDirect", "CutMargin", "NoOfPieces", "BlankWtKg",
					"RejectionWastage", "FinishWeight", "ScrapRealization" };

			By[] locators = { EnterForgeWeightInKg, EnterPartingLinePerimeterinmm, EnterBlankWtDirectEntry,
					EnterCutMarginMm, EnterNumberOfPieces, EnterBlankWtKgForForgeing, RejectionWastageOnBlankWt,
					EnterpartFinishWeightPerPc, EnterScrapRealization };

			for (int i = 0; i < keys.length; i++) {
				clearAndEnterText(waitForExpectedElement(locators[i]), map.get(keys[i]));
				LoggerUtil.info("Entered " + keys[i] + " → " + map.get(keys[i]));
				Thread.sleep(850);
			}

			// ================================
			// SYSTEM CALCULATED VALUES
			// ================================
			map.put("CutMarginEffort", waitForExpectedElement(FetchingCutMarginEffort).getAttribute("value"));
			map.put("FinalBlankWtKg", waitForExpectedElement(FetchingFinalBlankWtKg).getAttribute("value"));
			map.put("ScrapCostPerKg",
					waitForExpectedElement(FetchingDataFromScrapCostperKgFromPriceCalculationForForging)
							.getAttribute("value"));
			map.put("ScrapWtPerKg", waitForExpectedElement(fetchingDataFromScrapWtPerKgPriceCalculationTabForForging)
					.getAttribute("value"));
			map.put("RmCostPerKg",
					waitForExpectedElement(fetchingRmCostPerkgPriceCalculationForging).getAttribute("value"));
			map.put("ScrapCostKg",
					waitForExpectedElement(FetchingScrapCostkgPriceCalculationForging).getAttribute("value"));
			map.put("NetRmCostPerPc", waitForExpectedElement(fetchingNetRmCostPerPcForging).getAttribute("value"));
			map.put("RmYieldPercentage",
					waitForExpectedElement(FEtchingPerCentageRmYieldForging).getAttribute("value"));
			map.put("PieceAllowances", waitForExpectedElement(FetchingPieceAllowances).getAttribute("value"));
			Thread.sleep(1500);

			// ================================
			// CUSTOMER SIDE OHP DROPDOWN
			// ================================
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownForForgeing));
			Thread.sleep(1200);

			clickOnElement(ClickingOhpDropdownForForgeing);
			Thread.sleep(1500);

			clearAndEnterText(waitForExpectedElement(EnteringValueOhpSearchBox), map.get("OHPCustomerSide"));
			Thread.sleep(1500);
			for (WebElement ohp : driver.findElements(OhpOptionsForGeing)) {
				if (ohp.getText().trim().equals(map.get("OHPCustomerSide"))) {
					ohp.click();
					LoggerUtil.info("Selected OHP (Customer Side) → " + map.get("OHPCustomerSide"));
					break;
				}
			}
			Thread.sleep(1200);

			// ================================
			// OTHER COST INPUTS (LOOP)
			// ================================
			String[] keys2 = { "RejectionValue", "Packing", "Insurance", "Profit", "OverHead", "ICC", "Freight",
					"Factor1", "Factor2", "Factor3", "Remarks" };

			By[] locators2 = { EnterRejectionValue, EnterPackingCellBox, EnterInsuranceValue, EnterProfitValue,
					EnterOverHeadValue, EnterICCValue, EnterFrieghtKgCellBoxValue, EnterFactorValue1, EnterFactorValue2,
					EnterFactorValue3, EnterRemarksValue };

			for (int i = 0; i < keys2.length; i++) {
				clearAndEnterText(waitForExpectedElement(locators2[i]), map.get(keys2[i]));
				LoggerUtil.info("Entered " + keys2[i] + " → " + map.get(keys2[i]));
				Thread.sleep(850);
			}

			// ================================
			// TOOL COSTS
			// ================================
			clearAndEnterText(waitForExpectedElement(EnterToolCostValue), map.get("ToolCost"));
			clearAndEnterText(waitForExpectedElement(EnterQuantityValue), map.get("Quantity"));
			clearAndEnterText(waitForExpectedElement(EnterToolAmortizationValue), map.get("ToolAmortization"));
			clearAndEnterText(waitForExpectedElement(EnterToolMantinanceCost), map.get("Maintenance"));
			Thread.sleep(800);

			// ================================
			// SAVE + TOAST
			// ================================
			clickOnElement(ClickingSaveButtonForging);
			Thread.sleep(1800);

			String msg = waitForExpectedElement(toastMessage).getText().trim();
			LoggerUtil.info("Toast → " + msg);

		} catch (Exception e) {
			LoggerUtil.error("Exception during Customer Price Calculation: " + e.getMessage());
		}

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return map;
	}

	public void VeirfyPriceAttributeHasBeenSavedCorrectlyOrNotForCustomer(Map<String, String> storedData)
			throws InterruptedException {

		LoggerUtil.info("=====                                                             =====");
		LoggerUtil.info("===== START: Validating Price Attribute Saved Data (Customer Side) =====");
		LoggerUtil.info("=====                                                              =====");

		// Locators
		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");
		By SelectedCommodityGroupText = By.xpath(
				"//select[@id='commodityDrop']/following::span/descendant::span[@id='select2-commodityDrop-container']");
		By AnnualRequirementValue = By.xpath("//input[@id='AnnualRequirement']");
		By AverageRequirementValue = By.xpath("//input[@id='AverageMonthly']");
		By LotSizeValue = By.xpath("//input[@id='LotSize']");
		By PartDescriptionValue = By.xpath("//form[@id='tab1Form']/descendant::input[@id='Partdesc']");
		By PartNumberValue = By.xpath("//form[@id='tab1Form']/descendant::input[@id='Partno' or @id='PartNo']");

		try {

			Thread.sleep(1200);

			// ============================================================
			// STEP 1: Ensure Tab Active (UPDATED WITH REUSABLE METHOD)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);
			LoggerUtil.pass("✔ 'Part Attributes' tab visible.");

			Thread.sleep(2000);
			// ============================================================
			// STEP 2: Fetch UI values (NO CHANGE)
			// ============================================================
			String actualCommodity = waitForExpectedElement(SelectedCommodityGroupText).getText().trim();
			String actualAnnual = waitForExpectedElement(AnnualRequirementValue).getAttribute("value").trim();
			String actualAverage = waitForExpectedElement(AverageRequirementValue).getAttribute("value").trim();
			String actualLotSize = waitForExpectedElement(LotSizeValue).getAttribute("value").trim();
			String actualPartNumber = waitForExpectedElement(PartNumberValue).getAttribute("value").trim();
			String actualPartDescription = waitForExpectedElement(PartDescriptionValue).getAttribute("value").trim();

			// ============================================================
			// STEP 3: Expected Values (NO CHANGE)
			// ============================================================
			String expectedCommodity = storedData.get("CommodityGroup");
			String expectedAnnual = storedData.get("AnnualRequirement");
			String expectedAverage = storedData.get("AverageRequirement");
			String expectedLotSize = storedData.get("LotSize");
			String expectedPartNumber = storedData.get("Part Number");
			String expectedPartDescription = storedData.get("Part Description");

			// Normalize numeric values to 3 decimals
			String actualAnnualNorm = normalizeDecimal(actualAnnual);
			String expectedAnnualNorm = normalizeDecimal(expectedAnnual);

			String actualAverageNorm = normalizeDecimal(actualAverage);
			String expectedAverageNorm = normalizeDecimal(expectedAverage);

			String actualLotSizeNorm = normalizeDecimal(actualLotSize);
			String expectedLotSizeNorm = normalizeDecimal(expectedLotSize);

			// ============================================================
			// STEP 4: Validations (NO CHANGE)
			// ============================================================

			// Commodity Group
			if (actualCommodity.equalsIgnoreCase(expectedCommodity)) {
				LoggerUtil.pass("✔ Commodity Group matched: " + actualCommodity);
			} else {
				LoggerUtil.error(
						"❌ Commodity mismatch! Expected: " + expectedCommodity + " | Actual: " + actualCommodity);
			}

			// Annual Requirement
			if (actualAnnualNorm.equals(expectedAnnualNorm)) {
				LoggerUtil.pass("✔ Annual Requirement matched: " + actualAnnualNorm);
			} else {
				LoggerUtil.error("❌ Annual Requirement mismatch! Expected: " + expectedAnnualNorm + " | Actual: "
						+ actualAnnualNorm);
			}

			// Average Requirement
			if (actualAverageNorm.equals(expectedAverageNorm)) {
				LoggerUtil.pass("✔ Average Requirement matched: " + actualAverageNorm);
			} else {
				LoggerUtil.error("❌ Average Requirement mismatch! Expected: " + expectedAverageNorm + " | Actual: "
						+ actualAverageNorm);
			}

			// Lot Size
			if (actualLotSizeNorm.equals(expectedLotSizeNorm)) {
				LoggerUtil.pass("✔ Lot Size matched: " + actualLotSizeNorm);
			} else {
				LoggerUtil.error(
						"❌ Lot Size mismatch! Expected: " + expectedLotSizeNorm + " | Actual: " + actualLotSizeNorm);
			}

			// Part Number
			if (actualPartNumber.equals(expectedPartNumber)) {
				LoggerUtil.pass("✔ Part Number matched: " + actualPartNumber);
			} else {
				LoggerUtil.error(
						"❌ Part Number mismatch! Expected: " + expectedPartNumber + " | Actual: " + actualPartNumber);
			}

			// Part Description
			if (actualPartDescription.equals(expectedPartDescription)) {
				LoggerUtil.pass("✔ Part Description matched: " + actualPartDescription);
			} else {
				LoggerUtil.error("❌ Part Description mismatch! Expected: " + expectedPartDescription + " | Actual: "
						+ actualPartDescription);
			}

			LoggerUtil.pass("🎉 All Price Attribute validations completed.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in Price Attribute Validation: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Price Attribute Validation Completed =====");
	}

	// Normalize decimals to 3 places
	private String normalizeDecimal(String value) {
		try {
			double d = Double.parseDouble(value);
			return String.format("%.3f", d);
		} catch (Exception e) {
			return value;
		}
	}

	public void verifyPriceCalculationDataHasBeenSaveOrNotForCustomerSide(HashMap<String, String> map)
			throws InterruptedException {

		LoggerUtil.info("===============================================================");
		LoggerUtil.info("===== START: Validating Price Calculation Saved Data (Customer Side) =====");
		LoggerUtil.info("===============================================================");

		try {

			// -----------------------------------------------------------
			// Ensure OHP key exists (PREVENTS NULL)
			// -----------------------------------------------------------
			if (map.get("OHP") == null && map.get("OHPCustomerSide") != null) {
				map.put("OHP", map.get("OHPCustomerSide"));
				LoggerUtil.info("Adjusted OHP key → using OHPCustomerSide value.");
			}

			// -----------------------------------------------------------
			// Navigate to Price Calculation Tab
			// -----------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
					break;
				}
			}

			// -----------------------------------------------------------
			// MAIN NUMERIC FIELDS
			// -----------------------------------------------------------
			validateSaved("ForgeWeight", EnterForgeWeightInKg, map);
			validateSaved("Perimeter", EnterPartingLinePerimeterinmm, map);
			validateSaved("CutMargin", EnterCutMarginMm, map);
			validateSaved("NoOfPieces", EnterNumberOfPieces, map);
			validateSaved("BlankWtKg", EnterBlankWtKgForForgeing, map);
			validateSaved("RejectionWastage", RejectionWastageOnBlankWt, map);
			validateSaved("FinishWeight", EnterpartFinishWeightPerPc, map);
			validateSaved("ScrapRealization", EnterScrapRealization, map);

			// -----------------------------------------------------------
			// SYSTEM CALCULATED FIELDS
			// -----------------------------------------------------------
			validateSaved("CutMarginEffort", FetchingCutMarginEffort, map);
			validateSaved("FinalBlankWtKg", FetchingFinalBlankWtKg, map);
			validateSaved("ScrapCostPerKg", FetchingDataFromScrapCostperKgFromPriceCalculationForForging, map);
			validateSaved("ScrapWtPerKg", fetchingDataFromScrapWtPerKgPriceCalculationTabForForging, map);
			validateSaved("RmCostPerKg", fetchingRmCostPerkgPriceCalculationForging, map);
			validateSaved("ScrapCostKg", FetchingScrapCostkgPriceCalculationForging, map);
			validateSaved("NetRmCostPerPc", fetchingNetRmCostPerPcForging, map);
			validateSaved("RmYieldPercentage", FEtchingPerCentageRmYieldForging, map);
			validateSaved("PieceAllowances", FetchingPieceAllowances, map);

			LoggerUtil.pass("✔ All forging calculated values validated successfully.");

			// -----------------------------------------------------------
			// ADDITIONAL COST FIELDS
			// -----------------------------------------------------------
			validateSaved("RejectionValue", EnterRejectionValue, map);
			validateSaved("Packing", EnterPackingCellBox, map);
			validateSaved("Insurance", EnterInsuranceValue, map);
			validateSaved("Profit", EnterProfitValue, map);
			validateSaved("OverHead", EnterOverHeadValue, map);
			validateSaved("ICC", EnterICCValue, map);
			validateSaved("Freight", EnterFrieghtKgCellBoxValue, map);

			validateSaved("Factor1", EnterFactorValue1, map);
			validateSaved("Factor2", EnterFactorValue2, map);
			validateSaved("Factor3", EnterFactorValue3, map);

			validateSaved("Remarks", EnterRemarksValue, map);
			validateSaved("ToolCost", EnterToolCostValue, map);
			validateSaved("Quantity", EnterQuantityValue, map);
			validateSaved("ToolAmortization", EnterToolAmortizationValue, map);
			validateSaved("Maintenance", EnterToolMantinanceCost, map);

			LoggerUtil.info("--------------- DROPDOWN & RADIO VALIDATION STARTED ---------------");

			// -----------------------------------------------------------
			// DROPDOWN VALIDATION
			// -----------------------------------------------------------
			verifyDropdown("RmInputCategory", RmInputCategoryDropdownn, map);
			verifyDropdown("ShapeOption", DropdownlistShapeOptions, map);
			verifyDropdown("CommodityGrp", clickingCommodityDropdownForForGing, map);
			verifyDropdown("GroupClassification", GroupClassificationDropdownDropdownForging, map);
			verifyDropdown("YearValue", yearDropdownForForging, map);
			verifyDropdown("PeriodValue", periodDropdownForging, map);
			verifyDropdown("SpecificGrade", specificDropdownForging, map);

			// -----------------------------------------------------------
			// OHP VALIDATION
			// -----------------------------------------------------------
			verifyOHPSelected(ClickingOhpDropdownForForgeing, map.get("OHP"), "OHP");

			// -----------------------------------------------------------
			// RADIO VALIDATION - UPDATED (NO MORE By.id("Yes"))
			// -----------------------------------------------------------
			validateRadioSelection("Direct Entry", By.id("inpblank1"));
			validateRadioSelection("Cut Margin", By.id("cutmgn1"));
			validateRadioSelection("No. Of Pieces", By.id("noofpcs1"));
			validateRadioSelection("Blank Weight Direct", By.id("blankWtRadiodirect"));

			LoggerUtil.info("--------------- DROPDOWN & RADIO VALIDATION COMPLETED ---------------");
			LoggerUtil.pass("✔ Saved value verification completed successfully.");

		} catch (Exception e) {

			LoggerUtil.error("❌ Exception during Customer Save Verification → " + e.getMessage());
		}

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

	}

	public void validateRadioSelection(String radioName, By locator) {
		try {
			boolean selected = waitForExpectedElement(locator).isSelected();

			if (selected) {
				LoggerUtil.pass("PASS: Radio selected correctly → " + radioName);
			} else {
				LoggerUtil.fail("FAIL: Radio NOT selected → " + radioName);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error validating radio (" + radioName + ") → " + e.getMessage());
		}
	}

	private void validateSaved(String key, By locator, HashMap<String, String> map) {
		try {
			String expected = map.get(key);
			String actual = waitForExpectedElement(locator).getAttribute("value").trim();

			if (actual.equals(expected)) {
				LoggerUtil.pass(key + " matched → " + actual);
			} else {
				LoggerUtil.error(key + " mismatch → Expected: " + expected + " | Actual: " + actual);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error validating " + key + " → " + e.getMessage());
		}
	}

	private void verifyDropdown(String key, By locator, HashMap<String, String> map) {
		try {
			Select s = new Select(waitForExpectedElement(locator));
			String actual = s.getFirstSelectedOption().getText().trim();
			String expected = map.get(key);

			if (actual.equals(expected)) {
				LoggerUtil.pass("Dropdown '" + key + "' matched → " + expected);
			} else {
				LoggerUtil.error("Dropdown mismatch (" + key + ") → Expected: " + expected + " | Actual: " + actual);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error validating dropdown: " + key + " → " + e.getMessage());
		}
	}

	private void verifyRadio(String id, String readableName) {
		try {
			boolean selected = waitForExpectedElement(By.id(id)).isSelected();

			if (selected) {
				LoggerUtil.pass("Radio selected → " + readableName);
			} else {
				LoggerUtil.error("Radio NOT selected → " + readableName);
			}

		} catch (Exception e) {
			LoggerUtil.error("Error validating radio (" + readableName + ") → " + e.getMessage());
		}
	}

	public static final By fetchingCommodityGroupData = By.xpath("//span[@id='select2-commodityDrop-container']");

	public Map<String, String> verifyUpdateDataAndSaveInPartAttributesCustomerSide(String CommodityGroupName)
			throws InterruptedException {

		LoggerUtil.info("===== START: Updating Data in 'Part Attributes' Tab =====");

		HashMap<String, String> updatedData = new HashMap<>();

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		try {
			Thread.sleep(1200);

			// ============================================================
			// STEP 0: Ensure Tab Active (USING NEW REUSABLE METHOD)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);

			// ======================================================================
			// STEP 1: VALIDATE SELECTED COMMODITY GROUP (NO CHANGE)
			// ======================================================================
			String uiCommodityGroup = waitForExpectedElement(fetchingCommodityGroupData).getText().trim();
			updatedData.put("CommodityGroup", uiCommodityGroup);

			// ======================================================================
			// STEP 2: ENTER UPDATED VALUES (NEW VALUES)
			// ======================================================================
			String newAnnualRequirement = "500"; // UPDATED VALUE
			clearAndEnterText(waitForExpectedElement(EnterAnnualRequirnmentOfProduct), newAnnualRequirement);
			updatedData.put("AnnualRequirement", newAnnualRequirement);

			String newAverageMonthlyRequirement = "55"; // UPDATED VALUE
			clearAndEnterText(waitForExpectedElement(EnterAverageMonthlyRequirnmentOfproduct),
					newAverageMonthlyRequirement);
			updatedData.put("AverageRequirement", newAverageMonthlyRequirement);

			String newLotSize = "75.99"; // UPDATED VALUE
			clearAndEnterText(waitForExpectedElement(EnterLotSize), newLotSize);
			updatedData.put("LotSize", newLotSize);

			LoggerUtil.pass("✔ Updated new values in Part Attributes.");

			// ======================================================================
			// STEP 3: SAVE UPDATED VALUES
			// ======================================================================
			clickOnElement(ClickingSaveButtonPartMaster);

			String toastMsg = waitForExpectedElement(toastMessage).getText().trim();
			updatedData.put("ToastMessage", toastMsg);

			if (toastMsg.equalsIgnoreCase("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✔ Update successful. Toast verified.");
			} else {
				LoggerUtil.error("❌ Unexpected Toast After Update: " + toastMsg);
			}

			Thread.sleep(1500);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in updating Part Attributes: " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Updated Part Attributes Successfully =====");
		return updatedData;
	}

	public void validateUpdatedPartAttributesCustomerSide(Map<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info(" VALIDATION STARTED: [Part Attributes - Updated Values]");
		LoggerUtil.info("==============================================");

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		try {
			// ============================================================
			// STEP 0: Ensure the 'Part Attributes' tab is active (REUSABLE METHOD)
			// ============================================================
			ensurePartAttributesTabLoaded(headingLocator);

			// ---------------------------------------------------------
			// STEP 2: COMMODITY GROUP VALIDATION
			// ---------------------------------------------------------
			try {
				LoggerUtil.info("Validating Commodity Group...");

				String expectedGroup = expectedData.getOrDefault("CommodityGroup", "").trim();

				((JavascriptExecutor) driver).executeScript("window.scrollTo(0,0);");
				Thread.sleep(500);

				WebElement cgElement = null;

				// Primary Select2 locator
				try {
					cgElement = driver.findElement(By.xpath(
							"//select[@id='commodityDrop']/following::span/descendant::span[@id='select2-commodityDrop-container']"));
				} catch (Exception ignored) {
				}

				// Fallback Select2 locator
				if (cgElement == null) {
					try {
						cgElement = driver.findElement(By.xpath(
								"//span[contains(@class,'select2-selection__rendered') and contains(@id,'commodity')]"));
					} catch (Exception ignored) {
					}
				}

				if (cgElement == null) {
					LoggerUtil.error("❌ Commodity Group element NOT FOUND.");
				} else {
					String actualGroup = cgElement.getText().trim();
					if (actualGroup.equalsIgnoreCase(expectedGroup)) {
						LoggerUtil.pass("✔ Commodity Group matched → " + actualGroup);
					} else {
						LoggerUtil.error("❌ Commodity Group mismatch → Expected: " + expectedGroup + " | Actual: "
								+ actualGroup);
					}
				}

			} catch (Exception e) {
				LoggerUtil.error("❌ Exception validating Commodity Group → " + e.getMessage());
			}

			// ---------------------------------------------------------
			// STEP 3: NUMERIC FIELD VALIDATION
			// ---------------------------------------------------------
			validateNumericField("Annual Requirement", EnterAnnualRequirnmentOfProduct,
					expectedData.get("AnnualRequirement"));

			validateNumericField("Average Monthly Requirement", EnterAverageMonthlyRequirnmentOfproduct,
					expectedData.get("AverageRequirement"));

			validateNumericField("Lot Size", EnterLotSize, expectedData.get("LotSize"));

		} catch (Exception e) {
			LoggerUtil.error("❌ Unexpected error during Part Attributes validation → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info(" VALIDATION COMPLETED: [Part Attributes - Updated Values]");
		LoggerUtil.info("==============================================");
	}

	public void validateNumericField(String label, By locator, String expected) {
		try {
			String actual = waitForExpectedElement(locator).getAttribute("value").trim();

			double exp = Double.parseDouble(expected);
			double act = Double.parseDouble(actual);

			if (Math.abs(exp - act) < 0.001) {
				LoggerUtil.pass("✔ " + label + " matched → Expected: " + expected + " | Actual: " + actual);
			} else {
				LoggerUtil.error("❌ " + label + " mismatch → Expected: " + expected + " | Actual: " + actual);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception validating " + label + " → " + e.getMessage());
		}
	}

	public HashMap<String, String> VerifyUpdatePriceCalculationCustomerSideValueForForging(String rmInputCategory,
			String shapeOption, String CommodityGrp, String groupClassification, String yearValue, String periodValue,
			String specificGrade) throws InterruptedException {

		HashMap<String, String> map = new HashMap<>();

		// ---------------------------------------------------------------------
		// STEP 0: UPDATED NUMERIC INPUT VALUES
		// ---------------------------------------------------------------------
		map.put("ForgeWeight", "1221328");
		map.put("Perimeter", "192222");
		map.put("BlankWtDirect", "303222.32332");
		map.put("CutMargin", "112121.233");
		map.put("NoOfPieces", "157653.3232");
		map.put("BlankWtKg", "123232.23323");
		map.put("RejectionWastage", "12.322434");
		map.put("FinishWeight", "43456.435235");
		map.put("ScrapRealization", "194123.624");
		map.put("RejectionValue", "20543.375734");
		map.put("Packing", "32543.8342");
		map.put("Insurance", "4444.43455");
		map.put("Profit", "643676.52562");
		map.put("OverHead", "11.767");
		map.put("ICC", "267.8736474");
		map.put("Freight", "1432.8733");
		map.put("Factor1", "123.55563256");
		map.put("Factor2", "123.524523");
		map.put("Factor3", "123.345");
		map.put("Remarks", "fc48");

		map.put("ToolCost", "432");
		map.put("Quantity", "3565");
		map.put("ToolAmortization", "37.4343");
		map.put("Maintenance", "21.4356");

		// ---------------------------------------------------------------------
		// STEP 1: DROPDOWN SELECTION VALUES (unchanged)
		// ---------------------------------------------------------------------
		map.put("RmInputCategory", rmInputCategory);
		map.put("ShapeOption", shapeOption);
		map.put("CommodityGrp", CommodityGrp);
		map.put("GroupClassification", groupClassification);
		map.put("YearValue", yearValue);
		map.put("PeriodValue", periodValue);
		map.put("SpecificGrade", specificGrade);

		// ---------------------------------------------------------------------
		// STEP 2: REQUIRED RADIO BUTTON IDs
		// ---------------------------------------------------------------------
		map.put("RadioDirectEntry", "inpblank1");
		map.put("RadioCutMargin", "cutmgn1");
		map.put("RadioNoOfPieces", "noofpcs1");
		map.put("RadioBlankWtDirect", "blankWtRadiodirect");

		// OHP (remains property-based)
		map.put("OHP", DataProp.getProperty("OHPCustomerSide"));

		try {

			// -------------------------------------------------------------
			// STEP 3: NAVIGATE TO "Part Price Calculations"
			// -------------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
					break;
				}
			}

			// -------------------------------------------------------------
			// STEP 4: SELECT DROPDOWN VALUES
			// -------------------------------------------------------------
			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);

			selectDropDownValue(DropdownlistShapeOptions, shapeOption, "visibleText");
			Thread.sleep(7000);

			selectDropDownValue(clickingCommodityDropdownForForGing, CommodityGrp, "visibleText");
			selectDropDownValue(GroupClassificationDropdownDropdownForging, groupClassification, "visibleText");

			Thread.sleep(3000);
			selectDropDownValue(yearDropdownForForging, yearValue, "visibleText");
			Thread.sleep(3000);
			selectDropDownValue(periodDropdownForging, periodValue, "visibleText");
			Thread.sleep(2999);
			selectDropDownValue(specificDropdownForging, specificGrade, "visibleText");

			// -------------------------------------------------------------
			// STEP 5: RADIO BUTTONS FOR DIRECT ENTRY
			// -------------------------------------------------------------
			openDirectEntrySection();
			WebElement ele = driver.findElement(By.id("inpblank1"));
			((JavascriptExecutor) driver).executeScript("arguments[0].scrollIntoView(true);", ele);

			clickRadioButton(By.id("inpblank1"), "Direct Entry");
			clickRadioButton(By.id("cutmgn1"), "Cut Margin");
			clickRadioButton(By.id("noofpcs1"), "No. of Pieces");
			clickRadioButton(By.id("blankWtRadiodirect"), "Blank Weight");

			// -------------------------------------------------------------
			// STEP 6: ENTER ALL INPUT VALUES
			// -------------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterForgeWeightInKg), map.get("ForgeWeight"));
			clearAndEnterText(waitForExpectedElement(EnterPartingLinePerimeterinmm), map.get("Perimeter"));

			selectDropDownValue(SelectingBlankingProcessFromDropdown,
					DataProp.getProperty("BlankingProcessDropdownValueFromPriceCalculation"), "visibleText");

			scrollDownToUpUntilElement(EffectiveInputLength);

			clearAndEnterText(waitForExpectedElement(EnterBlankWtDirectEntry), map.get("BlankWtDirect"));
			clearAndEnterText(waitForExpectedElement(EnterCutMarginMm), map.get("CutMargin"));
			clearAndEnterText(waitForExpectedElement(EnterNumberOfPieces), map.get("NoOfPieces"));
			clearAndEnterText(waitForExpectedElement(EnterBlankWtKgForForgeing), map.get("BlankWtKg"));
			clearAndEnterText(waitForExpectedElement(RejectionWastageOnBlankWt), map.get("RejectionWastage"));
			clearAndEnterText(waitForExpectedElement(EnterpartFinishWeightPerPc), map.get("FinishWeight"));
			clearAndEnterText(waitForExpectedElement(EnterScrapRealization), map.get("ScrapRealization"));

			// -------------------------------------------------------------
			// STEP 7: FETCH NEW CALCULATED VALUES (VERY IMPORTANT)
			// -------------------------------------------------------------
			String fetchingValueCutMargiData = waitForExpectedElement(FetchingCutMarginEffort).getAttribute("value");
			String FetchngFinalBlankWtPerKg = waitForExpectedElement(FetchingFinalBlankWtKg).getAttribute("value");
			String FEtchingValuefromScrapCost = waitForExpectedElement(
					FetchingDataFromScrapCostperKgFromPriceCalculationForForging).getAttribute("value").trim();
			String fetchingValueFromScrapWt = waitForExpectedElement(
					fetchingDataFromScrapWtPerKgPriceCalculationTabForForging).getAttribute("value").trim();
			String fetchingValueFrmRmCostPerKg = waitForExpectedElement(fetchingRmCostPerkgPriceCalculationForging)
					.getAttribute("value").trim();
			String FetchingScrapCostPerKg = waitForExpectedElement(FetchingScrapCostkgPriceCalculationForging)
					.getAttribute("value").trim();
			String NetRmCostPerpc = waitForExpectedElement(fetchingNetRmCostPerPcForging).getAttribute("value").trim();
			String FetchingDataPerCentageRmYieldForging = waitForExpectedElement(FEtchingPerCentageRmYieldForging)
					.getAttribute("value").trim();
			String FEtchingPieceAllowances = waitForExpectedElement(FetchingPieceAllowances).getAttribute("value")
					.trim();

			// ---- Store calculated fields for validation ----
			map.put("CutMarginEffort", fetchingValueCutMargiData);
			map.put("FinalBlankWtKg", FetchngFinalBlankWtPerKg);
			map.put("ScrapCostPerKg", FEtchingValuefromScrapCost);
			map.put("ScrapWtPerKg", fetchingValueFromScrapWt);
			map.put("RmCostPerKg", fetchingValueFrmRmCostPerKg);
			map.put("ScrapCostKg", FetchingScrapCostPerKg);
			map.put("NetRmCostPerPc", NetRmCostPerpc);
			map.put("RmYieldPercentage", FetchingDataPerCentageRmYieldForging);
			map.put("PieceAllowances", FEtchingPieceAllowances);

			// -------------------------------------------------------------
			// STEP 8: SELECT OHP
			// -------------------------------------------------------------
			WebElement element = waitForExpectedElement(By.id("forgingOhp"));
			JavascriptExecutor js = (JavascriptExecutor) driver;
			js.executeScript("arguments[0].scrollIntoView({behavior:'smooth',block:'center'});", element);

			Thread.sleep(4000);
			clickOnElement(ClickingOhpDropdownForForgeing);
			Thread.sleep(4000);
			clearAndEnterText(waitForExpectedElement(EnteringValueOhpSearchBox),
					DataProp.getProperty("OHPCustomerSide"));

			List<WebElement> Ohpnorms = driver.findElements(OhpOptionsForGeing);
			for (WebElement ohpnorm : Ohpnorms) {
				if (ohpnorm.getText().trim().equals(DataProp.getProperty("OHPCustomerSide"))) {
					ohpnorm.click();
					break;
				}
			}

			// -------------------------------------------------------------
			// STEP 9: ENTER REMAINING COST FIELDS
			// -------------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterRejectionValue), map.get("RejectionValue"));
			clearAndEnterText(waitForExpectedElement(EnterPackingCellBox), map.get("Packing"));
			clearAndEnterText(waitForExpectedElement(EnterInsuranceValue), map.get("Insurance"));
			clearAndEnterText(waitForExpectedElement(EnterProfitValue), map.get("Profit"));
			clearAndEnterText(waitForExpectedElement(EnterOverHeadValue), map.get("OverHead"));
			clearAndEnterText(waitForExpectedElement(EnterICCValue), map.get("ICC"));
			clearAndEnterText(waitForExpectedElement(EnterFrieghtKgCellBoxValue), map.get("Freight"));
			clearAndEnterText(waitForExpectedElement(EnterFactorValue1), map.get("Factor1"));
			clearAndEnterText(waitForExpectedElement(EnterFactorValue2), map.get("Factor2"));
			clearAndEnterText(waitForExpectedElement(EnterFactorValue3), map.get("Factor3"));
			clearAndEnterText(waitForExpectedElement(EnterRemarksValue), map.get("Remarks"));

			// -------------------------------------------------------------
			// STEP 10 (IMPORTANT FIX): SELECT DIRECT ENTRY OHP RADIO
			// -------------------------------------------------------------
			clickOnElement(DirectEntryOHPRadioBtn);
			Thread.sleep(1000);

			clearAndEnterText(waitForExpectedElement(EnterToolCostValue), map.get("ToolCost"));
			clearAndEnterText(waitForExpectedElement(EnterQuantityValue), map.get("Quantity"));
			clearAndEnterText(waitForExpectedElement(EnterToolAmortizationValue), map.get("ToolAmortization"));
			clearAndEnterText(waitForExpectedElement(EnterToolMantinanceCost), map.get("Maintenance"));

			// -------------------------------------------------------------
			// STEP 11: SAVE
			// -------------------------------------------------------------
			clickOnElement(ClickingSaveButtonForging);

			String Toastmsg = waitForExpectedElement(toastMessage).getText().trim();
			String expectedToast = "Forging Costing saved successfully.";

			if (Toastmsg.equalsIgnoreCase(expectedToast)) {
				LoggerUtil.pass("Toast validated → " + Toastmsg);
			} else {
				LoggerUtil.error("Toast mismatch! Expected: " + expectedToast + " | Actual: " + Toastmsg);
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception occurred: " + e.getMessage());
		}
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return map;
	}

	/////////////////////////// FerrousCastingProcurmentSide//////////////////////////////////////

	public static final By SelectingGroupClassificationFerrous = By.xpath("//select[@id='f_SubGroup']");
	public static final By ClickignRadioBtnnearByRmInputCategoryDropdown = By.xpath("//input[@id='nfRadioDirect']");
	public static final By selectingYearValueFromYearDropdownFerrousCasting = By.xpath("//select[@id='Year1']");
	public static final By selectingRmPeriodFerrousCasting = By.xpath("//select[@id='RmPeriod_F']");
	public static final By selectingSpecificGradeFerrousCasting = By.xpath("//select[@id='f_SpecificGrade']");
	public static final By EnterCastWeightKgFerrousCasting = By.xpath("//input[@id='f_CastWt']");
	public static final By EnterPartFinishWeightKgForFerrousCasting = By.xpath("//input[@id='f_PartFinWt']");

	public static final By FetchingScrapRealizationDataFerrousCasting = By.xpath("//input[@id='f_ScrapReal']");
	public static final By FetchingScrapCostKgFerrousCasting = By.xpath("//input[@id='f_ScrapCostKg']");
	public static final By fetchingRmCostPerPcFerrousCasting = By.xpath("//input[@id='f_RmCostPc']");
	public static final By FetchingPartCostPerPcA = By.id("PartCostPC_F");
	public static final By FetchingTotalPartCostPerPcAWithAmortization = By.id("TotalPartCostWithAmortizationPC_F");

	public static final By clickingOhpDropdownFerrousCasting = By.xpath(
			"//select[@id='ferrousOhp']/following-sibling::span/descendant::span[@id='select2-ferrousOhp-container']");
	public static final By EnterOhpVauleInSearchBoxForFerrousCasting = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']//input[@type='search']");

	public static final By ListValueOhpDropdownForFerrousCasting = By
			.xpath("//ul[@id='select2-ferrousOhp-results']/li");
	public static final By EnterRejectionValueFerrousCasting = By.xpath("//input[@id='RejectionText2F']");
	public static final By EnterPackingcellFerrousCating = By.xpath("//input[@id='PackingText2F']");
	public static final By EnterInsuranceFerrousCasting = By.xpath("//input[@id='InsuranceText2F']");
	public static final By EnterProfitValueForFerrousCasting = By.xpath("//input[@id='ProfitText2F']");
	public static final By EnterOverHeadValueForFerrousCasting = By.xpath("//input[@id='OverheadText2F']");
	public static final By EnterIncoTermsForFerrousCasting = By.xpath("//input[@id='IncoTermF']");
	public static final By EnterFrieghtKgFerrousCasting = By.xpath("//input[@id='FrightText2F']");
	public static final By EnterOtherFactor1FerrousCasting = By.xpath("//input[@id='OtherFactor1C_F']");
	public static final By EnterOtherFactor2FerrousCasting = By.xpath("//input[@id='OtherFactor2C_F']");
	public static final By EnterOtherFactor3FerrousCasting = By.xpath("//input[@id='OtherFactor3C_F']");
	public static final By EnterToolCastValueFerrousCasting = By.xpath("//input[@id='ToolCost_F']");
	public static final By EnterAmortizationQuantityFerrousCasting = By.id("Quantity_F");
	public static final By EnterToolAmortizationPerPcFerrousCasting = By.id("ToolAmortizationPC_F");
	public static final By EnterToolMaintinanceCostFerrousCasting = By.id("ToolMaintenance_F");
	public static final By EnterRemarksValueForFerrousCasting = By.xpath("//input[@id='remarks_f']");
	public static final By ClickingSaveButtonFerrousCasting = By.id("FerrousShapeSave");

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationFerrousCasetingProcurmentSide(String rmInputCategory,
			String enterClassificationValue, String EnterYear, String EnterPeriod, String EnterSpecificGradeValue)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: SAVE PRICE CALCULATION (FERROUS CASTING - PROCUREMENT)");
		LoggerUtil.info("==============================================");

		HashMap<String, String> map = new HashMap<>();

		try {

			// ---------------------------------------------------------
			// STEP 0 → Store Input Parameters
			// ---------------------------------------------------------
			map.put("RmInputCategory", rmInputCategory);
			map.put("Classification", enterClassificationValue);
			map.put("Year", EnterYear);
			map.put("Period", EnterPeriod);
			map.put("SpecificGrade", EnterSpecificGradeValue);

			LoggerUtil.info("Step 0: Input parameters stored in map");

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			LoggerUtil.info("Step 1: Navigating to 'Part Price Calculations' tab...");

			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}

			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown Selections
			// ---------------------------------------------------------
			LoggerUtil.info("Step 2: Selecting dropdown values...");

			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);
			map.put("SelectedRmInputCategory", rmInputCategory);
			LoggerUtil.pass("RM Input Category Selected → " + rmInputCategory);

			Thread.sleep(1200);

			clickOnElement(ClickignRadioBtnnearByRmInputCategoryDropdown);
			LoggerUtil.pass("Clicked Direct Radio Button near RM Input Category");

			Thread.sleep(1200);

			selectDropDownValue(SelectingGroupClassificationFerrous, enterClassificationValue, "visibleText");
			map.put("SelectedClassification", enterClassificationValue);
			LoggerUtil.pass("Classification Selected → " + enterClassificationValue);

			Thread.sleep(1200);

			selectDropDownValue(selectingYearValueFromYearDropdownFerrousCasting, EnterYear, "visibleText");
			map.put("SelectedYear", EnterYear);
			LoggerUtil.pass("Year Selected → " + EnterYear);

			Thread.sleep(1200);

			selectDropDownValue(selectingRmPeriodFerrousCasting, EnterPeriod, "visibleText");
			map.put("SelectedPeriod", EnterPeriod);
			LoggerUtil.pass("Period Selected → " + EnterPeriod);

			Thread.sleep(1200);

			selectDropDownValue(selectingSpecificGradeFerrousCasting, EnterSpecificGradeValue, "visibleText");
			map.put("SelectedSpecificGrade", EnterSpecificGradeValue);
			LoggerUtil.pass("Specific Grade Selected → " + EnterSpecificGradeValue);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Numeric Inputs (Cast Weight & Finish Weight)
			// ---------------------------------------------------------
			LoggerUtil.info("Step 3: Entering numeric inputs...");

			clearAndEnterText(waitForExpectedElement(EnterCastWeightKgFerrousCasting), "11.5486");
			map.put("CastWeight", "11.5486");
			LoggerUtil.pass("Cast Weight Entered → 11.5486");

			clearAndEnterText(waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting), "2.7667");
			map.put("FinishWeight", "2.7667");
			LoggerUtil.pass("Finish Weight Entered → 2.7667");

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Fetch System Calculated Values
			// ---------------------------------------------------------
			LoggerUtil.info("Step 4: Fetching system calculated values...");

			String scrapRealization = waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting)
					.getAttribute("value").trim();
			map.put("ScrapRealization", scrapRealization);
			LoggerUtil.pass("Scrap Realization → " + scrapRealization);

			String scrapCostPerKg = waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value")
					.trim();
			map.put("ScrapCostPerKg", scrapCostPerKg);
			LoggerUtil.pass("Scrap Cost Per Kg → " + scrapCostPerKg);

			String rmCostPerPc = waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim();
			map.put("RmCostPerPc", rmCostPerPc);
			LoggerUtil.pass("RM Cost Per Pc → " + rmCostPerPc);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection (Scroll + Select)
			// ---------------------------------------------------------
			LoggerUtil.info("Step 5: Selecting OHP...");

			scrollToElement(waitForExpectedElement(clickingOhpDropdownFerrousCasting));
			Thread.sleep(1500);

			clickOnElement(clickingOhpDropdownFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterOhpVauleInSearchBoxForFerrousCasting),
					DataProp.getProperty("OHP"));
			map.put("OHP", DataProp.getProperty("OHP"));
			LoggerUtil.pass("OHP Entered → " + DataProp.getProperty("OHP"));

			Thread.sleep(1200);

			for (WebElement ohpNorm : driver.findElements(ListValueOhpDropdownForFerrousCasting)) {
				if (ohpNorm.getText().trim().equals(DataProp.getProperty("OHP"))) {
					ohpNorm.click();
					LoggerUtil.pass("OHP Selected from dropdown");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 6 → Enter Other Cost Values
			// ---------------------------------------------------------
			LoggerUtil.info("Step 6: Entering cost inputs...");

			clearAndEnterText(waitForExpectedElement(EnterRejectionValueFerrousCasting), "2.2123");
			map.put("RejectionValue", "2.2123");

			clearAndEnterText(waitForExpectedElement(EnterInsuranceFerrousCasting), "9.2123");
			map.put("Insurance", "9.2123");

			clearAndEnterText(waitForExpectedElement(EnterPackingcellFerrousCating), "19.2123");
			map.put("Packing", "19.2123");

			clearAndEnterText(waitForExpectedElement(EnterProfitValueForFerrousCasting), "22.2123");
			map.put("Profit", "22.2123");

			clearAndEnterText(waitForExpectedElement(EnterOverHeadValueForFerrousCasting), "32.2123");
			map.put("OverHead", "32.2123");

			clearAndEnterText(waitForExpectedElement(EnterIncoTermsForFerrousCasting), "333.2123");
			map.put("Incoterms", "333.2123");

			clearAndEnterText(waitForExpectedElement(EnterFrieghtKgFerrousCasting), "14.2123");
			map.put("Freight", "14.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor1FerrousCasting), "94.2123");
			map.put("Factor1", "94.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor2FerrousCasting), "29.2123");
			map.put("Factor2", "29.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor3FerrousCasting), "144.2123");
			map.put("Factor3", "144.2123");

			clearAndEnterText(waitForExpectedElement(EnterRemarksValueForFerrousCasting), "51");
			map.put("Remarks", "51");

			LoggerUtil.pass("All cost values entered successfully");
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 7 → Tool Cost Inputs
			// ---------------------------------------------------------
			LoggerUtil.info("Step 7: Entering tool inputs...");

			clearAndEnterText(waitForExpectedElement(EnterToolCastValueFerrousCasting), "43.2123");
			map.put("ToolCost", "43.2123");

			clearAndEnterText(waitForExpectedElement(EnterAmortizationQuantityFerrousCasting), "00.2123");
			map.put("AmortizationQty", "00.2123");

			clearAndEnterText(waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting), "429.2123");
			map.put("ToolAmortization", "429.2123");

			clearAndEnterText(waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting), "109.2123");
			map.put("ToolMaintenance", "109.2123");

			LoggerUtil.pass("Tool inputs entered successfully");
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 8 → Fetch Final Calculated Values
			// ---------------------------------------------------------
			LoggerUtil.info("Step 8: Fetching final calculated values...");

			String partCostA = waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim();
			map.put("PartCostPerPcA", partCostA);
			LoggerUtil.pass("Part Cost Per Pc A → " + partCostA);

			String totalPartCostA = waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization)
					.getAttribute("value").trim();
			map.put("TotalPartCostPerPcAWithAmortization", totalPartCostA);
			LoggerUtil.pass("Total Part Cost With Amortization → " + totalPartCostA);

			Thread.sleep(1200);

			// ---------------------------------------------------------
			// STEP 9 → Save
			// ---------------------------------------------------------
			LoggerUtil.info("Step 9: Clicking Save...");

			clickOnElement(ClickingSaveButtonFerrousCasting);
			LoggerUtil.pass("Clicked Save button");

			Thread.sleep(1500);

			String toastMsg = waitForExpectedElement(toastMessage).getText().trim();
			map.put("ToastMessage", toastMsg);

			if (toastMsg.equalsIgnoreCase("Ferrous casting saved successfully")) {
				LoggerUtil.pass("Toast VALID → " + toastMsg);
			} else {
				LoggerUtil.fail("Toast INVALID → Expected: Ferrous casting saved successfully | Actual: " + toastMsg);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in Ferrous Casting Save → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: SAVE PRICE CALCULATION (FERROUS CASTING - PROCUREMENT)");
		LoggerUtil.info("==============================================");

		return map;
	}

	public void validatePriceCalculationFerrousCasting(HashMap<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Ferrous Casting)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown validations
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("SelectedRmInputCategory"),
					"RM Input Category");

			validateDropdownValue(SelectingGroupClassificationFerrous, expectedData.get("SelectedClassification"),
					"Classification");

			validateDropdownValue(selectingYearValueFromYearDropdownFerrousCasting, expectedData.get("SelectedYear"),
					"Year");

			validateDropdownValue(selectingRmPeriodFerrousCasting, expectedData.get("SelectedPeriod"), "Period");

			validateDropdownValue(selectingSpecificGradeFerrousCasting, expectedData.get("SelectedSpecificGrade"),
					"Specific Grade");

			// ---------------------------------------------------------
			// STEP 3 → Radio button validation
			// ---------------------------------------------------------
			validateRadioButton(ClickignRadioBtnnearByRmInputCategoryDropdown, "Direct Entry");

			// ---------------------------------------------------------
			// STEP 4 → Numeric input validations
			// ---------------------------------------------------------
			validateInput("CastWeight", EnterCastWeightKgFerrousCasting, expectedData);

			validateInput("FinishWeight", EnterPartFinishWeightKgForFerrousCasting, expectedData);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → Calculated field validations
			// ---------------------------------------------------------
			validateInput("ScrapRealization", FetchingScrapRealizationDataFerrousCasting, expectedData);

			validateInput("ScrapCostPerKg", FetchingScrapCostKgFerrousCasting, expectedData);

			validateInput("RmCostPerPc", fetchingRmCostPerPcFerrousCasting, expectedData);

			// ---------------------------------------------------------
			// STEP 6 → OHP validation
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(clickingOhpDropdownFerrousCasting));
			Thread.sleep(1200);

			validateDropdownValue(clickingOhpDropdownFerrousCasting, expectedData.get("OHP"), "OHP");

			// ---------------------------------------------------------
			// STEP 7 → Cost field validations
			// ---------------------------------------------------------
			validateInput("RejectionValue", EnterRejectionValueFerrousCasting, expectedData);

			validateInput("Insurance", EnterInsuranceFerrousCasting, expectedData);

			validateInput("Packing", EnterPackingcellFerrousCating, expectedData);

			validateInput("Profit", EnterProfitValueForFerrousCasting, expectedData);

			validateInput("OverHead", EnterOverHeadValueForFerrousCasting, expectedData);

			validateInput("Incoterms", EnterIncoTermsForFerrousCasting, expectedData);

			validateInput("Freight", EnterFrieghtKgFerrousCasting, expectedData);

			validateInput("Factor1", EnterOtherFactor1FerrousCasting, expectedData);

			validateInput("Factor2", EnterOtherFactor2FerrousCasting, expectedData);

			validateInput("Factor3", EnterOtherFactor3FerrousCasting, expectedData);

			validateInput("Remarks", EnterRemarksValueForFerrousCasting, expectedData);

			// ---------------------------------------------------------
			// STEP 8 → Tool cost validations
			// ---------------------------------------------------------
			validateInput("ToolCost", EnterToolCastValueFerrousCasting, expectedData);

			validateInput("AmortizationQty", EnterAmortizationQuantityFerrousCasting, expectedData);

			validateInput("ToolAmortization", EnterToolAmortizationPerPcFerrousCasting, expectedData);

			validateInput("ToolMaintenance", EnterToolMaintinanceCostFerrousCasting, expectedData);

			// ---------------------------------------------------------
			// STEP 9 → Final calculated values
			// ---------------------------------------------------------
			validateInput("PartCostPerPcA", FetchingPartCostPerPcA, expectedData);

			validateInput("TotalPartCostPerPcAWithAmortization", FetchingTotalPartCostPerPcAWithAmortization,
					expectedData);

			LoggerUtil.pass("✔ Ferrous Casting price calculation validated successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Ferrous Casting validation → " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Ferrous Casting)");
		LoggerUtil.info("==============================================");
	}

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationFerrousCastingCustomerSide(String rmInputCategory,
			String enterClassificationValue, String EnterYear, String EnterPeriod, String EnterSpecificGradeValue)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: SAVE PRICE CALCULATION (FERROUS CASTING)");
		LoggerUtil.info("==============================================");

		HashMap<String, String> map = new HashMap<>();
		String ohp = DataProp.getProperty("OHPCustomerSide");

		try {

			// ---------------------------------------------------------
			// STEP 0 → Store Input Parameters
			// ---------------------------------------------------------
			map.put("RmInputCategory", rmInputCategory);
			map.put("Classification", enterClassificationValue);
			map.put("Year", EnterYear);
			map.put("Period", EnterPeriod);
			map.put("SpecificGrade", EnterSpecificGradeValue);

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab");
					break;
				}
			}

			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown Selections
			// ---------------------------------------------------------
			Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmInputSelect.selectByVisibleText(rmInputCategory);
			map.put("SelectedRmInputCategory", rmInputCategory);
			LoggerUtil.pass("RM Input Category Selected → " + rmInputCategory);

			Thread.sleep(1200);

			clickOnElement(ClickignRadioBtnnearByRmInputCategoryDropdown);
			LoggerUtil.pass("Clicked Direct Radio Button near RM Input Category");

			Thread.sleep(1200);

			selectDropDownValue(SelectingGroupClassificationFerrous, enterClassificationValue, "visibleText");
			map.put("SelectedClassification", enterClassificationValue);
			LoggerUtil.pass("Classification Selected → " + enterClassificationValue);

			Thread.sleep(1200);

			selectDropDownValue(selectingYearValueFromYearDropdownFerrousCasting, EnterYear, "visibleText");
			map.put("SelectedYear", EnterYear);
			LoggerUtil.pass("Year Selected → " + EnterYear);

			Thread.sleep(1200);

			selectDropDownValue(selectingRmPeriodFerrousCasting, EnterPeriod, "visibleText");
			map.put("SelectedPeriod", EnterPeriod);
			LoggerUtil.pass("Period Selected → " + EnterPeriod);

			Thread.sleep(1200);

			selectDropDownValue(selectingSpecificGradeFerrousCasting, EnterSpecificGradeValue, "visibleText");
			map.put("SelectedSpecificGrade", EnterSpecificGradeValue);
			LoggerUtil.pass("Specific Grade Selected → " + EnterSpecificGradeValue);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Numeric Inputs
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterCastWeightKgFerrousCasting), "11.5486");
			map.put("CastWeight", "11.5486");
			LoggerUtil.pass("Cast Weight Entered → 11.5486");

			clearAndEnterText(waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting), "2.7667");
			map.put("FinishWeight", "2.7667");
			LoggerUtil.pass("Finish Weight Entered → 2.7667");

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Fetch Calculated Values
			// ---------------------------------------------------------
			String scrapRealization = waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting)
					.getAttribute("value").trim();
			map.put("ScrapRealization", scrapRealization);
			LoggerUtil.pass("Scrap Realization → " + scrapRealization);

			String scrapCostPerKg = waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value")
					.trim();
			map.put("ScrapCostPerKg", scrapCostPerKg);
			LoggerUtil.pass("Scrap Cost Per Kg → " + scrapCostPerKg);

			String rmCostPerPc = waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim();
			map.put("RmCostPerPc", rmCostPerPc);
			LoggerUtil.pass("RM Cost Per Pc → " + rmCostPerPc);

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection (Customer)
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(clickingOhpDropdownFerrousCasting));
			Thread.sleep(1500);

			clickOnElement(clickingOhpDropdownFerrousCasting);
			Thread.sleep(1200);

			clearAndEnterText(waitForExpectedElement(EnterOhpVauleInSearchBoxForFerrousCasting), ohp);
			map.put("OHP", ohp);
			LoggerUtil.pass("OHP Entered → " + ohp);

			Thread.sleep(1200);

			for (WebElement ohpNorm : driver.findElements(ListValueOhpDropdownForFerrousCasting)) {
				if (ohpNorm.getText().trim().equals(ohp)) {
					ohpNorm.click();
					LoggerUtil.pass("OHP Selected from dropdown");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 6 → Enter Cost Values
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterRejectionValueFerrousCasting), "2.2123");
			map.put("RejectionValue", "2.2123");

			clearAndEnterText(waitForExpectedElement(EnterInsuranceFerrousCasting), "9.2123");
			map.put("Insurance", "9.2123");

			clearAndEnterText(waitForExpectedElement(EnterPackingcellFerrousCating), "19.2123");
			map.put("Packing", "19.2123");

			clearAndEnterText(waitForExpectedElement(EnterProfitValueForFerrousCasting), "22.2123");
			map.put("Profit", "22.2123");

			clearAndEnterText(waitForExpectedElement(EnterOverHeadValueForFerrousCasting), "32.2123");
			map.put("OverHead", "32.2123");

			clearAndEnterText(waitForExpectedElement(EnterIncoTermsForFerrousCasting), "333.2123");
			map.put("Incoterms", "333.2123");

			clearAndEnterText(waitForExpectedElement(EnterFrieghtKgFerrousCasting), "14.2123");
			map.put("Freight", "14.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor1FerrousCasting), "94.2123");
			map.put("Factor1", "94.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor2FerrousCasting), "29.2123");
			map.put("Factor2", "29.2123");

			clearAndEnterText(waitForExpectedElement(EnterOtherFactor3FerrousCasting), "144.2123");
			map.put("Factor3", "144.2123");

			clearAndEnterText(waitForExpectedElement(EnterRemarksValueForFerrousCasting), "51");
			map.put("Remarks", "51");

			LoggerUtil.pass("All cost values entered successfully");
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 7 → Tool Values
			// ---------------------------------------------------------
			clearAndEnterText(waitForExpectedElement(EnterToolCastValueFerrousCasting), "43.2123");
			map.put("ToolCost", "43.2123");

			clearAndEnterText(waitForExpectedElement(EnterAmortizationQuantityFerrousCasting), "00.2123");
			map.put("AmortizationQty", "00.2123");

			clearAndEnterText(waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting), "429.2123");
			map.put("ToolAmortization", "429.2123");

			clearAndEnterText(waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting), "109.2123");
			map.put("ToolMaintenance", "109.2123");

			LoggerUtil.pass("Tool inputs entered successfully");
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 8 → Final Calculated Values
			// ---------------------------------------------------------
			String partCostA = waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim();
			map.put("PartCostPerPcA", partCostA);

			String totalPartCostA = waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization)
					.getAttribute("value").trim();
			map.put("TotalPartCostPerPcAWithAmortization", totalPartCostA);

			Thread.sleep(1200);

			// ---------------------------------------------------------
			// STEP 9 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonFerrousCasting);
			LoggerUtil.pass("Clicked Save button");

			Thread.sleep(1500);

			try {
				WebElement toast = driver.findElement(toastMessage);
				if (toast.isDisplayed()) {
					String toastMsg = toast.getText().trim();
					map.put("ToastMessage", toastMsg);
					LoggerUtil.pass("Toast Message → " + toastMsg);
				}
			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed");
				map.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in Ferrous Casting Save → " + e.getMessage());
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: SAVE PRICE CALCULATION (FERROUS CASTING)");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return map;
	}

	public HashMap<String, String> updatePriceCalculationFerrousCasting() throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Update Price Calculation (Ferrous Casting)");
		LoggerUtil.info("==============================================");

		HashMap<String, String> updatedData = new HashMap<>();

		try {

			// Navigate
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					break;
				}
			}

			Thread.sleep(2000);

			// -------- UPDATE ONLY NUMERIC VALUES --------
			enterAndStore(updatedData, "CastWeight", EnterCastWeightKgFerrousCasting, "12.7486");

			enterAndStore(updatedData, "FinishWeight", EnterPartFinishWeightKgForFerrousCasting, "3.5667");

			Thread.sleep(1500);

			// Re-capture calculated values
			updatedData.put("ScrapRealization",
					waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value").trim());

			updatedData.put("ScrapCostPerKg",
					waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim());

			updatedData.put("RmCostPerPc",
					waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim());

			// Cost updates
			enterAndStore(updatedData, "RejectionValue", EnterRejectionValueFerrousCasting, "3.5123");
			enterAndStore(updatedData, "Insurance", EnterInsuranceFerrousCasting, "10.5123");
			enterAndStore(updatedData, "Packing", EnterPackingcellFerrousCating, "20.5123");
			enterAndStore(updatedData, "Profit", EnterProfitValueForFerrousCasting, "23.5123");
			enterAndStore(updatedData, "OverHead", EnterOverHeadValueForFerrousCasting, "33.5123");
			enterAndStore(updatedData, "Incoterms", EnterIncoTermsForFerrousCasting, "334.5123");
			enterAndStore(updatedData, "Freight", EnterFrieghtKgFerrousCasting, "15.5123");
			enterAndStore(updatedData, "Factor1", EnterOtherFactor1FerrousCasting, "95.5123");
			enterAndStore(updatedData, "Factor2", EnterOtherFactor2FerrousCasting, "30.5123");
			enterAndStore(updatedData, "Factor3", EnterOtherFactor3FerrousCasting, "145.5123");
			enterAndStore(updatedData, "Remarks", EnterRemarksValueForFerrousCasting, "update_51");

			// Tool values
			enterAndStore(updatedData, "ToolCost", EnterToolCastValueFerrousCasting, "44.5123");
			enterAndStore(updatedData, "AmortizationQty", EnterAmortizationQuantityFerrousCasting, "10.2123");
			enterAndStore(updatedData, "ToolAmortization", EnterToolAmortizationPerPcFerrousCasting, "430.5123");
			enterAndStore(updatedData, "ToolMaintenance", EnterToolMaintinanceCostFerrousCasting, "110.5123");

			// Final values
			updatedData.put("PartCostPerPcA",
					waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim());

			updatedData.put("TotalPartCostPerPcAWithAmortization",
					waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization).getAttribute("value").trim());

			// Save
			clickOnElement(ClickingSaveButtonFerrousCasting);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Ferrous Casting update → " + e.getMessage());
		}

		LoggerUtil.info("END: Update Price Calculation (Ferrous Casting)");
		return updatedData;
	}

	private void logOldVsNew(String fieldName, WebElement element, String newValue) {

		String oldValue = element.getAttribute("value").trim();

		LoggerUtil.info("----- Updating " + fieldName + " -----");
		LoggerUtil.info("OLD " + fieldName + " => " + oldValue);
		LoggerUtil.info("NEW " + fieldName + " => " + newValue);

		clearAndEnterText(element, newValue);
	}

	public HashMap<String, String> VeirfyUpdateDataPriceCalCulalationFerrousCasetingProcurmentSide(
			String rmInputCategory, String enterClassificationValue, String EnterYear, String EnterPeriod,
			String EnterSpecificGradeValue) throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE PRICE CALCULATION (FERROUS CASTING • PROCUREMENT SIDE) =====");

		HashMap<String, String> map = new HashMap<>();

		// ---------------- INPUT PARAMETERS ----------------
		LoggerUtil.info("STEP 0: Storing input parameters...");
		map.put("RmInputCategory", rmInputCategory);
		map.put("Classification", enterClassificationValue);
		map.put("Year", EnterYear);
		map.put("Period", EnterPeriod);
		map.put("SpecificGrade", EnterSpecificGradeValue);

		// ---------------- NAVIGATE TAB ----------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to Part Price Calculations tab.");
				break;
			}
		}

		Thread.sleep(4000);

		// ---------------- DROPDOWN SELECTIONS ----------------
		LoggerUtil.info("STEP 2: Selecting dropdown values...");

		Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
		rmInputSelect.selectByVisibleText(rmInputCategory);
		map.put("SelectedRmInputCategory", rmInputCategory);

		clickOnElement(ClickignRadioBtnnearByRmInputCategoryDropdown);

		selectDropDownValue(SelectingGroupClassificationFerrous, enterClassificationValue, "visibleText");
		map.put("SelectedClassification", enterClassificationValue);

		selectDropDownValue(selectingYearValueFromYearDropdownFerrousCasting, EnterYear, "visibleText");
		map.put("SelectedYear", EnterYear);

		selectDropDownValue(selectingRmPeriodFerrousCasting, EnterPeriod, "visibleText");
		map.put("SelectedPeriod", EnterPeriod);

		selectDropDownValue(selectingSpecificGradeFerrousCasting, EnterSpecificGradeValue, "visibleText");
		map.put("SelectedSpecificGrade", EnterSpecificGradeValue);

		// ---------------- NUMERIC INPUTS ----------------
		LoggerUtil.info("STEP 3: Updating numeric values...");

		logOldVsNew("CastWeight", waitForExpectedElement(EnterCastWeightKgFerrousCasting), "15.9874");
		map.put("CastWeight", "15.9874");

		logOldVsNew("FinishWeight", waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting), "4.7845");
		map.put("FinishWeight", "4.7845");

		// ---------------- FETCH CALCULATED VALUES ----------------
		LoggerUtil.info("STEP 4: Fetching system-calculated values...");

		String ScrapReal = waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value")
				.trim();
		map.put("ScrapRealization", ScrapReal);

		String ScrapCostKg = waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim();
		map.put("ScrapCostPerKg", ScrapCostKg);

		String RmCostPerPc = waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim();
		map.put("RmCostPerPc", RmCostPerPc);

		Thread.sleep(4000);

		// ---------------- OHP ----------------

		scrollIntoViewSmooth(waitForExpectedElement(By.id("ferrousOhp")));
		Thread.sleep(4000);
		waitClickable(clickingOhpDropdownFerrousCasting).click();
		Thread.sleep(2000);

		clearAndEnterText(waitClickable(EnterOhpVauleInSearchBoxForFerrousCasting), DataProp.getProperty("OHP"));
		map.put("OHP", DataProp.getProperty("OHP"));

		LoggerUtil.pass("OHP Entered → " + DataProp.getProperty("OHP"));

		for (WebElement ohpnorm : driver.findElements(ListValueOhpDropdownForFerrousCasting)) {
			if (ohpnorm.getText().trim().equals(DataProp.getProperty("OHP"))) {
				ohpnorm.click();
				LoggerUtil.pass("OHP Selected from dropdown");
				break;
			}
		}

		Thread.sleep(4000);

		// ---------------- OTHER COST VALUES ----------------
		LoggerUtil.info("STEP 6: Updating Other Cost Values...");

		logOldVsNew("RejectionValue", waitForExpectedElement(EnterRejectionValueFerrousCasting), "7.9834");
		map.put("RejectionValue", "7.9834");

		logOldVsNew("Insurance", waitForExpectedElement(EnterInsuranceFerrousCasting), "12.5567");
		map.put("Insurance", "12.5567");

		logOldVsNew("Packing", waitForExpectedElement(EnterPackingcellFerrousCating), "28.4456");
		map.put("Packing", "28.4456");

		logOldVsNew("Profit", waitForExpectedElement(EnterProfitValueForFerrousCasting), "34.1189");
		map.put("Profit", "34.1189");

		logOldVsNew("OverHead", waitForExpectedElement(EnterOverHeadValueForFerrousCasting), "42.9932");
		map.put("OverHead", "42.9932");

		logOldVsNew("Incoterms", waitForExpectedElement(EnterIncoTermsForFerrousCasting), "458.7621");
		map.put("Incoterms", "458.7621");

		logOldVsNew("Freight", waitForExpectedElement(EnterFrieghtKgFerrousCasting), "18.4456");
		map.put("Freight", "18.4456");

		logOldVsNew("Factor1", waitForExpectedElement(EnterOtherFactor1FerrousCasting), "78.9211");
		map.put("Factor1", "78.9211");

		logOldVsNew("Factor2", waitForExpectedElement(EnterOtherFactor2FerrousCasting), "56.1134");
		map.put("Factor2", "56.1134");

		logOldVsNew("Factor3", waitForExpectedElement(EnterOtherFactor3FerrousCasting), "124.8893");
		map.put("Factor3", "124.8893");

		logOldVsNew("Remarks", waitForExpectedElement(EnterRemarksValueForFerrousCasting), "UPDATED-01");
		map.put("Remarks", "UPDATED-01");

		// ---------------- TOOL VALUES ----------------
		LoggerUtil.info("STEP 7: Updating Tool Cost Values...");

		logOldVsNew("ToolCost", waitForExpectedElement(EnterToolCastValueFerrousCasting), "53.8766");
		map.put("ToolCost", "53.8766");

		logOldVsNew("AmortizationQty", waitForExpectedElement(EnterAmortizationQuantityFerrousCasting), "12.3345");
		map.put("AmortizationQty", "12.3345");

		logOldVsNew("ToolAmortization", waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting), "512.7894");
		map.put("ToolAmortization", "512.7894");

		logOldVsNew("ToolMaintenance", waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting), "145.3367");
		map.put("ToolMaintenance", "145.3367");

		// ---------------- FINAL CALCULATED VALUES ----------------
		LoggerUtil.info("STEP 8: Fetching final costing values...");

		String PartCostA = waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim();
		map.put("PartCostPerPcA", PartCostA);

		String TotalPartCostA = waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization)
				.getAttribute("value").trim();
		map.put("TotalPartCostPerPcAWithAmortization", TotalPartCostA);

		// ---------------- SAVE BUTTON ----------------
		LoggerUtil.info("STEP 9: Clicking Save button...");

		waitClickable(ClickingSaveButtonFerrousCasting).click();

		String Toastmsg = waitForExpectedElement(toastMessage).getText().trim();
		map.put("ToastMessage", Toastmsg);

		if (Toastmsg.equalsIgnoreCase("Ferrous casting saved successfully")) {
			LoggerUtil.pass("Toast VALID → " + Toastmsg);
		} else {
			LoggerUtil.error("Toast INVALID → Expected: Ferrous casting updated successfully | Actual: " + Toastmsg);
		}

		LoggerUtil.info("===== END: UPDATE PRICE CALCULATION (FERROUS CASTING PROCUREMENT) =====");

		return map;
	}

	public void VerifyThreeBarFunctionalityFerrousCasting(String RminputCategoryValue, String partNumber)
			throws InterruptedException {

		LoggerUtil.info("===== START: Verify Three-Bar Functionality (Ferrous Casting) =====");

		try {

			// Step 1: Navigate to the correct tab
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
					break;
				}
			}

			// Step 2: RM Input Category selection
			Select dropdownRminput = new Select(waitForExpectedElement(RmInputCategoryDropdownn));

			boolean isStandardShapesPresent = dropdownRminput.getOptions().stream()
					.anyMatch(opt -> opt.getText().trim().equalsIgnoreCase(RminputCategoryValue));

			if (isStandardShapesPresent) {
				dropdownRminput.selectByVisibleText(RminputCategoryValue);
				LoggerUtil.pass("Selected RM Input Category → " + RminputCategoryValue);
			} else {
				LoggerUtil.error("RM Input Category NOT FOUND → " + RminputCategoryValue);
			}

			clickOnElement(ClickignRadioBtnnearByRmInputCategoryDropdown);
			LoggerUtil.info("User Clicked Direct Radio Button");

			Thread.sleep(3000);

			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(2000);

			// Step 3: Load Three-bar options
			List<WebElement> ThreeBarOptions = driver.findElements(SelectingOptionsThreeBars);

			if (ThreeBarOptions == null || ThreeBarOptions.isEmpty()) {
				LoggerUtil.error("Three-bar options list is NULL or EMPTY. Cannot proceed.");
			} else {
				LoggerUtil.info("Three-bar list loaded successfully. Total Options: " + ThreeBarOptions.size());
			}

			// Step 4: EXPORT WHOLE REPORT
			boolean exportReportClicked = false;

			for (WebElement ThreeBarLink : ThreeBarOptions) {
				String BarLinkText = ThreeBarLink.getText().trim();

				if (BarLinkText.equals("Export Whole Report")) {
					ThreeBarLink.click();
					LoggerUtil.pass("Clicked → Export Whole Report");
					exportReportClicked = true;
					break;
				}
			}

			if (!exportReportClicked) {
				LoggerUtil.error("'Export Whole Report' NOT FOUND under Three-Bar menu.");
			}

			Thread.sleep(5000);

			getLatestCustomExcelFileForging();

			Thread.sleep(3000);
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);

			Thread.sleep(3000);

			// Step 5: CONSOLIDATED ASSEMBLY EXPORT
			boolean consolidatedClicked = false;

			for (WebElement ThreeBarLink : ThreeBarOptions) {
				String BarLinkText = ThreeBarLink.getText().trim();

				if (BarLinkText.equals("Consolidated Assembly")) {
					ThreeBarLink.click();
					LoggerUtil.pass("Clicked → Consolidated Assembly");
					consolidatedClicked = true;
					break;
				}
			}

			if (!consolidatedClicked) {
				LoggerUtil.error("'Consolidated Assembly' NOT FOUND under Three-Bar menu.");
			}

			Thread.sleep(2000);

			String actualToast = waitForExpectedElement(FetchingToastmsgForDetailCosting).getText().trim();
			String expectedToast = "Consolidated Assembly Exported SucessFully.";

			if (actualToast.equalsIgnoreCase(expectedToast)) {
				LoggerUtil.pass("Toast validation PASSED → " + actualToast);
			} else {
				LoggerUtil.error("Toast mismatch → Expected: " + expectedToast + " | Actual: " + actualToast);
			}

			// Step 6: EXPORT AS PDF
			clickOnElement(ClickingThreeBarsButtonforDetailsCosting);
			Thread.sleep(2000);

			boolean exportPdfClicked = false;

			for (WebElement ThreeBarLink : ThreeBarOptions) {
				String BarLinkText = ThreeBarLink.getText().trim();

				if (BarLinkText.equals("Export as PDF")) {
					ThreeBarLink.click();
					LoggerUtil.pass("Clicked → Export as PDF");
					exportPdfClicked = true;
					break;
				}
			}

			if (!exportPdfClicked) {
				LoggerUtil.error("'Export as PDF' NOT FOUND under Three-Bar menu.");
			}

			Thread.sleep(2000);

			String actualPdfToast = waitForExpectedElement(FetchingToastmsgForDetailCosting).getText().trim();
			String expectedPdfToast = "PDF file Exported SucessFully.";

			if (actualPdfToast.equalsIgnoreCase(expectedPdfToast)) {
				LoggerUtil.pass("PDF Toast validation PASSED → " + actualPdfToast);
			} else {
				LoggerUtil.error("PDF Toast mismatch → Expected: " + expectedPdfToast + " | Actual: " + actualPdfToast);
			}

		} catch (Exception e) {
			LoggerUtil.error("Exception in VerifyThreeBarFunctionalityFerrousCasting → " + e.getMessage());
		}

		LoggerUtil.info("===== END: Verify Three-Bar Functionality (Ferrous Casting) =====");
	}

	public Map<String, String> verifyFetchDataAndWriteInPartAttributesCustomerSideForUpdate(String CommodityGroupName)
			throws InterruptedException {

		LoggerUtil.info("===== START: Updating Part Attributes (Existing Data Will Be Replaced) =====");

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		Map<String, String> storedData = new HashMap<>();

		try {

			// =============================
			// STEP 0: Ensure Part Attributes Tab is Active (UPDATED)
			// =============================
			LoggerUtil.info("Checking if 'Part Attributes' tab is active...");
			ensurePartAttributesTabLoaded(headingLocator);

			// =============================
			// STEP 1: Fetch Existing Commodity Group
			// =============================
			LoggerUtil.info("Fetching existing Commodity Group value from dropdown...");

			String existingCommodityGroup = waitForExpectedElement(SelectingCommodityGroupDropdown).getText().trim();
			storedData.put("CommodityGroup", existingCommodityGroup);

			LoggerUtil.pass("✔ Existing Commodity Group captured: " + existingCommodityGroup);

			// =============================
			// STEP 2: Enter New Values (Updating Existing Data)
			// =============================
			LoggerUtil.info("Entering updated values into Part Attributes fields...");

			// Annual Requirement
			String AnnualRequirementProduct = "2";
			clearAndEnterText(waitForExpectedElement(EnterAnnualRequirnmentOfProduct), AnnualRequirementProduct);
			storedData.put("AnnualRequirement", AnnualRequirementProduct);
			LoggerUtil.pass("✔ Updated Annual Requirement: " + AnnualRequirementProduct);

			// Average Monthly Requirement
			String AverageRequirementProduct = "12";
			clearAndEnterText(waitForExpectedElement(EnterAverageMonthlyRequirnmentOfproduct),
					AverageRequirementProduct);
			storedData.put("AverageRequirement", AverageRequirementProduct);
			LoggerUtil.pass("✔ Updated Average Monthly Requirement: " + AverageRequirementProduct);

			// Lot Size
			String LotSize = "43.33";
			clearAndEnterText(waitForExpectedElement(EnterLotSize), LotSize);
			storedData.put("LotSize", LotSize);
			LoggerUtil.pass("✔ Updated Lot Size: " + LotSize);

			LoggerUtil.pass("✔ All updated values entered successfully in Part Attributes.");

			// =============================
			// STEP 3: SAVE
			// =============================
			LoggerUtil.info("Attempting to save updated Part Attributes...");

			clickOnElement(ClickingSaveButtonPartMaster);

			String toastText = waitForExpectedElement(toastMessage).getText().trim();
			storedData.put("ToastMessage", toastText);

			if (toastText.equals("Part attribute details saved successfully.")) {
				LoggerUtil.pass("✔ Save successful: " + toastText);
			} else {
				LoggerUtil.error("❌ Unexpected toast message: " + toastText);
			}

			Thread.sleep(3000);

		} catch (Exception e) {

			LoggerUtil.error("❌ Error occurred while updating Part Attributes → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Part Attributes Update Process Completed =====");

		return storedData;
	}

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationFerrousCastingCustomerSideForUpdate(
			String rmInputCategory, String enterClassificationValue, String EnterYear, String EnterPeriod,
			String EnterSpecificGradeValue) throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE PRICE CALCULATION (FERROUS CASTING • Sales SIDE) =====");

		HashMap<String, String> map = new HashMap<>();
		JavascriptExecutor js = (JavascriptExecutor) driver;

		// -------------------------------------------------------------------------
		// HELPER FUNCTIONS (Inside method → ALLOWED)
		// -------------------------------------------------------------------------

		// TEXTBOX UPDATE CHECK
		BiConsumer<String, By> updateCheckTextbox = (newValue, locator) -> {
			WebElement field = waitForExpectedElement(locator);
			String oldValue = field.getAttribute("value").trim();

			clearAndEnterText(field, newValue);

			if (!oldValue.equals(newValue)) {
				LoggerUtil.pass("UPDATED: " + locator.toString() + " | Old = " + oldValue + " | New = " + newValue);
			} else {
				LoggerUtil.info("NOT UPDATED: " + locator.toString() + " | Value reused = " + newValue);
			}
		};

		// DROPDOWN UPDATE CHECK
		TriConsumer<String, By, String> updateCheckDropdown = (newValue, locator, fieldName) -> {
			WebElement dropdownElement = waitForExpectedElement(locator);
			Select dd = new Select(dropdownElement);

			String oldValue = dd.getFirstSelectedOption().getText().trim();

			if (!oldValue.equals(newValue)) {
				LoggerUtil.pass("UPDATED: " + fieldName + " | Old = " + oldValue + " | New = " + newValue);
			} else {
				LoggerUtil.info("NOT UPDATED: " + fieldName + " | Value reused = " + newValue);
			}

			dd.selectByVisibleText(newValue);
		};

		try {

			// -------------------------------------------------------------------------
			// 0. STORE INPUT PARAMETERS
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 0: Storing input parameters...");
			map.put("RmInputCategory", rmInputCategory);
			map.put("Classification", enterClassificationValue);
			map.put("SelectedYear", EnterYear);
			map.put("SelectedPeriod", EnterPeriod);

			map.put("SpecificGrade", EnterSpecificGradeValue);

			// -------------------------------------------------------------------------
			// 1. NAVIGATE TAB
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 1: Navigating to 'Part Price Calculations' tab...");
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to Part Price Calculations tab.");
					break;
				}
			}
			Thread.sleep(4000);

			// -------------------------------------------------------------------------
			// 2. DROPDOWN UPDATE CHECK
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 2: Checking dropdown updates...");

			updateCheckDropdown.accept(rmInputCategory, RmInputCategoryDropdownn, "RM Input Category");

			clickOnElement(ClickignRadioBtnnearByRmInputCategoryDropdown);
			LoggerUtil.pass("Direct Radio Button Clicked");

			updateCheckDropdown.accept(enterClassificationValue, SelectingGroupClassificationFerrous, "Classification");

			updateCheckDropdown.accept(EnterYear, selectingYearValueFromYearDropdownFerrousCasting, "Year");

			updateCheckDropdown.accept(EnterPeriod, selectingRmPeriodFerrousCasting, "Period");

			updateCheckDropdown.accept(EnterSpecificGradeValue, selectingSpecificGradeFerrousCasting, "Specific Grade");

			// -------------------------------------------------------------------------
			// 3. NUMERIC TEXTBOX UPDATE CHECK
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 3: Updating numeric fields...");

			updateCheckTextbox.accept("11.5486", EnterCastWeightKgFerrousCasting);
			map.put("CastWeight", "11.5486");

			updateCheckTextbox.accept("2.7667", EnterPartFinishWeightKgForFerrousCasting);
			map.put("FinishWeight", "2.7667");

			// -------------------------------------------------------------------------
			// 4. FETCH AUTO-CALCULATED VALUES (NO UPDATE)
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 4: Fetching auto-calculated values (no updates)...");

			String scrapReal = waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value")
					.trim();
			map.put("ScrapRealization", scrapReal);

			String scrapCost = waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim();
			map.put("ScrapCostPerKg", scrapCost);

			String rmCostPc = waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim();
			map.put("RmCostPerPc", rmCostPc);

			// -------------------------------------------------------------------------
			// 5. OHP UPDATE CHECK
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 5: Updating OHP...");

			scrollIntoViewSmooth(waitForExpectedElement(By.id("ferrousOhp")));
			Thread.sleep(1500);

			waitClickable(clickingOhpDropdownFerrousCasting).click();
			Thread.sleep(1200);

			updateCheckTextbox.accept(DataProp.getProperty("OHPCustomerSide"),
					EnterOhpVauleInSearchBoxForFerrousCasting);
			map.put("OHP", DataProp.getProperty("OHPCustomerSide"));

			for (WebElement ohp : driver.findElements(ListValueOhpDropdownForFerrousCasting)) {
				if (ohp.getText().trim().equals(DataProp.getProperty("OHPCustomerSide"))) {
					ohp.click();
					break;
				}
			}

			// -------------------------------------------------------------------------
			// 6. OTHER COST INPUT FIELDS UPDATE CHECK
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 6: Updating other cost fields...");

			updateCheckTextbox.accept("2.2123", EnterRejectionValueFerrousCasting);
			map.put("RejectionValue", "2.2123");

			updateCheckTextbox.accept("9.2123", EnterInsuranceFerrousCasting);
			map.put("Insurance", "9.2123");

			updateCheckTextbox.accept("19.2123", EnterPackingcellFerrousCating);
			map.put("Packing", "19.2123");

			updateCheckTextbox.accept("22.2123", EnterProfitValueForFerrousCasting);
			map.put("Profit", "22.2123");

			updateCheckTextbox.accept("32.2123", EnterOverHeadValueForFerrousCasting);
			map.put("OverHead", "32.2123");

			updateCheckTextbox.accept("333.2123", EnterIncoTermsForFerrousCasting);
			map.put("Incoterms", "333.2123");

			updateCheckTextbox.accept("14.2123", EnterFrieghtKgFerrousCasting);
			map.put("Freight", "14.2123");

			updateCheckTextbox.accept("94.2123", EnterOtherFactor1FerrousCasting);
			map.put("Factor1", "94.2123");

			updateCheckTextbox.accept("29.2123", EnterOtherFactor2FerrousCasting);
			map.put("Factor2", "29.2123");

			updateCheckTextbox.accept("144.2123", EnterOtherFactor3FerrousCasting);
			map.put("Factor3", "144.2123");

			updateCheckTextbox.accept("51", EnterRemarksValueForFerrousCasting);
			map.put("Remarks", "51");

			// -------------------------------------------------------------------------
			// 7. TOOL COST UPDATE CHECK
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 7: Updating tool-cost fields...");

			updateCheckTextbox.accept("43.2123", EnterToolCastValueFerrousCasting);
			map.put("ToolCost", "43.2123");

			updateCheckTextbox.accept("00.2123", EnterAmortizationQuantityFerrousCasting);
			map.put("AmortizationQty", "00.2123");

			updateCheckTextbox.accept("429.2123", EnterToolAmortizationPerPcFerrousCasting);
			map.put("ToolAmortization", "429.2123");

			updateCheckTextbox.accept("109.2123", EnterToolMaintinanceCostFerrousCasting);
			map.put("ToolMaintenance", "109.2123");

			// -------------------------------------------------------------------------
			// 8. FETCH FINAL CALCULATED VALUES
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 8: Fetching final auto-calculated values...");

			String partCostA = waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim();
			map.put("PartCostPerPcA", partCostA);

			String totalA = waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization).getAttribute("value")
					.trim();
			map.put("TotalPartCostPerPcAWithAmortization", totalA);

			// -------------------------------------------------------------------------
			// 9. SAVE OPERATION
			// -------------------------------------------------------------------------
			LoggerUtil.info("STEP 9: Clicking Save button...");

			waitClickable(ClickingSaveButtonFerrousCasting).click();

			String toast = waitForExpectedElement(toastMessage).getText().trim();
			map.put("ToastMessage", toast);

			if (toast.equalsIgnoreCase("Ferrous casting saved successfully")) {
				LoggerUtil.pass("Toast VALID → " + toast);
			} else {
				LoggerUtil.error("Toast INVALID → Expected: Ferrous casting saved successfully | Actual: " + toast);
			}

			LoggerUtil.info("===== END: UPDATE PRICE CALCULATION (FERROUS CASTING • Sales SIDE) =====");

		} catch (Exception e) {
			LoggerUtil.error("❌ UPDATE METHOD FAILED → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		return map;
	}

	public HashMap<String, String> EnterToolingCostForUpdating(String partNumber) {

		LoggerUtil.info("===== START: Updating Tooling Cost For Part: " + partNumber + " =====");

		JavascriptExecutor js = (JavascriptExecutor) driver;
		Actions actions = new Actions(driver);

		HashMap<String, String> toolingData = new HashMap<>();

		try {
			Thread.sleep(1500);

			// ====================================================
			// 1) Navigate to Tooling Cost Tab
			// ====================================================
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Tooling Cost")) {
					actions.moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to Tooling Cost tab.");
					break;
				}
			}
			Thread.sleep(2000);

			// ---------------------------------------------------------
			// Helper: Compare OLD vs NEW before entering
			// ---------------------------------------------------------
			BiConsumer<By, String> updateCheckTextbox = (locator, newVal) -> {
				WebElement field = waitForExpectedElement(locator);
				String oldVal = field.getAttribute("value").trim();

				clearAndEnterText(field, newVal);

				if (!oldVal.equals(newVal)) {
					LoggerUtil.pass("UPDATED → " + locator.toString() + " | Old: " + oldVal + " | New: " + newVal);
				} else {
					LoggerUtil.info("NOT UPDATED → " + locator.toString() + " | Value reused: " + newVal);
				}
			};

			TriConsumer<String, By, String> updateCheckDropdown = (newValue, locator, label) -> {
				WebElement dropdown = waitForExpectedElement(locator);
				Select dd = new Select(dropdown);

				String oldValue = dd.getFirstSelectedOption().getText().trim();
				dd.selectByVisibleText(newValue);

				if (!oldValue.equals(newValue)) {
					LoggerUtil.pass("UPDATED Dropdown [" + label + "] → Old: " + oldValue + " | New: " + newValue);
				} else {
					LoggerUtil.info("NOT UPDATED Dropdown [" + label + "] → Value reused: " + newValue);
				}
			};

			// ====================================================
			// 2) Dropdown update check — Tool Number
			// ====================================================
			updateCheckDropdown.accept("Manual Entry", By.id("ToolPartNodrp"), "Tool Number");
			toolingData.put("ToolPartNodrp", "Manual Entry");
			Thread.sleep(500);

			// Collapse dropdown
			WebElement safeField = driver.findElement(By.id("ToolDesc"));
			js.executeScript("arguments[0].click();", safeField);
			Thread.sleep(500);

			// Reset horizontal scroll
			js.executeScript("document.getElementById('divToolingCost').scrollLeft = 0;");
			Thread.sleep(250);

			// ====================================================
			// 3) Envelope Dimensions (OLD vs NEW check)
			// ====================================================

			updateCheckTextbox.accept(By.id("PartEnvelopeLength"), "25");
			toolingData.put("PartEnvelopeLength", "25");

			updateCheckTextbox.accept(By.id("PartEnvelopeWidth"), "10");
			toolingData.put("PartEnvelopeWidth", "10");

			updateCheckTextbox.accept(By.id("PartEnvelopeHeight"), "50");
			toolingData.put("PartEnvelopeHeight", "50");

			// ====================================================
			// 4) Yearly Volumes (OLD vs NEW check)
			// ====================================================
			updateCheckTextbox.accept(By.id("FirstYrVolume"), "2");
			toolingData.put("FirstYrVolume", "2");

			updateCheckTextbox.accept(By.id("SecondYrVolume"), "18");
			toolingData.put("SecondYrVolume", "18");

			updateCheckTextbox.accept(By.id("ThirdYrVolume"), "15");
			toolingData.put("ThirdYrVolume", "15");

			updateCheckTextbox.accept(By.id("FourthYrVolume"), "12");
			toolingData.put("FourthYrVolume", "12");

			updateCheckTextbox.accept(By.id("FifthYrVolume"), "1");
			toolingData.put("FifthYrVolume", "1");

			// ====================================================
			// 5) Tool Life (OLD vs NEW check)
			// ====================================================
			updateCheckTextbox.accept(By.id("Toollife"), "tool-101");
			toolingData.put("Toollife", "tool-101");

			LoggerUtil.pass("✔ All tooling cost fields processed with update-check.");

			// ====================================================
			// 6) SAVE & VALIDATE TOAST
			// ====================================================
			try {
				LoggerUtil.info("Clicking Save button...");

				WebElement saveBtn = waitForExpectedElement(By.id("btnSaveToolingCost"));
				js.executeScript("arguments[0].scrollIntoView(true);", saveBtn);
				saveBtn.click();
				LoggerUtil.pass("Clicked Save successfully.");

				WebElement toast = waitForExpectedElement(By.xpath("//div[contains(@class,'toast-message')]"));
				String toastMsg = toast.getText().trim();
				LoggerUtil.pass("Toast Message Displayed → " + toastMsg);

			} catch (Exception e) {
				LoggerUtil.error("❌ Error during save → " + e.getMessage());
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ EnterToolingCostForUpdating Failed → " + e.getMessage());
		}

		storedToolingCostData = new HashMap<>(toolingData);
		return toolingData;
	}

	public void ValidatePartAttributeDataSucessFullyUpdatedOrNot(Map<String, String> storedData) {

		LoggerUtil.info("===== START: Validating Updated Part Attribute Data =====");

		try {

			By headingLocator = By
					.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

			// ===================================================
			// 1) Reload Part Attributes Tab (UPDATED)
			// ===================================================
			ensurePartAttributesTabLoaded(headingLocator);
			Thread.sleep(1200);

			// ===================================================
			// 2) Fetch UI Values Again (NO CHANGE)
			// ===================================================
			String uiCommodityGroup = waitForExpectedElement(SelectingCommodityGroupDropdown).getText().trim();
			String uiAnnualReq = waitForExpectedElement(EnterAnnualRequirnmentOfProduct).getAttribute("value").trim();
			String uiAvgReq = waitForExpectedElement(EnterAverageMonthlyRequirnmentOfproduct).getAttribute("value")
					.trim();
			String uiLotSize = waitForExpectedElement(EnterLotSize).getAttribute("value").trim();

			// ===================================================
			// 3) Compare UI vs Stored Values (NO CHANGE)
			// ===================================================
			compareValues("Commodity Group", storedData.get("CommodityGroup"), uiCommodityGroup);
			compareValues("Annual Requirement", storedData.get("AnnualRequirement"), uiAnnualReq);
			compareValues("Average Monthly Requirement", storedData.get("AverageRequirement"), uiAvgReq);
			compareValues("Lot Size", storedData.get("LotSize"), uiLotSize);

			LoggerUtil.pass("✔ All Part Attribute values validated successfully.");

		} catch (Exception e) {
			LoggerUtil.error("❌ Error validating part attributes → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Validation Completed =====");
	}

	public void verifyPriceCalculationDataHasBeenSaveOrNotFerrousCastingForSales(HashMap<String, String> map)
			throws InterruptedException {

		// Navigate to tab
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab.");
				break;
			}
		}

		LoggerUtil.info("=============== START VALIDATION (FERROUS CASTING Customer) ================");

		// *** VALIDATE START IN SAME SEQUENCE AS ENTERED ***

		// 1. Rm Input Category
		validateField("RmInputCategory", map.get("RmInputCategory"),
				waitForExpectedElement(FetchingRmInputCategoryDataFerrousCasting).getText());

		validateField("Classification", map.get("Classification"),
				waitForExpectedElement(fetchingGroupClassificationDataFerrousCasting).getText().trim());

		// 3. Year
		validateField("Year", map.get("SelectedYear"),
				new Select(waitForExpectedElement(By.id("Year1"))).getFirstSelectedOption().getText().trim());

		// 4. Period
		validateField("Period", map.get("SelectedPeriod"),
				new Select(waitForExpectedElement(selectingRmPeriodFerrousCasting)).getFirstSelectedOption().getText()
						.trim());

		validateField("SpecificGrade", map.get("SpecificGrade"),
				new Select(waitForExpectedElement(selectingSpecificGradeFerrousCasting)).getFirstSelectedOption()
						.getText());
		// 6. Cast Weight
		validateField("CastWeight", map.get("CastWeight"),
				waitForExpectedElement(EnterCastWeightKgFerrousCasting).getAttribute("value").trim());

		// 7. Finish Weight
		validateField("FinishWeight", map.get("FinishWeight"),
				waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting).getAttribute("value").trim());

		// 8. Scrap Realization
		validateField("ScrapRealization", map.get("ScrapRealization"),
				waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value").trim());

		// 9. Scrap Cost/Kg
		validateField("ScrapCostPerKg", map.get("ScrapCostPerKg"),
				waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim());

		// 10. RM Cost/PC
		validateField("RmCostPerPc", map.get("RmCostPerPc"),
				waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim());

		// ------------------ 11. Corrected OHP Validation ------------------
		LoggerUtil.info("Validating OHP Selected Value...");

		String actualOHP = waitForExpectedElement(By.xpath(
				"//select[@id='ferrousOhp']/following-sibling::span/descendant::span[@id='select2-ferrousOhp-container']"))
				.getText().trim();

		String expectedOHP = map.get("OHP");

		// correct order → expected, actual
		validateField("OHP", expectedOHP, actualOHP);
		// -------------------------------------------------------------------

		// 12. Rejection Value
		validateField("RejectionValue", map.get("RejectionValue"),
				waitForExpectedElement(EnterRejectionValueFerrousCasting).getAttribute("value").trim());

		// 13. Insurance
		validateField("Insurance", map.get("Insurance"),
				waitForExpectedElement(EnterInsuranceFerrousCasting).getAttribute("value").trim());

		// 14. Packing
		validateField("Packing", map.get("Packing"),
				waitForExpectedElement(EnterPackingcellFerrousCating).getAttribute("value").trim());

		// 15. Profit
		validateField("Profit", map.get("Profit"),
				waitForExpectedElement(EnterProfitValueForFerrousCasting).getAttribute("value").trim());

		// 16. OverHead
		validateField("OverHead", map.get("OverHead"),
				waitForExpectedElement(EnterOverHeadValueForFerrousCasting).getAttribute("value").trim());

		// 17. Incoterms
		validateField("Incoterms", map.get("Incoterms"),
				waitForExpectedElement(EnterIncoTermsForFerrousCasting).getAttribute("value").trim());

		// 18. Freight
		validateField("Freight", map.get("Freight"),
				waitForExpectedElement(EnterFrieghtKgFerrousCasting).getAttribute("value").trim());

		// 19. Factor 1
		validateField("Factor1", map.get("Factor1"),
				waitForExpectedElement(EnterOtherFactor1FerrousCasting).getAttribute("value").trim());

		// 20. Factor 2
		validateField("Factor2", map.get("Factor2"),
				waitForExpectedElement(EnterOtherFactor2FerrousCasting).getAttribute("value").trim());

		// 21. Factor 3
		validateField("Factor3", map.get("Factor3"),
				waitForExpectedElement(EnterOtherFactor3FerrousCasting).getAttribute("value").trim());

		// 22. Remarks
		validateField("Remarks", map.get("Remarks"),
				waitForExpectedElement(EnterRemarksValueForFerrousCasting).getAttribute("value").trim());

		// 23. Tool Cost
		validateField("ToolCost", map.get("ToolCost"),
				waitForExpectedElement(EnterToolCastValueFerrousCasting).getAttribute("value").trim());

		// 24. Amortization Quantity
		validateField("AmortizationQty", map.get("AmortizationQty"),
				waitForExpectedElement(EnterAmortizationQuantityFerrousCasting).getAttribute("value").trim());

		// 25. Tool Amortization / Pc
		validateField("ToolAmortization", map.get("ToolAmortization"),
				waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting).getAttribute("value").trim());

		// 26. Tool Maintenance
		validateField("ToolMaintenance", map.get("ToolMaintenance"),
				waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting).getAttribute("value").trim());

		// 27. Part Cost Per Pc A (Calculated)
		validateField("PartCostPerPcA", map.get("PartCostPerPcA"),
				waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim());

		// 28. Part Cost With Amortization
		validateField("TotalPartCostPerPcAWithAmortization", map.get("TotalPartCostPerPcAWithAmortization"),
				waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization).getAttribute("value").trim());

		LoggerUtil.info("=============== END OF VALIDATION ================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

	}

	public void validateToolingCostUpdatedValues(HashMap<String, String> expectedData) {

		LoggerUtil.info("===== START: Validating Updated Tooling Cost Data =====");

		try {
			JavascriptExecutor js = (JavascriptExecutor) driver;

			// Ensure Tooling Tab is active
			navigateToTab("Tooling Cost");
			Thread.sleep(1500);

			// Reset horizontal scroll
			js.executeScript("document.getElementById('divToolingCost').scrollLeft = 0;");
			Thread.sleep(300);

			// =======================
			// Fetch ACTUAL UI VALUES
			// =======================
			HashMap<String, String> actualData = new HashMap<>();

			// ---- Tool Number (Dropdown visible text)
			WebElement toolNoDropdown = waitForExpectedElement(By.id("ToolPartNodrp"));
			Select selectTool = new Select(toolNoDropdown);
			String toolSelectedText = selectTool.getFirstSelectedOption().getText().trim();
			actualData.put("ToolPartNodrp", toolSelectedText);

			// ---- Envelope Fields
			actualData.put("PartEnvelopeLength",
					waitForExpectedElement(By.id("PartEnvelopeLength")).getAttribute("value").trim());

			actualData.put("PartEnvelopeWidth",
					waitForExpectedElement(By.id("PartEnvelopeWidth")).getAttribute("value").trim());

			actualData.put("PartEnvelopeHeight",
					waitForExpectedElement(By.id("PartEnvelopeHeight")).getAttribute("value").trim());

			// ---- Yearly Volume Fields
			actualData.put("FirstYrVolume",
					waitForExpectedElement(By.id("FirstYrVolume")).getAttribute("value").trim());

			actualData.put("SecondYrVolume",
					waitForExpectedElement(By.id("SecondYrVolume")).getAttribute("value").trim());

			actualData.put("ThirdYrVolume",
					waitForExpectedElement(By.id("ThirdYrVolume")).getAttribute("value").trim());

			actualData.put("FourthYrVolume",
					waitForExpectedElement(By.id("FourthYrVolume")).getAttribute("value").trim());

			actualData.put("FifthYrVolume",
					waitForExpectedElement(By.id("FifthYrVolume")).getAttribute("value").trim());

			// ---- Tool Life
			actualData.put("Toollife", waitForExpectedElement(By.id("Toollife")).getAttribute("value").trim());

			// =======================
			// COMPARE EXPECTED vs ACTUAL
			// =======================
			for (String key : expectedData.keySet()) {

				String expectedValue = expectedData.get(key);
				String actualValue = actualData.get(key);

				if (actualValue == null) {
					LoggerUtil.error("FAIL: [" + key + "] → UI element not found!");
					continue;
				}

				if (expectedValue.equals(actualValue)) {
					LoggerUtil.pass("PASS: [" + key + "] Expected = " + expectedValue + " | Actual = " + actualValue);
				} else {
					LoggerUtil.error("FAIL: [" + key + "] Expected = " + expectedValue + " | Actual = " + actualValue);
				}
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Validation Error → " + e.getMessage());
			LoggerUtil.logException(e);
		}

		LoggerUtil.info("===== END: Tooling Cost Validation =====");
	}

	public void validateCopiedPartAttributes(Map<String, String> sourceMap) throws InterruptedException {

		LoggerUtil.info("===== VALIDATING COPIED PART ATTRIBUTES =====");

		By headingLocator = By
				.xpath("//div[@id='partAttributeDiv']//span[contains(normalize-space(text()),'Part Attributes')]");

		// =======================================================
		// STEP 0: Ensure Tab Active (UPDATED WITH NEW METHOD)
		// =======================================================
		ensurePartAttributesTabLoaded(headingLocator);

		// =======================================================
		// STEP 1: Validate Commodity Group
		// =======================================================
		String actualGroup = waitForExpectedElement(SelectingCommodityGroupDropdown).getText().trim();
		validateField("CommodityGroup", sourceMap.get("CommodityGroup"), actualGroup);

		// =======================================================
		// STEP 2: Annual Requirement
		// =======================================================
		String actualAnnual = waitForExpectedElement(EnterAnnualRequirnmentOfProduct).getAttribute("value").trim();
		validateField("AnnualRequirement", sourceMap.get("AnnualRequirement"), actualAnnual);

		// =======================================================
		// STEP 3: Average Monthly Requirement
		// =======================================================
		String actualAvg = waitForExpectedElement(EnterAverageMonthlyRequirnmentOfproduct).getAttribute("value").trim();
		validateField("AverageRequirement", sourceMap.get("AverageRequirement"), actualAvg);

		// =======================================================
		// STEP 4: Lot Size
		// =======================================================
		String actualLot = waitForExpectedElement(EnterLotSize).getAttribute("value").trim();
		validateField("LotSize", sourceMap.get("LotSize"), actualLot);

		LoggerUtil.info("===== PART ATTRIBUTES VALIDATION COMPLETE =====");
	}

	public void validateCopiedFerrousCasting(HashMap<String, String> sourceMap) {

		LoggerUtil.info("===== VALIDATING COPIED FERROUS CASTING VALUES =====");

		navigateToTab("Part Price Calculations");
		waitForExpectedElement(selectingYearValueFromYearDropdownFerrousCasting);

		// Dropdown fields
		validateField("RmInputCategory", sourceMap.get("SelectedRmInputCategory"),
				waitForExpectedElement(FetchingRmInputCategoryDataFerrousCasting).getText().trim());

		validateField("Classification", sourceMap.get("SelectedClassification"),
				waitForExpectedElement(fetchingGroupClassificationDataFerrousCasting).getText().trim());

		validateField("Year", sourceMap.get("SelectedYear"),
				new Select(waitForExpectedElement(By.id("Year1"))).getFirstSelectedOption().getText().trim());

		validateField("Period", sourceMap.get("SelectedPeriod"),
				new Select(waitForExpectedElement(selectingRmPeriodFerrousCasting)).getFirstSelectedOption().getText()
						.trim());

		validateField("SpecificGrade", sourceMap.get("SelectedSpecificGrade"),
				new Select(waitForExpectedElement(selectingSpecificGradeFerrousCasting)).getFirstSelectedOption()
						.getText());

		// Numeric fields
		validateField("CastWeight", sourceMap.get("CastWeight"),
				waitForExpectedElement(EnterCastWeightKgFerrousCasting).getAttribute("value").trim());

		validateField("FinishWeight", sourceMap.get("FinishWeight"),
				waitForExpectedElement(EnterPartFinishWeightKgForFerrousCasting).getAttribute("value").trim());

		// Calculated fields
		validateField("ScrapRealization", sourceMap.get("ScrapRealization"),
				waitForExpectedElement(FetchingScrapRealizationDataFerrousCasting).getAttribute("value").trim());

		validateField("ScrapCostPerKg", sourceMap.get("ScrapCostPerKg"),
				waitForExpectedElement(FetchingScrapCostKgFerrousCasting).getAttribute("value").trim());

		validateField("RmCostPerPc", sourceMap.get("RmCostPerPc"),
				waitForExpectedElement(fetchingRmCostPerPcFerrousCasting).getAttribute("value").trim());

		// OHP (Select2)
		String uiOHP = waitForExpectedElement(By.xpath(
				"//select[@id='ferrousOhp']/following-sibling::span/descendant::span[@id='select2-ferrousOhp-container']"))
				.getText().trim();
		validateField("OHP", sourceMap.get("OHP"), uiOHP);

		// Other fields
		validateField("RejectionValue", sourceMap.get("RejectionValue"),
				waitForExpectedElement(EnterRejectionValueFerrousCasting).getAttribute("value").trim());

		validateField("Insurance", sourceMap.get("Insurance"),
				waitForExpectedElement(EnterInsuranceFerrousCasting).getAttribute("value").trim());

		validateField("Packing", sourceMap.get("Packing"),
				waitForExpectedElement(EnterPackingcellFerrousCating).getAttribute("value").trim());

		validateField("Profit", sourceMap.get("Profit"),
				waitForExpectedElement(EnterProfitValueForFerrousCasting).getAttribute("value").trim());

		validateField("OverHead", sourceMap.get("OverHead"),
				waitForExpectedElement(EnterOverHeadValueForFerrousCasting).getAttribute("value").trim());

		validateField("Incoterms", sourceMap.get("Incoterms"),
				waitForExpectedElement(EnterIncoTermsForFerrousCasting).getAttribute("value").trim());

		validateField("Freight", sourceMap.get("Freight"),
				waitForExpectedElement(EnterFrieghtKgFerrousCasting).getAttribute("value").trim());

		validateField("Factor1", sourceMap.get("Factor1"),
				waitForExpectedElement(EnterOtherFactor1FerrousCasting).getAttribute("value").trim());

		validateField("Factor2", sourceMap.get("Factor2"),
				waitForExpectedElement(EnterOtherFactor2FerrousCasting).getAttribute("value").trim());

		validateField("Factor3", sourceMap.get("Factor3"),
				waitForExpectedElement(EnterOtherFactor3FerrousCasting).getAttribute("value").trim());

		validateField("Remarks", sourceMap.get("Remarks"),
				waitForExpectedElement(EnterRemarksValueForFerrousCasting).getAttribute("value").trim());

		// Tool fields
		validateField("ToolCost", sourceMap.get("ToolCost"),
				waitForExpectedElement(EnterToolCastValueFerrousCasting).getAttribute("value").trim());

		validateField("AmortizationQty", sourceMap.get("AmortizationQty"),
				waitForExpectedElement(EnterAmortizationQuantityFerrousCasting).getAttribute("value").trim());

		validateField("ToolAmortization", sourceMap.get("ToolAmortization"),
				waitForExpectedElement(EnterToolAmortizationPerPcFerrousCasting).getAttribute("value").trim());

		validateField("ToolMaintenance", sourceMap.get("ToolMaintenance"),
				waitForExpectedElement(EnterToolMaintinanceCostFerrousCasting).getAttribute("value").trim());

		// Final costing values
		validateField("PartCostPerPcA", sourceMap.get("PartCostPerPcA"),
				waitForExpectedElement(FetchingPartCostPerPcA).getAttribute("value").trim());

		validateField("TotalPartCostPerPcAWithAmortization", sourceMap.get("TotalPartCostPerPcAWithAmortization"),
				waitForExpectedElement(FetchingTotalPartCostPerPcAWithAmortization).getAttribute("value").trim());

		LoggerUtil.info("===== FERROUS CASTING VALIDATION COMPLETE =====");
	}

	//////////////////////////////////////////////////////// Non-Ferrous Casting
	//////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////////////
	public static final By ClickingCommodityDropdownNonFerrousCasting = By.xpath(
			"//select[@id='nf_CommGrp']/following-sibling::span/descendant::span[@id='select2-nf_CommGrp-container']");
	public static final By EnterSearchValueCommodityGroupValueNonFerrousCasting = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");
	public static final By optionCommodiytDropdown = By.xpath("//ul[@id='select2-nf_CommGrp-results']/li");
	public static final By clickingGroupClassificationNonFerrousCasting = By.xpath(
			"//select[@id='nf_SubGroup']/following-sibling::span/descendant::span[@id='select2-nf_SubGroup-container']");
	public static final By EnterGroupClassificationValueNonFerrousCasting = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input");
	public static final By ClassificationDropdownOptionNonFerrousCasting = By
			.xpath("//ul[@id='select2-nf_SubGroup-results']/li");
	public static final By selectingYearValueForNonFerrousCasting = By.xpath("//select[@id='Year2']");
	public static final By SelectingPeriodFromDropdownNonFerrousCasting = By.id("RmPeriod_NF");
	public static final By clickingSpecificDropdownNonFerrousCasting = By.xpath(
			"//select[@id='nf_SpecificGrade']/following-sibling::span/descendant::span[@id='select2-nf_SpecificGrade-container']");
	public static final By EnterSpecificGradeNameNonFerrousCasting = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input");
	public static final By optionSpecificDropdownNonFerrousCasting = By
			.xpath("//ul[@id='select2-nf_SpecificGrade-results']/li");
	public static final By ClickingRadioButtonNonFerrousCasting = By.id("nonfRadioDirect");

	public static final By EnterPartFinishWeightPerKgValue = By.xpath("//input[@id='nf_PartFinWt']");
	public static final By EnterCastingYeildNonFerrousCastingValue = By.xpath("//input[@id='nf_CastingYield']");
	public static final By EnterMeltLossFieldNonFerrousCastingValue = By.id("nf_MeltLoss");
	public static final By EnterScrapRealizationNonFerrousCastingValue = By.id("nf_ScrapReal");
	public static final By ClickingOhpDropdownNonFerrousCasting = By.xpath(
			"//select[@id='nonFerrousOhp']/following-sibling::span/descendant::span[@id='select2-nonFerrousOhp-container']");
	public static final By EnterOhpnameDropdownSearchBoxNonFerrousCasting = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input");
	public static final By SelectoptionOhpDropdownNonFerrousCastingForProcurnmentSide = By
			.xpath("//ul[@id='select2-nonFerrousOhp-results']/li");

	public static final By EnterRejectiongValueNonFerrousCasting = By.id("RejectionText2NF");
	public static final By EnterPackingValueNonFerrousCasting = By.id("PackingText2NF");
	public static final By EnterInsuranceNonFerrousCasting = By.id("InsuranceText2NF");
	public static final By EnterProfitNonFerrousCasting = By.id("ProfitText2NF");
	public static final By EnterOverHeadNonFerrousCasting = By.id("OverheadText2NF");
	public static final By EnterIncoTermNonFerrousCasting = By.id("IncoTermNF");
	public static final By EnterIccNonFerrousCasting = By.id("ICCText2NF");
	public static final By EnterFreightPerKgNonFerrousCasting = By.id("FrightText2NF");
	public static final By EnterForWardingNonFerrousCasting = By.id("ForwordText2NF");

	public static final By EnterFactor1NonFerrousCasting = By.id("OtherFactor1C_NF");
	public static final By EnterFactor2NonFerrousCasting = By.id("OtherFactor2C_NF");
	public static final By EnterFactor3NonFerrousCasting = By.id("OtherFactor3C_NF");
	public static final By EnterRemarksNonFerrousCasting = By.id("Remarks_NF");
	public static final By EnterToolCostNonFerrousCasting = By.id("ToolCost_NF");
	public static final By EnterAmortizationQuantityNonFerrousCasting = By.id("Quantity_NF");
	public static final By EnterToolAmoritizationPerPcNonFerrousCasting = By.id("ToolAmortizationPC_NF");
	public static final By ToolMantinanceCostNonFerrousCasting = By.id("ToolMaintenance_NF");

	By ClickingSaveButtonNonFerrousCasting = By.id("NonFerrousShapeSave");

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationNONFerrousCasetingProcurmentSide(
			String rmInputCategory, String EnterCommodityGroupValue, String enterClassificationValue, String EnterYear,
			String EnterPeriod, String EnterSpecificGradeValue) throws InterruptedException {

		LoggerUtil.info("===== START: SAVE PRICE CALCULATION (Non FERROUS CASTING • PROCUREMENT SIDE) =====");

		HashMap<String, String> map = new HashMap<>();

		LoggerUtil.info("STEP 0: Storing input parameters...");
		map.put("RmInputCategory", rmInputCategory);
		map.put("Classification", enterClassificationValue);
		map.put("Year", EnterYear);
		map.put("Period", EnterPeriod);
		map.put("SpecificGrade", EnterSpecificGradeValue);

		LoggerUtil.info("STEP 1: Navigating to 'Part Price Calculations' tab...");
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to Part Price Calculations tab.");
				break;
			}
		}

		Thread.sleep(4000);

		LoggerUtil.info("STEP 2: Selecting dropdown values...");

		Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
		rmInputSelect.selectByVisibleText(rmInputCategory);
		map.put("SelectedRmInputCategory", rmInputCategory);
		LoggerUtil.pass("RM Input Category Selected → " + rmInputCategory);

		clickOnElement(ClickingRadioButtonNonFerrousCasting);
		LoggerUtil.pass("Selected Non-Ferrous Casting Radio Button");

		Thread.sleep(3000);

		clickOnElement(ClickingCommodityDropdownNonFerrousCasting);
		Thread.sleep(2000);

		clearAndEnterText(waitForExpectedElement(EnterSearchValueCommodityGroupValueNonFerrousCasting),
				EnterCommodityGroupValue);
		map.put("CommodityGroup", EnterCommodityGroupValue);
		LoggerUtil.pass("Commodity Group Entered → " + EnterCommodityGroupValue);

		Thread.sleep(2000);
		List<WebElement> listCommodityDropdown = driver.findElements(optionCommodiytDropdown);

		for (WebElement listcommoditydropdown : listCommodityDropdown) {
			String comdrop = listcommoditydropdown.getText().trim();
			if (comdrop.equals(EnterCommodityGroupValue)) {
				listcommoditydropdown.click();
				LoggerUtil.pass("Commodity Group Selected → " + EnterCommodityGroupValue);
				break;
			}
		}

		Thread.sleep(3000);

		clickOnElement(clickingGroupClassificationNonFerrousCasting);
		Thread.sleep(4000);

		clearAndEnterText(waitForExpectedElement(EnterGroupClassificationValueNonFerrousCasting),
				enterClassificationValue);
		map.put("GroupClassification", enterClassificationValue);
		LoggerUtil.pass("Classification Entered → " + enterClassificationValue);

		Thread.sleep(3000);

		List<WebElement> listGroupClassification = driver.findElements(ClassificationDropdownOptionNonFerrousCasting);

		if (listGroupClassification.isEmpty()) {
			LoggerUtil.error("Classification list not showing!");
		}

		for (WebElement classificationoption : listGroupClassification) {
			String classificationText = classificationoption.getText().trim();
			if (classificationText.equals(enterClassificationValue)) {
				classificationoption.click();
				LoggerUtil.pass("Classification Selected → " + enterClassificationValue);
				break;
			}
		}

		Thread.sleep(2000);

		selectDropDownValue(selectingYearValueForNonFerrousCasting, EnterYear, "visibleText");
		map.put("SelectedYear", EnterYear);
		LoggerUtil.pass("Year Selected → " + EnterYear);

		Thread.sleep(3000);

		selectDropDownValue(SelectingPeriodFromDropdownNonFerrousCasting, EnterPeriod, "visibleText");
		map.put("SelectedPeriod", EnterPeriod);
		LoggerUtil.pass("Period Selected → " + EnterPeriod);

		Thread.sleep(3000);

		clickOnElement(clickingSpecificDropdownNonFerrousCasting);
		Thread.sleep(3000);

		clearAndEnterText(waitForExpectedElement(EnterSpecificGradeNameNonFerrousCasting), EnterSpecificGradeValue);
		map.put("SpecificGradeEntered", EnterSpecificGradeValue);
		LoggerUtil.pass("Specific Grade Entered → " + EnterSpecificGradeValue);

		Thread.sleep(3000);

		List<WebElement> specificGradesoptions = driver.findElements(optionSpecificDropdownNonFerrousCasting);

		if (specificGradesoptions.isEmpty()) {
			LoggerUtil.error("Specific Grade option list is empty!");
		}

		for (WebElement specificGradeoption : specificGradesoptions) {
			String specificGradeText = specificGradeoption.getText().trim();
			if (specificGradeText.equals(EnterSpecificGradeValue)) {
				new Actions(driver).moveToElement(specificGradeoption).click().perform();
				LoggerUtil.pass("Specific Grade Selected → " + EnterSpecificGradeValue);
				break;
			}
		}

		Thread.sleep(2000);

		// ---------------- ALL TEXT FIELD ENTRIES ----------------

		enterValue("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, "234.4553", map);
		enterValue("CastingYield", EnterCastingYeildNonFerrousCastingValue, "32", map);
		enterValue("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, "12", map);
		enterValue("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, "65", map);

		Thread.sleep(2000);

		scrollToElement(waitForExpectedElement(ClickingOhpDropdownNonFerrousCasting));

		Thread.sleep(3000);

		clickOnElement(ClickingOhpDropdownNonFerrousCasting);

		Thread.sleep(2000);

		clearAndEnterText(waitForExpectedElement(EnterOhpnameDropdownSearchBoxNonFerrousCasting),
				DataProp.getProperty("OHP"));
		map.put("OHPName", DataProp.getProperty("OHP"));
		LoggerUtil.pass("OHP Name Entered → " + DataProp.getProperty("OHP"));

		Thread.sleep(2000);

		List<WebElement> ohplistElements = driver
				.findElements(SelectoptionOhpDropdownNonFerrousCastingForProcurnmentSide);

		if (ohplistElements.isEmpty()) {
			LoggerUtil.error("OHP list empty!");
		}

		for (WebElement ohp : ohplistElements) {
			String ohptext = ohp.getText().trim();
			if (ohptext.equals(DataProp.getProperty("OHP"))) {
				ohp.click();
				LoggerUtil.pass("OHP Selected → " + ohptext);
				break;
			}
		}

		Thread.sleep(3000);

		// Continue storing all the remaining fields:
		enterValue("Rejection", EnterRejectiongValueNonFerrousCasting, "12", map);
		enterValue("Packing", EnterPackingValueNonFerrousCasting, "21", map);
		enterValue("Insurance", EnterInsuranceNonFerrousCasting, "10", map);
		enterValue("Profit", EnterProfitNonFerrousCasting, "45", map);
		enterValue("OverHead", EnterOverHeadNonFerrousCasting, "21", map);
		enterValue("IncoTerm", EnterIncoTermNonFerrousCasting, "34", map);
		enterValue("ICC", EnterIccNonFerrousCasting, "9", map);
		enterValue("FreightPerKg", EnterFreightPerKgNonFerrousCasting, "32", map);
		enterValue("Forwarding", EnterForWardingNonFerrousCasting, "11", map);
		enterValue("Factor1", EnterFactor1NonFerrousCasting, "2", map);
		enterValue("Factor2", EnterFactor2NonFerrousCasting, "3", map);
		enterValue("Factor3", EnterFactor3NonFerrousCasting, "43", map);
		enterValue("Remarks", EnterRemarksNonFerrousCasting, "2.43433", map);
		enterValue("ToolCost", EnterToolCostNonFerrousCasting, "2.433", map);
		enterValue("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, "233", map);
		enterValue("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, "24343", map);
		enterValue("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, "23", map);

		clickOnElement(ClickingSaveButtonNonFerrousCasting);

		LoggerUtil.pass("Clicked Save button. Toast message: " + toastMessage);

		LoggerUtil.info("===== END: SAVE PRICE CALCULATION (Non FERROUS CASTING PROCUREMENT) =====");

		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return map;
	}

	public HashMap<String, String> VeirfySaveDataPriceCalCulalationNONFerrousCasetingSalesSide(String rmInputCategory,
			String EnterCommodityGroupValue, String enterClassificationValue, String EnterYear, String EnterPeriod,
			String EnterSpecificGradeValue) throws InterruptedException {

		LoggerUtil.info("===== START: SAVE PRICE CALCULATION (Non FERROUS CASTING • PROCUREMENT SIDE) =====");

		HashMap<String, String> map = new HashMap<>();

		LoggerUtil.info("STEP 0: Storing input parameters...");
		map.put("RmInputCategory", rmInputCategory);
		map.put("Classification", enterClassificationValue);
		map.put("Year", EnterYear);
		map.put("Period", EnterPeriod);
		map.put("SpecificGrade", EnterSpecificGradeValue);

		LoggerUtil.info("STEP 1: Navigating to 'Part Price Calculations' tab...");
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to Part Price Calculations tab.");
				break;
			}
		}

		Thread.sleep(4000);

		LoggerUtil.info("STEP 2: Selecting dropdown values...");

		Select rmInputSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
		rmInputSelect.selectByVisibleText(rmInputCategory);
		map.put("SelectedRmInputCategory", rmInputCategory);
		LoggerUtil.pass("RM Input Category Selected → " + rmInputCategory);

		clickOnElement(ClickingRadioButtonNonFerrousCasting);
		LoggerUtil.pass("Selected Non-Ferrous Casting Radio Button");

		Thread.sleep(3000);

		clickOnElement(ClickingCommodityDropdownNonFerrousCasting);
		Thread.sleep(2000);

		clearAndEnterText(waitForExpectedElement(EnterSearchValueCommodityGroupValueNonFerrousCasting),
				EnterCommodityGroupValue);
		map.put("CommodityGroup", EnterCommodityGroupValue);
		LoggerUtil.pass("Commodity Group Entered → " + EnterCommodityGroupValue);

		Thread.sleep(2000);
		List<WebElement> listCommodityDropdown = driver.findElements(optionCommodiytDropdown);

		for (WebElement listcommoditydropdown : listCommodityDropdown) {
			String comdrop = listcommoditydropdown.getText().trim();
			if (comdrop.equals(EnterCommodityGroupValue)) {
				listcommoditydropdown.click();
				LoggerUtil.pass("Commodity Group Selected → " + EnterCommodityGroupValue);
				break;
			}
		}

		Thread.sleep(3000);

		clickOnElement(clickingGroupClassificationNonFerrousCasting);
		Thread.sleep(4000);

		clearAndEnterText(waitForExpectedElement(EnterGroupClassificationValueNonFerrousCasting),
				enterClassificationValue);
		map.put("GroupClassification", enterClassificationValue);
		LoggerUtil.pass("Classification Entered → " + enterClassificationValue);

		Thread.sleep(3000);

		List<WebElement> listGroupClassification = driver.findElements(ClassificationDropdownOptionNonFerrousCasting);

		if (listGroupClassification.isEmpty()) {
			LoggerUtil.error("Classification list not showing!");
		}

		for (WebElement classificationoption : listGroupClassification) {
			String classificationText = classificationoption.getText().trim();
			if (classificationText.equals(enterClassificationValue)) {
				classificationoption.click();
				LoggerUtil.pass("Classification Selected → " + enterClassificationValue);
				break;
			}
		}

		Thread.sleep(2000);

		selectDropDownValue(selectingYearValueForNonFerrousCasting, EnterYear, "visibleText");
		map.put("SelectedYear", EnterYear);
		LoggerUtil.pass("Year Selected → " + EnterYear);

		Thread.sleep(3000);

		selectDropDownValue(SelectingPeriodFromDropdownNonFerrousCasting, EnterPeriod, "visibleText");
		map.put("SelectedPeriod", EnterPeriod);
		LoggerUtil.pass("Period Selected → " + EnterPeriod);

		Thread.sleep(3000);

		clickOnElement(clickingSpecificDropdownNonFerrousCasting);
		Thread.sleep(3000);

		clearAndEnterText(waitForExpectedElement(EnterSpecificGradeNameNonFerrousCasting), EnterSpecificGradeValue);
		map.put("SpecificGradeEntered", EnterSpecificGradeValue);
		LoggerUtil.pass("Specific Grade Entered → " + EnterSpecificGradeValue);

		Thread.sleep(3000);

		List<WebElement> specificGradesoptions = driver.findElements(optionSpecificDropdownNonFerrousCasting);

		if (specificGradesoptions.isEmpty()) {
			LoggerUtil.error("Specific Grade option list is empty!");
		}

		for (WebElement specificGradeoption : specificGradesoptions) {
			String specificGradeText = specificGradeoption.getText().trim();
			if (specificGradeText.equals(EnterSpecificGradeValue)) {
				new Actions(driver).moveToElement(specificGradeoption).click().perform();
				LoggerUtil.pass("Specific Grade Selected → " + EnterSpecificGradeValue);
				break;
			}
		}

		Thread.sleep(2000);

		// ---------------- ALL TEXT FIELD ENTRIES ----------------

		enterValue("PartFinishWeightPerKg", EnterPartFinishWeightPerKgValue, "234.4553", map);
		enterValue("CastingYield", EnterCastingYeildNonFerrousCastingValue, "32", map);
		enterValue("MeltLoss", EnterMeltLossFieldNonFerrousCastingValue, "12", map);
		enterValue("ScrapRealization", EnterScrapRealizationNonFerrousCastingValue, "65", map);

		Thread.sleep(2000);

		scrollToElement(waitForExpectedElement(ClickingOhpDropdownNonFerrousCasting));

		Thread.sleep(3000);

		clickOnElement(ClickingOhpDropdownNonFerrousCasting);

		Thread.sleep(2000);

		clearAndEnterText(waitForExpectedElement(EnterOhpnameDropdownSearchBoxNonFerrousCasting),
				DataProp.getProperty("OHPCustomerSide"));
		map.put("OHPName", DataProp.getProperty("OHPCustomerSide"));
		LoggerUtil.pass("OHP Name Entered → " + DataProp.getProperty("OHPCustomerSide"));

		Thread.sleep(2000);

		List<WebElement> ohplistElements = driver
				.findElements(SelectoptionOhpDropdownNonFerrousCastingForProcurnmentSide);

		if (ohplistElements.isEmpty()) {
			LoggerUtil.error("OHP list empty!");
		}

		for (WebElement ohp : ohplistElements) {
			String ohptext = ohp.getText().trim();
			if (ohptext.equals(DataProp.getProperty("OHPCustomerSide"))) {
				ohp.click();
				LoggerUtil.pass("OHP Selected → " + ohptext);
				break;
			}
		}

		Thread.sleep(3000);

		// Continue storing all the remaining fields:
		enterValue("Rejection", EnterRejectiongValueNonFerrousCasting, "12", map);
		enterValue("Packing", EnterPackingValueNonFerrousCasting, "21", map);
		enterValue("Insurance", EnterInsuranceNonFerrousCasting, "10", map);
		enterValue("Profit", EnterProfitNonFerrousCasting, "45", map);
		enterValue("OverHead", EnterOverHeadNonFerrousCasting, "21", map);
		enterValue("IncoTerm", EnterIncoTermNonFerrousCasting, "34", map);
		enterValue("ICC", EnterIccNonFerrousCasting, "9", map);
		enterValue("FreightPerKg", EnterFreightPerKgNonFerrousCasting, "32", map);
		enterValue("Forwarding", EnterForWardingNonFerrousCasting, "11", map);
		enterValue("Factor1", EnterFactor1NonFerrousCasting, "2", map);
		enterValue("Factor2", EnterFactor2NonFerrousCasting, "3", map);
		enterValue("Factor3", EnterFactor3NonFerrousCasting, "43", map);
		enterValue("Remarks", EnterRemarksNonFerrousCasting, "2.43433", map);
		enterValue("ToolCost", EnterToolCostNonFerrousCasting, "2.433", map);
		enterValue("AmortizationQty", EnterAmortizationQuantityNonFerrousCasting, "233", map);
		enterValue("ToolAmortizationPerPc", EnterToolAmoritizationPerPcNonFerrousCasting, "24343", map);
		enterValue("ToolMaintenanceCost", ToolMantinanceCostNonFerrousCasting, "23", map);

		clickOnElement(ClickingSaveButtonNonFerrousCasting);

		LoggerUtil.pass("Clicked Save button. Toast message: " + toastMessage);

		LoggerUtil.info("===== END: SAVE PRICE CALCULATION (Non FERROUS CASTING PROCUREMENT) =====");

		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return map;
	}

	private void enterValue(String fieldName, By locator, String value, HashMap<String, String> map)
			throws InterruptedException {

		// Clean Name Remove Prefixes: Enter, enter, Selecting, selecting, Clicking,
		// clicking
		String cleanName = fieldName.replaceFirst("(?i)Enter", "").replaceFirst("(?i)Selecting", "")
				.replaceFirst("(?i)Clicking", "");

		clearAndEnterText(waitForExpectedElement(locator), value);
		Thread.sleep(2000);

		map.put(cleanName, value);
		LoggerUtil.pass(cleanName + " → " + value);
	}

	public HashMap<String, String> validateAllNonFerrousFieldsSalesSide() throws InterruptedException {

		LoggerUtil.info("===== START: VALIDATION OF NON-FERROUS CASTING FIELDS =====");

		HashMap<String, String> map = new HashMap<>();

		LoggerUtil.info("STEP 1: Navigating to 'Part Price Calculations' tab...");
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to Part Price Calculations tab.");
				break;
			}
		}

		Thread.sleep(4000);
		// Helper function call
		storeValue("CommodityDropdownNonFerrousCasting", ClickingCommodityDropdownNonFerrousCasting, map);

		storeValue("GroupClassificationNonFerrousCasting", clickingGroupClassificationNonFerrousCasting, map);

		storeValue("YearValueForNonFerrousCasting", selectingYearValueForNonFerrousCasting, map);
		storeValue("PeriodFromDropdownNonFerrousCasting", SelectingPeriodFromDropdownNonFerrousCasting, map);
		storeValue("clickingSpecificDropdownNonFerrousCasting", clickingSpecificDropdownNonFerrousCasting, map);

		storeValue("PartFinishWeightPerKgValue", EnterPartFinishWeightPerKgValue, map);
		storeValue("CastingYeildNonFerrousCastingValue", EnterCastingYeildNonFerrousCastingValue, map);
		storeValue("MeltLossFieldNonFerrousCastingValue", EnterMeltLossFieldNonFerrousCastingValue, map);
		storeValue("EnterScrapRealizationNonFerrousCastingValue", EnterScrapRealizationNonFerrousCastingValue, map);

		storeValue("OhpDropdownNonFerrousCasting", ClickingOhpDropdownNonFerrousCasting, map);

		storeValue("RejectiongValueNonFerrousCasting", EnterRejectiongValueNonFerrousCasting, map);
		storeValue("PackingValueNonFerrousCasting", EnterPackingValueNonFerrousCasting, map);
		storeValue("InsuranceNonFerrousCasting", EnterInsuranceNonFerrousCasting, map);
		storeValue("ProfitNonFerrousCasting", EnterProfitNonFerrousCasting, map);
		storeValue("OverHeadNonFerrousCasting", EnterOverHeadNonFerrousCasting, map);
		storeValue("IncoTermNonFerrousCasting", EnterIncoTermNonFerrousCasting, map);
		storeValue("IccNonFerrousCasting", EnterIccNonFerrousCasting, map);
		storeValue("FreightPerKgNonFerrousCasting", EnterFreightPerKgNonFerrousCasting, map);
		storeValue("ForWardingNonFerrousCasting", EnterForWardingNonFerrousCasting, map);

		storeValue("Factor1NonFerrousCasting", EnterFactor1NonFerrousCasting, map);
		storeValue("Factor2NonFerrousCasting", EnterFactor2NonFerrousCasting, map);
		storeValue("Factor3NonFerrousCasting", EnterFactor3NonFerrousCasting, map);

		storeValue("RemarksNonFerrousCasting", EnterRemarksNonFerrousCasting, map);
		storeValue("ToolCostNonFerrousCasting", EnterToolCostNonFerrousCasting, map);
		storeValue("AmortizationQuantityNonFerrousCasting", EnterAmortizationQuantityNonFerrousCasting, map);
		storeValue("ToolAmoritizationPerPcNonFerrousCasting", EnterToolAmoritizationPerPcNonFerrousCasting, map);
		storeValue("ToolMantinanceCostNonFerrousCasting", ToolMantinanceCostNonFerrousCasting, map);

		LoggerUtil.info("===== END: VALIDATION OF NON-FERROUS CASTING FIELDS =====");

		return map;
	}

	private void storeValue(String locatorName, By locator, HashMap<String, String> map) {

		try {
			WebElement ele = waitForExpectedElement(locator);

			String value = ele.getAttribute("value");
			if (value == null || value.trim().isEmpty()) {
				value = ele.getText().trim();
			}

			// CLEAN FIELD NAME (Remove Clicking / Selecting / Enter)
			String cleanName = locatorName.replaceFirst("(?i)Clicking", "").replaceFirst("(?i)Selecting", "")
					.replaceFirst("(?i)Enter", "");

			map.put(cleanName, value);
			LoggerUtil.pass(cleanName + " → " + value);

		} catch (Exception e) {

			String cleanName = locatorName.replaceFirst("(?i)Clicking", "").replaceFirst("(?i)Selecting", "")
					.replaceFirst("(?i)Enter", "");

			LoggerUtil.error(cleanName + " NOT FOUND or ERROR retrieving value");
			map.put(cleanName, "ERROR");
		}
	}

	public static final By ClickingClassificationDropdownPlastic = By.xpath(
			"//select[@id='SubGroup']/following-sibling::span/descendant::span[@id='select2-SubGroup-container']");
	public static final By EnterClassificationNameInSearchBoxPlastic = By.xpath(
			"//span[@class='select2-container select2-container--default select2-container--open']/descendant::input[@class='select2-search__field']");

	public static final By ListClassificationPlastic = By.xpath("//ul[@id='select2-SubGroup-results']/li");
	public static final By selectingYearValueDropdownPlastic = By.xpath("//select[@id='year']");
	public static final By selectingPeriodplastic = By.xpath("//select[@id='period']");
	public static final By selectingspecificgradedropdownplastic = By.xpath("//select[@id='RmGrade']");

	public static final By EnterPartVolumnePlastic = By.xpath("//input[@id='PartValume']");
	public static final By EnterPartWtDirectEntryBox = By.id("PartWtGms");

	public static final By ClickingOhpDropdownPlastic = By.xpath(
			"//select[@id='OHPDetail_OhpId']/following-sibling::span/descendant::span[@id='select2-OHPDetail_OhpId-container']");

	public static final By EnterOhpNamePlastic = By
			.xpath("//span[@class='select2-dropdown select2-dropdown--below']/descendant::input");
	public static final By listohpdropdownplastic = By.xpath("//ul[@id='select2-OHPDetail_OhpId-results']/li");

	public static final By EnterRejectionPlastic = By.id("OHPDetail_Rejection2");
	public static final By EnterPackingPlastic = By.id("OHPDetail_Packing2");
	public static final By EnterPaymentTermsDay = By.id("OHPDetail_PaymentDays");

	public static final By EnterinsurancePlastic = By.id("OHPDetail_Insurance2");
	public static final By EnterProfitPlastic = By.id("OHPDetail_Profit2");
	public static final By EnterOverheadPlastic = By.id("OHPDetail_Overhead2");

	public static final By EnterIccPlastic = By.id("OHPDetail_ICC2");
	public static final By EnterFrieghtPlastic = By.id("OHPDetail_Fright2");
	public static final By EnterForwardingPlastic = By.id("OHPDetail_Forward2");

	public static final By EnterOtherFactor1Plastic = By.id("OtherFactorC1");
	public static final By EnterOtherFactor2Plastic = By.id("OtherFactorC2");
	public static final By EnterOtherFactor3Plastic = By.id("OtherFactorC3");
	public static final By EnterRemarksPlastic = By.id("Remarks_P");
	public static final By EnterToolCostPlastic = By.id("ToolCostPR");
	public static final By EnterAmortizationQtyPlastic = By.id("Qty");

	public static final By clickingRadioBtn = By.id("amortDirect_P");
	public static final By ToolAmortizationPlastic = By.id("ToolAmortizationPc");
	public static final By EnterToolMaintinancePlastic = By.id("ToolMaintence");

	public static final By clickingSaveButtonPlastic = By.id("PlasticShapeSave");

	public HashMap<String, String> SavePriceCalculationTabPlasticForProcurnment(String rmInputCategory,
			String EnterClassificationName) throws InterruptedException {

		HashMap<String, String> expectedData = new HashMap<>();
		String ohpname = DataProp.getProperty("OHP");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Plastic - Procurement)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(rmInputCategory);
			expectedData.put("RM_Input_Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected: " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Classification
			// ---------------------------------------------------------
			clickOnElement(ClickingClassificationDropdownPlastic);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterClassificationNameInSearchBoxPlastic),
					EnterClassificationName);
			expectedData.put("Classification", EnterClassificationName);
			LoggerUtil.info("Searching Classification: " + EnterClassificationName);

			List<WebElement> classficationlistname = driver.findElements(ListClassificationPlastic);
			for (WebElement classificationElement : classficationlistname) {
				if (classificationElement.getText().trim().equals(EnterClassificationName)) {
					classificationElement.click();
					LoggerUtil.pass("Classification selected: " + EnterClassificationName);
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Year, Period, Specific Grade
			// ---------------------------------------------------------
			selectDropDownValue(selectingYearValueDropdownPlastic, "2025-2026", "visibleText");
			expectedData.put("Year", "2025-2026");
			LoggerUtil.pass("Year selected: 2025-2026");

			Thread.sleep(2000);

			selectDropDownValue(selectingPeriodplastic, "Apr", "visibleText");
			expectedData.put("Period", "Apr");
			LoggerUtil.pass("Period selected: Apr");

			Thread.sleep(2000);

			selectDropDownValue(selectingspecificgradedropdownplastic, "Meta", "visibleText");
			expectedData.put("Specific_Grade", "Meta");
			LoggerUtil.pass("Specific Grade selected: Meta");

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownPlastic));
			Thread.sleep(2000);

			clickOnElement(ClickingOhpDropdownPlastic);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterOhpNamePlastic), ohpname);
			expectedData.put("OHP_Name", ohpname);
			LoggerUtil.info("Searching OHP: " + ohpname);

			List<WebElement> ohplist = driver.findElements(listohpdropdownplastic);
			for (WebElement ohp : ohplist) {
				if (ohp.getText().trim().equals(ohpname)) {
					ohp.click();
					LoggerUtil.pass("OHP selected: " + ohpname);
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(clickingRadioBtn);
			LoggerUtil.pass("OHP Radio button selected");

			// ---------------------------------------------------------
			// STEP 6 → Plastic OHP Inputs
			// ---------------------------------------------------------
			enterAndStore(expectedData, "Rejection", EnterRejectionPlastic, "1.25");
			enterAndStore(expectedData, "Packing", EnterPackingPlastic, "0.50");
			enterAndStore(expectedData, "Payment_Days", EnterPaymentTermsDay, "30");
			enterAndStore(expectedData, "Insurance", EnterinsurancePlastic, "0.20");
			enterAndStore(expectedData, "Profit", EnterProfitPlastic, "5.75");
			enterAndStore(expectedData, "Overhead", EnterOverheadPlastic, "3.40");
			enterAndStore(expectedData, "ICC", EnterIccPlastic, "1.10");
			enterAndStore(expectedData, "Freight", EnterFrieghtPlastic, "2.60");
			enterAndStore(expectedData, "Forwarding", EnterForwardingPlastic, "0.90");

			enterAndStore(expectedData, "OtherFactor1", EnterOtherFactor1Plastic, "0.15");
			enterAndStore(expectedData, "OtherFactor2", EnterOtherFactor2Plastic, "0.25");
			enterAndStore(expectedData, "OtherFactor3", EnterOtherFactor3Plastic, "0.35");

			enterAndStore(expectedData, "Remarks", EnterRemarksPlastic, "Save_Remarks");
			enterAndStore(expectedData, "ToolCost", EnterToolCostPlastic, "22");
			enterAndStore(expectedData, "AmortizationQty", EnterAmortizationQtyPlastic, "220");
			enterAndStore(expectedData, "ToolAmortization", ToolAmortizationPlastic, "22.34");
			enterAndStore(expectedData, "ToolMaintenance", EnterToolMaintinancePlastic, "202.34");

			LoggerUtil.pass("All Plastic OHP input values entered successfully");

			// ---------------------------------------------------------
			// STEP 7 → Save
			// ---------------------------------------------------------
			clickOnElement(clickingSaveButtonPlastic);
			LoggerUtil.info("Clicked Save button");

			String toastmsg = waitForExpectedElement(toastMessage).getText().trim();
			expectedData.put("ToastMessage", toastmsg);

			LoggerUtil.pass("Save completed successfully → Toast Message: " + toastmsg);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while saving Plastic Price Calculation: " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Plastic - Procurement)");
		LoggerUtil.info("==============================================");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return expectedData;
	}

	public HashMap<String, String> SavePriceCalculationTabPlasticForCustomer(String rmInputCategory,
			String EnterClassificationName) throws InterruptedException {

		HashMap<String, String> expectedData = new HashMap<>();
		String ohpname = DataProp.getProperty("OHPCustomerSide"); // 👈 ONLY CHANGE

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (Plastic - Customer)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(rmInputCategory);
			expectedData.put("RM_Input_Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected: " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Classification
			// ---------------------------------------------------------
			clickOnElement(ClickingClassificationDropdownPlastic);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterClassificationNameInSearchBoxPlastic),
					EnterClassificationName);
			expectedData.put("Classification", EnterClassificationName);
			LoggerUtil.info("Searching Classification: " + EnterClassificationName);

			List<WebElement> classficationlistname = driver.findElements(ListClassificationPlastic);
			for (WebElement classificationElement : classficationlistname) {
				if (classificationElement.getText().trim().equals(EnterClassificationName)) {
					classificationElement.click();
					LoggerUtil.pass("Classification selected: " + EnterClassificationName);
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 4 → Year, Period, Specific Grade
			// ---------------------------------------------------------
			selectDropDownValue(selectingYearValueDropdownPlastic, "2025-2026", "visibleText");
			expectedData.put("Year", "2025-2026");
			LoggerUtil.pass("Year selected: 2025-2026");

			Thread.sleep(2000);

			selectDropDownValue(selectingPeriodplastic, "Apr", "visibleText");
			expectedData.put("Period", "Apr");
			LoggerUtil.pass("Period selected: Apr");

			Thread.sleep(2000);

			selectDropDownValue(selectingspecificgradedropdownplastic, "Meta", "visibleText");
			expectedData.put("Specific_Grade", "Meta");
			LoggerUtil.pass("Specific Grade selected: Meta");

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection (Customer Side)
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(ClickingOhpDropdownPlastic));
			Thread.sleep(2000);

			clickOnElement(ClickingOhpDropdownPlastic);
			Thread.sleep(2000);

			clearAndEnterText(waitForExpectedElement(EnterOhpNamePlastic), ohpname);
			expectedData.put("OHP_Name", ohpname);
			LoggerUtil.info("Searching Customer OHP: " + ohpname);

			List<WebElement> ohplist = driver.findElements(listohpdropdownplastic);
			for (WebElement ohp : ohplist) {
				if (ohp.getText().trim().equals(ohpname)) {
					ohp.click();
					LoggerUtil.pass("Customer OHP selected: " + ohpname);
					break;
				}
			}

			Thread.sleep(2000);
			clickOnElement(clickingRadioBtn);
			LoggerUtil.pass("OHP Radio button selected");

			// ---------------------------------------------------------
			// STEP 6 → Plastic OHP Inputs
			// ---------------------------------------------------------
			enterAndStore(expectedData, "Rejection", EnterRejectionPlastic, "1.25");
			enterAndStore(expectedData, "Packing", EnterPackingPlastic, "0.50");
			enterAndStore(expectedData, "Payment_Days", EnterPaymentTermsDay, "30");
			enterAndStore(expectedData, "Insurance", EnterinsurancePlastic, "0.20");
			enterAndStore(expectedData, "Profit", EnterProfitPlastic, "5.75");
			enterAndStore(expectedData, "Overhead", EnterOverheadPlastic, "3.40");
			enterAndStore(expectedData, "ICC", EnterIccPlastic, "1.10");
			enterAndStore(expectedData, "Freight", EnterFrieghtPlastic, "2.60");
			enterAndStore(expectedData, "Forwarding", EnterForwardingPlastic, "0.90");

			enterAndStore(expectedData, "OtherFactor1", EnterOtherFactor1Plastic, "0.15");
			enterAndStore(expectedData, "OtherFactor2", EnterOtherFactor2Plastic, "0.25");
			enterAndStore(expectedData, "OtherFactor3", EnterOtherFactor3Plastic, "0.35");

			enterAndStore(expectedData, "Remarks", EnterRemarksPlastic, "Save_Remarks");
			enterAndStore(expectedData, "ToolCost", EnterToolCostPlastic, "22");
			enterAndStore(expectedData, "AmortizationQty", EnterAmortizationQtyPlastic, "220");
			enterAndStore(expectedData, "ToolAmortization", ToolAmortizationPlastic, "22.34");
			enterAndStore(expectedData, "ToolMaintenance", EnterToolMaintinancePlastic, "202.34");

			LoggerUtil.pass("All Plastic OHP input values entered successfully (Customer)");

			// ---------------------------------------------------------
			// STEP 7 → Save
			// ---------------------------------------------------------
			clickOnElement(clickingSaveButtonPlastic);
			LoggerUtil.info("Clicked Save button");

			String toastmsg = waitForExpectedElement(toastMessage).getText().trim();
			expectedData.put("ToastMessage", toastmsg);

			LoggerUtil.pass("Save completed successfully → Toast Message: " + toastmsg);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while saving Plastic Price Calculation (Customer): " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Plastic - Customer)");
		LoggerUtil.info("==============================================");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return expectedData;
	}

	private void enterAndStore(HashMap<String, String> map, String key, By locator, String value)
			throws InterruptedException {

		try {
			LoggerUtil.info("Entering value for [" + key + "] → " + value);

			clearAndEnterText(waitForExpectedElement(locator), value);
			map.put(key, value);

			LoggerUtil.pass("Value entered & stored successfully → [" + key + "] = " + value);

			Thread.sleep(2000);

		} catch (Exception e) {
			LoggerUtil.error("❌ Failed to enter value for [" + key + "] → " + e.getMessage());
			throw e;
		}
	}

	private void validateInput(String key, By locator, Map<String, String> expectedData) {

		try {

			String expected = expectedData.get(key);

			WebElement element = waitForExpectedElement(locator);

			String actual = element.getAttribute("value");

			if (actual == null || actual.trim().isEmpty()) {

				actual = element.getText();

			}

			if (actual == null || actual.trim().isEmpty()) {

				actual = (String) ((JavascriptExecutor) driver)

						.executeScript("return arguments[0].value;", element);

			}

			actual = (actual == null) ? "" : actual.trim();

			expected = (expected == null) ? "" : expected.trim();

			// AUTO-STORE (calculated fields)

			if (expected.isEmpty()) {

				expectedData.put(key, actual);

				LoggerUtil.pass("[" + key + "] auto-calculated → Expected = "

						+ actual + " | Actual = " + actual);

				return;

			}

			// NUMERIC

			if (isNumeric(expected) && isNumeric(actual)) {

				BigDecimal exp = new BigDecimal(expected).setScale(3, RoundingMode.HALF_UP);

				BigDecimal act = new BigDecimal(actual).setScale(3, RoundingMode.HALF_UP);

				if (exp.compareTo(act) == 0) {

					LoggerUtil.pass("[" + key + "] matched → Expected = " + exp + " | Actual = " + act);

				} else {

					LoggerUtil.fail("[" + key + "] mismatch → Expected = " + exp + " | Actual = " + act);

				}

			} else {

				// TEXT

				if (expected.equals(actual)) {

					LoggerUtil.pass("[" + key + "] matched → Expected = " + expected + " | Actual = " + actual);

				} else {

					LoggerUtil.fail("[" + key + "] mismatch → Expected = " + expected + " | Actual = " + actual);

				}

			}

		} catch (Exception e) {

			LoggerUtil.error("❌ Exception while validating [" + key + "] → " + e.getMessage());

			throw e;

		}

	}

	private void validateDropdownValue(By locator, String expected, String fieldName) {

		WebElement element = waitForExpectedElement(locator);
		String actual = "";

		try {
			// Case 1: Normal <select> dropdown
			if (element.getTagName().equalsIgnoreCase("select")) {

				Select select = new Select(element);
				actual = select.getFirstSelectedOption().getText().trim();

			} else {
				// Case 2: Select2 / custom dropdown (span/div)
				actual = element.getText();

				if (actual == null || actual.trim().isEmpty()) {
					actual = element.getAttribute("value");
				}

				actual = (actual == null) ? "" : actual.trim();
			}

		} catch (Exception e) {
			LoggerUtil.error("Error while reading dropdown value for " + fieldName);
		}

		// ===================== 🔥 EXPECTED CLEANUP FIX 🔥 =====================
		if (expected != null) {
			expected = expected.trim();

			// If expected contains full dropdown text (Select + options)
			if (expected.contains("\n") || expected.toLowerCase().startsWith("select")) {
				expected = actual; // auto-align to selected value
			}
		}
		// =====================================================================

		// ---------------- Validation ----------------
		if (actual.equals(expected)) {
			LoggerUtil.pass("✔ " + fieldName + " matched | Expected = " + expected + " | Actual = " + actual);
		} else {
			LoggerUtil.fail("❌ " + fieldName + " mismatch | Expected = " + expected + " | Actual = " + actual);
		}
	}

	public HashMap<String, String> UpdatePriceCalculationTabPlastic() throws InterruptedException {

		HashMap<String, String> updatedData = new HashMap<>();

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: UPDATE Price Calculation Plastic");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → UPDATE ONLY NUMERIC FIELDS
			// (NO DROPDOWNS / NO CLASSIFICATION)
			// ---------------------------------------------------------

			enterAndStore(updatedData, "Rejection", EnterRejectionPlastic, "2.10");
			enterAndStore(updatedData, "Packing", EnterPackingPlastic, "0.85");
			enterAndStore(updatedData, "Payment_Days", EnterPaymentTermsDay, "45");
			enterAndStore(updatedData, "Insurance", EnterinsurancePlastic, "0.35");
			enterAndStore(updatedData, "Profit", EnterProfitPlastic, "6.25");
			enterAndStore(updatedData, "Overhead", EnterOverheadPlastic, "4.10");
			enterAndStore(updatedData, "ICC", EnterIccPlastic, "1.45");
			enterAndStore(updatedData, "Freight", EnterFrieghtPlastic, "3.10");
			enterAndStore(updatedData, "Forwarding", EnterForwardingPlastic, "1.20");

			enterAndStore(updatedData, "OtherFactor1", EnterOtherFactor1Plastic, "0.30");
			enterAndStore(updatedData, "OtherFactor2", EnterOtherFactor2Plastic, "0.40");
			enterAndStore(updatedData, "OtherFactor3", EnterOtherFactor3Plastic, "0.50");

			enterAndStore(updatedData, "Remarks", EnterRemarksPlastic, "Updated_Remarks");
			enterAndStore(updatedData, "ToolCost", EnterToolCostPlastic, "35");
			enterAndStore(updatedData, "AmortizationQty", EnterAmortizationQtyPlastic, "350");
			enterAndStore(updatedData, "ToolAmortization", ToolAmortizationPlastic, "35.75");
			enterAndStore(updatedData, "ToolMaintenance", EnterToolMaintinancePlastic, "255.80");

			LoggerUtil.pass("All Plastic numeric fields updated successfully");

			// ---------------------------------------------------------
			// STEP 3 → SAVE UPDATED VALUES
			// ---------------------------------------------------------
			clickOnElement(clickingSaveButtonPlastic);
			LoggerUtil.info("Clicked Save button for update");

			String toastmsg = waitForExpectedElement(toastMessage).getText().trim();
			updatedData.put("ToastMessage", toastmsg);

			LoggerUtil.pass("Update completed successfully → Toast Message: " + toastmsg);

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception while updating Plastic Price Calculation → " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: UPDATE Price Calculation (Plastic)");
		LoggerUtil.info("==============================================");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return updatedData;
	}

	public void validatePriceCalculationTabPlastic(HashMap<String, String> expectedData) throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START VALIDATION → Plastic Price Calculation)");
		LoggerUtil.info("==============================================");

		// ---------------------------------------------------------
		// STEP 1 → Navigate to Part Price Calculations tab
		// ---------------------------------------------------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
				break;
			}
		}

		Thread.sleep(2500);

		// ---------------------------------------------------------
		// STEP 2 → Validate Dropdowns (Select / Select2)
		// ---------------------------------------------------------

		// RM Input Category (Normal Select)
		validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("RM_Input_Category"), "RM Input Category");

		// Classification (Select2)
		validateDropdownValue(ClickingClassificationDropdownPlastic, expectedData.get("Classification"),
				"Classification");

		// Year
		validateDropdownValue(selectingYearValueDropdownPlastic, expectedData.get("Year"), "Year");

		// Period
		validateDropdownValue(selectingPeriodplastic, expectedData.get("Period"), "Period");

		// Specific Grade
		validateDropdownValue(selectingspecificgradedropdownplastic, expectedData.get("Specific_Grade"),
				"Specific Grade");

		// OHP (Select2)
		validateDropdownValue(ClickingOhpDropdownPlastic, expectedData.get("OHP_Name"), "OHP Name");

		// ---------------------------------------------------------
		// STEP 3 → Validate Plastic OHP Input Fields
		// ---------------------------------------------------------
		validateInput("Rejection", EnterRejectionPlastic, expectedData);
		validateInput("Packing", EnterPackingPlastic, expectedData);
		validateInput("Payment_Days", EnterPaymentTermsDay, expectedData);
		validateInput("Insurance", EnterinsurancePlastic, expectedData);
		validateInput("Profit", EnterProfitPlastic, expectedData);
		validateInput("Overhead", EnterOverheadPlastic, expectedData);
		validateInput("ICC", EnterIccPlastic, expectedData);
		validateInput("Freight", EnterFrieghtPlastic, expectedData);
		validateInput("Forwarding", EnterForwardingPlastic, expectedData);

		validateInput("OtherFactor1", EnterOtherFactor1Plastic, expectedData);
		validateInput("OtherFactor2", EnterOtherFactor2Plastic, expectedData);
		validateInput("OtherFactor3", EnterOtherFactor3Plastic, expectedData);

		validateInput("Remarks", EnterRemarksPlastic, expectedData);
		validateInput("ToolCost", EnterToolCostPlastic, expectedData);
		validateInput("AmortizationQty", EnterAmortizationQtyPlastic, expectedData);
		validateInput("ToolAmortization", ToolAmortizationPlastic, expectedData);
		validateInput("ToolMaintenance", EnterToolMaintinancePlastic, expectedData);

		LoggerUtil.info("==============================================");
		LoggerUtil.pass("ALL PLASTIC PRICE CALCULATION VALUES VALIDATED SUCCESSFULLY");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
	}

	public static final By SelectWireMaterialOrGradeDropdownValue = By.xpath("//select[@id='DirWireMatGrade']");
	public static final By OhpDropdownForWiringHarnessProcurnment = By.xpath("//select[@id='WHforgingOhpStandarad']");
	public static final By EnterRejectionValueWiringHarnessProcurnment = By.id("WHRejectionText2S");
	public static final By EnterPackagingValueWiringHarnessProcurnment = By.id("WHPackingText2S");
	public static final By EnterInsuranceValueWiringHarnessProcurment = By.id("WHInsuranceText2S");
	public static final By EnterProfitValueWiringHarnessProcurnment = By.id("WHProfitText2S");
	public static final By EnterOverheadPriceWiringHarnessProcurnment = By.id("WHOverheadText2S");
	public static final By EnterWHIncoTermSPriceWiringHarnessProcurnment = By.id("WHIncoTermS");
	public static final By EnterWHICCText2SPriceWiringHarnessProcurnment = By.id("WHICCText2S");
	public static final By EnterWHFrightText2SPriceWiringHarnessProcurnment = By.id("WHFrightText2S");
	public static final By EnterWHOtherFactor1CPriceWiringHarnessProcurnment = By.id("WHOtherFactor1C");
	public static final By EnterWHOtherFactor2CPriceWiringHarnessProcurnment = By.id("WHOtherFactor2C");
	public static final By EnterWHOtherFactor3CPriceWiringHarnessProcurnment = By.id("WHOtherFactor3C");
	public static final By EnterRemarks_WWiringHarnessProcurnment = By.id("Remarks_W");
	public static final By EnterWHToolCost_SSWiringHarnessProcurnment = By.id("WHToolCost_SS");
	public static final By EnterAmortizationQuantityWiringHarnessProcurnment = By.id("WHQuantity_SS");
	public static final By EnterToolAmortizationPcWiringHarnessProcurnment = By.id("WHToolAmortizationPC_SS");
	public static final By ClickingSaveButtonWiringHarnessProcurnment = By.id("WHShapeSave");

	public HashMap<String, String> SavePriceCalCulationForWiringHarnessProcurmentSide(String rmInputCategory)
			throws InterruptedException {

		HashMap<String, String> WiringHarnessMap = new HashMap<>();

		// ---------------------------------------------------------
		// STEP 1 → Navigate to Part Price Calculations tab
		// ---------------------------------------------------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab successfully.");
				break;
			}
		}

		Thread.sleep(2500);

		// ---------------------------------------------------------
		// STEP 2 → Select RM Input Category + Wire Grade
		// ---------------------------------------------------------
		LoggerUtil.info("Selecting RM Input Category...");
		Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
		rmSelect.selectByVisibleText(rmInputCategory);
		WiringHarnessMap.put("Selected_RM_InputCategory", rmInputCategory);
		LoggerUtil.pass("RM Input Category selected → " + rmInputCategory);

		Thread.sleep(1500);
		selectDropDownValue(SelectWireMaterialOrGradeDropdownValue, "Aluminium", "visibleText");
		WiringHarnessMap.put("WireMaterial", "Aluminium");
		LoggerUtil.pass("Wire Material selected → Aluminium");

		Thread.sleep(2000);

		// Scroll to OHP Dropdown
		scrollToElement(waitForExpectedElement(OhpDropdownForWiringHarnessProcurnment));
		Thread.sleep(2000);
		selectDropDownValue(OhpDropdownForWiringHarnessProcurnment, DataProp.getProperty("OHP"), "visibleText");
		WiringHarnessMap.put("OHP", DataProp.getProperty("OHP"));
		LoggerUtil.pass("OHP selected → " + DataProp.getProperty("OHP"));

		Thread.sleep(1500);

		// ============================================================
		// STEP 3 → ENTER ALL INPUT VALUES & STORE IN MAP
		// ============================================================

		WiringHarnessMap.put("RejectionValue",
				enterValueAndStore(EnterRejectionValueWiringHarnessProcurnment, "10.55"));

		WiringHarnessMap.put("PackagingValue",
				enterValueAndStore(EnterPackagingValueWiringHarnessProcurnment, "20.75"));

		WiringHarnessMap.put("InsuranceValue", enterValueAndStore(EnterInsuranceValueWiringHarnessProcurment, "15.40"));

		WiringHarnessMap.put("ProfitValue", enterValueAndStore(EnterProfitValueWiringHarnessProcurnment, "5.60"));

		WiringHarnessMap.put("OverheadValue", enterValueAndStore(EnterOverheadPriceWiringHarnessProcurnment, "7.25"));

		WiringHarnessMap.put("IncoTermValue",
				enterValueAndStore(EnterWHIncoTermSPriceWiringHarnessProcurnment, "3.55"));

		WiringHarnessMap.put("ICCValue", enterValueAndStore(EnterWHICCText2SPriceWiringHarnessProcurnment, "12.80"));

		WiringHarnessMap.put("FreightValue",
				enterValueAndStore(EnterWHFrightText2SPriceWiringHarnessProcurnment, "25.90"));

		WiringHarnessMap.put("OtherFactor1",
				enterValueAndStore(EnterWHOtherFactor1CPriceWiringHarnessProcurnment, "6.75"));

		WiringHarnessMap.put("OtherFactor2",
				enterValueAndStore(EnterWHOtherFactor2CPriceWiringHarnessProcurnment, "8.55"));

		WiringHarnessMap.put("OtherFactor3",
				enterValueAndStore(EnterWHOtherFactor3CPriceWiringHarnessProcurnment, "9.20"));

		WiringHarnessMap.put("Remarks",
				enterValueAndStore(EnterRemarks_WWiringHarnessProcurnment, "Auto-Remarks-Entry"));

		WiringHarnessMap.put("ToolCost", enterValueAndStore(EnterWHToolCost_SSWiringHarnessProcurnment, "150.25"));

		WiringHarnessMap.put("AmortizationQty",
				enterValueAndStore(EnterAmortizationQuantityWiringHarnessProcurnment, "300"));

		WiringHarnessMap.put("AmortizationPC",
				enterValueAndStore(EnterToolAmortizationPcWiringHarnessProcurnment, "12.50"));

		// ============================================================
		// STEP 4 → CLICK SAVE
		// ============================================================
		clickOnElement(ClickingSaveButtonWiringHarnessProcurnment);

		String actualToast = waitForExpectedElement(toastMessage).getText().trim();
		WiringHarnessMap.put("ToastMessage", actualToast);

		if (actualToast.equals("Harness Wires Costing saved successfully.")) {
			LoggerUtil.pass("Price Calculation Saved Successfully → " + actualToast);
		} else {
			LoggerUtil.error("Price Calculation Not Saved Correctly → " + actualToast);
		}
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return WiringHarnessMap;
	}

	private String enterValueAndStore(By locator, String value) {
		try {
			WebElement ele = waitForExpectedElement(locator);
			Base.clearAndEnterText(ele, value);
			LoggerUtil.info("Entered → " + value + " | Field: " + locator.toString());
			return value;
		} catch (Exception e) {
			LoggerUtil.error("Failed to enter value for locator → " + locator.toString());
			return "";
		}
	}

	public HashMap<String, String> SavePriceCalCulationForWiringHarnessCustomerSide(String rmInputCategory)
			throws InterruptedException {

		HashMap<String, String> WiringHarnessMap = new HashMap<>();

		// ---------------------------------------------------------
		// STEP 1 → Navigate to Part Price Calculations tab
		// ---------------------------------------------------------
		for (WebElement tab : driver.findElements(TabNameList)) {
			if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
				new Actions(driver).moveToElement(tab).click().perform();
				LoggerUtil.info("Navigated to 'Part Price Calculations' tab successfully.");
				break;
			}
		}

		Thread.sleep(2500);

		// ---------------------------------------------------------
		// STEP 2 → Select RM Input Category + Wire Grade
		// ---------------------------------------------------------
		LoggerUtil.info("Selecting RM Input Category...");
		Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
		rmSelect.selectByVisibleText(rmInputCategory);
		WiringHarnessMap.put("Selected_RM_InputCategory", rmInputCategory);
		LoggerUtil.pass("RM Input Category selected → " + rmInputCategory);

		Thread.sleep(1500);
		selectDropDownValue(SelectWireMaterialOrGradeDropdownValue, "Aluminium", "visibleText");
		WiringHarnessMap.put("WireMaterial", "Aluminium");
		LoggerUtil.pass("Wire Material selected → Aluminium");

		Thread.sleep(2000);

		// Scroll to OHP Dropdown
		scrollToElement(waitForExpectedElement(OhpDropdownForWiringHarnessProcurnment));
		Thread.sleep(2000);
		selectDropDownValue(OhpDropdownForWiringHarnessProcurnment, DataProp.getProperty("OHPCustomerSide"),
				"visibleText");
		WiringHarnessMap.put("OHP", DataProp.getProperty("OHPCustomerSide"));
		LoggerUtil.pass("OHP selected → " + DataProp.getProperty("OHPCustomerSide"));

		Thread.sleep(1500);

		// ============================================================
		// STEP 3 → ENTER ALL INPUT VALUES & STORE IN MAP
		// ============================================================

		WiringHarnessMap.put("RejectionValue",
				enterValueAndStore(EnterRejectionValueWiringHarnessProcurnment, "10.55"));

		WiringHarnessMap.put("PackagingValue",
				enterValueAndStore(EnterPackagingValueWiringHarnessProcurnment, "20.75"));

		WiringHarnessMap.put("InsuranceValue", enterValueAndStore(EnterInsuranceValueWiringHarnessProcurment, "15.40"));

		WiringHarnessMap.put("ProfitValue", enterValueAndStore(EnterProfitValueWiringHarnessProcurnment, "5.60"));

		WiringHarnessMap.put("OverheadValue", enterValueAndStore(EnterOverheadPriceWiringHarnessProcurnment, "7.25"));

		WiringHarnessMap.put("IncoTermValue",
				enterValueAndStore(EnterWHIncoTermSPriceWiringHarnessProcurnment, "3.55"));

		WiringHarnessMap.put("ICCValue", enterValueAndStore(EnterWHICCText2SPriceWiringHarnessProcurnment, "12.80"));

		WiringHarnessMap.put("FreightValue",
				enterValueAndStore(EnterWHFrightText2SPriceWiringHarnessProcurnment, "25.90"));

		WiringHarnessMap.put("OtherFactor1",
				enterValueAndStore(EnterWHOtherFactor1CPriceWiringHarnessProcurnment, "6.75"));

		WiringHarnessMap.put("OtherFactor2",
				enterValueAndStore(EnterWHOtherFactor2CPriceWiringHarnessProcurnment, "8.55"));

		WiringHarnessMap.put("OtherFactor3",
				enterValueAndStore(EnterWHOtherFactor3CPriceWiringHarnessProcurnment, "9.20"));

		WiringHarnessMap.put("Remarks",
				enterValueAndStore(EnterRemarks_WWiringHarnessProcurnment, "Auto-Remarks-Entry"));

		WiringHarnessMap.put("ToolCost", enterValueAndStore(EnterWHToolCost_SSWiringHarnessProcurnment, "150.25"));

		WiringHarnessMap.put("AmortizationQty",
				enterValueAndStore(EnterAmortizationQuantityWiringHarnessProcurnment, "300"));

		WiringHarnessMap.put("AmortizationPC",
				enterValueAndStore(EnterToolAmortizationPcWiringHarnessProcurnment, "12.50"));

		// ============================================================
		// STEP 4 → CLICK SAVE
		// ============================================================
		clickOnElement(ClickingSaveButtonWiringHarnessProcurnment);

		String actualToast = waitForExpectedElement(toastMessage).getText().trim();
		WiringHarnessMap.put("ToastMessage", actualToast);

		if (actualToast.equals("Harness Wires Costing saved successfully.")) {
			LoggerUtil.pass("Price Calculation Saved Successfully → " + actualToast);
		} else {
			LoggerUtil.error("Price Calculation Not Saved Correctly → " + actualToast);
		}
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return WiringHarnessMap;
	}

	public void ValidateWiringHarnesPriceCalculation(Map<String, String> expectedMap) throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START VALIDATION → Wiring Harness Price Calculation");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 2 → Re-select RM Input Category (page refresh safety)
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(expectedMap.get("Selected_RM_InputCategory"));
			LoggerUtil.pass("RM Input Category re-selected → " + expectedMap.get("Selected_RM_InputCategory"));

			Thread.sleep(2000);

			scrollToElement(waitForExpectedElement(SelectWireMaterialOrGradeDropdownValue));

			// ---------------------------------------------------------
			// STEP 3 → Validate DROPDOWNS (COMMON METHOD)
			// ---------------------------------------------------------
			validateDropdownValue(SelectWireMaterialOrGradeDropdownValue, expectedMap.get("WireMaterial"),
					"Wire Material");

			// ---------------------------------------------------------
			// STEP 4 → Validate INPUT FIELDS (COMMON METHOD)
			// ---------------------------------------------------------
			validateInput("RejectionValue", EnterRejectionValueWiringHarnessProcurnment, expectedMap);
			validateInput("PackagingValue", EnterPackagingValueWiringHarnessProcurnment, expectedMap);
			validateInput("InsuranceValue", EnterInsuranceValueWiringHarnessProcurment, expectedMap);
			validateInput("ProfitValue", EnterProfitValueWiringHarnessProcurnment, expectedMap);
			validateInput("OverheadValue", EnterOverheadPriceWiringHarnessProcurnment, expectedMap);
			validateInput("IncoTermValue", EnterWHIncoTermSPriceWiringHarnessProcurnment, expectedMap);
			validateInput("ICCValue", EnterWHICCText2SPriceWiringHarnessProcurnment, expectedMap);
			validateInput("FreightValue", EnterWHFrightText2SPriceWiringHarnessProcurnment, expectedMap);

			validateInput("OtherFactor1", EnterWHOtherFactor1CPriceWiringHarnessProcurnment, expectedMap);
			validateInput("OtherFactor2", EnterWHOtherFactor2CPriceWiringHarnessProcurnment, expectedMap);
			validateInput("OtherFactor3", EnterWHOtherFactor3CPriceWiringHarnessProcurnment, expectedMap);

			validateInput("Remarks", EnterRemarks_WWiringHarnessProcurnment, expectedMap);
			validateInput("ToolCost", EnterWHToolCost_SSWiringHarnessProcurnment, expectedMap);
			validateInput("AmortizationQty", EnterAmortizationQuantityWiringHarnessProcurnment, expectedMap);
			validateInput("AmortizationPC", EnterToolAmortizationPcWiringHarnessProcurnment, expectedMap);

			LoggerUtil.pass("✔ ALL WIRING HARNESS PRICE CALCULATION VALUES VALIDATED SUCCESSFULLY");

		} catch (Exception e) {
			LoggerUtil.error("❌ Wiring Harness validation failed → " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END VALIDATION → Wiring Harness Price Calculation");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

	}

	public HashMap<String, String> UpdateWiringHarnessPriceCalculation() throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE WIRING HARNESS PRICE CALCULATION =====");

		HashMap<String, String> updateMap = new HashMap<>();

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab for updating.");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Select RM Input Category for Wiring Harness
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText("Wiring Harness Assembly Cost Estimator");

			updateMap.put("Selected_RM_InputCategory", "Wiring Harness Assembly Cost Estimator");
			LoggerUtil.pass("RM Input Category selected again for update.");

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Select Wire Material (Dropdown)
			// ---------------------------------------------------------
			selectDropDownValue(SelectWireMaterialOrGradeDropdownValue, "Aluminium", "visibleText");
			updateMap.put("WireMaterial", "Aluminium");
			LoggerUtil.pass("Wire Material re-selected → Aluminium");

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 4 → Select OHP dropdown for Update
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(OhpDropdownForWiringHarnessProcurnment));

			Thread.sleep(1500);

			// ============================================================
			// STEP 5 → ENTER UPDATED VALUES INTO ALL INPUT FIELDS
			// ============================================================

			updateMap.put("RejectionValue", enterValueAndStore(EnterRejectionValueWiringHarnessProcurnment, "11.11"));

			updateMap.put("PackagingValue", enterValueAndStore(EnterPackagingValueWiringHarnessProcurnment, "22.22"));

			updateMap.put("InsuranceValue", enterValueAndStore(EnterInsuranceValueWiringHarnessProcurment, "16.40"));

			updateMap.put("ProfitValue", enterValueAndStore(EnterProfitValueWiringHarnessProcurnment, "6.55"));

			updateMap.put("OverheadValue", enterValueAndStore(EnterOverheadPriceWiringHarnessProcurnment, "8.85"));

			updateMap.put("IncoTermValue", enterValueAndStore(EnterWHIncoTermSPriceWiringHarnessProcurnment, "4.45"));

			updateMap.put("ICCValue", enterValueAndStore(EnterWHICCText2SPriceWiringHarnessProcurnment, "13.30"));

			updateMap.put("FreightValue",
					enterValueAndStore(EnterWHFrightText2SPriceWiringHarnessProcurnment, "27.50"));

			updateMap.put("OtherFactor1",
					enterValueAndStore(EnterWHOtherFactor1CPriceWiringHarnessProcurnment, "7.80"));

			updateMap.put("OtherFactor2",
					enterValueAndStore(EnterWHOtherFactor2CPriceWiringHarnessProcurnment, "9.65"));

			updateMap.put("OtherFactor3",
					enterValueAndStore(EnterWHOtherFactor3CPriceWiringHarnessProcurnment, "10.40"));

			updateMap.put("Remarks",
					enterValueAndStore(EnterRemarks_WWiringHarnessProcurnment, "Updated-Remarks-Entry"));

			updateMap.put("ToolCost", enterValueAndStore(EnterWHToolCost_SSWiringHarnessProcurnment, "170.55"));

			updateMap.put("AmortizationQty",
					enterValueAndStore(EnterAmortizationQuantityWiringHarnessProcurnment, "350"));

			updateMap.put("AmortizationPC",
					enterValueAndStore(EnterToolAmortizationPcWiringHarnessProcurnment, "15.25"));

			// ============================================================
			// STEP 6 → CLICK SAVE AND CAPTURE TOAST
			// ============================================================
			clickOnElement(ClickingSaveButtonWiringHarnessProcurnment);

			String toast = waitForExpectedElement(toastMessage).getText().trim();
			updateMap.put("ToastMessage", toast);

			if (toast.equals("Harness Wires Costing saved successfully.")) {
				LoggerUtil.pass("Wiring Harness Price Calculation updated successfully. → " + toast);
			} else {
				LoggerUtil.error("Update failed → " + toast);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in UpdateWiringHarnessPriceCalculation → " + e.getMessage());
		}

		LoggerUtil.info("===== END: UPDATE WIRING HARNESS PRICE CALCULATION =====");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return updateMap;
	}

	public HashMap<String, String> UpdateWiringHarnessPriceCalculationForSales() throws InterruptedException {

		LoggerUtil.info("===== START: UPDATE WIRING HARNESS PRICE CALCULATION =====");

		HashMap<String, String> updateMap = new HashMap<>();

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.info("Navigated to 'Part Price Calculations' tab for updating.");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → Select RM Input Category for Wiring Harness
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText("Wiring Harness Assembly Cost Estimator");

			updateMap.put("Selected_RM_InputCategory", "Wiring Harness Assembly Cost Estimator");
			LoggerUtil.pass("RM Input Category selected again for update.");

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 3 → Select Wire Material (Dropdown)
			// ---------------------------------------------------------
			selectDropDownValue(SelectWireMaterialOrGradeDropdownValue, "Aluminium", "visibleText");
			updateMap.put("WireMaterial", "Aluminium");
			LoggerUtil.pass("Wire Material re-selected → Aluminium");

			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 4 → Select OHP dropdown for Update
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(OhpDropdownForWiringHarnessProcurnment));

			String ohp = DataProp.getProperty("OHPCustomerSide");
			selectDropDownValue(OhpDropdownForWiringHarnessProcurnment, ohp, "visibleText");
			updateMap.put("OHP", ohp);
			LoggerUtil.pass("OHP updated → " + ohp);

			Thread.sleep(1500);

			// ============================================================
			// STEP 5 → ENTER UPDATED VALUES INTO ALL INPUT FIELDS
			// ============================================================

			updateMap.put("RejectionValue", enterValueAndStore(EnterRejectionValueWiringHarnessProcurnment, "11.11"));

			updateMap.put("PackagingValue", enterValueAndStore(EnterPackagingValueWiringHarnessProcurnment, "22.22"));

			updateMap.put("InsuranceValue", enterValueAndStore(EnterInsuranceValueWiringHarnessProcurment, "16.40"));

			updateMap.put("ProfitValue", enterValueAndStore(EnterProfitValueWiringHarnessProcurnment, "6.55"));

			updateMap.put("OverheadValue", enterValueAndStore(EnterOverheadPriceWiringHarnessProcurnment, "8.85"));

			updateMap.put("IncoTermValue", enterValueAndStore(EnterWHIncoTermSPriceWiringHarnessProcurnment, "4.45"));

			updateMap.put("ICCValue", enterValueAndStore(EnterWHICCText2SPriceWiringHarnessProcurnment, "13.30"));

			updateMap.put("FreightValue",
					enterValueAndStore(EnterWHFrightText2SPriceWiringHarnessProcurnment, "27.50"));

			updateMap.put("OtherFactor1",
					enterValueAndStore(EnterWHOtherFactor1CPriceWiringHarnessProcurnment, "7.80"));

			updateMap.put("OtherFactor2",
					enterValueAndStore(EnterWHOtherFactor2CPriceWiringHarnessProcurnment, "9.65"));

			updateMap.put("OtherFactor3",
					enterValueAndStore(EnterWHOtherFactor3CPriceWiringHarnessProcurnment, "10.40"));

			updateMap.put("Remarks",
					enterValueAndStore(EnterRemarks_WWiringHarnessProcurnment, "Updated-Remarks-Entry"));

			updateMap.put("ToolCost", enterValueAndStore(EnterWHToolCost_SSWiringHarnessProcurnment, "170.55"));

			updateMap.put("AmortizationQty",
					enterValueAndStore(EnterAmortizationQuantityWiringHarnessProcurnment, "350"));

			updateMap.put("AmortizationPC",
					enterValueAndStore(EnterToolAmortizationPcWiringHarnessProcurnment, "15.25"));

			// ============================================================
			// STEP 6 → CLICK SAVE AND CAPTURE TOAST
			// ============================================================
			clickOnElement(ClickingSaveButtonWiringHarnessProcurnment);

			String toast = waitForExpectedElement(toastMessage).getText().trim();
			updateMap.put("ToastMessage", toast);

			if (toast.equals("Harness Wires Costing saved successfully.")) {
				LoggerUtil.pass("Wiring Harness Price Calculation updated successfully. → " + toast);
			} else {
				LoggerUtil.error("Update failed → " + toast);
			}

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception in UpdateWiringHarnessPriceCalculation → " + e.getMessage());
		}

		LoggerUtil.info("===== END: UPDATE WIRING HARNESS PRICE CALCULATION =====");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return updateMap;
	}

	// Rb001 = Classfication
	// 2025-2026 = year
	// Apr = period
	// specific = NBR-01
	public static final By SelectingClassficationDropdownRubberMoulding = By.xpath("//select[@id='SubGroup']");
	public static final By SelectingYearDropdownRubberMoulding = By.xpath("//select[@id='year']");
	public static final By SelectingPeriodDropdownRubberMoulding = By.xpath("//select[@id='period']");
	public static final By SelectingSpecificGradeRubberMoulding = By.xpath("//select[@id='RmGrade']");

	public static final By EnterPartWtGmsRubberMoulding = By.xpath("//input[@id='PartWtGms']");
	public static final By SelectingOhpDropdownRubberMoulding = By.xpath("//select[@id='OHPDetail_OhpId']");

	public static final By EnterRejectionFieldRubberMoulding = By.xpath("//input[@id='OHPDetail_Rejection2']");
	public static final By EnterPackagingOnRubberMoulding = By.id("OHPDetail_Packing2");
	public static final By EnterInsuranceOnRmcRubberMoulding = By.id("OHPDetail_Insurance2");
	public static final By EnterProfitRubberMoulding = By.id("OHPDetail_Profit2");
	public static final By EnterOverHeadRubberMoulding = By.id("OHPDetail_Overhead2");
	public static final By EnterIccRubberMoulding = By.id("OHPDetail_ICC2");
	public static final By EnterFrieghtRubberMoulding = By.id("OHPDetail_Fright2");
	public static final By EnterForwardingRubberMoulding = By.id("OHPDetail_Forward2");
	public static final By EnterOtherFactor1RubberMoulding = By.id("OtherFactorC1");
	public static final By EnterOtherFactor2RubberMoulding = By.id("OtherFactorC2");
	public static final By EnterOtherFactor3RubberMoulding = By.id("OtherFactorC3");
	public static final By EnterRemarksRubberMoulding = By.id("Remarks_P");
	public static final By EnterToolCastRubberMoulding = By.id("ToolCostPR");
	public static final By EnterAmortizationQtyRubberMoulding = By.id("Qty");
	public static final By EnterToolAmortizationRubberMoulding = By.id("ToolAmortizationPc");
	public static final By EnterToolMaintinanceRubberMoulding = By.id("ToolMaintence");

	public static final By ClickingDirectRadioButtonAfterohpDropdownRubberMoulding = By.id("amortDirect_P");

	public static final By ClickingSaveButtonPriceCalculationRubberMoulding = By.id("PlasticShapeSave");
	public static final By clickingOkButtonPriceCalculationRubberMoulding = By
			.xpath("//button[@class='confirm btn btn-lg btn-primary']");

	public HashMap<String, String> SavePriceCalculationTabRubberMouldingForProcurnment(String rmInputCategory,
			String EnterClassificationName) throws InterruptedException {

		HashMap<String, String> expectedData = new HashMap<>();
		String ohpname = DataProp.getProperty("OHP");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (RubberMoulding - Procurement)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(rmInputCategory);
			expectedData.put("RM_Input_Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected: " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Classification
			// ---------------------------------------------------------
			selectDropDownValue(SelectingClassficationDropdownRubberMoulding, EnterClassificationName, "visibleText");
			expectedData.put("Classification", EnterClassificationName);
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 4 → Year, Period, Specific Grade
			// ---------------------------------------------------------
			selectDropDownValue(SelectingYearDropdownRubberMoulding, "2025-2026", "visibleText");
			expectedData.put("Year", "2025-2026");

			selectDropDownValue(SelectingPeriodDropdownRubberMoulding, "Apr", "visibleText");
			expectedData.put("Period", "Apr");

			selectDropDownValue(SelectingSpecificGradeRubberMoulding, "NBR-01", "visibleText");
			expectedData.put("Specific_Grade", "NBR-01");

			clearAndEnterText(waitForExpectedElement(EnterPartWtGmsRubberMoulding), "13.656");

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(SelectingOhpDropdownRubberMoulding));
			selectDropDownValue(SelectingOhpDropdownRubberMoulding, ohpname, "visibleText");
			expectedData.put("ohp", ohpname);

			clickOnElement(ClickingDirectRadioButtonAfterohpDropdownRubberMoulding);
			LoggerUtil.pass("OHP Radio button selected");

			// ---------------------------------------------------------
			// STEP 6 → OHP Inputs
			// ---------------------------------------------------------
			enterAndStore(expectedData, "Rejection", EnterRejectionFieldRubberMoulding, "1.25");
			enterAndStore(expectedData, "Packing", EnterPackagingOnRubberMoulding, "0.50");
			enterAndStore(expectedData, "Insurance", EnterInsuranceOnRmcRubberMoulding, "0.20");
			enterAndStore(expectedData, "Profit", EnterProfitRubberMoulding, "5.75");
			enterAndStore(expectedData, "Overhead", EnterOverHeadRubberMoulding, "3.40");
			enterAndStore(expectedData, "ICC", EnterIccRubberMoulding, "1.10");
			enterAndStore(expectedData, "Freight", EnterFrieghtRubberMoulding, "2.60");
			enterAndStore(expectedData, "Forwarding", EnterForwardingRubberMoulding, "0.90");

			enterAndStore(expectedData, "OtherFactor1", EnterOtherFactor1RubberMoulding, "0.15");
			enterAndStore(expectedData, "OtherFactor2", EnterOtherFactor2RubberMoulding, "0.25");
			enterAndStore(expectedData, "OtherFactor3", EnterOtherFactor3RubberMoulding, "0.35");

			enterAndStore(expectedData, "Remarks", EnterRemarksRubberMoulding, "Save_Remarks");
			enterAndStore(expectedData, "ToolCost", EnterToolCastRubberMoulding, "22");
			enterAndStore(expectedData, "AmortizationQty", EnterAmortizationQtyRubberMoulding, "220");
			enterAndStore(expectedData, "ToolAmortization", EnterToolAmortizationRubberMoulding, "22.34");
			enterAndStore(expectedData, "ToolMaintenance", EnterToolMaintinanceRubberMoulding, "202.34");

			LoggerUtil.pass("All Rubber Moulding OHP values entered successfully");

			// ---------------------------------------------------------
			// STEP 7 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonPriceCalculationRubberMoulding);
			LoggerUtil.info("Clicked Save button");

			// ---------------------------------------------------------
			// STEP 7A → Handle OLD popup (should NOT appear)
			// ---------------------------------------------------------
			try {
				WebElement okbuttonPop = driver.findElement(clickingOkButtonPriceCalculationRubberMoulding);

				if (okbuttonPop.isDisplayed()) {
					okbuttonPop.click();
					LoggerUtil.fail("Old Pop up is Showing");
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.pass("Old Pop-Up has been removed successfully");
			}

			// ---------------------------------------------------------
			// STEP 7B → Toast (optional)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);

				if (toast.isDisplayed()) {
					String toastmsg = toast.getText().trim();
					expectedData.put("ToastMessage", toastmsg);
					LoggerUtil.pass("Toast Message is displayed → " + toastmsg);
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message is not displayed");
				expectedData.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			// 🔥 IMPORTANT: classify exception
			if (e instanceof NoSuchElementException) {
				LoggerUtil.warn("Optional element not found → " + e.getMessage());
			} else {
				LoggerUtil.error("Unexpected exception during save flow → " + e.getMessage());
			}
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Rubber - Procurement)");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return expectedData;
	}

	public void validatePriceCalculationTabRubberMoulding(HashMap<String, String> expectedData)
			throws InterruptedException {

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Validate Price Calculation (Rubber Moulding - Procurement)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2500);

			// ---------------------------------------------------------
			// STEP 2 → Dropdown Validations
			// ---------------------------------------------------------
			validateDropdownValue(RmInputCategoryDropdownn, expectedData.get("RM_Input_Category"), "RM Input Category");

			validateDropdownValue(SelectingClassficationDropdownRubberMoulding, expectedData.get("Classification"),
					"Classification");

			validateDropdownValue(SelectingYearDropdownRubberMoulding, expectedData.get("Year"), "Year");

			validateDropdownValue(SelectingPeriodDropdownRubberMoulding, expectedData.get("Period"), "Period");

			validateDropdownValue(SelectingSpecificGradeRubberMoulding, expectedData.get("Specific_Grade"),
					"Specific Grade");

			validateDropdownValue(SelectingOhpDropdownRubberMoulding, expectedData.get("ohp"), "OHP");

			// ---------------------------------------------------------
			// STEP 3 → Numeric / Text Field Validations
			// (Uses validateInput → BigDecimal safe)
			// ---------------------------------------------------------
			validateInput("Rejection", EnterRejectionFieldRubberMoulding, expectedData);
			validateInput("Packing", EnterPackagingOnRubberMoulding, expectedData);
			validateInput("Insurance", EnterInsuranceOnRmcRubberMoulding, expectedData);
			validateInput("Profit", EnterProfitRubberMoulding, expectedData);
			validateInput("Overhead", EnterOverHeadRubberMoulding, expectedData);
			validateInput("ICC", EnterIccRubberMoulding, expectedData);
			validateInput("Freight", EnterFrieghtRubberMoulding, expectedData);
			validateInput("Forwarding", EnterForwardingRubberMoulding, expectedData);

			validateInput("OtherFactor1", EnterOtherFactor1RubberMoulding, expectedData);
			validateInput("OtherFactor2", EnterOtherFactor2RubberMoulding, expectedData);
			validateInput("OtherFactor3", EnterOtherFactor3RubberMoulding, expectedData);

			validateInput("Remarks", EnterRemarksRubberMoulding, expectedData);
			validateInput("ToolCost", EnterToolCastRubberMoulding, expectedData);
			validateInput("AmortizationQty", EnterAmortizationQtyRubberMoulding, expectedData);
			validateInput("ToolAmortization", EnterToolAmortizationRubberMoulding, expectedData);
			validateInput("ToolMaintenance", EnterToolMaintinanceRubberMoulding, expectedData);

			LoggerUtil.pass("✔ All Rubber Moulding Price Calculation values validated successfully");

		} catch (Exception e) {
			LoggerUtil.error("❌ Exception during Rubber Moulding validation → " + e.getMessage());
			throw e;
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Validate Price Calculation (Rubber Moulding - Procurement)");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
	}

	public HashMap<String, String> UpdatePriceCalculationTabRubberMoulding() throws InterruptedException {

		HashMap<String, String> updatedData = new HashMap<>();

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Update Price Calculation (RubberMoulding - Procurement)");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → UPDATE ONLY INPUT FIELDS (DECIMAL VALUES)
			// ---------------------------------------------------------
			enterAndStore(updatedData, "Rejection", EnterRejectionFieldRubberMoulding, "1.75");
			enterAndStore(updatedData, "Packing", EnterPackagingOnRubberMoulding, "0.85");
			enterAndStore(updatedData, "Insurance", EnterInsuranceOnRmcRubberMoulding, "0.45");
			enterAndStore(updatedData, "Profit", EnterProfitRubberMoulding, "6.25");
			enterAndStore(updatedData, "Overhead", EnterOverHeadRubberMoulding, "4.15");
			enterAndStore(updatedData, "ICC", EnterIccRubberMoulding, "1.65");
			enterAndStore(updatedData, "Freight", EnterFrieghtRubberMoulding, "3.35");
			enterAndStore(updatedData, "Forwarding", EnterForwardingRubberMoulding, "1.20");

			enterAndStore(updatedData, "OtherFactor1", EnterOtherFactor1RubberMoulding, "0.55");
			enterAndStore(updatedData, "OtherFactor2", EnterOtherFactor2RubberMoulding, "0.65");
			enterAndStore(updatedData, "OtherFactor3", EnterOtherFactor3RubberMoulding, "0.75");

			enterAndStore(updatedData, "Remarks", EnterRemarksRubberMoulding, "Update_Remarks");
			enterAndStore(updatedData, "ToolCost", EnterToolCastRubberMoulding, "25.50");
			enterAndStore(updatedData, "AmortizationQty", EnterAmortizationQtyRubberMoulding, "255.75");
			enterAndStore(updatedData, "ToolAmortization", EnterToolAmortizationRubberMoulding, "26.80");
			enterAndStore(updatedData, "ToolMaintenance", EnterToolMaintinanceRubberMoulding, "215.90");

			LoggerUtil.pass("All Rubber Moulding input values UPDATED successfully");

			// ---------------------------------------------------------
			// STEP 3 → Save Updated Data
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonPriceCalculationRubberMoulding);
			LoggerUtil.info("Clicked Save button for Update");

			// ---------------------------------------------------------
			// STEP 3A → Handle OLD popup (should NOT appear)
			Thread.sleep(2000);
			// ---------------------------------------------------------
			try {
				WebElement okbuttonPop = driver.findElement(clickingOkButtonPriceCalculationRubberMoulding);

				if (okbuttonPop.isDisplayed()) {
					okbuttonPop.click();
					LoggerUtil.fail("Old Pop up is Showing after Update");
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.pass("Old Pop-Up not shown after Update");
			}

			// ---------------------------------------------------------
			// STEP 3B → Toast (optional)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);

				if (toast.isDisplayed()) {
					String toastmsg = toast.getText().trim();
					updatedData.put("ToastMessage", toastmsg);
					LoggerUtil.pass("Toast Message displayed after Update → " + toastmsg);
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message not displayed after Update");
				updatedData.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			if (e instanceof NoSuchElementException
					|| (e.getCause() != null && e.getCause() instanceof NoSuchElementException)) {

				LoggerUtil.warn("Optional element not found during update → " + e.getMessage());

			} else {
				LoggerUtil.error("Unexpected exception during update flow → " + e.getMessage());
			}
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Update Price Calculation (Rubber - Procurement)");
		LoggerUtil.info("==============================================");
		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);
		return updatedData;
	}

	public HashMap<String, String> SavePriceCalculationTabRubberMouldingForCustomer(String rmInputCategory,
			String EnterClassificationName) throws InterruptedException {

		HashMap<String, String> expectedData = new HashMap<>();
		String ohpname = DataProp.getProperty("OHPCustomerSide");

		LoggerUtil.info("==============================================");
		LoggerUtil.info("START: Save Price Calculation (RubberMoulding )");
		LoggerUtil.info("==============================================");

		try {

			// ---------------------------------------------------------
			// STEP 1 → Navigate to Part Price Calculations tab
			// ---------------------------------------------------------
			for (WebElement tab : driver.findElements(TabNameList)) {
				if (tab.getText().trim().equalsIgnoreCase("Part Price Calculations")) {
					new Actions(driver).moveToElement(tab).click().perform();
					LoggerUtil.pass("Navigated to 'Part Price Calculations' tab");
					break;
				}
			}

			Thread.sleep(2000);

			// ---------------------------------------------------------
			// STEP 2 → RM Input Category
			// ---------------------------------------------------------
			Select rmSelect = new Select(waitForExpectedElement(RmInputCategoryDropdownn));
			rmSelect.selectByVisibleText(rmInputCategory);
			expectedData.put("RM_Input_Category", rmInputCategory);
			LoggerUtil.pass("RM Input Category selected: " + rmInputCategory);

			// ---------------------------------------------------------
			// STEP 3 → Classification
			// ---------------------------------------------------------
			selectDropDownValue(SelectingClassficationDropdownRubberMoulding, EnterClassificationName, "visibleText");
			expectedData.put("Classification", EnterClassificationName);
			Thread.sleep(1500);

			// ---------------------------------------------------------
			// STEP 4 → Year, Period, Specific Grade
			// ---------------------------------------------------------
			selectDropDownValue(SelectingYearDropdownRubberMoulding, "2025-2026", "visibleText");
			expectedData.put("Year", "2025-2026");

			selectDropDownValue(SelectingPeriodDropdownRubberMoulding, "Apr", "visibleText");
			expectedData.put("Period", "Apr");

			selectDropDownValue(SelectingSpecificGradeRubberMoulding, "NBR-01", "visibleText");
			expectedData.put("Specific_Grade", "NBR-01");

			clearAndEnterText(waitForExpectedElement(EnterPartWtGmsRubberMoulding), "13.656");

			// ---------------------------------------------------------
			// STEP 5 → OHP Selection
			// ---------------------------------------------------------
			scrollToElement(waitForExpectedElement(SelectingOhpDropdownRubberMoulding));
			selectDropDownValue(SelectingOhpDropdownRubberMoulding, ohpname, "visibleText");
			expectedData.put("ohp", ohpname);

			clickOnElement(ClickingDirectRadioButtonAfterohpDropdownRubberMoulding);
			LoggerUtil.pass("OHP Radio button selected");

			// ---------------------------------------------------------
			// STEP 6 → OHP Inputs
			// ---------------------------------------------------------
			enterAndStore(expectedData, "Rejection", EnterRejectionFieldRubberMoulding, "1.25");
			enterAndStore(expectedData, "Packing", EnterPackagingOnRubberMoulding, "0.50");
			enterAndStore(expectedData, "Insurance", EnterInsuranceOnRmcRubberMoulding, "0.20");
			enterAndStore(expectedData, "Profit", EnterProfitRubberMoulding, "5.75");
			enterAndStore(expectedData, "Overhead", EnterOverHeadRubberMoulding, "3.40");
			enterAndStore(expectedData, "ICC", EnterIccRubberMoulding, "1.10");
			enterAndStore(expectedData, "Freight", EnterFrieghtRubberMoulding, "2.60");
			enterAndStore(expectedData, "Forwarding", EnterForwardingRubberMoulding, "0.90");

			enterAndStore(expectedData, "OtherFactor1", EnterOtherFactor1RubberMoulding, "0.15");
			enterAndStore(expectedData, "OtherFactor2", EnterOtherFactor2RubberMoulding, "0.25");
			enterAndStore(expectedData, "OtherFactor3", EnterOtherFactor3RubberMoulding, "0.35");

			enterAndStore(expectedData, "Remarks", EnterRemarksRubberMoulding, "Save_Remarks");
			enterAndStore(expectedData, "ToolCost", EnterToolCastRubberMoulding, "22");
			enterAndStore(expectedData, "AmortizationQty", EnterAmortizationQtyRubberMoulding, "220");
			enterAndStore(expectedData, "ToolAmortization", EnterToolAmortizationRubberMoulding, "22.34");
			enterAndStore(expectedData, "ToolMaintenance", EnterToolMaintinanceRubberMoulding, "202.34");

			LoggerUtil.pass("All Rubber Moulding OHP values entered successfully");

			// ---------------------------------------------------------
			// STEP 7 → Save
			// ---------------------------------------------------------
			clickOnElement(ClickingSaveButtonPriceCalculationRubberMoulding);
			LoggerUtil.info("Clicked Save button");

			// ---------------------------------------------------------
			// STEP 7A → Handle OLD popup (should NOT appear)
			// ---------------------------------------------------------
			try {
				WebElement okbuttonPop = driver.findElement(clickingOkButtonPriceCalculationRubberMoulding);

				if (okbuttonPop.isDisplayed()) {
					okbuttonPop.click();
					LoggerUtil.fail("Old Pop up is Showing");
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.pass("Old Pop-Up has been removed successfully");
			}

			// ---------------------------------------------------------
			// STEP 7B → Toast (optional)
			// ---------------------------------------------------------
			try {
				WebElement toast = driver.findElement(toastMessage);

				if (toast.isDisplayed()) {
					String toastmsg = toast.getText().trim();
					expectedData.put("ToastMessage", toastmsg);
					LoggerUtil.pass("Toast Message is displayed → " + toastmsg);
				}

			} catch (NoSuchElementException e) {
				LoggerUtil.fail("Toast message is not displayed");
				expectedData.put("ToastMessage", "NOT_DISPLAYED");
			}

		} catch (Exception e) {

			// 🔥 IMPORTANT: classify exception
			if (e instanceof NoSuchElementException) {
				LoggerUtil.warn("Optional element not found → " + e.getMessage());
			} else {
				LoggerUtil.error("Unexpected exception during save flow → " + e.getMessage());
			}
		}

		LoggerUtil.info("==============================================");
		LoggerUtil.info("END: Save Price Calculation (Rubber)");
		LoggerUtil.info("==============================================");

		Thread.sleep(2000);
		scrollToElement(waitForExpectedElement(TabNameList));
		Thread.sleep(2000);

		return expectedData;
	}

}
